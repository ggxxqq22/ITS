{"ast":null,"code":"import { polygon as basePolygon } from '../../adaptor/geometries/polygon';\nimport { interaction, animation, theme, legend, annotation, tooltip } from '../../adaptor/common';\nimport { flow, deepAssign } from '../../utils';\nimport { transformData } from './utils';\n/**\n * 获取默认 option\n * @param params\n */\n\nfunction defaultOptions(params) {\n  var options = params.options;\n  var colorField = options.colorField;\n  return deepAssign({\n    options: {\n      // 默认按照 name 字段对颜色进行分类\n      colorField: 'name',\n      rectStyle: {\n        lineWidth: 1,\n        stroke: '#fff'\n      },\n      hierarchyConfig: {\n        tile: 'treemapResquarify'\n      },\n      label: {\n        fields: ['name'],\n        layout: {\n          type: 'limit-in-shape'\n        }\n      },\n      tooltip: {\n        showMarkers: false,\n        showTitle: false,\n        fields: ['name', 'value', colorField],\n        formatter: function (data) {\n          return {\n            name: data.name,\n            value: data.value\n          };\n        }\n      }\n    }\n  }, params);\n}\n/**\n * 字段\n * @param params\n */\n\n\nfunction geometry(params) {\n  var chart = params.chart,\n      options = params.options;\n  var color = options.color,\n      colorField = options.colorField,\n      rectStyle = options.rectStyle;\n  var data = transformData(options);\n  chart.data(data); // geometry\n\n  basePolygon(deepAssign({}, params, {\n    options: {\n      xField: 'x',\n      yField: 'y',\n      seriesField: colorField,\n      rawFields: ['value'],\n      polygon: {\n        color: color,\n        style: rectStyle\n      }\n    }\n  }));\n  return params;\n}\n/**\n * 坐标轴\n * @param params\n */\n\n\nfunction axis(params) {\n  var chart = params.chart;\n  chart.axis(false);\n  return params;\n}\n/**\n * 矩形树图\n * @param chart\n * @param options\n */\n\n\nexport function adaptor(params) {\n  return flow(defaultOptions, geometry, axis, theme, legend, tooltip, interaction, animation, annotation())(params);\n}","map":{"version":3,"sources":["../../../src/plots/treemap/adaptor.ts"],"names":[],"mappings":"AAAA,SAAS,OAAO,IAAI,WAApB,QAAuC,kCAAvC;AAEA,SAAS,WAAT,EAAsB,SAAtB,EAAiC,KAAjC,EAAwC,MAAxC,EAAgD,UAAhD,EAA4D,OAA5D,QAA2E,sBAA3E;AACA,SAAS,IAAT,EAAe,UAAf,QAAiC,aAAjC;AACA,SAAS,aAAT,QAA8B,SAA9B;AAGA;;;AAGG;;AACH,SAAS,cAAT,CAAwB,MAAxB,EAAsD;AAC5C,MAAA,OAAO,GAAK,MAAM,CAAX,OAAP;AACA,MAAA,UAAU,GAAK,OAAO,CAAZ,UAAV;AAER,SAAO,UAAU,CACf;AACE,IAAA,OAAO,EAAE;AACP;AACA,MAAA,UAAU,EAAE,MAFL;AAGP,MAAA,SAAS,EAAE;AACT,QAAA,SAAS,EAAE,CADF;AAET,QAAA,MAAM,EAAE;AAFC,OAHJ;AAOP,MAAA,eAAe,EAAE;AACf,QAAA,IAAI,EAAE;AADS,OAPV;AAUP,MAAA,KAAK,EAAE;AACL,QAAA,MAAM,EAAE,CAAC,MAAD,CADH;AAEL,QAAA,MAAM,EAAE;AACN,UAAA,IAAI,EAAE;AADA;AAFH,OAVA;AAgBP,MAAA,OAAO,EAAE;AACP,QAAA,WAAW,EAAE,KADN;AAEP,QAAA,SAAS,EAAE,KAFJ;AAGP,QAAA,MAAM,EAAE,CAAC,MAAD,EAAS,OAAT,EAAkB,UAAlB,CAHD;AAIP,QAAA,SAAS,EAAE,UAAC,IAAD,EAAK;AACd,iBAAO;AACL,YAAA,IAAI,EAAE,IAAI,CAAC,IADN;AAEL,YAAA,KAAK,EAAE,IAAI,CAAC;AAFP,WAAP;AAID;AATM;AAhBF;AADX,GADe,EA+Bf,MA/Be,CAAjB;AAiCD;AAED;;;AAGG;;;AACH,SAAS,QAAT,CAAkB,MAAlB,EAAgD;AACtC,MAAA,KAAK,GAAc,MAAM,CAApB,KAAL;AAAA,MAAO,OAAO,GAAK,MAAM,CAAX,OAAd;AACA,MAAA,KAAK,GAA4B,OAAO,CAAnC,KAAL;AAAA,MAAO,UAAU,GAAgB,OAAO,CAAvB,UAAjB;AAAA,MAAmB,SAAS,GAAK,OAAO,CAAZ,SAA5B;AACR,MAAM,IAAI,GAAG,aAAa,CAAC,OAAD,CAA1B;AACA,EAAA,KAAK,CAAC,IAAN,CAAW,IAAX,EAJ8C,CAM9C;;AACA,EAAA,WAAW,CACT,UAAU,CAAC,EAAD,EAAK,MAAL,EAAa;AACrB,IAAA,OAAO,EAAE;AACP,MAAA,MAAM,EAAE,GADD;AAEP,MAAA,MAAM,EAAE,GAFD;AAGP,MAAA,WAAW,EAAE,UAHN;AAIP,MAAA,SAAS,EAAE,CAAC,OAAD,CAJJ;AAKP,MAAA,OAAO,EAAE;AACP,QAAA,KAAK,EAAA,KADE;AAEP,QAAA,KAAK,EAAE;AAFA;AALF;AADY,GAAb,CADD,CAAX;AAeA,SAAO,MAAP;AACD;AAED;;;AAGG;;;AACH,SAAS,IAAT,CAAc,MAAd,EAA4C;AAClC,MAAA,KAAK,GAAK,MAAM,CAAX,KAAL;AACR,EAAA,KAAK,CAAC,IAAN,CAAW,KAAX;AACA,SAAO,MAAP;AACD;AAED;;;;AAIG;;;AACH,OAAM,SAAU,OAAV,CAAkB,MAAlB,EAAgD;AACpD,SAAO,IAAI,CAAC,cAAD,EAAiB,QAAjB,EAA2B,IAA3B,EAAiC,KAAjC,EAAwC,MAAxC,EAAgD,OAAhD,EAAyD,WAAzD,EAAsE,SAAtE,EAAiF,UAAU,EAA3F,CAAJ,CAAmG,MAAnG,CAAP;AACD","sourcesContent":["import { polygon as basePolygon } from '../../adaptor/geometries/polygon';\nimport { Params } from '../../core/adaptor';\nimport { interaction, animation, theme, legend, annotation, tooltip } from '../../adaptor/common';\nimport { flow, deepAssign } from '../../utils';\nimport { transformData } from './utils';\nimport { TreemapOptions } from './types';\n\n/**\n * 获取默认 option\n * @param params\n */\nfunction defaultOptions(params: Params<TreemapOptions>): Params<TreemapOptions> {\n  const { options } = params;\n  const { colorField } = options;\n\n  return deepAssign(\n    {\n      options: {\n        // 默认按照 name 字段对颜色进行分类\n        colorField: 'name',\n        rectStyle: {\n          lineWidth: 1,\n          stroke: '#fff',\n        },\n        hierarchyConfig: {\n          tile: 'treemapResquarify',\n        },\n        label: {\n          fields: ['name'],\n          layout: {\n            type: 'limit-in-shape',\n          },\n        },\n        tooltip: {\n          showMarkers: false,\n          showTitle: false,\n          fields: ['name', 'value', colorField],\n          formatter: (data) => {\n            return {\n              name: data.name,\n              value: data.value,\n            };\n          },\n        },\n      },\n    },\n    params\n  );\n}\n\n/**\n * 字段\n * @param params\n */\nfunction geometry(params: Params<TreemapOptions>): Params<TreemapOptions> {\n  const { chart, options } = params;\n  const { color, colorField, rectStyle } = options;\n  const data = transformData(options);\n  chart.data(data);\n\n  // geometry\n  basePolygon(\n    deepAssign({}, params, {\n      options: {\n        xField: 'x',\n        yField: 'y',\n        seriesField: colorField,\n        rawFields: ['value'],\n        polygon: {\n          color,\n          style: rectStyle,\n        },\n      },\n    })\n  );\n\n  return params;\n}\n\n/**\n * 坐标轴\n * @param params\n */\nfunction axis(params: Params<TreemapOptions>): Params<TreemapOptions> {\n  const { chart } = params;\n  chart.axis(false);\n  return params;\n}\n\n/**\n * 矩形树图\n * @param chart\n * @param options\n */\nexport function adaptor(params: Params<TreemapOptions>) {\n  return flow(defaultOptions, geometry, axis, theme, legend, tooltip, interaction, animation, annotation())(params);\n}\n"],"sourceRoot":""},"metadata":{},"sourceType":"module"}