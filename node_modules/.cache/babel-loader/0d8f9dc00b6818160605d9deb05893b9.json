{"ast":null,"code":"import React, { useState, useEffect } from 'react';\nimport * as d3 from 'd3';\nconst InnerList = ['Camden', 'Greenwich', 'Hackney', 'Hammersmith and Fulham', 'Islington', 'Kensington and Chelsea', 'Lambeth', 'Lewisham', 'Southwark', 'Tower Hamlets', 'Wandsworth', 'Westminster'];\nexport const useData = () => {\n  const [data, setData] = useState(null);\n  useEffect(() => {\n    console.log('1');\n    d3.csv('./happy.csv').then(d => {\n      let data = {};\n      d.map((l, index) => {\n        //l 结构：\n        // Code: \"E09000001\"\n        // Area: \"City of London\"\n        // 2011/12: \"x\"\n        // 2012/13: \"x\"\n        // 2013/14: \"x\"\n        // 2014/15: \"x\"\n        // 2015/16: \"x\"\n        // 2016/17: \"x\"\n        let pro = Object.getOwnPropertyNames(l); // console.log(l);\n\n        pro.map((n, index) => {\n          if (index > 1) {\n            if (data[n] === undefined) {\n              data[n] = {};\n            }\n\n            if (data[n][l['Area']] === undefined) {\n              data[n][l['Area']] = {};\n            }\n\n            data[n][l['Area']].happy = l[n];\n\n            if (InnerList.indexOf(l['Area'].toString()) >= 0) {\n              console.log('innner');\n              data[n][l['Area']].Area = 'InnerLondon';\n            } else data[n][l['Area']].Area = 'OuterLondon';\n          }\n        }); // l.map((t,i)=>{\n        //     if(i>1){\n        //         if(data[i]===undefined){\n        //             data[i]=[]\n        //         }\n        //         // data[i].happy=\n        //         console.log(Object.getOwnPropertyNames(t))\n        //     }\n        //\n        // })\n      }); // hpData=d;\n      // console.log('data:',data);\n\n      d3.csv('./worthwhile.csv').then(d => {\n        d.map((l, index) => {\n          let pro = Object.getOwnPropertyNames(l);\n          pro.map((n, index) => {\n            if (index > 1) {\n              if (data[n] === undefined) {\n                data[n] = {};\n              }\n\n              if (data[n][l['Area']] === undefined) {\n                data[n][l['Area']] = {};\n              }\n\n              data[n][l['Area']].worth = l[n];\n            }\n          });\n        });\n        setData(data);\n      });\n    });\n  }, []); //这里加这个[],可以让这个useEffect只执行一次\n\n  return data;\n};","map":{"version":3,"sources":["/home/zhiguangda/ITS/deckgl/src/components/city/useData.js"],"names":["React","useState","useEffect","d3","InnerList","useData","data","setData","console","log","csv","then","d","map","l","index","pro","Object","getOwnPropertyNames","n","undefined","happy","indexOf","toString","Area","worth"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport * as d3 from 'd3';\n\nconst InnerList=['Camden',\n    'Greenwich',\n    'Hackney',\n    'Hammersmith and Fulham',\n    'Islington',\n    'Kensington and Chelsea',\n    'Lambeth',\n    'Lewisham',\n    'Southwark',\n    'Tower Hamlets',\n    'Wandsworth',\n    'Westminster']\n\nexport const useData = () => {\n    const [data, setData] = useState(null);\n    useEffect(() => {\n        console.log('1');\n        d3.csv('./happy.csv').then(d=>{\n            let data={};\n            d.map((l,index)=>{\n                //l 结构：\n                // Code: \"E09000001\"\n                // Area: \"City of London\"\n                // 2011/12: \"x\"\n                // 2012/13: \"x\"\n                // 2013/14: \"x\"\n                // 2014/15: \"x\"\n                // 2015/16: \"x\"\n                // 2016/17: \"x\"\n                let pro=Object.getOwnPropertyNames(l);\n                // console.log(l);\n                pro.map((n,index)=>{\n                    if(index>1){\n                        if(data[n]===undefined){\n                            data[n]={}\n                        }\n                        if(data[n][l['Area']]===undefined){\n                            data[n][l['Area']]={};\n                        }\n                        data[n][l['Area']].happy=l[n];\n                        if(InnerList.indexOf(l['Area'].toString())>=0){\n                            console.log('innner')\n                            data[n][l['Area']].Area='InnerLondon'\n                        }\n                        else data[n][l['Area']].Area='OuterLondon'\n                    }\n\n                })\n                // l.map((t,i)=>{\n                //     if(i>1){\n                //         if(data[i]===undefined){\n                //             data[i]=[]\n                //         }\n                //         // data[i].happy=\n                //         console.log(Object.getOwnPropertyNames(t))\n                //     }\n                //\n                // })\n            })\n            // hpData=d;\n            // console.log('data:',data);\n            d3.csv('./worthwhile.csv').then(d=>{\n                d.map((l,index)=>{\n                    let pro=Object.getOwnPropertyNames(l);\n                    pro.map((n,index)=>{\n                        if(index>1){\n                            if(data[n]===undefined){\n                                data[n]={}\n                            }\n                            if(data[n][l['Area']]===undefined){\n                                data[n][l['Area']]={};\n                            }\n                            data[n][l['Area']].worth=l[n];\n                        }\n                    })\n                })\n                setData(data)\n            });\n        })\n    },[]);//这里加这个[],可以让这个useEffect只执行一次\n\n    return data;\n};\n"]},"metadata":{},"sourceType":"module"}