{"ast":null,"code":"(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports) : typeof define === 'function' && define.amd ? define(['exports'], factory) : (global = typeof globalThis !== 'undefined' ? globalThis : global || self, factory(global.F2 = {}));\n})(this, function (exports) {\n  'use strict';\n\n  var isArrayLike = function (value) {\n    /**\n     * isArrayLike([1, 2, 3]) => true\n     * isArrayLike(document.body.children) => true\n     * isArrayLike('abc') => true\n     * isArrayLike(Function) => false\n     */\n    return value !== null && typeof value !== 'function' && isFinite(value.length);\n  };\n\n  var contains = function (arr, value) {\n    if (!isArrayLike(arr)) {\n      return false;\n    }\n\n    return arr.indexOf(value) > -1;\n  };\n\n  var filter = function (arr, func) {\n    if (!isArrayLike(arr)) {\n      return arr;\n    }\n\n    var result = [];\n\n    for (var index = 0; index < arr.length; index++) {\n      var value = arr[index];\n\n      if (func(value, index)) {\n        result.push(value);\n      }\n    }\n\n    return result;\n  };\n\n  var toString = {}.toString;\n\n  var isType = function (value, type) {\n    return toString.call(value) === '[object ' + type + ']';\n  };\n  /**\n   * 是否为函数\n   * @param  {*} fn 对象\n   * @return {Boolean}  是否函数\n   */\n\n\n  var isFunction = function (value) {\n    return isType(value, 'Function');\n  }; // isFinite,\n\n\n  var isNil = function (value) {\n    /**\n     * isNil(null) => true\n     * isNil() => true\n     */\n    return value === null || value === undefined;\n  };\n\n  var isArray = function (value) {\n    return Array.isArray ? Array.isArray(value) : isType(value, 'Array');\n  };\n\n  var isObject = function (value) {\n    /**\n     * isObject({}) => true\n     * isObject([1, 2, 3]) => true\n     * isObject(Function) => true\n     * isObject(null) => false\n     */\n    var type = typeof value;\n    return value !== null && type === 'object' || type === 'function';\n  };\n\n  function each(elements, func) {\n    if (!elements) {\n      return;\n    }\n\n    var rst;\n\n    if (isArray(elements)) {\n      for (var i = 0, len = elements.length; i < len; i++) {\n        rst = func(elements[i], i);\n\n        if (rst === false) {\n          break;\n        }\n      }\n    } else if (isObject(elements)) {\n      for (var k in elements) {\n        if (elements.hasOwnProperty(k)) {\n          rst = func(elements[k], k);\n\n          if (rst === false) {\n            break;\n          }\n        }\n      }\n    }\n  }\n\n  var keys = Object.keys ? function (obj) {\n    return Object.keys(obj);\n  } : function (obj) {\n    var result = [];\n    each(obj, function (value, key) {\n      if (!(isFunction(obj) && key === 'prototype')) {\n        result.push(key);\n      }\n    });\n    return result;\n  };\n\n  function isMatch(obj, attrs) {\n    var _keys = keys(attrs);\n\n    var length = _keys.length;\n    if (isNil(obj)) return !length;\n\n    for (var i = 0; i < length; i += 1) {\n      var key = _keys[i];\n\n      if (attrs[key] !== obj[key] || !(key in obj)) {\n        return false;\n      }\n    }\n\n    return true;\n  }\n\n  var isObjectLike = function (value) {\n    /**\n     * isObjectLike({}) => true\n     * isObjectLike([1, 2, 3]) => true\n     * isObjectLike(Function) => false\n     * isObjectLike(null) => false\n     */\n    return typeof value === 'object' && value !== null;\n  };\n\n  var isPlainObject = function (value) {\n    /**\n     * isObjectLike(new Foo) => false\n     * isObjectLike([1, 2, 3]) => false\n     * isObjectLike({ x: 0, y: 0 }) => true\n     * isObjectLike(Object.create(null)) => true\n     */\n    if (!isObjectLike(value) || !isType(value, 'Object')) {\n      return false;\n    }\n\n    if (Object.getPrototypeOf(value) === null) {\n      return true;\n    }\n\n    var proto = value;\n\n    while (Object.getPrototypeOf(proto) !== null) {\n      proto = Object.getPrototypeOf(proto);\n    }\n\n    return Object.getPrototypeOf(value) === proto;\n  };\n\n  function find(arr, predicate) {\n    if (!isArray(arr)) return null;\n\n    var _predicate;\n\n    if (isFunction(predicate)) {\n      _predicate = predicate;\n    }\n\n    if (isPlainObject(predicate)) {\n      _predicate = function (a) {\n        return isMatch(a, predicate);\n      };\n    }\n\n    if (_predicate) {\n      for (var i = 0; i < arr.length; i += 1) {\n        if (_predicate(arr[i])) {\n          return arr[i];\n        }\n      }\n    }\n\n    return null;\n  }\n\n  var getRange = function (values) {\n    // 存在 NaN 时，min,max 判定会出问题\n    var filterValues = values.filter(function (v) {\n      return !isNaN(v);\n    });\n\n    if (!filterValues.length) {\n      // 如果没有数值则直接返回0\n      return {\n        min: 0,\n        max: 0\n      };\n    }\n\n    if (isArray(values[0])) {\n      var tmp = [];\n\n      for (var i = 0; i < values.length; i++) {\n        tmp = tmp.concat(values[i]);\n      }\n\n      filterValues = tmp;\n    }\n\n    var max = Math.max.apply(null, filterValues);\n    var min = Math.min.apply(null, filterValues);\n    return {\n      min: min,\n      max: max\n    };\n  };\n\n  var isString = function (str) {\n    return isType(str, 'String');\n  };\n\n  var uniq = function (arr) {\n    var resultArr = [];\n    each(arr, function (item) {\n      if (!contains(resultArr, item)) {\n        resultArr.push(item);\n      }\n    });\n    return resultArr;\n  };\n\n  function head(o) {\n    if (isArrayLike(o)) {\n      return o[0];\n    }\n\n    return undefined;\n  }\n\n  function last(o) {\n    if (isArrayLike(o)) {\n      var arr = o;\n      return arr[arr.length - 1];\n    }\n\n    return undefined;\n  }\n\n  var fixedBase = function (v, base) {\n    var str = base.toString();\n    var index = str.indexOf('.');\n\n    if (index === -1) {\n      return Math.round(v);\n    }\n\n    var length = str.substr(index + 1).length;\n\n    if (length > 20) {\n      length = 20;\n    }\n\n    return parseFloat(v.toFixed(length));\n  };\n  /**\n   * 判断是否数字\n   * @return {Boolean} 是否数字\n   */\n\n\n  var isNumber = function (value) {\n    return isType(value, 'Number');\n  };\n\n  var toString$1 = function (value) {\n    if (isNil(value)) return '';\n    return value.toString();\n  };\n\n  var lowerFirst = function (value) {\n    var str = toString$1(value);\n    return str.charAt(0).toLowerCase() + str.substring(1);\n  };\n\n  function substitute(str, o) {\n    if (!str || !o) {\n      return str;\n    }\n\n    return str.replace(/\\\\?\\{([^{}]+)\\}/g, function (match, name) {\n      if (match.charAt(0) === '\\\\') {\n        return match.slice(1);\n      }\n\n      return o[name] === undefined ? '' : o[name];\n    });\n  }\n\n  var upperFirst = function (value) {\n    var str = toString$1(value);\n    return str.charAt(0).toUpperCase() + str.substring(1);\n  };\n\n  var toString$2 = {}.toString;\n\n  var getType = function (value) {\n    return toString$2.call(value).replace(/^\\[object /, '').replace(/]$/, '');\n  };\n  /**\n   * 是否是布尔类型\n   *\n   * @param {Object} value 测试的值\n   * @return {Boolean}\n   */\n\n\n  var isBoolean = function (value) {\n    return isType(value, 'Boolean');\n  };\n\n  var isDate = function (value) {\n    return isType(value, 'Date');\n  };\n\n  var objectProto = Object.prototype;\n\n  var isPrototype = function (value) {\n    var Ctor = value && value.constructor;\n    var proto = typeof Ctor === 'function' && Ctor.prototype || objectProto;\n    return value === proto;\n  }; // FIXME: Mutable param should be forbidden in static lang.\n\n\n  function _mix(dist, obj) {\n    for (var key in obj) {\n      if (obj.hasOwnProperty(key) && key !== 'constructor' && obj[key] !== undefined) {\n        dist[key] = obj[key];\n      }\n    }\n  }\n\n  function mix(dist, src1, src2, src3) {\n    if (src1) _mix(dist, src1);\n    if (src2) _mix(dist, src2);\n    if (src3) _mix(dist, src3);\n    return dist;\n  }\n\n  var MAX_MIX_LEVEL = 5;\n\n  function _deepMix(dist, src, level, maxLevel) {\n    level = level || 0;\n    maxLevel = maxLevel || MAX_MIX_LEVEL;\n\n    for (var key in src) {\n      if (src.hasOwnProperty(key)) {\n        var value = src[key];\n\n        if (value !== null && isPlainObject(value)) {\n          if (!isPlainObject(dist[key])) {\n            dist[key] = {};\n          }\n\n          if (level < maxLevel) {\n            _deepMix(dist[key], value, level + 1, maxLevel);\n          } else {\n            dist[key] = src[key];\n          }\n        } else if (isArray(value)) {\n          dist[key] = [];\n          dist[key] = dist[key].concat(value);\n        } else if (value !== undefined) {\n          dist[key] = value;\n        }\n      }\n    }\n  } // todo 重写\n\n\n  var deepMix = function (rst) {\n    var args = [];\n\n    for (var _i = 1; _i < arguments.length; _i++) {\n      args[_i - 1] = arguments[_i];\n    }\n\n    for (var i = 0; i < args.length; i += 1) {\n      _deepMix(rst, args[i]);\n    }\n\n    return rst;\n  };\n\n  var indexOf = function (arr, obj) {\n    if (!isArrayLike(arr)) {\n      return -1;\n    }\n\n    var m = Array.prototype.indexOf;\n\n    if (m) {\n      return m.call(arr, obj);\n    }\n\n    var index = -1;\n\n    for (var i = 0; i < arr.length; i++) {\n      if (arr[i] === obj) {\n        index = i;\n        break;\n      }\n    }\n\n    return index;\n  };\n\n  var hasOwnProperty = Object.prototype.hasOwnProperty;\n\n  function isEmpty(value) {\n    /**\n     * isEmpty(null) => true\n     * isEmpty() => true\n     * isEmpty(true) => true\n     * isEmpty(1) => true\n     * isEmpty([1, 2, 3]) => false\n     * isEmpty('abc') => false\n     * isEmpty({ a: 1 }) => false\n     */\n    if (isNil(value)) {\n      return true;\n    }\n\n    if (isArrayLike(value)) {\n      return !value.length;\n    }\n\n    var type = getType(value);\n\n    if (type === 'Map' || type === 'Set') {\n      return !value.size;\n    }\n\n    if (isPrototype(value)) {\n      return !Object.keys(value).length;\n    }\n\n    for (var key in value) {\n      if (hasOwnProperty.call(value, key)) {\n        return false;\n      }\n    }\n\n    return true;\n  }\n\n  var isEqual = function (value, other) {\n    if (value === other) {\n      return true;\n    }\n\n    if (!value || !other) {\n      return false;\n    }\n\n    if (isString(value) || isString(other)) {\n      return false;\n    }\n\n    if (isArrayLike(value) || isArrayLike(other)) {\n      if (value.length !== other.length) {\n        return false;\n      }\n\n      var rst = true;\n\n      for (var i = 0; i < value.length; i++) {\n        rst = isEqual(value[i], other[i]);\n\n        if (!rst) {\n          break;\n        }\n      }\n\n      return rst;\n    }\n\n    if (isObjectLike(value) || isObjectLike(other)) {\n      var valueKeys = Object.keys(value);\n      var otherKeys = Object.keys(other);\n\n      if (valueKeys.length !== otherKeys.length) {\n        return false;\n      }\n\n      var rst = true;\n\n      for (var i = 0; i < valueKeys.length; i++) {\n        rst = isEqual(value[valueKeys[i]], other[valueKeys[i]]);\n\n        if (!rst) {\n          break;\n        }\n      }\n\n      return rst;\n    }\n\n    return false;\n  };\n\n  var map = function (arr, func) {\n    if (!isArrayLike(arr)) {\n      // @ts-ignore\n      return arr;\n    }\n\n    var result = [];\n\n    for (var index = 0; index < arr.length; index++) {\n      var value = arr[index];\n      result.push(func(value, index));\n    }\n\n    return result;\n  };\n\n  function size(o) {\n    if (isNil(o)) {\n      return 0;\n    }\n\n    if (isArrayLike(o)) {\n      return o.length;\n    }\n\n    return Object.keys(o).length;\n  }\n\n  function merge(dataArray) {\n    var rst = [];\n\n    for (var i = 0, len = dataArray.length; i < len; i++) {\n      rst = rst.concat(dataArray[i]);\n    }\n\n    return rst;\n  }\n\n  function values(data, name) {\n    var rst = [];\n    var tmpMap = {};\n\n    for (var i = 0, len = data.length; i < len; i++) {\n      var obj = data[i];\n      var value = obj[name];\n\n      if (!isNil(value)) {\n        if (!isArray(value)) {\n          if (!tmpMap[value]) {\n            rst.push(value);\n            tmpMap[value] = true;\n          }\n        } else {\n          each(value, function (val) {\n            if (!tmpMap[val]) {\n              rst.push(val);\n              tmpMap[val] = true;\n            }\n          });\n        }\n      }\n    }\n\n    return rst;\n  }\n\n  function firstValue(data, name) {\n    var rst = null;\n\n    for (var i = 0, len = data.length; i < len; i++) {\n      var obj = data[i];\n      var value = obj[name];\n\n      if (!isNil(value)) {\n        if (isArray(value)) {\n          rst = value[0];\n        } else {\n          rst = value;\n        }\n\n        break;\n      }\n    }\n\n    return rst;\n  }\n\n  function groupToMap(data, fields) {\n    if (!fields) {\n      return {\n        0: data\n      };\n    }\n\n    var callback = function callback(row) {\n      var unique = '_';\n\n      for (var i = 0, l = fields.length; i < l; i++) {\n        unique += row[fields[i]] && row[fields[i]].toString();\n      }\n\n      return unique;\n    };\n\n    var groups = {};\n\n    for (var i = 0, len = data.length; i < len; i++) {\n      var row = data[i];\n      var key = callback(row);\n\n      if (groups[key]) {\n        groups[key].push(row);\n      } else {\n        groups[key] = [row];\n      }\n    }\n\n    return groups;\n  }\n\n  function group(data, fields, appendConditions) {\n    if (appendConditions === void 0) {\n      appendConditions = {};\n    }\n\n    if (!fields) {\n      return [data];\n    }\n\n    var groups = groupToMap(data, fields);\n    var array = [];\n\n    if (fields.length === 1 && appendConditions[fields[0]]) {\n      var _values = appendConditions[fields[0]];\n      each(_values, function (value) {\n        value = '_' + value;\n        array.push(groups[value]);\n      });\n    } else {\n      for (var i in groups) {\n        array.push(groups[i]);\n      }\n    }\n\n    return array;\n  }\n\n  function remove(arr, obj) {\n    if (!arr) {\n      return;\n    }\n\n    var index = arr.indexOf(obj);\n\n    if (index !== -1) {\n      arr.splice(index, 1);\n    }\n  }\n\n  function getRange$1(values) {\n    if (!values.length) {\n      return {\n        min: 0,\n        max: 0\n      };\n    }\n\n    var max = Math.max.apply(null, values);\n    var min = Math.min.apply(null, values);\n    return {\n      min: min,\n      max: max\n    };\n  }\n\n  var array = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    merge: merge,\n    values: values,\n    firstValue: firstValue,\n    group: group,\n    groupToMap: groupToMap,\n    remove: remove,\n    getRange: getRange$1\n  });\n  /**\n   * Detects support for options object argument in addEventListener.\n   * https://developer.mozilla.org/en-US/docs/Web/API/EventTarget/addEventListener#Safely_detecting_option_support\n   * @private\n   */\n\n  var supportsEventListenerOptions = function () {\n    var supports = false;\n\n    try {\n      var options = Object.defineProperty({}, 'passive', {\n        get: function get() {\n          supports = true;\n        }\n      });\n      window.addEventListener('e', null, options);\n    } catch (e) {// continue regardless of error\n    }\n\n    return supports;\n  }(); // Default passive to true as expected by Chrome for 'touchstart' and 'touchend' events.\n  // https://github.com/chartjs/Chart.js/issues/4287\n\n\n  var eventListenerOptions = supportsEventListenerOptions ? {\n    passive: true\n  } : false;\n  /* global wx, my */\n  // weixin miniprogram\n\n  var isWx = typeof wx === 'object' && typeof wx.getSystemInfoSync === 'function'; // ant miniprogram\n\n  var isMy = typeof my === 'object' && typeof my.getSystemInfoSync === 'function'; // in node\n\n  var isNode = typeof global && !typeof window; // in browser\n\n  var isBrowser = typeof window !== 'undefined' && typeof window.document !== 'undefined' && typeof window.sessionStorage !== 'undefined';\n\n  function isCanvasElement(el) {\n    if (!el || typeof el !== 'object') return false;\n\n    if (el.nodeType === 1 && el.nodeName) {\n      // HTMLCanvasElement\n      return true;\n    } // CanvasElement\n\n\n    return !!el.isCanvasElement;\n  }\n\n  function getPixelRatio() {\n    return window && window.devicePixelRatio || 1;\n  }\n\n  function getStyle(el, property) {\n    return el.currentStyle ? el.currentStyle[property] : document.defaultView.getComputedStyle(el, null).getPropertyValue(property);\n  }\n\n  function getWidth(el) {\n    var width = getStyle(el, 'width');\n\n    if (width === 'auto') {\n      width = el.offsetWidth;\n    }\n\n    return parseFloat(width);\n  }\n\n  function getHeight(el) {\n    var height = getStyle(el, 'height');\n\n    if (height === 'auto') {\n      height = el.offsetHeight;\n    }\n\n    return parseFloat(height);\n  }\n\n  function getDomById(id) {\n    if (!id) {\n      return null;\n    }\n\n    return document.getElementById(id);\n  }\n\n  function getRelativePosition(point, canvas) {\n    var canvasDom = canvas.get('el');\n    if (!canvasDom) return point;\n\n    var _canvasDom$getBoundin = canvasDom.getBoundingClientRect(),\n        top = _canvasDom$getBoundin.top,\n        left = _canvasDom$getBoundin.left;\n\n    var paddingLeft = parseFloat(getStyle(canvasDom, 'padding-left'));\n    var paddingTop = parseFloat(getStyle(canvasDom, 'padding-top'));\n    var mouseX = point.x - left - paddingLeft;\n    var mouseY = point.y - top - paddingTop;\n    return {\n      x: mouseX,\n      y: mouseY\n    };\n  }\n\n  function addEventListener(source, type, listener) {\n    source.addEventListener(type, listener, eventListenerOptions);\n  }\n\n  function removeEventListener(source, type, listener) {\n    source.removeEventListener(type, listener, eventListenerOptions);\n  }\n\n  function landscapePoint(point, canvas) {\n    var landscape = canvas.get('landscape');\n\n    if (!landscape) {\n      return point;\n    }\n\n    if (isFunction(landscape)) {\n      return landscape(point, canvas);\n    } // 默认顺时针旋转90度\n\n\n    var height = canvas.get('height');\n    var x = point.y;\n    var y = height - point.x;\n    return {\n      x: x,\n      y: y\n    };\n  }\n\n  function convertPoints(ev, canvas) {\n    var touches = ev.touches; // 认为是mouse事件\n\n    if (!touches) {\n      var point = getRelativePosition({\n        x: ev.clientX,\n        y: ev.clientY\n      }, canvas);\n      return [landscapePoint(point, canvas)];\n    } // 单指 touchend 后，touchs 会变空，最后的触点要从changedTouches里拿\n\n\n    if (!touches.length) {\n      // 为了防止万一，加个空逻辑\n      touches = ev.changedTouches || [];\n    }\n\n    var points = [];\n\n    for (var i = 0, len = touches.length; i < len; i++) {\n      var touch = touches[i]; // x, y: 相对canvas原点的位置，clientX, clientY 相对于可视窗口的位置\n\n      var x = touch.x,\n          y = touch.y,\n          clientX = touch.clientX,\n          clientY = touch.clientY;\n\n      var _point = void 0; // 小程序环境会有x,y\n\n\n      if (isNumber(x) || isNumber(y)) {\n        _point = {\n          x: x,\n          y: y\n        };\n      } else {\n        // 浏览器环境再计算下canvas的相对位置\n        _point = getRelativePosition({\n          x: clientX,\n          y: clientY\n        }, canvas);\n      }\n\n      points.push(landscapePoint(_point, canvas));\n    }\n\n    return points;\n  }\n\n  function createEvent(event, chart) {\n    var canvas = chart.get('canvas');\n    var points = convertPoints(event, canvas); // touchend会没有points\n\n    var point = points[0] || {};\n    return {\n      type: event.type,\n      chart: chart,\n      \"native\": event,\n      x: point.x,\n      y: point.y\n    };\n  }\n\n  function measureText(text, font, ctx) {\n    if (!ctx) {\n      ctx = document.createElement('canvas').getContext('2d');\n    }\n\n    ctx.font = font || '12px sans-serif';\n    return ctx.measureText(text);\n  }\n  /**\n   * @fileOverview Utility for F2\n   * @author dxq613 @gmail.com\n   * @author sima.zhang1990@gmail.com\n   */\n\n\n  function isObjectValueEqual(a, b) {\n    // for vue.js\n    a = Object.assign({}, a);\n    b = Object.assign({}, b);\n    var aProps = Object.getOwnPropertyNames(a);\n    var bProps = Object.getOwnPropertyNames(b);\n\n    if (aProps.length !== bProps.length) {\n      return false;\n    }\n\n    for (var i = 0, len = aProps.length; i < len; i++) {\n      var propName = aProps[i];\n\n      if (a[propName] !== b[propName]) {\n        return false;\n      }\n    }\n\n    return true;\n  }\n\n  function parsePadding(padding) {\n    var top;\n    var right;\n    var bottom;\n    var left;\n\n    if (isNumber(padding) || isString(padding)) {\n      top = bottom = left = right = padding;\n    } else if (isArray(padding)) {\n      top = padding[0];\n      right = !isNil(padding[1]) ? padding[1] : padding[0];\n      bottom = !isNil(padding[2]) ? padding[2] : padding[0];\n      left = !isNil(padding[3]) ? padding[3] : right;\n    }\n\n    return [top, right, bottom, left];\n  }\n\n  function directionEnabled(mode, dir) {\n    if (mode === undefined) {\n      return true;\n    } else if (typeof mode === 'string') {\n      return mode.indexOf(dir) !== -1;\n    }\n\n    return false;\n  }\n\n  function toTimeStamp(value) {\n    if (isString(value)) {\n      if (value.indexOf('T') > 0) {\n        value = new Date(value).getTime();\n      } else {\n        // new Date('2010/01/10') 和 new Date('2010-01-10') 的差别在于:\n        // 如果仅有年月日时，前者是带有时区的: Fri Jan 10 2020 02:40:13 GMT+0800 (中国标准时间)\n        // 后者会格式化成 Sun Jan 10 2010 08:00:00 GMT+0800 (中国标准时间)\n        value = new Date(value.replace(/-/gi, '/')).getTime();\n      }\n    }\n\n    if (isDate(value)) {\n      value = value.getTime();\n    }\n\n    return value;\n  }\n\n  var Util = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    Array: array,\n    upperFirst: upperFirst,\n    lowerFirst: lowerFirst,\n    isString: isString,\n    isNumber: isNumber,\n    isBoolean: isBoolean,\n    isFunction: isFunction,\n    isDate: isDate,\n    isArray: isArray,\n    isNil: isNil,\n    isObject: isObject,\n    isPlainObject: isPlainObject,\n    isEqual: isEqual,\n    deepMix: deepMix,\n    mix: mix,\n    each: each,\n    uniq: uniq,\n    find: find,\n    isObjectValueEqual: isObjectValueEqual,\n    parsePadding: parsePadding,\n    directionEnabled: directionEnabled,\n    toTimeStamp: toTimeStamp,\n    substitute: substitute,\n    isWx: isWx,\n    isMy: isMy,\n    isNode: isNode,\n    isBrowser: isBrowser,\n    isCanvasElement: isCanvasElement,\n    getPixelRatio: getPixelRatio,\n    getStyle: getStyle,\n    getWidth: getWidth,\n    getHeight: getHeight,\n    getDomById: getDomById,\n    getRelativePosition: getRelativePosition,\n    addEventListener: addEventListener,\n    removeEventListener: removeEventListener,\n    createEvent: createEvent,\n    convertPoints: convertPoints,\n    measureText: measureText\n  });\n  /**\n   * @fileOverview default theme\n   * @author dxq613@gail.com\n   */\n\n  var color1 = '#E8E8E8'; // color of axis-line and axis-grid\n\n  var color2 = '#808080'; // color of axis label\n\n  var defaultAxis = {\n    label: {\n      fill: color2,\n      fontSize: 10\n    },\n    line: {\n      stroke: color1,\n      lineWidth: 1\n    },\n    grid: {\n      type: 'line',\n      stroke: color1,\n      lineWidth: 1,\n      lineDash: [2]\n    },\n    tickLine: null,\n    labelOffset: 7.5\n  };\n  var Theme = {\n    fontFamily: '\"Helvetica Neue\", \"San Francisco\", Helvetica, Tahoma, Arial, \"PingFang SC\", \"Hiragino Sans GB\", \"Heiti SC\", \"Microsoft YaHei\", sans-serif',\n    defaultColor: '#1890FF',\n    pixelRatio: 1,\n    padding: 'auto',\n    appendPadding: 15,\n    colors: ['#1890FF', '#2FC25B', '#FACC14', '#223273', '#8543E0', '#13C2C2', '#3436C7', '#F04864'],\n    shapes: {\n      line: ['line', 'dash'],\n      point: ['circle', 'hollowCircle']\n    },\n    sizes: [4, 10],\n    axis: {\n      common: defaultAxis,\n      // common axis configuration\n      bottom: mix({}, defaultAxis, {\n        grid: null\n      }),\n      left: mix({}, defaultAxis, {\n        line: null\n      }),\n      right: mix({}, defaultAxis, {\n        line: null\n      }),\n      circle: mix({}, defaultAxis, {\n        line: null\n      }),\n      radius: mix({}, defaultAxis, {\n        labelOffset: 4\n      })\n    },\n    shape: {\n      line: {\n        lineWidth: 2,\n        lineJoin: 'round',\n        lineCap: 'round'\n      },\n      point: {\n        lineWidth: 0,\n        size: 3\n      },\n      area: {\n        fillOpacity: 0.1\n      }\n    },\n    _defaultAxis: defaultAxis\n  };\n  var lang = {\n    general: {\n      title: '这是一个图表，',\n      withTitle: '这是一个关于“{title}”的图表。'\n    },\n    coord: {\n      cartesian: 'X轴是{xLabel}Y轴是{yLabel}' // polar: '弧度是{xLabel}半径是{yLabel}'\n\n    },\n    scale: {\n      linear: '数值型，数据最小值为{min}，最大值为{max}；',\n      cat: '分类型, 分类类型有：{values}；',\n      timeCat: '时间型，时间范围从{start}到{end}；'\n    },\n    geometry: {\n      prefix: '共有{count}种分类组成，',\n      oneData: '第{index}类是{name}，数据是{values};',\n      partData: '第{index}类是{name}，共有{count}项数据，前{part}项是{values};',\n      allData: '第{index}类是{name}，有{count}项数据，分别是{values};'\n    },\n    legend: {\n      prefix: '图例分类有：'\n    }\n  };\n  var Global = {\n    version: '3.8.2',\n    scales: {},\n    widthRatio: {\n      column: 1 / 2,\n      rose: 0.999999,\n      multiplePie: 3 / 4\n    },\n    lineDash: [4, 4],\n    lang: lang\n  };\n\n  Global.setTheme = function (theme) {\n    deepMix(Global, theme);\n  };\n\n  Global.setTheme(Theme);\n\n  function _defineProperty(obj, key, value) {\n    if (key in obj) {\n      Object.defineProperty(obj, key, {\n        value: value,\n        enumerable: true,\n        configurable: true,\n        writable: true\n      });\n    } else {\n      obj[key] = value;\n    }\n\n    return obj;\n  }\n\n  function _extends() {\n    _extends = Object.assign || function (target) {\n      for (var i = 1; i < arguments.length; i++) {\n        var source = arguments[i];\n\n        for (var key in source) {\n          if (Object.prototype.hasOwnProperty.call(source, key)) {\n            target[key] = source[key];\n          }\n        }\n      }\n\n      return target;\n    };\n\n    return _extends.apply(this, arguments);\n  }\n\n  function _inheritsLoose(subClass, superClass) {\n    subClass.prototype = Object.create(superClass.prototype);\n    subClass.prototype.constructor = subClass;\n    subClass.__proto__ = superClass;\n  }\n\n  function _assertThisInitialized(self) {\n    if (self === void 0) {\n      throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n    }\n\n    return self;\n  }\n\n  var EVENT_AFTER_INIT = 'afterinit';\n  var EVENT_BEFORE_RENDER = 'beforerender';\n  var EVENT_AFTER_RENDER = 'afterrender';\n  var EVENT_BEFORE_DATA_CHANGE = 'beforedatachange';\n  var EVENT_AFTER_DATA_CHANGE = 'afterdatachange';\n  var EVENT_AFTER_SIZE_CHANGE = '_aftersizechange';\n  var EVENT_AFTER_GEOM_INIT = '_aftergeominit';\n  var EVENT_BEFORE_GEOM_DRAW = 'beforegeomdraw';\n  var EVENT_AFTER_GEOM_DRAW = 'aftergeomdraw';\n  var EVENT_CLEAR = 'clear';\n  var EVENT_CLEAR_INNER = 'clearinner';\n  var EVENT_REPAINT = 'repaint'; // 实现简单的事件机制\n\n  var EventEmit = /*#__PURE__*/function () {\n    function EventEmit() {\n      this.__events = {};\n    }\n\n    var _proto = EventEmit.prototype;\n\n    _proto.on = function on(type, listener) {\n      if (!type || !listener) {\n        return;\n      }\n\n      var events = this.__events[type] || [];\n      events.push(listener);\n      this.__events[type] = events;\n    };\n\n    _proto.emit = function emit(type, e) {\n      var _this = this;\n\n      if (isObject(type)) {\n        e = type;\n        type = e && e.type;\n      }\n\n      if (!type) {\n        return;\n      }\n\n      var events = this.__events[type];\n\n      if (!events || !events.length) {\n        return;\n      }\n\n      events.forEach(function (listener) {\n        listener.call(_this, e);\n      });\n    };\n\n    _proto.off = function off(type, listener) {\n      var __events = this.__events;\n      var events = __events[type];\n\n      if (!events || !events.length) {\n        return;\n      } // 如果没有指定方法，则删除所有项\n\n\n      if (!listener) {\n        delete __events[type];\n        return;\n      } // 删除指定的 listener\n\n\n      for (var i = 0, len = events.length; i < len; i++) {\n        if (events[i] === listener) {\n          events.splice(i, 1);\n          i--;\n        }\n      }\n    };\n\n    return EventEmit;\n  }();\n\n  var Base = /*#__PURE__*/function (_Emit) {\n    _inheritsLoose(Base, _Emit);\n\n    var _proto = Base.prototype;\n\n    _proto.getDefaultCfg = function getDefaultCfg() {\n      return {};\n    };\n\n    function Base(cfg) {\n      var _this;\n\n      _this = _Emit.call(this) || this;\n      var attrs = {};\n\n      var defaultCfg = _this.getDefaultCfg();\n\n      _this._attrs = attrs;\n      mix(attrs, defaultCfg, cfg);\n      return _this;\n    }\n\n    _proto.get = function get(name) {\n      return this._attrs[name];\n    };\n\n    _proto.set = function set(name, value) {\n      this._attrs[name] = value;\n    };\n\n    _proto.destroy = function destroy() {\n      this._attrs = {};\n      this.destroyed = true;\n    };\n\n    return Base;\n  }(EventEmit);\n\n  var Plot = /*#__PURE__*/function () {\n    function Plot(cfg) {\n      mix(this, cfg);\n\n      this._init();\n    }\n\n    var _proto = Plot.prototype;\n\n    _proto._init = function _init() {\n      var self = this;\n      var start = self.start;\n      var end = self.end;\n      var xMin = Math.min(start.x, end.x);\n      var xMax = Math.max(start.x, end.x);\n      var yMin = Math.min(start.y, end.y);\n      var yMax = Math.max(start.y, end.y);\n      this.tl = {\n        x: xMin,\n        y: yMin\n      };\n      this.tr = {\n        x: xMax,\n        y: yMin\n      };\n      this.bl = {\n        x: xMin,\n        y: yMax\n      };\n      this.br = {\n        x: xMax,\n        y: yMax\n      };\n      this.width = xMax - xMin;\n      this.height = yMax - yMin;\n    }\n    /**\n     * reset\n     * @param  {Object} start start point\n     * @param  {Object} end end point\n     */\n    ;\n\n    _proto.reset = function reset(start, end) {\n      this.start = start;\n      this.end = end;\n\n      this._init();\n    }\n    /**\n     * check the point is in the range of plot\n     * @param  {Number}  x x value\n     * @param  {[type]}  y y value\n     * @return {Boolean} return the result\n     */\n    ;\n\n    _proto.isInRange = function isInRange(x, y) {\n      if (isObject(x)) {\n        y = x.y;\n        x = x.x;\n      }\n\n      var tl = this.tl;\n      var br = this.br;\n      return tl.x <= x && x <= br.x && tl.y <= y && y <= br.y;\n    };\n\n    return Plot;\n  }();\n\n  var Matrix = {\n    generateDefault: function generateDefault() {\n      return [1, 0, 0, 1, 0, 0];\n    },\n    isChanged: function isChanged(m) {\n      return m[0] !== 1 || m[1] !== 0 || m[2] !== 0 || m[3] !== 1 || m[4] !== 0 || m[5] !== 0;\n    },\n    multiply: function multiply(m1, m2) {\n      var m11 = m1[0] * m2[0] + m1[2] * m2[1];\n      var m12 = m1[1] * m2[0] + m1[3] * m2[1];\n      var m21 = m1[0] * m2[2] + m1[2] * m2[3];\n      var m22 = m1[1] * m2[2] + m1[3] * m2[3];\n      var dx = m1[0] * m2[4] + m1[2] * m2[5] + m1[4];\n      var dy = m1[1] * m2[4] + m1[3] * m2[5] + m1[5];\n      return [m11, m12, m21, m22, dx, dy];\n    },\n    scale: function scale(out, m, v) {\n      out[0] = m[0] * v[0];\n      out[1] = m[1] * v[0];\n      out[2] = m[2] * v[1];\n      out[3] = m[3] * v[1];\n      out[4] = m[4];\n      out[5] = m[5];\n      return out;\n    },\n    rotate: function rotate(out, m, radian) {\n      var c = Math.cos(radian);\n      var s = Math.sin(radian);\n      var m11 = m[0] * c + m[2] * s;\n      var m12 = m[1] * c + m[3] * s;\n      var m21 = m[0] * -s + m[2] * c;\n      var m22 = m[1] * -s + m[3] * c;\n      out[0] = m11;\n      out[1] = m12;\n      out[2] = m21;\n      out[3] = m22;\n      out[4] = m[4];\n      out[5] = m[5];\n      return out;\n    },\n    translate: function translate(out, m, v) {\n      out[0] = m[0];\n      out[1] = m[1];\n      out[2] = m[2];\n      out[3] = m[3];\n      out[4] = m[4] + m[0] * v[0] + m[2] * v[1];\n      out[5] = m[5] + m[1] * v[0] + m[3] * v[1];\n      return out;\n    },\n    transform: function transform(m, actions) {\n      var out = [].concat(m);\n\n      for (var i = 0, len = actions.length; i < len; i++) {\n        var action = actions[i];\n\n        switch (action[0]) {\n          case 't':\n            Matrix.translate(out, out, [action[1], action[2]]);\n            break;\n\n          case 's':\n            Matrix.scale(out, out, [action[1], action[2]]);\n            break;\n\n          case 'r':\n            Matrix.rotate(out, out, action[1]);\n            break;\n        }\n      }\n\n      return out;\n    }\n  };\n  /**\n   * 2 Dimensional Vector\n   * @module vector2\n   */\n\n  var Vector2 = {\n    /**\n     * Creates a new, empty vector2\n     *\n     * @return {vector2} a new 2D vector\n     */\n    create: function create() {\n      return [0, 0];\n    },\n\n    /**\n     * Calculates the length of a vector2\n     *\n     * @param {vector2} v vector to calculate length of\n     * @return {Number} length of v\n     */\n    length: function length(v) {\n      var x = v[0];\n      var y = v[1];\n      return Math.sqrt(x * x + y * y);\n    },\n\n    /**\n     * Normalize a vector2\n     *\n     * @param {vector2} out the receiving vector\n     * @param {vector2} v vector to normalize\n     * @return {vector2} out\n     */\n    normalize: function normalize(out, v) {\n      var len = this.length(v);\n\n      if (len === 0) {\n        out[0] = 0;\n        out[1] = 0;\n      } else {\n        out[0] = v[0] / len;\n        out[1] = v[1] / len;\n      }\n\n      return out;\n    },\n\n    /**\n     * Adds two vector2's\n     *\n     * @param {vector2} out the receiving vector\n     * @param {vector2} v1 the first operand\n     * @param {vector2} v2 the second operand\n     * @return {vector2} out\n     */\n    add: function add(out, v1, v2) {\n      out[0] = v1[0] + v2[0];\n      out[1] = v1[1] + v2[1];\n      return out;\n    },\n\n    /**\n     * Subtracts vector v2 from vector v1\n     *\n     * @param {vector2} out the receiving vector\n     * @param {vector2} v1 the first operand\n     * @param {vector2} v2 the second operand\n     * @return {vector2} out\n     */\n    sub: function sub(out, v1, v2) {\n      out[0] = v1[0] - v2[0];\n      out[1] = v1[1] - v2[1];\n      return out;\n    },\n\n    /**\n     * Scales a vector2 by a scalar number\n     *\n     * @param {vector2} out the receiving vector\n     * @param {vector2} v the vector to scale\n     * @param {Number} s amount to scale the vector by\n     * @return {vector2} out\n     */\n    scale: function scale(out, v, s) {\n      out[0] = v[0] * s;\n      out[1] = v[1] * s;\n      return out;\n    },\n\n    /**\n     * Calculates the dot product of two vector2's\n     *\n     * @param {vector2} v1 the first operand\n     * @param {vector2} v2 the second operand\n     * @return {Number} dot product of v1 and v2\n     */\n    dot: function dot(v1, v2) {\n      return v1[0] * v2[0] + v1[1] * v2[1];\n    },\n\n    /**\n     * Calculates the direction of two vector2's\n     *\n     * @param {vector2} v1 the first operand\n     * @param {vector2} v2 the second operand\n     * @return {Boolean} the direction of v1 and v2\n     */\n    direction: function direction(v1, v2) {\n      return v1[0] * v2[1] - v2[0] * v1[1];\n    },\n\n    /**\n     * Calculates the angle of two vector2's\n     *\n     * @param {vector2} v1 the first operand\n     * @param {vector2} v2 the second operand\n     * @return {Number} angle of v1 and v2\n     */\n    angle: function angle(v1, v2) {\n      var theta = this.dot(v1, v2) / (this.length(v1) * this.length(v2));\n      return Math.acos(theta);\n    },\n\n    /**\n     * Calculates the angle of two vector2's with direction\n     *\n     * @param {vector2} v1 the first operand\n     * @param {vector2} v2 the second operand\n     * @param {Boolean} direction the direction of two vector2's\n     * @return {Number} angle of v1 and v2\n     */\n    angleTo: function angleTo(v1, v2, direction) {\n      var angle = this.angle(v1, v2);\n      var angleLargeThanPI = this.direction(v1, v2) >= 0;\n\n      if (direction) {\n        if (angleLargeThanPI) {\n          return Math.PI * 2 - angle;\n        }\n\n        return angle;\n      }\n\n      if (angleLargeThanPI) {\n        return angle;\n      }\n\n      return Math.PI * 2 - angle;\n    },\n\n    /**\n     * whether a vector2 is zero vector\n     *\n     * @param  {vector2} v vector to calculate\n     * @return {Boolean}   is or not a zero vector\n     */\n    zero: function zero(v) {\n      return v[0] === 0 && v[1] === 0;\n    },\n\n    /**\n     * Calculates the euclidian distance between two vector2's\n     *\n     * @param {vector2} v1 the first operand\n     * @param {vector2} v2 the second operand\n     * @return {Number} distance between a and b\n     */\n    distance: function distance(v1, v2) {\n      var x = v2[0] - v1[0];\n      var y = v2[1] - v1[1];\n      return Math.sqrt(x * x + y * y);\n    },\n\n    /**\n     * Creates a new vector2 initialized with values from an existing vector\n     *\n     * @param {vector2} v vector to clone\n     * @return {Array} a new 2D vector\n     */\n    clone: function clone(v) {\n      return [v[0], v[1]];\n    },\n\n    /**\n     * Return the minimum of two vector2's\n     *\n     * @param {vector2} out the receiving vector\n     * @param {vector2} v1 the first operand\n     * @param {vector2} v2 the second operand\n     * @return {vector2} out\n     */\n    min: function min(out, v1, v2) {\n      out[0] = Math.min(v1[0], v2[0]);\n      out[1] = Math.min(v1[1], v2[1]);\n      return out;\n    },\n\n    /**\n     * Return the maximum of two vector2's\n     *\n     * @param {vector2} out the receiving vector\n     * @param {vector2} v1 the first operand\n     * @param {vector2} v2 the second operand\n     * @return {vector2} out\n     */\n    max: function max(out, v1, v2) {\n      out[0] = Math.max(v1[0], v2[0]);\n      out[1] = Math.max(v1[1], v2[1]);\n      return out;\n    },\n\n    /**\n     * Transforms the vector2 with a mat2d\n     *\n     * @param {vector2} out the receiving vector\n     * @param {vector2} v the vector to transform\n     * @param {mat2d} m matrix to transform with\n     * @return {vector2} out\n     */\n    transformMat2d: function transformMat2d(out, v, m) {\n      var x = v[0];\n      var y = v[1];\n      out[0] = m[0] * x + m[2] * y + m[4];\n      out[1] = m[1] * x + m[3] * y + m[5];\n      return out;\n    }\n  };\n  var defaultMatrix = [1, 0, 0, 1, 0, 0];\n\n  var Base$1 = /*#__PURE__*/function () {\n    var _proto = Base.prototype;\n\n    _proto._initDefaultCfg = function _initDefaultCfg() {};\n\n    function Base(cfg) {\n      this._initDefaultCfg();\n\n      mix(this, cfg);\n      var start;\n      var end;\n\n      if (this.plot) {\n        start = this.plot.bl;\n        end = this.plot.tr;\n        this.start = start;\n        this.end = end;\n      } else {\n        start = this.start;\n        end = this.end;\n      }\n\n      this.init(start, end);\n    }\n\n    _proto._scale = function _scale(s1, s2) {\n      var matrix = this.matrix;\n      var center = this.center;\n      Matrix.translate(matrix, matrix, [center.x, center.y]);\n      Matrix.scale(matrix, matrix, [s1, s2]);\n      Matrix.translate(matrix, matrix, [-center.x, -center.y]);\n    };\n\n    _proto.init = function init(start, end) {\n      this.matrix = [].concat(defaultMatrix); // 设置中心点\n\n      this.center = {\n        x: (end.x - start.x) / 2 + start.x,\n        y: (end.y - start.y) / 2 + start.y\n      };\n\n      if (this.scale) {\n        this._scale(this.scale[0], this.scale[1]);\n      }\n    };\n\n    _proto.convertPoint = function convertPoint(point) {\n      var _this$_convertPoint = this._convertPoint(point),\n          x = _this$_convertPoint.x,\n          y = _this$_convertPoint.y;\n\n      if (!Matrix.isChanged(this.matrix)) {\n        return {\n          x: x,\n          y: y\n        };\n      }\n\n      var vector = [x, y];\n      Vector2.transformMat2d(vector, vector, this.matrix);\n      return {\n        x: vector[0],\n        y: vector[1]\n      };\n    };\n\n    _proto.invertPoint = function invertPoint(point) {\n      return this._invertPoint(point);\n    };\n\n    _proto._convertPoint = function _convertPoint(point) {\n      return point;\n    };\n\n    _proto._invertPoint = function _invertPoint(point) {\n      return point;\n    };\n\n    _proto.reset = function reset(plot) {\n      this.plot = plot;\n      var bl = plot.bl,\n          tr = plot.tr;\n      this.start = bl;\n      this.end = tr;\n      this.init(bl, tr);\n    };\n\n    return Base;\n  }();\n\n  var Cartesian = /*#__PURE__*/function (_Base) {\n    _inheritsLoose(Cartesian, _Base);\n\n    function Cartesian() {\n      return _Base.apply(this, arguments) || this;\n    }\n\n    var _proto = Cartesian.prototype;\n\n    _proto._initDefaultCfg = function _initDefaultCfg() {\n      this.type = 'cartesian';\n      this.transposed = false;\n      this.isRect = true;\n    };\n\n    _proto.init = function init(start, end) {\n      _Base.prototype.init.call(this, start, end);\n\n      this.x = {\n        start: start.x,\n        end: end.x\n      };\n      this.y = {\n        start: start.y,\n        end: end.y\n      };\n    };\n\n    _proto._convertPoint = function _convertPoint(point) {\n      var self = this;\n      var transposed = self.transposed;\n      var xDim = transposed ? 'y' : 'x';\n      var yDim = transposed ? 'x' : 'y';\n      var x = self.x;\n      var y = self.y;\n      return {\n        x: x.start + (x.end - x.start) * point[xDim],\n        y: y.start + (y.end - y.start) * point[yDim]\n      };\n    };\n\n    _proto._invertPoint = function _invertPoint(point) {\n      var self = this;\n      var transposed = self.transposed;\n      var xDim = transposed ? 'y' : 'x';\n      var yDim = transposed ? 'x' : 'y';\n      var x = self.x;\n      var y = self.y;\n      var rst = {};\n      rst[xDim] = (point.x - x.start) / (x.end - x.start);\n      rst[yDim] = (point.y - y.start) / (y.end - y.start);\n      return rst;\n    };\n\n    return Cartesian;\n  }(Base$1);\n\n  Base$1.Cartesian = Cartesian;\n  Base$1.Rect = Cartesian;\n  /**\n   * @fileOverview the Attribute base class\n   */\n\n  function toScaleString(scale, value) {\n    if (isString(value)) {\n      return value;\n    }\n\n    return scale.invert(scale.scale(value));\n  }\n  /**\n   * 所有视觉通道属性的基类\n   * @class Attr\n   */\n\n\n  var AttributeBase = /*#__PURE__*/function () {\n    function AttributeBase(cfg) {\n      var _this = this;\n      /**\n       * 属性的类型\n       * @type {String}\n       */\n\n\n      this.type = 'base';\n      /**\n       * 属性的名称\n       * @type {String}\n       */\n\n      this.name = null;\n      /**\n       * 回调函数\n       * @type {Function}\n       */\n\n      this.method = null;\n      /**\n       * 备选的值数组\n       * @type {Array}\n       */\n\n      this.values = [];\n      /**\n       * 属性内部的度量\n       * @type {Array}\n       */\n\n      this.scales = [];\n      /**\n       * 是否通过线性取值, 如果未指定，则根据数值的类型判定\n       * @type {Boolean}\n       */\n\n      this.linear = null;\n      /**\n       * 当用户设置的 callback 返回 null 时, 应该返回默认 callback 中的值\n       */\n\n      var mixedCallback = null;\n      var defaultCallback = this.callback;\n\n      if (cfg.callback) {\n        var userCallback = cfg.callback;\n\n        mixedCallback = function mixedCallback() {\n          for (var _len = arguments.length, params = new Array(_len), _key = 0; _key < _len; _key++) {\n            params[_key] = arguments[_key];\n          }\n\n          var ret = userCallback.apply(void 0, params);\n\n          if (isNil(ret)) {\n            ret = defaultCallback.apply(_this, params);\n          }\n\n          return ret;\n        };\n      }\n\n      mix(this, cfg);\n\n      if (mixedCallback) {\n        mix(this, {\n          callback: mixedCallback\n        });\n      }\n    } // 获取属性值，将值映射到视觉通道\n\n\n    var _proto = AttributeBase.prototype;\n\n    _proto._getAttrValue = function _getAttrValue(scale, value) {\n      var values = this.values;\n\n      if (scale.isCategory && !this.linear) {\n        var index = scale.translate(value);\n        return values[index % values.length];\n      }\n\n      var percent = scale.scale(value);\n      return this.getLinearValue(percent);\n    }\n    /**\n     * 如果进行线性映射，返回对应的映射值\n     * @protected\n     * @param  {Number} percent 百分比\n     * @return {*}  颜色值、形状、大小等\n     */\n    ;\n\n    _proto.getLinearValue = function getLinearValue(percent) {\n      var values = this.values;\n      var steps = values.length - 1;\n      var step = Math.floor(steps * percent);\n      var leftPercent = steps * percent - step;\n      var start = values[step];\n      var end = step === steps ? start : values[step + 1];\n      var rstValue = start + (end - start) * leftPercent;\n      return rstValue;\n    }\n    /**\n     * 默认的回调函数\n     * @param {*} value 回调函数的值\n     * @type {Function}\n     * @return {Array} 返回映射后的值\n     */\n    ;\n\n    _proto.callback = function callback(value) {\n      var self = this;\n      var scale = self.scales[0];\n      var rstValue = null;\n\n      if (scale.type === 'identity') {\n        rstValue = scale.value;\n      } else {\n        rstValue = self._getAttrValue(scale, value);\n      }\n\n      return rstValue;\n    }\n    /**\n     * 根据度量获取属性名\n     * @return {Array} dims of this Attribute\n     */\n    ;\n\n    _proto.getNames = function getNames() {\n      var scales = this.scales;\n      var names = this.names;\n      var length = Math.min(scales.length, names.length);\n      var rst = [];\n\n      for (var i = 0; i < length; i++) {\n        rst.push(names[i]);\n      }\n\n      return rst;\n    }\n    /**\n     * 根据度量获取维度名\n     * @return {Array} dims of this Attribute\n     */\n    ;\n\n    _proto.getFields = function getFields() {\n      var scales = this.scales;\n      var rst = [];\n      each(scales, function (scale) {\n        rst.push(scale.field);\n      });\n      return rst;\n    }\n    /**\n     * 根据名称获取度量\n     * @param  {String} name the name of scale\n     * @return {Scale} scale\n     */\n    ;\n\n    _proto.getScale = function getScale(name) {\n      var scales = this.scales;\n      var names = this.names;\n      var index = names.indexOf(name);\n      return scales[index];\n    }\n    /**\n     * 映射数据\n     * @param {*} param1...paramn 多个数值\n     * @return {Array} 映射的值组成的数组\n     */\n    ;\n\n    _proto.mapping = function mapping() {\n      var scales = this.scales;\n      var callback = this.callback;\n\n      for (var _len2 = arguments.length, params = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n        params[_key2] = arguments[_key2];\n      }\n\n      var values = params;\n\n      if (callback) {\n        for (var i = 0, len = params.length; i < len; i++) {\n          params[i] = this._toOriginParam(params[i], scales[i]);\n        }\n\n        values = callback.apply(this, params);\n      }\n\n      values = [].concat(values);\n      return values;\n    } // 原始的参数\n    ;\n\n    _proto._toOriginParam = function _toOriginParam(param, scale) {\n      var rst = param;\n\n      if (!scale.isLinear) {\n        if (isArray(param)) {\n          rst = [];\n\n          for (var i = 0, len = param.length; i < len; i++) {\n            rst.push(toScaleString(scale, param[i]));\n          }\n        } else {\n          rst = toScaleString(scale, param);\n        }\n      }\n\n      return rst;\n    };\n\n    return AttributeBase;\n  }();\n\n  var Position = /*#__PURE__*/function (_Base) {\n    _inheritsLoose(Position, _Base);\n\n    function Position(cfg) {\n      var _this;\n\n      _this = _Base.call(this, cfg) || this;\n      _this.names = ['x', 'y'];\n      _this.type = 'position';\n      return _this;\n    }\n\n    var _proto = Position.prototype;\n\n    _proto.mapping = function mapping(x, y) {\n      var scales = this.scales;\n      var coord = this.coord;\n      var scaleX = scales[0];\n      var scaleY = scales[1];\n      var rstX;\n      var rstY;\n      var obj;\n\n      if (isNil(x) || isNil(y)) {\n        return [];\n      }\n\n      if (isArray(y) && isArray(x)) {\n        rstX = [];\n        rstY = [];\n\n        for (var i = 0, j = 0, xLen = x.length, yLen = y.length; i < xLen && j < yLen; i++, j++) {\n          obj = coord.convertPoint({\n            x: scaleX.scale(x[i]),\n            y: scaleY.scale(y[j])\n          });\n          rstX.push(obj.x);\n          rstY.push(obj.y);\n        }\n      } else if (isArray(y)) {\n        x = scaleX.scale(x);\n        rstY = [];\n        each(y, function (yVal) {\n          yVal = scaleY.scale(yVal);\n          obj = coord.convertPoint({\n            x: x,\n            y: yVal\n          });\n\n          if (rstX && rstX !== obj.x) {\n            if (!isArray(rstX)) {\n              rstX = [rstX];\n            }\n\n            rstX.push(obj.x);\n          } else {\n            rstX = obj.x;\n          }\n\n          rstY.push(obj.y);\n        });\n      } else if (isArray(x)) {\n        y = scaleY.scale(y);\n        rstX = [];\n        each(x, function (xVal) {\n          xVal = scaleX.scale(xVal);\n          obj = coord.convertPoint({\n            x: xVal,\n            y: y\n          });\n\n          if (rstY && rstY !== obj.y) {\n            if (!isArray(rstY)) {\n              rstY = [rstY];\n            }\n\n            rstY.push(obj.y);\n          } else {\n            rstY = obj.y;\n          }\n\n          rstX.push(obj.x);\n        });\n      } else {\n        x = scaleX.scale(x);\n        y = scaleY.scale(y);\n        var point = coord.convertPoint({\n          x: x,\n          y: y\n        });\n        rstX = point.x;\n        rstY = point.y;\n      }\n\n      return [rstX, rstY];\n    };\n\n    return Position;\n  }(AttributeBase);\n\n  var Shape = /*#__PURE__*/function (_Base) {\n    _inheritsLoose(Shape, _Base);\n\n    function Shape(cfg) {\n      var _this;\n\n      _this = _Base.call(this, cfg) || this;\n      _this.names = ['shape'];\n      _this.type = 'shape';\n      _this.gradient = null;\n      return _this;\n    }\n    /**\n     * @override\n     */\n\n\n    var _proto = Shape.prototype;\n\n    _proto.getLinearValue = function getLinearValue(percent) {\n      var values = this.values;\n      var index = Math.round((values.length - 1) * percent);\n      return values[index];\n    };\n\n    return Shape;\n  }(AttributeBase);\n\n  var Size = /*#__PURE__*/function (_Base) {\n    _inheritsLoose(Size, _Base);\n\n    function Size(cfg) {\n      var _this;\n\n      _this = _Base.call(this, cfg) || this;\n      _this.names = ['size'];\n      _this.type = 'size';\n      _this.gradient = null;\n      return _this;\n    }\n\n    return Size;\n  }(AttributeBase);\n\n  function getValue(start, end, percent, index) {\n    var value = start[index] + (end[index] - start[index]) * percent;\n    return value;\n  } // convert to hex\n\n\n  function arr2hex(arr) {\n    return '#' + toRGBValue(arr[0]) + toRGBValue(arr[1]) + toRGBValue(arr[2]);\n  }\n\n  function toRGBValue(value) {\n    value = Math.round(value);\n    value = value.toString(16);\n\n    if (value.length === 1) {\n      value = '0' + value;\n    }\n\n    return value;\n  }\n\n  function calColor(colors, percent) {\n    var steps = colors.length - 1;\n    var step = Math.floor(steps * percent);\n    var left = steps * percent - step;\n    var start = colors[step];\n    var end = step === steps ? start : colors[step + 1];\n    var rgb = arr2hex([getValue(start, end, left, 0), getValue(start, end, left, 1), getValue(start, end, left, 2)]);\n    return rgb;\n  }\n\n  function hex2arr(str) {\n    var arr = [];\n    arr.push(parseInt(str.substr(1, 2), 16));\n    arr.push(parseInt(str.substr(3, 2), 16));\n    arr.push(parseInt(str.substr(5, 2), 16));\n    return arr;\n  }\n\n  var colorCache = {\n    black: '#000000',\n    blue: '#0000ff',\n    grey: '#808080',\n    green: '#008000',\n    orange: '#ffa500',\n    pink: '#ffc0cb',\n    purple: '#800080',\n    red: '#ff0000',\n    white: '#ffffff',\n    yellow: '#ffff00'\n  };\n  /**\n   * Returns a hexadecimal string representing this color in RGB space, such as #f7eaba.\n   * @param  {String} color color value\n   * @return {String} Returns a hexadecimal string\n   */\n\n  function toHex(color) {\n    if (colorCache[color]) {\n      return colorCache[color];\n    }\n\n    if (color[0] === '#') {\n      if (color.length === 7) {\n        return color;\n      }\n\n      var hex = color.replace(/^#?([a-f\\d])([a-f\\d])([a-f\\d])$/i, function (m, r, g, b) {\n        return '#' + r + r + g + g + b + b;\n      }); // hex3 to hex6\n\n      colorCache[color] = hex;\n      return hex;\n    } // rgb/rgba to hex\n\n\n    var rst = color.match(/^rgba?[\\s+]?\\([\\s+]?(\\d+)[\\s+]?,[\\s+]?(\\d+)[\\s+]?,[\\s+]?(\\d+)[\\s+]?/i);\n    rst.shift();\n    rst = arr2hex(rst);\n    colorCache[color] = rst;\n    return rst;\n  }\n  /**\n   * handle the gradient color\n   * @param  {Array} colors the colors\n   * @return {String} return the color value\n   */\n\n\n  function gradient(colors) {\n    var points = [];\n\n    if (isString(colors)) {\n      colors = colors.split('-');\n    }\n\n    each(colors, function (color) {\n      if (color.indexOf('#') === -1) {\n        color = toHex(color);\n      }\n\n      points.push(hex2arr(color));\n    });\n    return function (percent) {\n      return calColor(points, percent);\n    };\n  }\n\n  var Color = /*#__PURE__*/function (_Base) {\n    _inheritsLoose(Color, _Base);\n\n    function Color(cfg) {\n      var _this;\n\n      _this = _Base.call(this, cfg) || this;\n      _this.names = ['color'];\n      _this.type = 'color';\n      _this.gradient = null;\n\n      if (isString(_this.values)) {\n        _this.linear = true;\n      }\n\n      return _this;\n    }\n    /**\n     * @override\n     */\n\n\n    var _proto = Color.prototype;\n\n    _proto.getLinearValue = function getLinearValue(percent) {\n      var gradient$1 = this.gradient;\n\n      if (!gradient$1) {\n        var values = this.values;\n        gradient$1 = gradient(values);\n        this.gradient = gradient$1;\n      }\n\n      return gradient$1(percent);\n    };\n\n    return Color;\n  }(AttributeBase);\n\n  var Attr = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    Position: Position,\n    Shape: Shape,\n    Size: Size,\n    Color: Color\n  });\n  var Shape$1 = {};\n  var ShapeBase = {\n    _coord: null,\n\n    /**\n     * draw the shape\n     * @param {Object} cfg options\n     * @param {Object} container container to store the shapes\n     */\n    draw: function draw(cfg, container) {\n      if (this.drawShape) {\n        this.drawShape(cfg, container);\n      }\n    },\n\n    /**\n     * set the coordinate instance\n     * @param {Coord} coord coordinate instance\n     */\n    setCoord: function setCoord(coord) {\n      this._coord = coord;\n    },\n\n    /**\n     * convert the normalized value to the canvas position\n     * @param  {point} point the point to convert\n     * @return {point} point return the result\n     */\n    parsePoint: function parsePoint(point) {\n      var coord = this._coord;\n\n      if (coord.isPolar) {\n        if (point.x === 1) point.x = 0.9999999;\n        if (point.y === 1) point.y = 0.9999999;\n      }\n\n      return coord.convertPoint(point);\n    },\n\n    /**\n     * convert the normalized value to the canvas position\n     * @param  {points} points the array that store the points\n     * @return {points} points return the result\n     */\n    parsePoints: function parsePoints(points) {\n      if (!points) return false;\n      var self = this;\n      var rst = [];\n      points.forEach(function (point) {\n        rst.push(self.parsePoint(point));\n      });\n      return rst;\n    }\n  };\n  var ShapeFactoryBase = {\n    defaultShapeType: null,\n    setCoord: function setCoord(coord) {\n      this._coord = coord;\n    },\n    getShape: function getShape(type) {\n      var self = this;\n\n      if (isArray(type)) {\n        type = type[0];\n      }\n\n      var shape = self[type] || self[self.defaultShapeType];\n      shape._coord = self._coord;\n      return shape;\n    },\n    getShapePoints: function getShapePoints(type, cfg) {\n      var shape = this.getShape(type);\n      var fn = shape.getPoints || shape.getShapePoints || this.getDefaultPoints;\n      var points = fn(cfg);\n      return points;\n    },\n    getDefaultPoints: function getDefaultPoints()\n    /* cfg */\n    {\n      return [];\n    },\n    drawShape: function drawShape(type, cfg, container) {\n      var shape = this.getShape(type);\n\n      if (!cfg.color) {\n        cfg.color = Global.colors[0];\n      }\n\n      return shape.draw(cfg, container);\n    }\n  };\n\n  Shape$1.registerFactory = function (factoryName, cfg) {\n    var className = upperFirst(factoryName);\n    var geomObj = mix({}, ShapeFactoryBase, cfg);\n    Shape$1[className] = geomObj;\n    geomObj.name = factoryName;\n    return geomObj;\n  };\n\n  Shape$1.registerShape = function (factoryName, shapeType, cfg) {\n    var className = upperFirst(factoryName);\n    var factory = Shape$1[className];\n    var shapeObj = mix({}, ShapeBase, cfg);\n    factory[shapeType] = shapeObj;\n    return shapeObj;\n  };\n\n  Shape$1.registShape = Shape$1.registerShape;\n\n  Shape$1.getShapeFactory = function (factoryName) {\n    var self = this;\n    factoryName = factoryName || 'point';\n    var className = upperFirst(factoryName);\n    return self[className];\n  };\n\n  function _mix$1(dist, obj) {\n    for (var key in obj) {\n      if (obj.hasOwnProperty(key) && key !== 'constructor' && obj[key] !== undefined) {\n        dist[key] = obj[key];\n      }\n    }\n  }\n\n  var mix$1 = function mix(dist, src1, src2, src3) {\n    if (src1) _mix$1(dist, src1);\n    if (src2) _mix$1(dist, src2);\n    if (src3) _mix$1(dist, src3);\n    return dist;\n  };\n\n  var mix_1 = mix$1;\n\n  var Adjust = /*#__PURE__*/function () {\n    var _proto = Adjust.prototype;\n\n    _proto._initDefaultCfg = function _initDefaultCfg() {\n      this.adjustNames = ['x', 'y']; // 调整的维度，默认,x,y都做调整\n    };\n\n    function Adjust(cfg) {\n      this._initDefaultCfg();\n\n      mix_1(this, cfg);\n    }\n    /**\n     * @override\n     */\n\n\n    _proto.processAdjust = function processAdjust()\n    /* dataArray */\n    {};\n\n    return Adjust;\n  }();\n\n  var base = Adjust;\n\n  function generateScaleAria(scale) {\n    var type = scale.type,\n        values = scale.values;\n\n    if (type === 'linear') {\n      return substitute(lang.scale.linear, scale);\n    }\n\n    if (type === 'cat') {\n      return substitute(lang.scale.cat, {\n        values: values.slice(0, 10).join(' ')\n      });\n    }\n\n    if (type === 'timeCat') {\n      var start = scale.getText(values[0]);\n      var end = scale.getText(values[values.length - 1]);\n      return substitute(lang.scale.timeCat, {\n        start: start,\n        end: end\n      });\n    }\n\n    return '';\n  }\n\n  function generateCoordAria(coord, xScale, yScale) {\n    var type = coord.type;\n\n    if (!lang.coord[type]) {\n      return '';\n    }\n\n    return substitute(lang.coord[type], {\n      xLabel: generateScaleAria(xScale),\n      yLabel: generateScaleAria(yScale)\n    });\n  }\n\n  var GROUP_ATTRS = ['color', 'size', 'shape'];\n  var FIELD_ORIGIN = '_origin';\n  var FIELD_ORIGIN_Y = '_originY';\n\n  function parseFields(field) {\n    if (isArray(field)) {\n      return field;\n    }\n\n    if (isString(field)) {\n      return field.split('*');\n    }\n\n    return [field];\n  }\n  /**\n   * The parent class for Geometry\n   * @class Geom\n   */\n\n\n  var Geom = /*#__PURE__*/function (_Base) {\n    _inheritsLoose(Geom, _Base);\n\n    function Geom() {\n      return _Base.apply(this, arguments) || this;\n    }\n\n    var _proto = Geom.prototype;\n\n    _proto.getDefaultCfg = function getDefaultCfg() {\n      return {\n        /**\n         * geometry type\n         * @type {String}\n         */\n        type: null,\n\n        /**\n         * the data of geometry\n         * @type {Array}\n         */\n        data: null,\n\n        /**\n         * the attrs of geo,etry\n         * @type {Object}\n         */\n        attrs: {},\n        scales: {},\n\n        /**\n         * group for storing the shapes\n         * @type {Canvas}\n         */\n        container: null,\n\n        /**\n         * style options\n         * @type {Object}\n         */\n        styleOptions: null,\n        chart: null,\n        shapeType: '',\n\n        /**\n         * wether to generate key points for each shape\n         * @protected\n         * @type {Boolean}\n         */\n        generatePoints: false,\n        attrOptions: {},\n        sortable: false,\n        startOnZero: true,\n        visible: true,\n        connectNulls: false,\n        // 是否丢弃没有值的分组。\n        ignoreEmptyGroup: false,\n        // 是否已经初始化\n        isInit: false\n      };\n    };\n\n    _proto.init = function init() {\n      var self = this;\n      var isInit = self.get('isInit');\n\n      if (isInit) {\n        return;\n      }\n\n      self._initAttrs();\n\n      self._processData();\n\n      self.set('isInit', true);\n    };\n\n    _proto._getGroupScales = function _getGroupScales() {\n      var self = this;\n      var scales = [];\n      each(GROUP_ATTRS, function (attrName) {\n        var attr = self.getAttr(attrName);\n\n        if (attr) {\n          var attrScales = attr.scales;\n          each(attrScales, function (scale) {\n            if (scale && scale.isCategory && scales.indexOf(scale) === -1) {\n              scales.push(scale);\n            }\n          });\n        }\n      });\n      return scales;\n    };\n\n    _proto._groupData = function _groupData(data) {\n      var self = this;\n      var colDefs = self.get('colDefs');\n\n      var groupScales = self._getGroupScales();\n\n      if (groupScales.length) {\n        var appendConditions = {};\n        var names = [];\n        each(groupScales, function (scale) {\n          var field = scale.field;\n          names.push(field);\n\n          if (colDefs && colDefs[field] && colDefs[field].values) {\n            // users have defined\n            appendConditions[scale.field] = colDefs[field].values;\n          }\n        });\n        return group(data, names, appendConditions);\n      }\n\n      return [data];\n    };\n\n    _proto._setAttrOptions = function _setAttrOptions(attrName, attrCfg) {\n      var options = this.get('attrOptions');\n      options[attrName] = attrCfg;\n      var attrs = this.get('attrs'); // 说明已经初始化过了\n\n      if (Object.keys(attrs).length) {\n        this._createAttr(attrName, attrCfg);\n      }\n    };\n\n    _proto._createAttrOption = function _createAttrOption(attrName, field, cfg, defaultValues) {\n      var attrCfg = {};\n      attrCfg.field = field;\n\n      if (cfg) {\n        if (isFunction(cfg)) {\n          attrCfg.callback = cfg;\n        } else {\n          attrCfg.values = cfg;\n        }\n      } else {\n        attrCfg.values = defaultValues;\n      }\n\n      this._setAttrOptions(attrName, attrCfg);\n    };\n\n    _proto._createAttr = function _createAttr(type, option) {\n      var self = this;\n      var attrs = self.get('attrs');\n      var coord = self.get('coord');\n      var className = upperFirst(type);\n      var fields = parseFields(option.field);\n\n      if (type === 'position') {\n        option.coord = coord;\n      }\n\n      var scales = [];\n\n      for (var i = 0, len = fields.length; i < len; i++) {\n        var field = fields[i];\n\n        var scale = self._createScale(field);\n\n        scales.push(scale);\n      }\n\n      if (type === 'position') {\n        var yScale = scales[1]; // 饼图的处理，但是还不知道为啥\n\n        if (coord.type === 'polar' && coord.transposed && self.hasAdjust('stack')) {\n          if (yScale.values.length) {\n            yScale.change({\n              nice: false,\n              min: 0,\n              max: Math.max.apply(null, yScale.values)\n            });\n          }\n        }\n      }\n\n      option.scales = scales;\n      var attr = new Attr[className](option);\n      attrs[type] = attr;\n      return attr;\n    };\n\n    _proto._initAttrs = function _initAttrs() {\n      var self = this;\n      var attrOptions = self.get('attrOptions');\n\n      for (var type in attrOptions) {\n        if (attrOptions.hasOwnProperty(type)) {\n          this._createAttr(type, attrOptions[type]);\n        }\n      }\n    };\n\n    _proto._createScale = function _createScale(field) {\n      var scales = this.get('scales');\n      var scale = scales[field];\n\n      if (!scale) {\n        scale = this.get('chart').createScale(field);\n        scales[field] = scale;\n      }\n\n      return scale;\n    };\n\n    _proto._processData = function _processData() {\n      var self = this;\n      var data = this.get('data');\n      var dataArray = [];\n\n      var groupedArray = this._groupData(data);\n\n      if (this.get('ignoreEmptyGroup')) {\n        var yScale = this.getYScale();\n        groupedArray = groupedArray.filter(function (group) {\n          return group.some(function (item) {\n            return typeof item[yScale.field] !== 'undefined';\n          });\n        });\n      }\n\n      for (var i = 0, len = groupedArray.length; i < len; i++) {\n        var subData = groupedArray[i];\n\n        var tempData = self._saveOrigin(subData);\n\n        if (this.hasAdjust('dodge')) {\n          self._numberic(tempData);\n        }\n\n        dataArray.push(tempData);\n      }\n\n      if (self.get('adjust')) {\n        self._adjustData(dataArray);\n      }\n\n      if (self.get('sortable')) {\n        self._sort(dataArray);\n      }\n\n      self.emit('afterprocessdata', {\n        dataArray: dataArray\n      });\n      self.set('mappingData', dataArray);\n      self.set('dataArray', dataArray);\n      return dataArray;\n    };\n\n    _proto._saveOrigin = function _saveOrigin(data) {\n      var rst = [];\n\n      for (var i = 0, len = data.length; i < len; i++) {\n        var origin = data[i];\n        var obj = {};\n\n        for (var k in origin) {\n          obj[k] = origin[k];\n        }\n\n        obj[FIELD_ORIGIN] = origin;\n        rst.push(obj);\n      }\n\n      return rst;\n    };\n\n    _proto._numberic = function _numberic(data) {\n      var positionAttr = this.getAttr('position');\n      var scales = positionAttr.scales;\n\n      for (var j = 0, len = data.length; j < len; j++) {\n        var obj = data[j];\n        var count = Math.min(2, scales.length);\n\n        for (var i = 0; i < count; i++) {\n          var scale = scales[i];\n\n          if (scale.isCategory) {\n            var field = scale.field;\n            obj[field] = scale.translate(obj[field]);\n          }\n        }\n      }\n    };\n\n    _proto._adjustData = function _adjustData(dataArray) {\n      var self = this;\n      var adjust = self.get('adjust');\n\n      if (adjust) {\n        var adjustType = upperFirst(adjust.type);\n\n        if (!base[adjustType]) {\n          throw new Error('not support such adjust : ' + adjust);\n        }\n\n        var xScale = self.getXScale();\n        var yScale = self.getYScale();\n        var cfg = mix({\n          xField: xScale.field,\n          yField: yScale.field\n        }, adjust);\n        var adjustObject = new base[adjustType](cfg);\n        adjustObject.processAdjust(dataArray);\n\n        if (adjustType === 'Stack') {\n          self._updateStackRange(yScale.field, yScale, dataArray);\n        }\n      }\n    };\n\n    _proto._updateStackRange = function _updateStackRange(field, scale, dataArray) {\n      var mergeArray = merge(dataArray);\n      var min = scale.min;\n      var max = scale.max;\n\n      for (var i = 0, len = mergeArray.length; i < len; i++) {\n        var obj = mergeArray[i];\n        var tmpMin = Math.min.apply(null, obj[field]);\n        var tmpMax = Math.max.apply(null, obj[field]);\n\n        if (tmpMin < min) {\n          min = tmpMin;\n        }\n\n        if (tmpMax > max) {\n          max = tmpMax;\n        }\n      }\n\n      if (min < scale.min || max > scale.max) {\n        scale.change({\n          min: min,\n          max: max\n        });\n      }\n    };\n\n    _proto._sort = function _sort(mappedArray) {\n      var self = this;\n      var xScale = self.getXScale();\n      var field = xScale.field,\n          type = xScale.type;\n\n      if (type !== 'identity' && xScale.values.length > 1) {\n        each(mappedArray, function (itemArr) {\n          itemArr.sort(function (obj1, obj2) {\n            if (type === 'timeCat') {\n              return toTimeStamp(obj1[FIELD_ORIGIN][field]) - toTimeStamp(obj2[FIELD_ORIGIN][field]);\n            }\n\n            return xScale.translate(obj1[FIELD_ORIGIN][field]) - xScale.translate(obj2[FIELD_ORIGIN][field]);\n          });\n        });\n      }\n\n      self.set('hasSorted', true);\n      self.set('dataArray', mappedArray);\n    };\n\n    _proto.paint = function paint() {\n      var self = this;\n      var dataArray = self.get('mappingData');\n      var mappedArray = [];\n      var shapeFactory = self.getShapeFactory();\n      shapeFactory.setCoord(self.get('coord'));\n\n      self._beforeMapping(dataArray);\n\n      for (var i = 0, len = dataArray.length; i < len; i++) {\n        var data = dataArray[i];\n\n        if (data.length) {\n          var mappedData = self._mapping(data);\n\n          mappedArray.push(mappedData);\n          self.draw(mappedData, shapeFactory);\n        }\n      }\n\n      self.set('dataArray', mappedArray);\n      this.generateAria();\n    };\n\n    _proto.getShapeFactory = function getShapeFactory() {\n      var shapeFactory = this.get('shapeFactory');\n\n      if (!shapeFactory) {\n        var shapeType = this.get('shapeType');\n        shapeFactory = Shape$1.getShapeFactory(shapeType);\n        this.set('shapeFactory', shapeFactory);\n      }\n\n      return shapeFactory;\n    };\n\n    _proto._mapping = function _mapping(data) {\n      var self = this;\n      var attrs = self.get('attrs');\n      var yField = self.getYScale().field; // 用来缓存转换的值，减少mapping耗时\n\n      var mappedCache = {};\n      var mappedData = new Array(data.length);\n\n      for (var k in attrs) {\n        if (attrs.hasOwnProperty(k)) {\n          var attr = attrs[k];\n          var names = attr.names;\n          var scales = attr.scales;\n\n          for (var i = 0, len = data.length; i < len; i++) {\n            var record = data[i];\n\n            var mappedRecord = _extends({}, record, mappedData[i]);\n\n            mappedRecord[FIELD_ORIGIN_Y] = record[yField]; // 获取视觉属性对应的value值\n            // 位置的缓存命中率低，还是每次单独计算\n\n            if (attr.type === 'position') {\n              var values = self._getAttrValues(attr, record);\n\n              for (var j = 0, _len = values.length; j < _len; j++) {\n                var val = values[j];\n                var name = names[j];\n                mappedRecord[name] = isArray(val) && val.length === 1 ? val[0] : val;\n              }\n            } else {\n              // 除了position其他都只有一项\n              var _name = names[0];\n              var field = scales[0].field;\n              var value = record[field];\n              var key = \"\" + _name + value;\n              var _values = mappedCache[key];\n\n              if (!_values) {\n                _values = self._getAttrValues(attr, record);\n                mappedCache[key] = _values;\n              }\n\n              mappedRecord[_name] = _values[0];\n            } // 设置新数组\n\n\n            mappedData[i] = mappedRecord;\n          }\n        }\n      }\n\n      return mappedData;\n    };\n\n    _proto._getAttrValues = function _getAttrValues(attr, record) {\n      var scales = attr.scales;\n      var params = [];\n\n      for (var i = 0, len = scales.length; i < len; i++) {\n        var scale = scales[i];\n        var field = scale.field;\n\n        if (scale.type === 'identity') {\n          params.push(scale.value);\n        } else {\n          params.push(record[field]);\n        }\n      }\n\n      var values = attr.mapping.apply(attr, params);\n      return values;\n    };\n\n    _proto.getAttrValue = function getAttrValue(attrName, record) {\n      var attr = this.getAttr(attrName);\n      var rst = null;\n\n      if (attr) {\n        var values = this._getAttrValues(attr, record);\n\n        rst = values[0];\n      }\n\n      return rst;\n    };\n\n    _proto._beforeMapping = function _beforeMapping(dataArray) {\n      var self = this;\n\n      if (self.get('generatePoints')) {\n        self._generatePoints(dataArray);\n      }\n    };\n\n    _proto.isInCircle = function isInCircle() {\n      var coord = this.get('coord');\n      return coord && coord.isPolar;\n    };\n\n    _proto.getCallbackCfg = function getCallbackCfg(fields, cfg, origin) {\n      if (!fields) {\n        return cfg;\n      }\n\n      var tmpCfg = {};\n      var params = fields.map(function (field) {\n        return origin[field];\n      });\n      each(cfg, function (v, k) {\n        if (isFunction(v)) {\n          tmpCfg[k] = v.apply(null, params);\n        } else {\n          tmpCfg[k] = v;\n        }\n      });\n      return tmpCfg;\n    };\n\n    _proto.getDrawCfg = function getDrawCfg(obj) {\n      var self = this;\n      var isInCircle = self.isInCircle();\n      var cfg = {\n        origin: obj,\n        x: obj.x,\n        y: obj.y,\n        color: obj.color,\n        size: obj.size,\n        shape: obj.shape,\n        isInCircle: isInCircle,\n        opacity: obj.opacity\n      };\n      var styleOptions = self.get('styleOptions');\n\n      if (styleOptions && styleOptions.style) {\n        cfg.style = self.getCallbackCfg(styleOptions.fields, styleOptions.style, obj[FIELD_ORIGIN]);\n      }\n\n      if (self.get('generatePoints')) {\n        cfg.points = obj.points;\n        cfg.nextPoints = obj.nextPoints;\n      }\n\n      if (isInCircle) {\n        cfg.center = self.get('coord').center;\n      }\n\n      return cfg;\n    };\n\n    _proto.draw = function draw(data, shapeFactory) {\n      var self = this;\n      var container = self.get('container');\n      var yScale = self.getYScale();\n      each(data, function (obj, index) {\n        if (yScale && isNil(obj._origin[yScale.field])) {\n          return;\n        }\n\n        obj.index = index;\n        var cfg = self.getDrawCfg(obj);\n        var shape = obj.shape;\n        self.drawShape(shape, obj, cfg, container, shapeFactory);\n      });\n    };\n\n    _proto.drawShape = function drawShape(shape, shapeData, cfg, container, shapeFactory) {\n      var gShape = shapeFactory.drawShape(shape, cfg, container);\n\n      if (gShape) {\n        each([].concat(gShape), function (s) {\n          s.set('origin', shapeData);\n        });\n      }\n    };\n\n    _proto._generatePoints = function _generatePoints(dataArray) {\n      var self = this;\n      var shapeFactory = self.getShapeFactory();\n      var shapeAttr = self.getAttr('shape');\n      each(dataArray, function (data) {\n        for (var i = 0, len = data.length; i < len; i++) {\n          var obj = data[i];\n          var cfg = self.createShapePointsCfg(obj);\n          var shape = shapeAttr ? self._getAttrValues(shapeAttr, obj) : null;\n          var points = shapeFactory.getShapePoints(shape, cfg);\n          obj.points = points;\n        }\n      }); // 添加nextPoints\n\n      each(dataArray, function (data, index) {\n        var nextData = dataArray[index + 1];\n\n        if (nextData) {\n          data[0].nextPoints = nextData[0].points;\n        }\n      });\n    } // 生成无障碍文本\n    ;\n\n    _proto.generateAria = function generateAria() {\n      var container = this.get('container');\n      var aria = container.get('aria');\n\n      if (!aria) {\n        return;\n      }\n\n      var ariaLables = [];\n      var coord = this.get('coord');\n      var xScale = this.getXScale();\n      var yScale = this.getYScale();\n      var coordAriaLabel = generateCoordAria(coord, xScale, yScale);\n      ariaLables.push(coordAriaLabel);\n      var _lang$geometry = lang.geometry,\n          prefix = _lang$geometry.prefix,\n          oneData = _lang$geometry.oneData,\n          partData = _lang$geometry.partData,\n          allData = _lang$geometry.allData;\n      var dataArray = this.get('dataArray');\n      var count = dataArray.length; // 只处理一个，不然太复杂\n\n      var groupScale = this._getGroupScales()[0];\n\n      if (groupScale) {\n        var prefixLabel = substitute(prefix, {\n          count: count\n        });\n        ariaLables.push(prefixLabel);\n        each(dataArray, function (data, index) {\n          var len = data.length;\n          if (!len) return;\n          var firstObj = data[0]._origin;\n\n          if (len === 1) {\n            ariaLables.push(substitute(oneData, {\n              index: index + 1,\n              count: len,\n              name: firstObj[groupScale.field],\n              values: firstObj[yScale.field]\n            }));\n          } else {\n            var template = len > 5 ? partData : allData;\n            var values = data.slice(0, 5).map(function (record) {\n              var _origin = record._origin;\n              var xValue = xScale.getText(_origin[xScale.field]);\n              var yValue = yScale.getText(_origin[yScale.field]);\n              return xValue + \":\" + yValue;\n            });\n            ariaLables.push(substitute(template, {\n              index: index + 1,\n              count: len,\n              part: 3,\n              name: firstObj[groupScale.field],\n              values: values.join(' ')\n            }));\n          }\n        });\n      }\n\n      container.set('ariaLabel', ariaLables.join(''));\n    }\n    /**\n     * get the info of each shape\n     * @protected\n     * @param  {Object} obj the data item\n     * @return {Object} cfg return the result\n     */\n    ;\n\n    _proto.createShapePointsCfg = function createShapePointsCfg(obj) {\n      var xScale = this.getXScale();\n      var yScale = this.getYScale();\n\n      var x = this._normalizeValues(obj[xScale.field], xScale);\n\n      var y;\n\n      if (yScale) {\n        y = this._normalizeValues(obj[yScale.field], yScale);\n      } else {\n        y = obj.y ? obj.y : 0.1;\n      }\n\n      return {\n        x: x,\n        y: y,\n        y0: yScale ? yScale.scale(this.getYMinValue()) : undefined\n      };\n    };\n\n    _proto.getYMinValue = function getYMinValue() {\n      var yScale = this.getYScale();\n      var min = yScale.min,\n          max = yScale.max;\n      var value;\n\n      if (this.get('startOnZero')) {\n        if (max <= 0 && min <= 0) {\n          value = max;\n        } else {\n          value = min >= 0 ? min : 0;\n        }\n      } else {\n        value = min;\n      }\n\n      return value;\n    };\n\n    _proto._normalizeValues = function _normalizeValues(values, scale) {\n      var rst = [];\n\n      if (isArray(values)) {\n        for (var i = 0, len = values.length; i < len; i++) {\n          var v = values[i];\n          rst.push(scale.scale(v));\n        }\n      } else {\n        rst = scale.scale(values);\n      }\n\n      return rst;\n    };\n\n    _proto.getAttr = function getAttr(name) {\n      return this.get('attrs')[name];\n    };\n\n    _proto.getXScale = function getXScale() {\n      return this.getAttr('position').scales[0];\n    };\n\n    _proto.getYScale = function getYScale() {\n      return this.getAttr('position').scales[1];\n    };\n\n    _proto.hasAdjust = function hasAdjust(adjust) {\n      return this.get('adjust') && this.get('adjust').type === adjust;\n    };\n\n    _proto._getSnap = function _getSnap(scale, item, arr) {\n      var i = 0;\n      var values;\n      var yField = this.getYScale().field; // 叠加的维度\n\n      if (this.hasAdjust('stack') && scale.field === yField) {\n        values = [];\n        arr.forEach(function (obj) {\n          values.push(obj[FIELD_ORIGIN_Y]);\n        });\n\n        for (var len = values.length; i < len; i++) {\n          if (values[0][0] > item) {\n            break;\n          }\n\n          if (values[values.length - 1][1] <= item) {\n            i = values.length - 1;\n            break;\n          }\n\n          if (values[i][0] <= item && values[i][1] > item) {\n            break;\n          }\n        }\n      } else {\n        values = scale.values;\n        values.sort(function (a, b) {\n          return a - b;\n        });\n\n        for (var _len2 = values.length; i < _len2; i++) {\n          // 如果只有1个点直接返回第1个点\n          if (_len2 <= 1) {\n            break;\n          } // 第1个点和第2个点之间\n\n\n          if ((values[0] + values[1]) / 2 > item) {\n            break;\n          } // 中间的点\n\n\n          if ((values[i - 1] + values[i]) / 2 <= item && (values[i + 1] + values[i]) / 2 > item) {\n            break;\n          } // 最后2个点\n\n\n          if ((values[values.length - 2] + values[values.length - 1]) / 2 <= item) {\n            i = values.length - 1;\n            break;\n          }\n        }\n      }\n\n      var result = values[i];\n      return result;\n    };\n\n    _proto.getSnapRecords = function getSnapRecords(point) {\n      var self = this;\n      var coord = self.get('coord');\n      var xScale = self.getXScale();\n      var yScale = self.getYScale();\n      var xfield = xScale.field;\n      var dataArray = self.get('dataArray');\n\n      if (!this.get('hasSorted')) {\n        this._sort(dataArray);\n      }\n\n      var rst = [];\n      var invertPoint = coord.invertPoint(point);\n      var invertPointX = invertPoint.x;\n\n      if (self.isInCircle() && !coord.transposed && invertPointX > (1 + xScale.rangeMax()) / 2) {\n        invertPointX = xScale.rangeMin();\n      }\n\n      var xValue = xScale.invert(invertPointX);\n\n      if (!xScale.isCategory) {\n        xValue = self._getSnap(xScale, xValue);\n      }\n\n      var tmp = [];\n      dataArray.forEach(function (data) {\n        data.forEach(function (obj) {\n          var originValue = isNil(obj[FIELD_ORIGIN]) ? obj[xfield] : obj[FIELD_ORIGIN][xfield];\n\n          if (self._isEqual(originValue, xValue, xScale)) {\n            tmp.push(obj);\n          }\n        });\n      }); // special for pie chart\n\n      if (this.hasAdjust('stack') && coord.isPolar && coord.transposed) {\n        if (invertPointX >= 0 && invertPointX <= 1) {\n          var yValue = yScale.invert(invertPoint.y);\n          yValue = self._getSnap(yScale, yValue, tmp);\n          tmp.forEach(function (obj) {\n            if (isArray(yValue) ? obj[FIELD_ORIGIN_Y].toString() === yValue.toString() : obj[FIELD_ORIGIN_Y] === yValue) {\n              rst.push(obj);\n            }\n          });\n        }\n      } else {\n        rst = tmp;\n      }\n\n      return rst;\n    };\n\n    _proto.getRecords = function getRecords(value) {\n      var _this = this;\n\n      var xScale = this.getXScale();\n      var dataArray = this.get('dataArray');\n      var xfield = xScale.field;\n      return dataArray.map(function (data) {\n        for (var len = data.length, i = len - 1; i >= 0; i--) {\n          var obj = data[i];\n          var originValue = isNil(obj[FIELD_ORIGIN]) ? obj[xfield] : obj[FIELD_ORIGIN][xfield];\n\n          if (_this._isEqual(originValue, value, xScale)) {\n            return obj;\n          }\n        }\n\n        return null;\n      });\n    };\n\n    _proto._isEqual = function _isEqual(originValue, value, scale) {\n      if (scale.type === 'timeCat') {\n        return toTimeStamp(originValue) === value;\n      }\n\n      return value === originValue;\n    };\n\n    _proto.position = function position(field) {\n      this._setAttrOptions('position', {\n        field: field\n      });\n\n      return this;\n    };\n\n    _proto.color = function color(field, values) {\n      this._createAttrOption('color', field, values, Global.colors);\n\n      return this;\n    };\n\n    _proto.size = function size(field, values) {\n      this._createAttrOption('size', field, values, Global.sizes);\n\n      return this;\n    };\n\n    _proto.shape = function shape(field, values) {\n      var type = this.get('type');\n      var shapes = Global.shapes[type] || [];\n\n      this._createAttrOption('shape', field, values, shapes);\n\n      return this;\n    };\n\n    _proto.style = function style(field, cfg) {\n      var styleOptions = this.get('styleOptions');\n\n      if (!styleOptions) {\n        styleOptions = {};\n        this.set('styleOptions', styleOptions);\n      }\n\n      if (isObject(field)) {\n        cfg = field;\n        field = null;\n      }\n\n      var fields;\n\n      if (field) {\n        fields = parseFields(field);\n      }\n\n      styleOptions.fields = fields;\n      styleOptions.style = cfg;\n      return this;\n    };\n\n    _proto.adjust = function adjust(type) {\n      if (isString(type)) {\n        type = {\n          type: type\n        };\n      }\n\n      this.set('adjust', type);\n      return this;\n    };\n\n    _proto.animate = function animate(cfg) {\n      this.set('animateCfg', cfg);\n      return this;\n    };\n\n    _proto.changeData = function changeData(data) {\n      this.set('data', data); // 改变数据后，情况度量，因为需要重新实例化\n\n      this.set('scales', {});\n      if (!this.get('isInit')) return;\n      this.set('isInit', false);\n      this.init();\n    };\n\n    _proto.clearInner = function clearInner() {\n      var container = this.get('container');\n\n      if (container) {\n        container.clear(); // container.setMatrix([ 1, 0, 0, 1, 0, 0 ]);\n      }\n    };\n\n    _proto.reset = function reset() {\n      this.set('isInit', false);\n      this.set('attrs', {});\n      this.set('attrOptions', {});\n      this.set('adjust', null);\n      this.clearInner();\n    };\n\n    _proto.clear = function clear() {\n      this.clearInner();\n    };\n\n    _proto.destroy = function destroy() {\n      this.set('isInit', false);\n      this.clear();\n\n      _Base.prototype.destroy.call(this);\n    };\n\n    _proto._display = function _display(visible) {\n      this.set('visible', visible);\n      var container = this.get('container');\n      var canvas = container.get('canvas');\n      container.set('visible', visible);\n      canvas.draw();\n    };\n\n    _proto.show = function show() {\n      this._display(true);\n    };\n\n    _proto.hide = function hide() {\n      this._display(false);\n    };\n\n    return Geom;\n  }(Base);\n\n  var methodCache = {};\n  /**\n   * 获取计算 ticks 的方法\n   * @param key 键值\n   * @returns 计算 ticks 的方法\n   */\n\n  function getTickMethod(key) {\n    return methodCache[key];\n  }\n  /**\n   * 注册计算 ticks 的方法\n   * @param key 键值\n   * @param method 方法\n   */\n\n\n  function registerTickMethod(key, method) {\n    methodCache[key] = method;\n  }\n\n  var Scale =\n  /** @class */\n  function () {\n    function Scale(cfg) {\n      /**\n       * 度量的类型\n       */\n      this.type = 'base';\n      /**\n       * 是否分类类型的度量\n       */\n\n      this.isCategory = false;\n      /**\n       * 是否线性度量，有linear, time 度量\n       */\n\n      this.isLinear = false;\n      /**\n       * 是否连续类型的度量，linear,time,log, pow, quantile, quantize 都支持\n       */\n\n      this.isContinuous = false;\n      /**\n       * 是否是常量的度量，传入和传出一致\n       */\n\n      this.isIdentity = false;\n      this.values = [];\n      this.range = [0, 1];\n      this.ticks = [];\n      this.__cfg__ = cfg;\n      this.initCfg();\n      this.init();\n    } // 对于原始值的必要转换，如分类、时间字段需转换成数值，用transform/map命名可能更好\n\n\n    Scale.prototype.translate = function (v) {\n      return v;\n    };\n    /** 重新初始化 */\n\n\n    Scale.prototype.change = function (cfg) {\n      // 覆盖配置项，而不替代\n      mix(this.__cfg__, cfg);\n      this.init();\n    };\n\n    Scale.prototype.clone = function () {\n      return this.constructor(this.__cfg__);\n    };\n    /** 获取坐标轴需要的ticks */\n\n\n    Scale.prototype.getTicks = function () {\n      var _this = this;\n\n      return map(this.ticks, function (tick, idx) {\n        if (isObject(tick)) {\n          // 仅当符合Tick类型时才有意义\n          return tick;\n        }\n\n        return {\n          text: _this.getText(tick, idx),\n          tickValue: tick,\n          value: _this.scale(tick)\n        };\n      });\n    };\n    /** 获取Tick的格式化结果 */\n\n\n    Scale.prototype.getText = function (value, key) {\n      var formatter = this.formatter;\n      var res = formatter ? formatter(value, key) : value;\n\n      if (isNil(res) || !isFunction(res.toString)) {\n        return '';\n      }\n\n      return res.toString();\n    }; // 获取配置项中的值，当前 scale 上的值可能会被修改\n\n\n    Scale.prototype.getConfig = function (key) {\n      return this.__cfg__[key];\n    }; // scale初始化\n\n\n    Scale.prototype.init = function () {\n      mix(this, this.__cfg__);\n      this.setDomain();\n\n      if (isEmpty(this.getConfig('ticks'))) {\n        this.ticks = this.calculateTicks();\n      }\n    }; // 子类上覆盖某些属性，不能直接在类上声明，否则会被覆盖\n\n\n    Scale.prototype.initCfg = function () {};\n\n    Scale.prototype.setDomain = function () {};\n\n    Scale.prototype.calculateTicks = function () {\n      var tickMethod = this.tickMethod;\n      var ticks = [];\n\n      if (isString(tickMethod)) {\n        var method = getTickMethod(tickMethod);\n\n        if (!method) {\n          throw new Error('There is no method to to calculate ticks!');\n        }\n\n        ticks = method(this);\n      } else if (isFunction(tickMethod)) {\n        ticks = tickMethod(this);\n      }\n\n      return ticks;\n    }; // range 的最小值\n\n\n    Scale.prototype.rangeMin = function () {\n      return head(this.range);\n    }; // range 的最大值\n\n\n    Scale.prototype.rangeMax = function () {\n      return last(this.range);\n    };\n    /** 定义域转 0~1 */\n\n\n    Scale.prototype.calcPercent = function (value, min, max) {\n      if (isNumber(value)) {\n        return (value - min) / (max - min);\n      }\n\n      return NaN;\n    };\n    /** 0~1转定义域 */\n\n\n    Scale.prototype.calcValue = function (percent, min, max) {\n      return min + percent * (max - min);\n    };\n\n    return Scale;\n  }();\n  /*! *****************************************************************************\r\n  Copyright (c) Microsoft Corporation.\r\n    Permission to use, copy, modify, and/or distribute this software for any\r\n  purpose with or without fee is hereby granted.\r\n    THE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\n  REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\n  AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\n  INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\n  LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\n  OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\n  PERFORMANCE OF THIS SOFTWARE.\r\n  ***************************************************************************** */\n\n  /* global Reflect, Promise */\n\n\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  function __extends(d, b) {\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  }\n\n  function __spreadArrays() {\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\n\n    for (var r = Array(s), k = 0, i = 0; i < il; i++) for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++) r[k] = a[j];\n\n    return r;\n  }\n  /**\n   * 分类度量\n   * @class\n   */\n\n\n  var Category =\n  /** @class */\n  function (_super) {\n    __extends(Category, _super);\n\n    function Category() {\n      var _this = _super !== null && _super.apply(this, arguments) || this;\n\n      _this.type = 'cat';\n      _this.isCategory = true;\n      return _this;\n    }\n\n    Category.prototype.translate = function (value) {\n      var index = indexOf(this.values, value);\n\n      if (index === -1) {\n        return isNumber(value) ? value : NaN;\n      }\n\n      return index;\n    };\n\n    Category.prototype.scale = function (value) {\n      var order = this.translate(value); // 分类数据允许 0.5 范围内调整\n      // if (order < this.min - 0.5 || order > this.max + 0.5) {\n      //   return NaN;\n      // }\n\n      var percent = this.calcPercent(order, this.min, this.max);\n      return this.calcValue(percent, this.rangeMin(), this.rangeMax());\n    };\n\n    Category.prototype.invert = function (scaledValue) {\n      var domainRange = this.max - this.min;\n      var percent = this.calcPercent(scaledValue, this.rangeMin(), this.rangeMax());\n      var idx = Math.round(domainRange * percent) + this.min;\n\n      if (idx < this.min || idx > this.max) {\n        return NaN;\n      }\n\n      return this.values[idx];\n    };\n\n    Category.prototype.getText = function (value) {\n      var args = [];\n\n      for (var _i = 1; _i < arguments.length; _i++) {\n        args[_i - 1] = arguments[_i];\n      }\n\n      var v = value; // value为index\n\n      if (isNumber(value) && !this.values.includes(value)) {\n        v = this.values[v];\n      }\n\n      return _super.prototype.getText.apply(this, __spreadArrays([v], args));\n    }; // 复写属性\n\n\n    Category.prototype.initCfg = function () {\n      this.tickMethod = 'cat';\n    }; // 设置 min, max\n\n\n    Category.prototype.setDomain = function () {\n      // 用户有可能设置 min\n      if (isNil(this.getConfig('min'))) {\n        this.min = 0;\n      }\n\n      if (isNil(this.getConfig('max'))) {\n        var size = this.values.length;\n        this.max = size > 1 ? size - 1 : size;\n      }\n    };\n\n    return Category;\n  }(Scale);\n\n  var token = /d{1,4}|M{1,4}|YY(?:YY)?|S{1,3}|Do|ZZ|Z|([HhMsDm])\\1?|[aA]|\"[^\"]*\"|'[^']*'/g;\n  var twoDigitsOptional = \"[1-9]\\\\d?\";\n  var twoDigits = \"\\\\d\\\\d\";\n  var threeDigits = \"\\\\d{3}\";\n  var fourDigits = \"\\\\d{4}\";\n  var word = \"[^\\\\s]+\";\n  var literal = /\\[([^]*?)\\]/gm;\n\n  function shorten(arr, sLen) {\n    var newArr = [];\n\n    for (var i = 0, len = arr.length; i < len; i++) {\n      newArr.push(arr[i].substr(0, sLen));\n    }\n\n    return newArr;\n  }\n\n  var monthUpdate = function (arrName) {\n    return function (v, i18n) {\n      var lowerCaseArr = i18n[arrName].map(function (v) {\n        return v.toLowerCase();\n      });\n      var index = lowerCaseArr.indexOf(v.toLowerCase());\n\n      if (index > -1) {\n        return index;\n      }\n\n      return null;\n    };\n  };\n\n  function assign(origObj) {\n    var args = [];\n\n    for (var _i = 1; _i < arguments.length; _i++) {\n      args[_i - 1] = arguments[_i];\n    }\n\n    for (var _a = 0, args_1 = args; _a < args_1.length; _a++) {\n      var obj = args_1[_a];\n\n      for (var key in obj) {\n        // @ts-ignore ex\n        origObj[key] = obj[key];\n      }\n    }\n\n    return origObj;\n  }\n\n  var dayNames = [\"Sunday\", \"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\", \"Friday\", \"Saturday\"];\n  var monthNames = [\"January\", \"February\", \"March\", \"April\", \"May\", \"June\", \"July\", \"August\", \"September\", \"October\", \"November\", \"December\"];\n  var monthNamesShort = shorten(monthNames, 3);\n  var dayNamesShort = shorten(dayNames, 3);\n  var defaultI18n = {\n    dayNamesShort: dayNamesShort,\n    dayNames: dayNames,\n    monthNamesShort: monthNamesShort,\n    monthNames: monthNames,\n    amPm: [\"am\", \"pm\"],\n    DoFn: function (dayOfMonth) {\n      return dayOfMonth + [\"th\", \"st\", \"nd\", \"rd\"][dayOfMonth % 10 > 3 ? 0 : (dayOfMonth - dayOfMonth % 10 !== 10 ? 1 : 0) * dayOfMonth % 10];\n    }\n  };\n  var globalI18n = assign({}, defaultI18n);\n\n  var setGlobalDateI18n = function (i18n) {\n    return globalI18n = assign(globalI18n, i18n);\n  };\n\n  var regexEscape = function (str) {\n    return str.replace(/[|\\\\{()[^$+*?.-]/g, \"\\\\$&\");\n  };\n\n  var pad = function (val, len) {\n    if (len === void 0) {\n      len = 2;\n    }\n\n    val = String(val);\n\n    while (val.length < len) {\n      val = \"0\" + val;\n    }\n\n    return val;\n  };\n\n  var formatFlags = {\n    D: function (dateObj) {\n      return String(dateObj.getDate());\n    },\n    DD: function (dateObj) {\n      return pad(dateObj.getDate());\n    },\n    Do: function (dateObj, i18n) {\n      return i18n.DoFn(dateObj.getDate());\n    },\n    d: function (dateObj) {\n      return String(dateObj.getDay());\n    },\n    dd: function (dateObj) {\n      return pad(dateObj.getDay());\n    },\n    ddd: function (dateObj, i18n) {\n      return i18n.dayNamesShort[dateObj.getDay()];\n    },\n    dddd: function (dateObj, i18n) {\n      return i18n.dayNames[dateObj.getDay()];\n    },\n    M: function (dateObj) {\n      return String(dateObj.getMonth() + 1);\n    },\n    MM: function (dateObj) {\n      return pad(dateObj.getMonth() + 1);\n    },\n    MMM: function (dateObj, i18n) {\n      return i18n.monthNamesShort[dateObj.getMonth()];\n    },\n    MMMM: function (dateObj, i18n) {\n      return i18n.monthNames[dateObj.getMonth()];\n    },\n    YY: function (dateObj) {\n      return pad(String(dateObj.getFullYear()), 4).substr(2);\n    },\n    YYYY: function (dateObj) {\n      return pad(dateObj.getFullYear(), 4);\n    },\n    h: function (dateObj) {\n      return String(dateObj.getHours() % 12 || 12);\n    },\n    hh: function (dateObj) {\n      return pad(dateObj.getHours() % 12 || 12);\n    },\n    H: function (dateObj) {\n      return String(dateObj.getHours());\n    },\n    HH: function (dateObj) {\n      return pad(dateObj.getHours());\n    },\n    m: function (dateObj) {\n      return String(dateObj.getMinutes());\n    },\n    mm: function (dateObj) {\n      return pad(dateObj.getMinutes());\n    },\n    s: function (dateObj) {\n      return String(dateObj.getSeconds());\n    },\n    ss: function (dateObj) {\n      return pad(dateObj.getSeconds());\n    },\n    S: function (dateObj) {\n      return String(Math.round(dateObj.getMilliseconds() / 100));\n    },\n    SS: function (dateObj) {\n      return pad(Math.round(dateObj.getMilliseconds() / 10), 2);\n    },\n    SSS: function (dateObj) {\n      return pad(dateObj.getMilliseconds(), 3);\n    },\n    a: function (dateObj, i18n) {\n      return dateObj.getHours() < 12 ? i18n.amPm[0] : i18n.amPm[1];\n    },\n    A: function (dateObj, i18n) {\n      return dateObj.getHours() < 12 ? i18n.amPm[0].toUpperCase() : i18n.amPm[1].toUpperCase();\n    },\n    ZZ: function (dateObj) {\n      var offset = dateObj.getTimezoneOffset();\n      return (offset > 0 ? \"-\" : \"+\") + pad(Math.floor(Math.abs(offset) / 60) * 100 + Math.abs(offset) % 60, 4);\n    },\n    Z: function (dateObj) {\n      var offset = dateObj.getTimezoneOffset();\n      return (offset > 0 ? \"-\" : \"+\") + pad(Math.floor(Math.abs(offset) / 60), 2) + \":\" + pad(Math.abs(offset) % 60, 2);\n    }\n  };\n\n  var monthParse = function (v) {\n    return +v - 1;\n  };\n\n  var emptyDigits = [null, twoDigitsOptional];\n  var emptyWord = [null, word];\n  var amPm = [\"isPm\", word, function (v, i18n) {\n    var val = v.toLowerCase();\n\n    if (val === i18n.amPm[0]) {\n      return 0;\n    } else if (val === i18n.amPm[1]) {\n      return 1;\n    }\n\n    return null;\n  }];\n  var timezoneOffset = [\"timezoneOffset\", \"[^\\\\s]*?[\\\\+\\\\-]\\\\d\\\\d:?\\\\d\\\\d|[^\\\\s]*?Z?\", function (v) {\n    var parts = (v + \"\").match(/([+-]|\\d\\d)/gi);\n\n    if (parts) {\n      var minutes = +parts[1] * 60 + parseInt(parts[2], 10);\n      return parts[0] === \"+\" ? minutes : -minutes;\n    }\n\n    return 0;\n  }];\n  var parseFlags = {\n    D: [\"day\", twoDigitsOptional],\n    DD: [\"day\", twoDigits],\n    Do: [\"day\", twoDigitsOptional + word, function (v) {\n      return parseInt(v, 10);\n    }],\n    M: [\"month\", twoDigitsOptional, monthParse],\n    MM: [\"month\", twoDigits, monthParse],\n    YY: [\"year\", twoDigits, function (v) {\n      var now = new Date();\n      var cent = +(\"\" + now.getFullYear()).substr(0, 2);\n      return +(\"\" + (+v > 68 ? cent - 1 : cent) + v);\n    }],\n    h: [\"hour\", twoDigitsOptional, undefined, \"isPm\"],\n    hh: [\"hour\", twoDigits, undefined, \"isPm\"],\n    H: [\"hour\", twoDigitsOptional],\n    HH: [\"hour\", twoDigits],\n    m: [\"minute\", twoDigitsOptional],\n    mm: [\"minute\", twoDigits],\n    s: [\"second\", twoDigitsOptional],\n    ss: [\"second\", twoDigits],\n    YYYY: [\"year\", fourDigits],\n    S: [\"millisecond\", \"\\\\d\", function (v) {\n      return +v * 100;\n    }],\n    SS: [\"millisecond\", twoDigits, function (v) {\n      return +v * 10;\n    }],\n    SSS: [\"millisecond\", threeDigits],\n    d: emptyDigits,\n    dd: emptyDigits,\n    ddd: emptyWord,\n    dddd: emptyWord,\n    MMM: [\"month\", word, monthUpdate(\"monthNamesShort\")],\n    MMMM: [\"month\", word, monthUpdate(\"monthNames\")],\n    a: amPm,\n    A: amPm,\n    ZZ: timezoneOffset,\n    Z: timezoneOffset\n  }; // Some common format strings\n\n  var globalMasks = {\n    default: \"ddd MMM DD YYYY HH:mm:ss\",\n    shortDate: \"M/D/YY\",\n    mediumDate: \"MMM D, YYYY\",\n    longDate: \"MMMM D, YYYY\",\n    fullDate: \"dddd, MMMM D, YYYY\",\n    isoDate: \"YYYY-MM-DD\",\n    isoDateTime: \"YYYY-MM-DDTHH:mm:ssZ\",\n    shortTime: \"HH:mm\",\n    mediumTime: \"HH:mm:ss\",\n    longTime: \"HH:mm:ss.SSS\"\n  };\n\n  var setGlobalDateMasks = function (masks) {\n    return assign(globalMasks, masks);\n  };\n  /***\n   * Format a date\n   * @method format\n   * @param {Date|number} dateObj\n   * @param {string} mask Format of the date, i.e. 'mm-dd-yy' or 'shortDate'\n   * @returns {string} Formatted date string\n   */\n\n\n  var format = function (dateObj, mask, i18n) {\n    if (mask === void 0) {\n      mask = globalMasks[\"default\"];\n    }\n\n    if (i18n === void 0) {\n      i18n = {};\n    }\n\n    if (typeof dateObj === \"number\") {\n      dateObj = new Date(dateObj);\n    }\n\n    if (Object.prototype.toString.call(dateObj) !== \"[object Date]\" || isNaN(dateObj.getTime())) {\n      throw new Error(\"Invalid Date pass to format\");\n    }\n\n    mask = globalMasks[mask] || mask;\n    var literals = []; // Make literals inactive by replacing them with @@@\n\n    mask = mask.replace(literal, function ($0, $1) {\n      literals.push($1);\n      return \"@@@\";\n    });\n    var combinedI18nSettings = assign(assign({}, globalI18n), i18n); // Apply formatting rules\n\n    mask = mask.replace(token, function ($0) {\n      return formatFlags[$0](dateObj, combinedI18nSettings);\n    }); // Inline literal values back into the formatted value\n\n    return mask.replace(/@@@/g, function () {\n      return literals.shift();\n    });\n  };\n  /**\n   * Parse a date string into a Javascript Date object /\n   * @method parse\n   * @param {string} dateStr Date string\n   * @param {string} format Date parse format\n   * @param {i18n} I18nSettingsOptional Full or subset of I18N settings\n   * @returns {Date|null} Returns Date object. Returns null what date string is invalid or doesn't match format\n   */\n\n\n  function parse(dateStr, format, i18n) {\n    if (i18n === void 0) {\n      i18n = {};\n    }\n\n    if (typeof format !== \"string\") {\n      throw new Error(\"Invalid format in fecha parse\");\n    } // Check to see if the format is actually a mask\n\n\n    format = globalMasks[format] || format; // Avoid regular expression denial of service, fail early for really long strings\n    // https://www.owasp.org/index.php/Regular_expression_Denial_of_Service_-_ReDoS\n\n    if (dateStr.length > 1000) {\n      return null;\n    } // Default to the beginning of the year.\n\n\n    var today = new Date();\n    var dateInfo = {\n      year: today.getFullYear(),\n      month: 0,\n      day: 1,\n      hour: 0,\n      minute: 0,\n      second: 0,\n      millisecond: 0,\n      isPm: null,\n      timezoneOffset: null\n    };\n    var parseInfo = [];\n    var literals = []; // Replace all the literals with @@@. Hopefully a string that won't exist in the format\n\n    var newFormat = format.replace(literal, function ($0, $1) {\n      literals.push(regexEscape($1));\n      return \"@@@\";\n    });\n    var specifiedFields = {};\n    var requiredFields = {}; // Change every token that we find into the correct regex\n\n    newFormat = regexEscape(newFormat).replace(token, function ($0) {\n      var info = parseFlags[$0];\n      var field = info[0],\n          regex = info[1],\n          requiredField = info[3]; // Check if the person has specified the same field twice. This will lead to confusing results.\n\n      if (specifiedFields[field]) {\n        throw new Error(\"Invalid format. \" + field + \" specified twice in format\");\n      }\n\n      specifiedFields[field] = true; // Check if there are any required fields. For instance, 12 hour time requires AM/PM specified\n\n      if (requiredField) {\n        requiredFields[requiredField] = true;\n      }\n\n      parseInfo.push(info);\n      return \"(\" + regex + \")\";\n    }); // Check all the required fields are present\n\n    Object.keys(requiredFields).forEach(function (field) {\n      if (!specifiedFields[field]) {\n        throw new Error(\"Invalid format. \" + field + \" is required in specified format\");\n      }\n    }); // Add back all the literals after\n\n    newFormat = newFormat.replace(/@@@/g, function () {\n      return literals.shift();\n    }); // Check if the date string matches the format. If it doesn't return null\n\n    var matches = dateStr.match(new RegExp(newFormat, \"i\"));\n\n    if (!matches) {\n      return null;\n    }\n\n    var combinedI18nSettings = assign(assign({}, globalI18n), i18n); // For each match, call the parser function for that date part\n\n    for (var i = 1; i < matches.length; i++) {\n      var _a = parseInfo[i - 1],\n          field = _a[0],\n          parser = _a[2];\n      var value = parser ? parser(matches[i], combinedI18nSettings) : +matches[i]; // If the parser can't make sense of the value, return null\n\n      if (value == null) {\n        return null;\n      }\n\n      dateInfo[field] = value;\n    }\n\n    if (dateInfo.isPm === 1 && dateInfo.hour != null && +dateInfo.hour !== 12) {\n      dateInfo.hour = +dateInfo.hour + 12;\n    } else if (dateInfo.isPm === 0 && +dateInfo.hour === 12) {\n      dateInfo.hour = 0;\n    }\n\n    var dateWithoutTZ = new Date(dateInfo.year, dateInfo.month, dateInfo.day, dateInfo.hour, dateInfo.minute, dateInfo.second, dateInfo.millisecond);\n    var validateFields = [[\"month\", \"getMonth\"], [\"day\", \"getDate\"], [\"hour\", \"getHours\"], [\"minute\", \"getMinutes\"], [\"second\", \"getSeconds\"]];\n\n    for (var i = 0, len = validateFields.length; i < len; i++) {\n      // Check to make sure the date field is within the allowed range. Javascript dates allows values\n      // outside the allowed range. If the values don't match the value was invalid\n      if (specifiedFields[validateFields[i][0]] && dateInfo[validateFields[i][0]] !== dateWithoutTZ[validateFields[i][1]]()) {\n        return null;\n      }\n    }\n\n    if (dateInfo.timezoneOffset == null) {\n      return dateWithoutTZ;\n    }\n\n    return new Date(Date.UTC(dateInfo.year, dateInfo.month, dateInfo.day, dateInfo.hour, dateInfo.minute - dateInfo.timezoneOffset, dateInfo.second, dateInfo.millisecond));\n  }\n\n  var fecha = {\n    format: format,\n    parse: parse,\n    defaultI18n: defaultI18n,\n    setGlobalDateI18n: setGlobalDateI18n,\n    setGlobalDateMasks: setGlobalDateMasks\n  };\n  var fecha1 = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    'default': fecha,\n    assign: assign,\n    format: format,\n    parse: parse,\n    defaultI18n: defaultI18n,\n    setGlobalDateI18n: setGlobalDateI18n,\n    setGlobalDateMasks: setGlobalDateMasks\n  });\n  /**\n   * 二分右侧查找\n   * https://github.com/d3/d3-array/blob/master/src/bisector.js\n   */\n\n  function bisector(getter) {\n    /**\n     * x: 目标值\n     * lo: 起始位置\n     * hi: 结束位置\n     */\n    return function (a, x, _lo, _hi) {\n      var lo = isNil(_lo) ? 0 : _lo;\n      var hi = isNil(_hi) ? a.length : _hi;\n\n      while (lo < hi) {\n        var mid = lo + hi >>> 1;\n\n        if (getter(a[mid]) > x) {\n          hi = mid;\n        } else {\n          lo = mid + 1;\n        }\n      }\n\n      return lo;\n    };\n  }\n\n  var FORMAT_METHOD = 'format';\n\n  function timeFormat(time, mask) {\n    var method = fecha1[FORMAT_METHOD] || fecha[FORMAT_METHOD];\n    return method(time, mask);\n  }\n  /**\n   * 转换成时间戳\n   * @param value 时间值\n   */\n\n\n  function toTimeStamp$1(value) {\n    if (isString(value)) {\n      if (value.indexOf('T') > 0) {\n        value = new Date(value).getTime();\n      } else {\n        // new Date('2010/01/10') 和 new Date('2010-01-10') 的差别在于:\n        // 如果仅有年月日时，前者是带有时区的: Fri Jan 10 2020 02:40:13 GMT+0800 (中国标准时间)\n        // 后者会格式化成 Sun Jan 10 2010 08:00:00 GMT+0800 (中国标准时间)\n        value = new Date(value.replace(/-/gi, '/')).getTime();\n      }\n    }\n\n    if (isDate(value)) {\n      value = value.getTime();\n    }\n\n    return value;\n  }\n\n  var SECOND = 1000;\n  var MINUTE = 60 * SECOND;\n  var HOUR = 60 * MINUTE;\n  var DAY = 24 * HOUR;\n  var MONTH = DAY * 31;\n  var YEAR = DAY * 365;\n  var intervals = [['HH:mm:ss', SECOND], ['HH:mm:ss', SECOND * 10], ['HH:mm:ss', SECOND * 30], ['HH:mm', MINUTE], ['HH:mm', MINUTE * 10], ['HH:mm', MINUTE * 30], ['HH', HOUR], ['HH', HOUR * 6], ['HH', HOUR * 12], ['YYYY-MM-DD', DAY], ['YYYY-MM-DD', DAY * 4], ['YYYY-WW', DAY * 7], ['YYYY-MM', MONTH], ['YYYY-MM', MONTH * 4], ['YYYY-MM', MONTH * 6], ['YYYY', DAY * 380]];\n\n  function getTickInterval(min, max, tickCount) {\n    var target = (max - min) / tickCount;\n    var idx = bisector(function (o) {\n      return o[1];\n    })(intervals, target) - 1;\n    var interval = intervals[idx];\n\n    if (idx < 0) {\n      interval = intervals[0];\n    } else if (idx >= intervals.length) {\n      interval = last(intervals);\n    }\n\n    return interval;\n  }\n  /**\n   * 时间分类度量\n   * @class\n   */\n\n\n  var TimeCat =\n  /** @class */\n  function (_super) {\n    __extends(TimeCat, _super);\n\n    function TimeCat() {\n      var _this = _super !== null && _super.apply(this, arguments) || this;\n\n      _this.type = 'timeCat';\n      return _this;\n    }\n    /**\n     * @override\n     */\n\n\n    TimeCat.prototype.translate = function (value) {\n      value = toTimeStamp$1(value);\n      var index = this.values.indexOf(value);\n\n      if (index === -1) {\n        if (isNumber(value) && value < this.values.length) {\n          index = value;\n        } else {\n          index = NaN;\n        }\n      }\n\n      return index;\n    };\n    /**\n     * 由于时间类型数据需要转换一下，所以复写 getText\n     * @override\n     */\n\n\n    TimeCat.prototype.getText = function (value, tickIndex) {\n      var index = this.translate(value);\n\n      if (index > -1) {\n        var result = this.values[index];\n        var formatter = this.formatter;\n        result = formatter ? formatter(result, tickIndex) : timeFormat(result, this.mask);\n        return result;\n      }\n\n      return value;\n    };\n\n    TimeCat.prototype.initCfg = function () {\n      this.tickMethod = 'time-cat';\n      this.mask = 'YYYY-MM-DD';\n      this.tickCount = 7; // 一般时间数据会显示 7， 14， 30 天的数字\n    };\n\n    TimeCat.prototype.setDomain = function () {\n      var values = this.values; // 针对时间分类类型，会将时间统一转换为时间戳\n\n      each(values, function (v, i) {\n        values[i] = toTimeStamp$1(v);\n      });\n      values.sort(function (v1, v2) {\n        return v1 - v2;\n      });\n\n      _super.prototype.setDomain.call(this);\n    };\n\n    return TimeCat;\n  }(Category);\n  /**\n   * 连续度量的基类\n   * @class\n   */\n\n\n  var Continuous =\n  /** @class */\n  function (_super) {\n    __extends(Continuous, _super);\n\n    function Continuous() {\n      var _this = _super !== null && _super.apply(this, arguments) || this;\n\n      _this.isContinuous = true;\n      return _this;\n    }\n\n    Continuous.prototype.scale = function (value) {\n      if (isNil(value)) {\n        return NaN;\n      }\n\n      var rangeMin = this.rangeMin();\n      var rangeMax = this.rangeMax();\n      var max = this.max;\n      var min = this.min;\n\n      if (max === min) {\n        return rangeMin;\n      }\n\n      var percent = this.getScalePercent(value);\n      return rangeMin + percent * (rangeMax - rangeMin);\n    };\n\n    Continuous.prototype.init = function () {\n      _super.prototype.init.call(this); // init 完成后保证 min, max 包含 ticks 的范围\n\n\n      var ticks = this.ticks;\n      var firstTick = head(ticks);\n      var lastTick = last(ticks);\n\n      if (firstTick < this.min) {\n        this.min = firstTick;\n      }\n\n      if (lastTick > this.max) {\n        this.max = lastTick;\n      } // strict-limit 方式\n\n\n      if (!isNil(this.minLimit)) {\n        this.min = firstTick;\n      }\n\n      if (!isNil(this.maxLimit)) {\n        this.max = lastTick;\n      }\n    };\n\n    Continuous.prototype.setDomain = function () {\n      var _a = getRange(this.values),\n          min = _a.min,\n          max = _a.max;\n\n      if (isNil(this.min)) {\n        this.min = min;\n      }\n\n      if (isNil(this.max)) {\n        this.max = max;\n      }\n\n      if (this.min > this.max) {\n        this.min = min;\n        this.max = max;\n      }\n    };\n\n    Continuous.prototype.calculateTicks = function () {\n      var _this = this;\n\n      var ticks = _super.prototype.calculateTicks.call(this);\n\n      if (!this.nice) {\n        ticks = filter(ticks, function (tick) {\n          return tick >= _this.min && tick <= _this.max;\n        });\n      }\n\n      return ticks;\n    }; // 计算原始值值占的百分比\n\n\n    Continuous.prototype.getScalePercent = function (value) {\n      var max = this.max;\n      var min = this.min;\n      return (value - min) / (max - min);\n    };\n\n    Continuous.prototype.getInvertPercent = function (value) {\n      return (value - this.rangeMin()) / (this.rangeMax() - this.rangeMin());\n    };\n\n    return Continuous;\n  }(Scale);\n  /**\n   * 线性度量\n   * @class\n   */\n\n\n  var Linear =\n  /** @class */\n  function (_super) {\n    __extends(Linear, _super);\n\n    function Linear() {\n      var _this = _super !== null && _super.apply(this, arguments) || this;\n\n      _this.type = 'linear';\n      _this.isLinear = true;\n      return _this;\n    }\n\n    Linear.prototype.invert = function (value) {\n      var percent = this.getInvertPercent(value);\n      return this.min + percent * (this.max - this.min);\n    };\n\n    Linear.prototype.initCfg = function () {\n      this.tickMethod = 'wilkinson-extended';\n      this.nice = false;\n    };\n\n    return Linear;\n  }(Continuous); // 虽然数学上 b 不支持负数，但是这里需要支持 负数\n\n\n  function calBase(a, b) {\n    var e = Math.E;\n    var value;\n\n    if (b >= 0) {\n      value = Math.pow(e, Math.log(b) / a); // 使用换底公式求底\n    } else {\n      value = Math.pow(e, Math.log(-b) / a) * -1; // 使用换底公式求底\n    }\n\n    return value;\n  }\n\n  function log(a, b) {\n    if (a === 1) {\n      return 1;\n    }\n\n    return Math.log(b) / Math.log(a);\n  }\n\n  function getLogPositiveMin(values, base, max) {\n    if (isNil(max)) {\n      max = Math.max.apply(null, values);\n    }\n\n    var positiveMin = max;\n    each(values, function (value) {\n      if (value > 0 && value < positiveMin) {\n        positiveMin = value;\n      }\n    });\n\n    if (positiveMin === max) {\n      positiveMin = max / base;\n    }\n\n    if (positiveMin > 1) {\n      positiveMin = 1;\n    }\n\n    return positiveMin;\n  }\n  /**\n   * Log 度量，处理非均匀分布\n   */\n\n\n  var Log =\n  /** @class */\n  function (_super) {\n    __extends(Log, _super);\n\n    function Log() {\n      var _this = _super !== null && _super.apply(this, arguments) || this;\n\n      _this.type = 'log';\n      return _this;\n    }\n    /**\n     * @override\n     */\n\n\n    Log.prototype.invert = function (value) {\n      var base = this.base;\n      var max = log(base, this.max);\n      var rangeMin = this.rangeMin();\n      var range = this.rangeMax() - rangeMin;\n      var min;\n      var positiveMin = this.positiveMin;\n\n      if (positiveMin) {\n        if (value === 0) {\n          return 0;\n        }\n\n        min = log(base, positiveMin / base);\n        var appendPercent = 1 / (max - min) * range; // 0 到 positiveMin的占比\n\n        if (value < appendPercent) {\n          // 落到 0 - positiveMin 之间\n          return value / appendPercent * positiveMin;\n        }\n      } else {\n        min = log(base, this.min);\n      }\n\n      var percent = (value - rangeMin) / range;\n      var tmp = percent * (max - min) + min;\n      return Math.pow(base, tmp);\n    };\n\n    Log.prototype.initCfg = function () {\n      this.tickMethod = 'log';\n      this.base = 10;\n      this.tickCount = 6;\n      this.nice = true;\n    }; // 设置\n\n\n    Log.prototype.setDomain = function () {\n      _super.prototype.setDomain.call(this);\n\n      var min = this.min;\n\n      if (min < 0) {\n        throw new Error('When you use log scale, the minimum value must be greater than zero!');\n      }\n\n      if (min === 0) {\n        this.positiveMin = getLogPositiveMin(this.values, this.base, this.max);\n      }\n    }; // 根据当前值获取占比\n\n\n    Log.prototype.getScalePercent = function (value) {\n      var max = this.max;\n      var min = this.min;\n\n      if (max === min) {\n        return 0;\n      } // 如果值小于等于0，则按照0处理\n\n\n      if (value <= 0) {\n        return 0;\n      }\n\n      var base = this.base;\n      var positiveMin = this.positiveMin; // 如果min == 0, 则根据比0大的最小值，计算比例关系。这个最小值作为坐标轴上的第二个tick，第一个是0但是不显示\n\n      if (positiveMin) {\n        min = positiveMin * 1 / base;\n      }\n\n      var percent; // 如果数值小于次小值，那么就计算 value / 次小值 占整体的比例\n\n      if (value < positiveMin) {\n        percent = value / positiveMin / (log(base, max) - log(base, min));\n      } else {\n        percent = (log(base, value) - log(base, min)) / (log(base, max) - log(base, min));\n      }\n\n      return percent;\n    };\n\n    return Log;\n  }(Continuous);\n  /**\n   * Pow 度量，处理非均匀分布\n   */\n\n\n  var Pow =\n  /** @class */\n  function (_super) {\n    __extends(Pow, _super);\n\n    function Pow() {\n      var _this = _super !== null && _super.apply(this, arguments) || this;\n\n      _this.type = 'pow';\n      return _this;\n    }\n    /**\n     * @override\n     */\n\n\n    Pow.prototype.invert = function (value) {\n      var percent = this.getInvertPercent(value);\n      var exponent = this.exponent;\n      var max = calBase(exponent, this.max);\n      var min = calBase(exponent, this.min);\n      var tmp = percent * (max - min) + min;\n      var factor = tmp >= 0 ? 1 : -1;\n      return Math.pow(tmp, exponent) * factor;\n    };\n\n    Pow.prototype.initCfg = function () {\n      this.tickMethod = 'pow';\n      this.exponent = 2;\n      this.tickCount = 5;\n      this.nice = true;\n    }; // 获取度量计算时，value占的定义域百分比\n\n\n    Pow.prototype.getScalePercent = function (value) {\n      var max = this.max;\n      var min = this.min;\n\n      if (max === min) {\n        return 0;\n      }\n\n      var exponent = this.exponent;\n      var percent = (calBase(exponent, value) - calBase(exponent, min)) / (calBase(exponent, max) - calBase(exponent, min));\n      return percent;\n    };\n\n    return Pow;\n  }(Continuous);\n  /**\n   * 时间度量\n   * @class\n   */\n\n\n  var Time =\n  /** @class */\n  function (_super) {\n    __extends(Time, _super);\n\n    function Time() {\n      var _this = _super !== null && _super.apply(this, arguments) || this;\n\n      _this.type = 'time';\n      return _this;\n    }\n    /**\n     * @override\n     */\n\n\n    Time.prototype.getText = function (value, index) {\n      var numberValue = this.translate(value);\n      var formatter = this.formatter;\n      return formatter ? formatter(numberValue, index) : timeFormat(numberValue, this.mask);\n    };\n    /**\n     * @override\n     */\n\n\n    Time.prototype.scale = function (value) {\n      var v = value;\n\n      if (isString(v) || isDate(v)) {\n        v = this.translate(v);\n      }\n\n      return _super.prototype.scale.call(this, v);\n    };\n    /**\n     * 将时间转换成数字\n     * @override\n     */\n\n\n    Time.prototype.translate = function (v) {\n      return toTimeStamp$1(v);\n    };\n\n    Time.prototype.initCfg = function () {\n      this.tickMethod = 'time-pretty';\n      this.mask = 'YYYY-MM-DD';\n      this.tickCount = 7;\n      this.nice = false;\n    };\n\n    Time.prototype.setDomain = function () {\n      var values = this.values; // 是否设置了 min, max，而不是直接取 this.min, this.max\n\n      var minConfig = this.getConfig('min');\n      var maxConfig = this.getConfig('max'); // 如果设置了 min,max 则转换成时间戳\n\n      if (!isNil(minConfig) || !isNumber(minConfig)) {\n        this.min = this.translate(this.min);\n      }\n\n      if (!isNil(maxConfig) || !isNumber(maxConfig)) {\n        this.max = this.translate(this.max);\n      } // 没有设置 min, max 时\n\n\n      if (values && values.length) {\n        // 重新计算最大最小值\n        var timeStamps_1 = [];\n        var min_1 = Infinity; // 最小值\n\n        var secondMin_1 = min_1; // 次小值\n\n        var max_1 = 0; // 使用一个循环，计算min,max,secondMin\n\n        each(values, function (v) {\n          var timeStamp = toTimeStamp$1(v);\n\n          if (isNaN(timeStamp)) {\n            throw new TypeError(\"Invalid Time: \" + v + \" in time scale!\");\n          }\n\n          if (min_1 > timeStamp) {\n            secondMin_1 = min_1;\n            min_1 = timeStamp;\n          } else if (secondMin_1 > timeStamp) {\n            secondMin_1 = timeStamp;\n          }\n\n          if (max_1 < timeStamp) {\n            max_1 = timeStamp;\n          }\n\n          timeStamps_1.push(timeStamp);\n        }); // 存在多个值时，设置最小间距\n\n        if (values.length > 1) {\n          this.minTickInterval = secondMin_1 - min_1;\n        }\n\n        if (isNil(minConfig)) {\n          this.min = min_1;\n        }\n\n        if (isNil(maxConfig)) {\n          this.max = max_1;\n        }\n      }\n    };\n\n    return Time;\n  }(Linear);\n  /**\n   * 分段度量\n   */\n\n\n  var Quantize =\n  /** @class */\n  function (_super) {\n    __extends(Quantize, _super);\n\n    function Quantize() {\n      var _this = _super !== null && _super.apply(this, arguments) || this;\n\n      _this.type = 'quantize';\n      return _this;\n    }\n\n    Quantize.prototype.invert = function (value) {\n      var ticks = this.ticks;\n      var length = ticks.length;\n      var percent = this.getInvertPercent(value);\n      var minIndex = Math.floor(percent * (length - 1)); // 最后一个\n\n      if (minIndex >= length - 1) {\n        return last(ticks);\n      } // 超出左边界， 则取第一个\n\n\n      if (minIndex < 0) {\n        return head(ticks);\n      }\n\n      var minTick = ticks[minIndex];\n      var nextTick = ticks[minIndex + 1]; // 比当前值小的 tick 在度量上的占比\n\n      var minIndexPercent = minIndex / (length - 1);\n      var maxIndexPercent = (minIndex + 1) / (length - 1);\n      return minTick + (percent - minIndexPercent) / (maxIndexPercent - minIndexPercent) * (nextTick - minTick);\n    };\n\n    Quantize.prototype.initCfg = function () {\n      this.tickMethod = 'r-pretty';\n      this.tickCount = 5;\n      this.nice = true;\n    };\n\n    Quantize.prototype.calculateTicks = function () {\n      var ticks = _super.prototype.calculateTicks.call(this);\n\n      if (!this.nice) {\n        // 如果 nice = false ,补充 min, max\n        if (last(ticks) !== this.max) {\n          ticks.push(this.max);\n        }\n\n        if (head(ticks) !== this.min) {\n          ticks.unshift(this.min);\n        }\n      }\n\n      return ticks;\n    }; // 计算当前值在刻度中的占比\n\n\n    Quantize.prototype.getScalePercent = function (value) {\n      var ticks = this.ticks; // 超出左边界\n\n      if (value < head(ticks)) {\n        return 0;\n      } // 超出右边界\n\n\n      if (value > last(ticks)) {\n        return 1;\n      }\n\n      var minIndex = 0;\n      each(ticks, function (tick, index) {\n        if (value >= tick) {\n          minIndex = index;\n        } else {\n          return false;\n        }\n      });\n      return minIndex / (ticks.length - 1);\n    };\n\n    return Quantize;\n  }(Continuous);\n\n  var Quantile =\n  /** @class */\n  function (_super) {\n    __extends(Quantile, _super);\n\n    function Quantile() {\n      var _this = _super !== null && _super.apply(this, arguments) || this;\n\n      _this.type = 'quantile';\n      return _this;\n    }\n\n    Quantile.prototype.initCfg = function () {\n      this.tickMethod = 'quantile';\n      this.tickCount = 5;\n      this.nice = true;\n    };\n\n    return Quantile;\n  }(Quantize);\n\n  var map$1 = {};\n\n  function getClass(key) {\n    return map$1[key];\n  }\n\n  function registerClass(key, cls) {\n    if (getClass(key)) {\n      throw new Error(\"type '\" + key + \"' existed.\");\n    }\n\n    map$1[key] = cls;\n  }\n  /**\n   * identity scale原则上是定义域和值域一致，scale/invert方法也是一致的\n   * 参考R的实现：https://github.com/r-lib/scales/blob/master/R/pal-identity.r\n   * 参考d3的实现（做了下转型）：https://github.com/d3/d3-scale/blob/master/src/identity.js\n   */\n\n\n  var Identity =\n  /** @class */\n  function (_super) {\n    __extends(Identity, _super);\n\n    function Identity() {\n      var _this = _super !== null && _super.apply(this, arguments) || this;\n\n      _this.type = 'identity';\n      _this.isIdentity = true;\n      return _this;\n    }\n\n    Identity.prototype.calculateTicks = function () {\n      return this.values;\n    };\n\n    Identity.prototype.scale = function (value) {\n      // 如果传入的值不等于 identity 的值，则直接返回，用于一维图时的 dodge\n      if (this.values[0] !== value && isNumber(value)) {\n        return value;\n      }\n\n      return this.range[0];\n    };\n\n    Identity.prototype.invert = function (value) {\n      var range = this.range;\n\n      if (value < range[0] || value > range[1]) {\n        return NaN;\n      }\n\n      return this.values[0];\n    };\n\n    return Identity;\n  }(Scale);\n\n  var DEFAULT_Q = [1, 5, 2, 2.5, 4, 3];\n  var eps = Number.EPSILON * 100; // https://stackoverflow.com/questions/4467539/javascript-modulo-gives-a-negative-result-for-negative-numbers\n\n  function mod(n, m) {\n    return (n % m + m) % m;\n  }\n\n  function simplicity(q, Q, j, lmin, lmax, lstep) {\n    var n = size(Q);\n    var i = indexOf(Q, q);\n    var v = 0;\n    var m = mod(lmin, lstep);\n\n    if ((m < eps || lstep - m < eps) && lmin <= 0 && lmax >= 0) {\n      v = 1;\n    }\n\n    return 1 - i / (n - 1) - j + v;\n  }\n\n  function simplicityMax(q, Q, j) {\n    var n = size(Q);\n    var i = indexOf(Q, q);\n    var v = 1;\n    return 1 - i / (n - 1) - j + v;\n  }\n\n  function density(k, m, dmin, dmax, lmin, lmax) {\n    var r = (k - 1) / (lmax - lmin);\n    var rt = (m - 1) / (Math.max(lmax, dmax) - Math.min(dmin, lmin));\n    return 2 - Math.max(r / rt, rt / r);\n  }\n\n  function densityMax(k, m) {\n    if (k >= m) {\n      return 2 - (k - 1) / (m - 1);\n    }\n\n    return 1;\n  }\n\n  function coverage(dmin, dmax, lmin, lmax) {\n    var range = dmax - dmin;\n    return 1 - 0.5 * (Math.pow(dmax - lmax, 2) + Math.pow(dmin - lmin, 2)) / Math.pow(0.1 * range, 2);\n  }\n\n  function coverageMax(dmin, dmax, span) {\n    var range = dmax - dmin;\n\n    if (span > range) {\n      var half = (span - range) / 2;\n      return 1 - Math.pow(half, 2) / Math.pow(0.1 * range, 2);\n    }\n\n    return 1;\n  }\n\n  function legibility() {\n    return 1;\n  }\n  /**\n   * An Extension of Wilkinson's Algorithm for Position Tick Labels on Axes\n   * https://www.yuque.com/preview/yuque/0/2019/pdf/185317/1546999150858-45c3b9c2-4e86-4223-bf1a-8a732e8195ed.pdf\n   * @param dmin 最小值\n   * @param dmax 最大值\n   * @param m tick个数\n   * @param onlyLoose 是否允许扩展min、max，不绝对强制，例如[3, 97]\n   * @param Q nice numbers集合\n   * @param w 四个优化组件的权重\n   */\n\n\n  function extended(dmin, dmax, m, onlyLoose, Q, w) {\n    if (m === void 0) {\n      m = 5;\n    }\n\n    if (onlyLoose === void 0) {\n      onlyLoose = true;\n    }\n\n    if (Q === void 0) {\n      Q = DEFAULT_Q;\n    }\n\n    if (w === void 0) {\n      w = [0.25, 0.2, 0.5, 0.05];\n    } // 异常数据情况下，直接返回，防止 oom\n\n\n    if (typeof dmin !== 'number' || typeof dmax !== 'number') {\n      return {\n        min: 0,\n        max: 0,\n        ticks: []\n      };\n    }\n\n    if (dmin === dmax || m === 1) {\n      return {\n        min: dmin,\n        max: dmax,\n        ticks: [dmin]\n      };\n    }\n\n    var best = {\n      score: -2,\n      lmin: 0,\n      lmax: 0,\n      lstep: 0\n    };\n    var j = 1;\n\n    while (j < Infinity) {\n      for (var _i = 0, Q_1 = Q; _i < Q_1.length; _i++) {\n        var q = Q_1[_i];\n        var sm = simplicityMax(q, Q, j);\n\n        if (Number.isNaN(sm)) {\n          throw new Error('NaN');\n        }\n\n        if (w[0] * sm + w[1] + w[2] + w[3] < best.score) {\n          j = Infinity;\n          break;\n        }\n\n        var k = 2;\n\n        while (k < Infinity) {\n          var dm = densityMax(k, m);\n\n          if (w[0] * sm + w[1] + w[2] * dm + w[3] < best.score) {\n            break;\n          }\n\n          var delta = (dmax - dmin) / (k + 1) / j / q;\n          var z = Math.ceil(Math.log10(delta));\n\n          while (z < Infinity) {\n            var step = j * q * Math.pow(10, z);\n            var cm = coverageMax(dmin, dmax, step * (k - 1));\n\n            if (w[0] * sm + w[1] * cm + w[2] * dm + w[3] < best.score) {\n              break;\n            }\n\n            var minStart = Math.floor(dmax / step) * j - (k - 1) * j;\n            var maxStart = Math.ceil(dmin / step) * j;\n\n            if (minStart > maxStart) {\n              z = z + 1;\n              continue;\n            }\n\n            for (var start = minStart; start <= maxStart; start = start + 1) {\n              var lmin = start * (step / j);\n              var lmax = lmin + step * (k - 1);\n              var lstep = step;\n              var s = simplicity(q, Q, j, lmin, lmax, lstep);\n              var c = coverage(dmin, dmax, lmin, lmax);\n              var g = density(k, m, dmin, dmax, lmin, lmax);\n              var l = legibility();\n              var score = w[0] * s + w[1] * c + w[2] * g + w[3] * l;\n\n              if (score > best.score && (!onlyLoose || lmin <= dmin && lmax >= dmax)) {\n                best.lmin = lmin;\n                best.lmax = lmax;\n                best.lstep = lstep;\n                best.score = score;\n              }\n            }\n\n            z = z + 1;\n          }\n\n          k = k + 1;\n        }\n      }\n\n      j = j + 1;\n    } // 步长为浮点数时处理精度\n\n\n    var toFixed = Number.isInteger(best.lstep) ? 0 : Math.ceil(Math.abs(Math.log10(best.lstep)));\n    var range = [];\n\n    for (var tick = best.lmin; tick <= best.lmax; tick += best.lstep) {\n      range.push(tick);\n    }\n\n    var ticks = toFixed ? map(range, function (x) {\n      return Number.parseFloat(x.toFixed(toFixed));\n    }) : range;\n    return {\n      min: Math.min(dmin, head(ticks)),\n      max: Math.max(dmax, last(ticks)),\n      ticks: ticks\n    };\n  }\n  /**\n   * 计算分类 ticks\n   * @param cfg 度量的配置项\n   * @returns 计算后的 ticks\n   */\n\n\n  function calculateCatTicks(cfg) {\n    var values = cfg.values,\n        tickInterval = cfg.tickInterval,\n        tickCount = cfg.tickCount;\n    var ticks = values;\n\n    if (isNumber(tickInterval)) {\n      return filter(ticks, function (__, i) {\n        return i % tickInterval === 0;\n      });\n    }\n\n    var min = cfg.min,\n        max = cfg.max;\n\n    if (isNil(min)) {\n      min = 0;\n    }\n\n    if (isNil(max)) {\n      max = values.length - 1;\n    }\n\n    if (isNumber(tickCount) && tickCount < max - min) {\n      // 简单过滤，部分情况下小数的倍数也可以是整数\n      // tslint:disable-next-line: no-shadowed-variable\n      var ticks_1 = extended(min, max, tickCount, false, [1, 2, 5, 3, 4, 7, 6, 8, 9]).ticks;\n      var valid = filter(ticks_1, function (tick) {\n        return tick >= min && tick <= max;\n      });\n      return valid.map(function (index) {\n        return values[index];\n      });\n    }\n\n    return values.slice(min, max + 1);\n  }\n\n  function d3Linear(cfg) {\n    var min = cfg.min,\n        max = cfg.max,\n        nice = cfg.nice,\n        tickCount = cfg.tickCount;\n    var linear = new D3Linear();\n    linear.domain([min, max]);\n\n    if (nice) {\n      linear.nice(tickCount);\n    }\n\n    return linear.ticks(tickCount);\n  }\n\n  var DEFAULT_COUNT = 5;\n  var e10 = Math.sqrt(50);\n  var e5 = Math.sqrt(10);\n  var e2 = Math.sqrt(2); // https://github.com/d3/d3-scale\n\n  var D3Linear =\n  /** @class */\n  function () {\n    function D3Linear() {\n      this._domain = [0, 1];\n    }\n\n    D3Linear.prototype.domain = function (domain) {\n      if (domain) {\n        this._domain = Array.from(domain, Number);\n        return this;\n      }\n\n      return this._domain.slice();\n    };\n\n    D3Linear.prototype.nice = function (count) {\n      var _a, _b;\n\n      if (count === void 0) {\n        count = DEFAULT_COUNT;\n      }\n\n      var d = this._domain.slice();\n\n      var i0 = 0;\n      var i1 = this._domain.length - 1;\n      var start = this._domain[i0];\n      var stop = this._domain[i1];\n      var step;\n\n      if (stop < start) {\n        _a = [stop, start], start = _a[0], stop = _a[1];\n        _b = [i1, i0], i0 = _b[0], i1 = _b[1];\n      }\n\n      step = tickIncrement(start, stop, count);\n\n      if (step > 0) {\n        start = Math.floor(start / step) * step;\n        stop = Math.ceil(stop / step) * step;\n        step = tickIncrement(start, stop, count);\n      } else if (step < 0) {\n        start = Math.ceil(start * step) / step;\n        stop = Math.floor(stop * step) / step;\n        step = tickIncrement(start, stop, count);\n      }\n\n      if (step > 0) {\n        d[i0] = Math.floor(start / step) * step;\n        d[i1] = Math.ceil(stop / step) * step;\n        this.domain(d);\n      } else if (step < 0) {\n        d[i0] = Math.ceil(start * step) / step;\n        d[i1] = Math.floor(stop * step) / step;\n        this.domain(d);\n      }\n\n      return this;\n    };\n\n    D3Linear.prototype.ticks = function (count) {\n      if (count === void 0) {\n        count = DEFAULT_COUNT;\n      }\n\n      return d3ArrayTicks(this._domain[0], this._domain[this._domain.length - 1], count || DEFAULT_COUNT);\n    };\n\n    return D3Linear;\n  }();\n\n  function d3ArrayTicks(start, stop, count) {\n    var reverse;\n    var i = -1;\n    var n;\n    var ticks;\n    var step;\n    stop = +stop, start = +start, count = +count;\n\n    if (start === stop && count > 0) {\n      return [start];\n    } // tslint:disable-next-line\n\n\n    if (reverse = stop < start) {\n      n = start, start = stop, stop = n;\n    } // tslint:disable-next-line\n\n\n    if ((step = tickIncrement(start, stop, count)) === 0 || !isFinite(step)) {\n      return [];\n    }\n\n    if (step > 0) {\n      start = Math.ceil(start / step);\n      stop = Math.floor(stop / step);\n      ticks = new Array(n = Math.ceil(stop - start + 1));\n\n      while (++i < n) {\n        ticks[i] = (start + i) * step;\n      }\n    } else {\n      start = Math.floor(start * step);\n      stop = Math.ceil(stop * step);\n      ticks = new Array(n = Math.ceil(start - stop + 1));\n\n      while (++i < n) {\n        ticks[i] = (start - i) / step;\n      }\n    }\n\n    if (reverse) {\n      ticks.reverse();\n    }\n\n    return ticks;\n  }\n\n  function tickIncrement(start, stop, count) {\n    var step = (stop - start) / Math.max(0, count);\n    var power = Math.floor(Math.log(step) / Math.LN10);\n    var error = step / Math.pow(10, power);\n    return power >= 0 ? (error >= e10 ? 10 : error >= e5 ? 5 : error >= e2 ? 2 : 1) * Math.pow(10, power) : -Math.pow(10, -power) / (error >= e10 ? 10 : error >= e5 ? 5 : error >= e2 ? 2 : 1);\n  }\n\n  function snapMultiple(v, base, snapType) {\n    var div;\n\n    if (snapType === 'ceil') {\n      div = Math.ceil(v / base);\n    } else if (snapType === 'floor') {\n      div = Math.floor(v / base);\n    } else {\n      div = Math.round(v / base);\n    }\n\n    return div * base;\n  }\n\n  function intervalTicks(min, max, interval) {\n    // 变成 interval 的倍数\n    var minTick = snapMultiple(min, interval, 'floor');\n    var maxTick = snapMultiple(max, interval, 'ceil'); // 统一小数位数\n\n    minTick = fixedBase(minTick, interval);\n    maxTick = fixedBase(maxTick, interval);\n    var ticks = [];\n\n    for (var i = minTick; i <= maxTick; i = i + interval) {\n      var tickValue = fixedBase(i, interval); // 防止浮点数加法出现问题\n\n      ticks.push(tickValue);\n    }\n\n    return {\n      min: minTick,\n      max: maxTick,\n      ticks: ticks\n    };\n  }\n  /**\n   * 按照给定的 minLimit/maxLimit/tickCount 均匀计算出刻度 ticks\n   *\n   * @param cfg Scale 配置项\n   * @return ticks\n   */\n\n\n  function strictLimit(cfg, defaultMin, defaultMax) {\n    var _a;\n\n    var minLimit = cfg.minLimit,\n        maxLimit = cfg.maxLimit,\n        min = cfg.min,\n        max = cfg.max,\n        _b = cfg.tickCount,\n        tickCount = _b === void 0 ? 5 : _b;\n    var tickMin = isNil(minLimit) ? isNil(defaultMin) ? min : defaultMin : minLimit;\n    var tickMax = isNil(maxLimit) ? isNil(defaultMax) ? max : defaultMax : maxLimit;\n\n    if (tickMin > tickMax) {\n      _a = [tickMin, tickMax], tickMax = _a[0], tickMin = _a[1];\n    }\n\n    if (tickCount <= 2) {\n      return [tickMin, tickMax];\n    }\n\n    var step = (tickMax - tickMin) / (tickCount - 1);\n    var ticks = [];\n\n    for (var i = 0; i < tickCount; i++) {\n      ticks.push(tickMin + step * i);\n    }\n\n    return ticks;\n  }\n\n  function d3LinearTickMethod(cfg) {\n    var min = cfg.min,\n        max = cfg.max,\n        tickInterval = cfg.tickInterval,\n        minLimit = cfg.minLimit,\n        maxLimit = cfg.maxLimit;\n    var ticks = d3Linear(cfg);\n\n    if (!isNil(minLimit) || !isNil(maxLimit)) {\n      return strictLimit(cfg, head(ticks), last(ticks));\n    }\n\n    if (tickInterval) {\n      return intervalTicks(min, max, tickInterval).ticks;\n    }\n\n    return ticks;\n  }\n  /**\n   * 计算线性的 ticks，使用 wilkinson extended 方法\n   * @param cfg 度量的配置项\n   * @returns 计算后的 ticks\n   */\n\n\n  function linear(cfg) {\n    var min = cfg.min,\n        max = cfg.max,\n        tickCount = cfg.tickCount,\n        nice = cfg.nice,\n        tickInterval = cfg.tickInterval,\n        minLimit = cfg.minLimit,\n        maxLimit = cfg.maxLimit;\n    var ticks = extended(min, max, tickCount, nice).ticks;\n\n    if (!isNil(minLimit) || !isNil(maxLimit)) {\n      return strictLimit(cfg, head(ticks), last(ticks));\n    }\n\n    if (tickInterval) {\n      return intervalTicks(min, max, tickInterval).ticks;\n    }\n\n    return ticks;\n  }\n  /**\n   * 计算 log 的 ticks，考虑 min = 0 的场景\n   * @param cfg 度量的配置项\n   * @returns 计算后的 ticks\n   */\n\n\n  function calculateLogTicks(cfg) {\n    var base = cfg.base,\n        tickCount = cfg.tickCount,\n        min = cfg.min,\n        max = cfg.max,\n        values = cfg.values;\n    var minTick;\n    var maxTick = log(base, max);\n\n    if (min > 0) {\n      minTick = Math.floor(log(base, min));\n    } else {\n      var positiveMin = getLogPositiveMin(values, base, max);\n      minTick = Math.floor(log(base, positiveMin));\n    }\n\n    var count = maxTick - minTick;\n    var avg = Math.ceil(count / tickCount);\n    var ticks = [];\n\n    for (var i = minTick; i < maxTick + avg; i = i + avg) {\n      ticks.push(Math.pow(base, i));\n    }\n\n    if (min <= 0) {\n      // 最小值 <= 0 时显示 0\n      ticks.unshift(0);\n    }\n\n    return ticks;\n  }\n\n  function pretty(min, max, n) {\n    if (n === void 0) {\n      n = 5;\n    }\n\n    var res = {\n      max: 0,\n      min: 0,\n      ticks: []\n    };\n\n    if (min === max) {\n      return {\n        max: max,\n        min: min,\n        ticks: [min]\n      };\n    }\n    /*\n      R pretty:\n      https://svn.r-project.org/R/trunk/src/appl/pretty.c\n      https://www.rdocumentation.org/packages/base/versions/3.5.2/topics/pretty\n      */\n\n\n    var h = 1.5; // high.u.bias\n\n    var h5 = 0.5 + 1.5 * h; // u5.bias\n    // 反正我也不会调参，跳过所有判断步骤\n\n    var d = max - min;\n    var c = d / n; // 当d非常小的时候触发，但似乎没什么用\n    // const min_n = Math.floor(n / 3);\n    // const shrink_sml = Math.pow(2, 5);\n    // if (Math.log10(d) < -2) {\n    //   c = (_.max([ Math.abs(max), Math.abs(min) ]) * shrink_sml) / min_n;\n    // }\n\n    var base = Math.pow(10, Math.floor(Math.log10(c)));\n    var toFixed = base < 1 ? Math.ceil(Math.abs(Math.log10(base))) : 0;\n    var unit = base;\n\n    if (2 * base - c < h * (c - unit)) {\n      unit = 2 * base;\n\n      if (5 * base - c < h5 * (c - unit)) {\n        unit = 5 * base;\n\n        if (10 * base - c < h * (c - unit)) {\n          unit = 10 * base;\n        }\n      }\n    }\n\n    var nu = Math.ceil(max / unit);\n    var ns = Math.floor(min / unit);\n    res.max = Math.max(nu * unit, max);\n    res.min = Math.min(ns * unit, min);\n    var x = Number.parseFloat((ns * unit).toFixed(toFixed));\n\n    while (x < max) {\n      res.ticks.push(x);\n      x += unit;\n\n      if (toFixed) {\n        x = Number.parseFloat(x.toFixed(toFixed));\n      }\n    }\n\n    res.ticks.push(x);\n    return res;\n  }\n  /**\n   * 计算 Pow 的 ticks\n   * @param cfg 度量的配置项\n   * @returns 计算后的 ticks\n   */\n\n\n  function calculatePowTicks(cfg) {\n    var exponent = cfg.exponent,\n        tickCount = cfg.tickCount;\n    var max = Math.ceil(calBase(exponent, cfg.max));\n    var min = Math.floor(calBase(exponent, cfg.min));\n    var ticks = pretty(min, max, tickCount).ticks;\n    return ticks.map(function (tick) {\n      var factor = tick >= 0 ? 1 : -1;\n      return Math.pow(tick, exponent) * factor;\n    });\n  }\n  /**\n   * 计算几分位 https://github.com/simple-statistics/simple-statistics/blob/master/src/quantile_sorted.js\n   * @param x  数组\n   * @param p  百分比\n   */\n\n\n  function quantileSorted(x, p) {\n    var idx = x.length * p;\n    /*if (x.length === 0) { // 当前场景这些条件不可能命中\n      throw new Error('quantile requires at least one value.');\n    } else if (p < 0 || p > 1) {\n      throw new Error('quantiles must be between 0 and 1');\n    } else */\n\n    if (p === 1) {\n      // If p is 1, directly return the last element\n      return x[x.length - 1];\n    } else if (p === 0) {\n      // If p is 0, directly return the first element\n      return x[0];\n    } else if (idx % 1 !== 0) {\n      // If p is not integer, return the next element in array\n      return x[Math.ceil(idx) - 1];\n    } else if (x.length % 2 === 0) {\n      // If the list has even-length, we'll take the average of this number\n      // and the next value, if there is one\n      return (x[idx - 1] + x[idx]) / 2;\n    } else {\n      // Finally, in the simple case of an integer value\n      // with an odd-length list, return the x value at the index.\n      return x[idx];\n    }\n  }\n\n  function calculateTicks(cfg) {\n    var tickCount = cfg.tickCount,\n        values = cfg.values;\n\n    if (!values || !values.length) {\n      return [];\n    }\n\n    var sorted = values.slice().sort(function (a, b) {\n      return a - b;\n    });\n    var ticks = [];\n\n    for (var i = 0; i < tickCount; i++) {\n      var p = i / (tickCount - 1);\n      ticks.push(quantileSorted(sorted, p));\n    }\n\n    return ticks;\n  }\n  /**\n   * 计算线性的 ticks，使用 R's pretty 方法\n   * @param cfg 度量的配置项\n   * @returns 计算后的 ticks\n   */\n\n\n  function linearPretty(cfg) {\n    var min = cfg.min,\n        max = cfg.max,\n        tickCount = cfg.tickCount,\n        tickInterval = cfg.tickInterval,\n        minLimit = cfg.minLimit,\n        maxLimit = cfg.maxLimit;\n    var ticks = pretty(min, max, tickCount).ticks;\n\n    if (!isNil(minLimit) || !isNil(maxLimit)) {\n      return strictLimit(cfg, head(ticks), last(ticks));\n    }\n\n    if (tickInterval) {\n      return intervalTicks(min, max, tickInterval).ticks;\n    }\n\n    return ticks;\n  }\n\n  function calculateTimeTicks(cfg) {\n    var min = cfg.min,\n        max = cfg.max,\n        minTickInterval = cfg.minTickInterval;\n    var tickInterval = cfg.tickInterval;\n    var tickCount = cfg.tickCount; // 指定 tickInterval 后 tickCount 不生效，需要重新计算\n\n    if (tickInterval) {\n      tickCount = Math.ceil((max - min) / tickInterval);\n    } else {\n      tickInterval = getTickInterval(min, max, tickCount)[1];\n      var count = (max - min) / tickInterval;\n      var ratio = count / tickCount;\n\n      if (ratio > 1) {\n        tickInterval = tickInterval * Math.ceil(ratio);\n      } // 如果设置了最小间距，则使用最小间距\n\n\n      if (minTickInterval && tickInterval < minTickInterval) {\n        tickInterval = minTickInterval;\n      }\n    }\n\n    var ticks = [];\n\n    for (var i = min; i < max + tickInterval; i += tickInterval) {\n      ticks.push(i);\n    }\n\n    return ticks;\n  }\n  /**\n   * 计算时间分类的 ticks, 保头，保尾\n   * @param cfg 度量的配置项\n   * @returns 计算后的 ticks\n   */\n\n\n  function calculateTimeCatTicks(cfg) {\n    var ticks = calculateCatTicks(cfg);\n    var lastValue = last(cfg.values);\n\n    if (lastValue !== last(ticks)) {\n      ticks.push(lastValue);\n    }\n\n    return ticks;\n  }\n\n  function getYear(date) {\n    return new Date(date).getFullYear();\n  }\n\n  function createYear(year) {\n    return new Date(year, 0, 1).getTime();\n  }\n\n  function getMonth(date) {\n    return new Date(date).getMonth();\n  }\n\n  function diffMonth(min, max) {\n    var minYear = getYear(min);\n    var maxYear = getYear(max);\n    var minMonth = getMonth(min);\n    var maxMonth = getMonth(max);\n    return (maxYear - minYear) * 12 + (maxMonth - minMonth) % 12;\n  }\n\n  function creatMonth(year, month) {\n    return new Date(year, month, 1).getTime();\n  }\n\n  function diffDay(min, max) {\n    return Math.ceil((max - min) / DAY);\n  }\n\n  function diffHour(min, max) {\n    return Math.ceil((max - min) / HOUR);\n  }\n\n  function diffMinus(min, max) {\n    return Math.ceil((max - min) / (60 * 1000));\n  }\n  /**\n   * 计算 time 的 ticks，对 month, year 进行 pretty 处理\n   * @param cfg 度量的配置项\n   * @returns 计算后的 ticks\n   */\n\n\n  function timePretty(cfg) {\n    var min = cfg.min,\n        max = cfg.max,\n        minTickInterval = cfg.minTickInterval,\n        tickCount = cfg.tickCount;\n    var tickInterval = cfg.tickInterval;\n    var ticks = []; // 指定 tickInterval 后 tickCount 不生效，需要重新计算\n\n    if (!tickInterval) {\n      tickInterval = (max - min) / tickCount; // 如果设置了最小间距，则使用最小间距\n\n      if (minTickInterval && tickInterval < minTickInterval) {\n        tickInterval = minTickInterval;\n      }\n    }\n\n    var minYear = getYear(min); // 如果间距大于 1 年，则将开始日期从整年开始\n\n    if (tickInterval > YEAR) {\n      var maxYear = getYear(max);\n      var yearInterval = Math.ceil(tickInterval / YEAR);\n\n      for (var i = minYear; i <= maxYear + yearInterval; i = i + yearInterval) {\n        ticks.push(createYear(i));\n      }\n    } else if (tickInterval > MONTH) {\n      // 大于月时\n      var monthInterval = Math.ceil(tickInterval / MONTH);\n      var mmMoth = getMonth(min);\n      var dMonths = diffMonth(min, max);\n\n      for (var i = 0; i <= dMonths + monthInterval; i = i + monthInterval) {\n        ticks.push(creatMonth(minYear, i + mmMoth));\n      }\n    } else if (tickInterval > DAY) {\n      // 大于天\n      var date = new Date(min);\n      var year = date.getFullYear();\n      var month = date.getMonth();\n      var mday = date.getDate();\n      var day = Math.ceil(tickInterval / DAY);\n      var ddays = diffDay(min, max);\n\n      for (var i = 0; i < ddays + day; i = i + day) {\n        ticks.push(new Date(year, month, mday + i).getTime());\n      }\n    } else if (tickInterval > HOUR) {\n      // 大于小时\n      var date = new Date(min);\n      var year = date.getFullYear();\n      var month = date.getMonth();\n      var day = date.getDate();\n      var hour = date.getHours();\n      var hours = Math.ceil(tickInterval / HOUR);\n      var dHours = diffHour(min, max);\n\n      for (var i = 0; i <= dHours + hours; i = i + hours) {\n        ticks.push(new Date(year, month, day, hour + i).getTime());\n      }\n    } else if (tickInterval > MINUTE) {\n      // 大于分钟\n      var dMinus = diffMinus(min, max);\n      var minutes = Math.ceil(tickInterval / MINUTE);\n\n      for (var i = 0; i <= dMinus + minutes; i = i + minutes) {\n        ticks.push(min + i * MINUTE);\n      }\n    } else {\n      // 小于分钟\n      var interval = tickInterval;\n\n      if (interval < SECOND) {\n        interval = SECOND;\n      }\n\n      var minSecond = Math.floor(min / SECOND) * SECOND;\n      var dSeconds = Math.ceil((max - min) / SECOND);\n      var seconds = Math.ceil(interval / SECOND);\n\n      for (var i = 0; i < dSeconds + seconds; i = i + seconds) {\n        ticks.push(minSecond + i * SECOND);\n      }\n    } // 最好是能从算法能解决这个问题，但是如果指定了 tickInterval，计算 ticks，也只能这么算，所以\n    // 打印警告提示\n\n\n    if (ticks.length >= 512) {\n      console.warn(\"Notice: current ticks length(\" + ticks.length + \") >= 512, may cause performance issues, even out of memory. Because of the configure \\\"tickInterval\\\"(in milliseconds, current is \" + tickInterval + \") is too small, increase the value to solve the problem!\");\n    }\n\n    return ticks;\n  }\n\n  registerTickMethod('cat', calculateCatTicks);\n  registerTickMethod('time-cat', calculateTimeCatTicks);\n  registerTickMethod('wilkinson-extended', linear);\n  registerTickMethod('r-pretty', linearPretty);\n  registerTickMethod('time', calculateTimeTicks);\n  registerTickMethod('time-pretty', timePretty);\n  registerTickMethod('log', calculateLogTicks);\n  registerTickMethod('pow', calculatePowTicks);\n  registerTickMethod('quantile', calculateTicks);\n  registerTickMethod('d3-linear', d3LinearTickMethod);\n  registerClass('cat', Category);\n  registerClass('category', Category);\n  registerClass('identity', Identity);\n  registerClass('linear', Linear);\n  registerClass('log', Log);\n  registerClass('pow', Pow);\n  registerClass('time', Time);\n  registerClass('timeCat', TimeCat);\n  registerClass('quantize', Quantize);\n  registerClass('quantile', Quantile); // cat平均算法，保头保尾\n\n  var CatTick = function (cfg) {\n    var values = cfg.values,\n        tickCount = cfg.tickCount;\n\n    if (!tickCount) {\n      return values;\n    }\n\n    if (values.length <= 1) {\n      return values;\n    } // 获取间隔步长, 最小是1\n\n\n    var step = parseInt(values.length / (tickCount - 1)) || 1;\n    var ticks = []; // 按间隔数取对应节点\n\n    for (var index = 0; index < values.length; index = index + step) {\n      ticks.push(values[index]);\n    }\n\n    var last = values[values.length - 1]; // 如果最后一个tick不等于原数据的最后一个\n\n    if (ticks[ticks.length - 1] !== last) {\n      if (ticks.length >= tickCount) {\n        // 如果当前的tick个数满足要求\n        ticks[ticks.length - 1] = last;\n      } else {\n        // 不满足tickCount则直接加入最后一个\n        ticks.push(last);\n      }\n    }\n\n    return ticks;\n  }; // 认为是nice的刻度\n\n\n  var SNAP_COUNT_ARRAY = [1, 1.2, 1.5, 2, 2.2, 2.4, 2.5, 3, 4, 5, 6, 7.5, 8, 10];\n  var DEFAULT_COUNT$1 = 5; // 默认刻度值\n\n  var LinearTick = function (cfg) {\n    var _ref = cfg || {},\n        tickCount = _ref.tickCount,\n        tickInterval = _ref.tickInterval;\n\n    var _ref2 = cfg || {},\n        min = _ref2.min,\n        max = _ref2.max;\n\n    min = isNaN(min) ? 0 : min;\n    max = isNaN(max) ? 0 : max;\n    var count = tickCount && tickCount >= 2 ? tickCount : DEFAULT_COUNT$1; // 计算interval， 优先取tickInterval\n\n    var interval = tickInterval || getBestInterval({\n      tickCount: count,\n      max: max,\n      min: min\n    }); // 通过interval计算最小tick\n\n    var minTick = Math.floor(min / interval) * interval; // 如果指定了tickInterval, count 需要根据指定的tickInterval来算计\n\n    if (tickInterval) {\n      var intervalCount = Math.abs(Math.ceil((max - minTick) / tickInterval)) + 1; // tickCount 作为最小 count 处理\n\n      count = Math.max(count, intervalCount);\n    }\n\n    var ticks = [];\n    var tickLength = 0;\n    var fixedLength = getFixedLength(interval);\n\n    while (tickLength < count) {\n      ticks.push(toFixed(minTick + tickLength * interval, fixedLength));\n      tickLength++;\n    }\n\n    return ticks;\n  };\n\n  var DECIMAL_LENGTH = 12;\n\n  function getFactor(number) {\n    // 取正数\n    number = Math.abs(number);\n    var factor = 1;\n\n    if (number === 0) {\n      return factor;\n    } // 小于1,逐渐放大\n\n\n    if (number < 1) {\n      var count = 0;\n\n      while (number < 1) {\n        factor = factor / 10;\n        number = number * 10;\n        count++;\n      } // 浮点数计算出现问题\n\n\n      if (factor.toString().length > DECIMAL_LENGTH) {\n        factor = parseFloat(factor.toFixed(count));\n      }\n\n      return factor;\n    } // 大于10逐渐缩小\n\n\n    while (number > 10) {\n      factor = factor * 10;\n      number = number / 10;\n    }\n\n    return factor;\n  } // 获取最佳匹配刻度\n\n\n  function getBestInterval(_ref3) {\n    var tickCount = _ref3.tickCount,\n        min = _ref3.min,\n        max = _ref3.max; // 如果最大最小相等，则直接按1处理\n\n    if (min === max) {\n      return 1 * getFactor(max);\n    } // 1.计算平均刻度\b间隔\n\n\n    var avgInterval = (max - min) / (tickCount - 1); // 2.数据标准归一化 映射到[1-10]区间\n\n    var factor = getFactor(avgInterval);\n    var calInterval = avgInterval / factor;\n    var calMax = max / factor;\n    var calMin = min / factor; // 根据平均值推算最逼近刻度值\n\n    var similarityIndex = 0;\n\n    for (var index = 0; index < SNAP_COUNT_ARRAY.length; index++) {\n      var item = SNAP_COUNT_ARRAY[index];\n\n      if (calInterval <= item) {\n        similarityIndex = index;\n        break;\n      }\n    }\n\n    var similarityInterval = getInterval(similarityIndex, tickCount, calMin, calMax); // 小数点位数还原到数据的位数, 因为similarityIndex有可能是小数，所以需要保留similarityIndex自己的小数位数\n\n    var fixedLength = getFixedLength(similarityInterval) + getFixedLength(factor);\n    return toFixed(similarityInterval * factor, fixedLength);\n  }\n\n  function getInterval(startIndex, tickCount, min, max) {\n    var verify = false;\n    var interval = SNAP_COUNT_ARRAY[startIndex]; // 刻度值校验，如果不满足，循环下去\n\n    for (var i = startIndex; i < SNAP_COUNT_ARRAY.length; i++) {\n      if (intervalIsVerify({\n        interval: SNAP_COUNT_ARRAY[i],\n        tickCount: tickCount,\n        max: max,\n        min: min\n      })) {\n        // 有符合条件的interval\n        interval = SNAP_COUNT_ARRAY[i];\n        verify = true;\n        break;\n      }\n    } // 如果不满足, 依次缩小10倍，再计算\n\n\n    if (!verify) {\n      return 10 * getInterval(0, tickCount, min / 10, max / 10);\n    }\n\n    return interval;\n  } // 刻度是否满足展示需求\n\n\n  function intervalIsVerify(_ref4) {\n    var interval = _ref4.interval,\n        tickCount = _ref4.tickCount,\n        max = _ref4.max,\n        min = _ref4.min;\n    var minTick = Math.floor(min / interval) * interval;\n\n    if (minTick + (tickCount - 1) * interval >= max) {\n      return true;\n    }\n\n    return false;\n  } // 计算小数点应该保留的位数\n\n\n  function getFixedLength(num) {\n    var str = num.toString();\n    var index = str.indexOf('.');\n    var indexOfExp = str.indexOf('e-');\n    var length = indexOfExp >= 0 ? parseInt(str.substr(indexOfExp + 2), 10) : str.substr(index + 1).length;\n\n    if (length > 20) {\n      // 最多保留20位小数\n      length = 20;\n    }\n\n    return length;\n  } // @antv/util fixedbase不支持科学计数法的判断，需要提mr\n\n\n  function toFixed(v, length) {\n    return parseFloat(v.toFixed(length));\n  }\n\n  var Linear$1 = getClass('linear');\n  var Identity$1 = getClass('identity');\n  var Category$1 = getClass('category');\n  var TimeCat$1 = getClass('timeCat'); // 覆盖0.3.x的 cat 方法\n\n  registerTickMethod('cat', CatTick);\n  registerTickMethod('time-cat', CatTick); // 覆盖linear 度量的tick算法\n\n  registerTickMethod('wilkinson-extended', LinearTick);\n  Scale.Linear = Linear$1;\n  Scale.Identity = Identity$1;\n  Scale.Category = Category$1;\n  Scale.Cat = Category$1;\n  Scale.TimeCat = TimeCat$1;\n\n  function isFullCircle(coord) {\n    if (!coord.isPolar) {\n      return false;\n    }\n\n    var startAngle = coord.startAngle;\n    var endAngle = coord.endAngle;\n\n    if (!isNil(startAngle) && !isNil(endAngle) && endAngle - startAngle < Math.PI * 2) {\n      return false;\n    }\n\n    return true;\n  }\n\n  function clearObj(obj) {\n    Object.keys(obj).forEach(function (key) {\n      delete obj[key];\n    });\n  }\n\n  var ScaleController = /*#__PURE__*/function () {\n    function ScaleController(cfg) {\n      // defs 列定义\n      this.defs = {}; // 已经实例化的scale\n\n      this.scales = {};\n      mix(this, cfg);\n    }\n\n    var _proto = ScaleController.prototype;\n\n    _proto.setFieldDef = function setFieldDef(field, cfg) {\n      var defs = this.defs;\n\n      if (isObject(field)) {\n        mix(defs, field);\n      } else {\n        defs[field] = cfg;\n      } // 因为可能同时变更多个scale，所以要把所有已实例化的scale都更新下\n\n\n      this.updateScales();\n    };\n\n    _proto._getDef = function _getDef(field) {\n      var defs = this.defs;\n      var def = null;\n\n      if (Global.scales[field] || defs[field]) {\n        def = mix({}, Global.scales[field]);\n        each(defs[field], function (v, k) {\n          if (isNil(v)) {\n            delete def[k];\n          } else {\n            def[k] = v;\n          }\n        });\n      }\n\n      return def;\n    };\n\n    _proto._getDefaultType = function _getDefaultType(field, data, def) {\n      if (def && def.type) {\n        return def.type;\n      }\n\n      var type = 'linear';\n      var value = firstValue(data, field);\n\n      if (isArray(value)) {\n        value = value[0];\n      }\n\n      if (isString(value)) {\n        type = 'cat';\n      }\n\n      return type;\n    };\n\n    _proto._getScaleDef = function _getScaleDef(type, field, data, def) {\n      var values$1;\n\n      if (def && def.values) {\n        values$1 = def.values;\n      } else {\n        values$1 = values(data, field);\n      }\n\n      var cfg = {\n        field: field,\n        values: values$1\n      };\n\n      if (type !== 'cat' && type !== 'timeCat') {\n        if (!def || !(def.min && def.max)) {\n          var _Array$getRange = getRange$1(values$1),\n              min = _Array$getRange.min,\n              max = _Array$getRange.max;\n\n          cfg.min = min;\n          cfg.max = max;\n          cfg.nice = true;\n        }\n      } else {\n        cfg.isRounding = false; // used for tickCount calculation\n      }\n\n      return cfg;\n    } // 调整range，为了让图形居中\n    ;\n\n    _proto._adjustRange = function _adjustRange(type, cfg) {\n      var range = cfg.range,\n          values = cfg.values; // 如果是线性, 或者有自定义range都不处理\n\n      if (type === 'linear' || range || !values) {\n        return cfg;\n      }\n\n      var count = values.length; // 单只有一条数据时，在中间显示\n\n      if (count === 1) {\n        cfg.range = [0.5, 1];\n      } else {\n        var chart = this.chart;\n        var coord = chart.get('coord');\n        var widthRatio = Global.widthRatio.multiplePie;\n        var offset = 0;\n\n        if (isFullCircle(coord)) {\n          if (!coord.transposed) {\n            cfg.range = [0, 1 - 1 / count];\n          } else {\n            offset = 1 / count * widthRatio;\n            cfg.range = [offset / 2, 1 - offset / 2];\n          }\n        } else {\n          // 为了让图形居中，所以才设置range\n          offset = 1 / count * 0.5; // 这里可能用0.25会更合理\n\n          cfg.range = [offset, 1 - offset];\n        }\n      }\n\n      return cfg;\n    };\n\n    _proto._getScaleCfg = function _getScaleCfg(field, data) {\n      var self = this;\n\n      var def = self._getDef(field);\n\n      if (!data || !data.length) {\n        if (def && def.type) {\n          def.field = field;\n          return {\n            type: def.type,\n            cfg: def\n          };\n        }\n\n        return {\n          type: 'identity',\n          cfg: {\n            value: field,\n            field: field.toString(),\n            values: [field]\n          }\n        };\n      }\n\n      var firstObj = data[0];\n      var firstValue$1 = firstObj[field];\n\n      if (firstValue$1 === null) {\n        firstValue$1 = firstValue(data, field);\n      }\n\n      if (isNumber(field) || isNil(firstValue$1) && !def) {\n        return {\n          type: 'identity',\n          cfg: {\n            value: field,\n            field: field.toString(),\n            values: [field]\n          }\n        };\n      }\n\n      var type = self._getDefaultType(field, data, def);\n\n      var cfg = self._getScaleDef(type, field, data, def);\n\n      def && mix(cfg, def);\n      cfg = this._adjustRange(type, cfg);\n      return {\n        type: type,\n        cfg: cfg\n      };\n    };\n\n    _proto.createScale = function createScale(field, data) {\n      var scales = this.scales;\n\n      var _this$_getScaleCfg = this._getScaleCfg(field, data),\n          type = _this$_getScaleCfg.type,\n          cfg = _this$_getScaleCfg.cfg;\n\n      var scale = scales[field]; // 如果已经存在，且类型相等时直接返回\n\n      if (scale && scale.type === type) {\n        scale.change(cfg);\n        return scale;\n      }\n\n      var Scale = getClass(type);\n      var newScale = new Scale(cfg);\n      scales[field] = newScale;\n      return newScale;\n    };\n\n    _proto._updateScale = function _updateScale(scale) {\n      var field = scale.field; // 因为每个field的数据都会不同\n\n      var data = this.chart._getScaleData(field);\n\n      var _this$_getScaleCfg2 = this._getScaleCfg(field, data),\n          cfg = _this$_getScaleCfg2.cfg;\n\n      scale.change(cfg);\n    };\n\n    _proto.updateScales = function updateScales() {\n      var _this = this;\n\n      var scales = this.scales; // 修改完列定义后，需要更新已经实例化的scale\n      // 如果是还没有实例化的，在geom初始化的时候会被实例化，所以这里可以不用更新\n\n      each(scales, function (scale) {\n        _this._updateScale(scale);\n      });\n    } // 调整scale从0开始\n    ;\n\n    _proto.adjustStartZero = function adjustStartZero(scale) {\n      var defs = this.defs;\n      var field = scale.field,\n          min = scale.min,\n          max = scale.max; // 如果有定义，则不处理\n\n      if (defs[field] && defs[field].min) {\n        return;\n      }\n\n      if (min > 0) {\n        scale.change({\n          min: 0\n        });\n      } else if (max < 0) {\n        scale.change({\n          max: 0\n        });\n      }\n    };\n\n    _proto.clear = function clear() {\n      // this.defs = {};\n      // this.scales = {};\n      clearObj(this.defs);\n      clearObj(this.scales);\n      this.data = null;\n    };\n\n    return ScaleController;\n  }();\n\n  var Abastract = /*#__PURE__*/function () {\n    var _proto = Abastract.prototype;\n\n    _proto._initDefaultCfg = function _initDefaultCfg() {\n      /**\n       * ticks\n       * @type {Array}\n       */\n      this.ticks = [];\n      /**\n       * the configuration for tickLine\n       * @type {Object}\n       */\n\n      this.tickLine = {};\n      /**\n       * the direction of ticks, 1 means clockwise\n       * @type {Number}\n       */\n\n      this.offsetFactor = 1;\n      /**\n       * the top container\n       * @type {container}\n       */\n\n      this.frontContainer = null;\n      /**\n       * the back container\n       * @type {[type]}\n       */\n\n      this.backContainer = null;\n      /**\n       * points for draw grid line\n       * @type {Array}\n       */\n\n      this.gridPoints = [];\n    };\n\n    function Abastract(cfg) {\n      this._initDefaultCfg();\n\n      mix(this, cfg);\n      this.draw();\n    }\n\n    _proto.draw = function draw() {\n      var line = this.line,\n          tickLine = this.tickLine,\n          label = this.label,\n          grid = this.grid;\n      grid && this.drawGrid(grid); // draw the grid lines\n\n      tickLine && this.drawTicks(tickLine); // draw the tickLine\n\n      line && this.drawLine(line); // draw axis line\n\n      label && this.drawLabels(); // draw ticks\n    };\n\n    _proto.drawTicks = function drawTicks(tickCfg) {\n      var self = this;\n      var ticks = self.ticks;\n      var length = tickCfg.length;\n      var container = self.getContainer(tickCfg.top);\n      each(ticks, function (tick) {\n        var start = self.getOffsetPoint(tick.value);\n        var end = self.getSidePoint(start, length);\n        var shape = container.addShape('line', {\n          className: 'axis-tick',\n          attrs: mix({\n            x1: start.x,\n            y1: start.y,\n            x2: end.x,\n            y2: end.y\n          }, tickCfg)\n        });\n        shape._id = self._id + '-ticks';\n      });\n    };\n\n    _proto.drawLabels = function drawLabels() {\n      var self = this;\n      var labelOffset = self.labelOffset;\n      var labels = self.labels;\n      each(labels, function (labelShape) {\n        var container = self.getContainer(labelShape.get('top'));\n        var start = self.getOffsetPoint(labelShape.get('value'));\n\n        var _self$getSidePoint = self.getSidePoint(start, labelOffset),\n            x = _self$getSidePoint.x,\n            y = _self$getSidePoint.y;\n\n        labelShape.attr(mix({\n          x: x,\n          y: y\n        }, self.getTextAlignInfo(start, labelOffset), labelShape.get('textStyle')));\n        labelShape._id = self._id + '-' + labelShape.attr('text');\n        container.add(labelShape);\n      });\n    };\n\n    _proto.drawLine = function drawLine() {};\n\n    _proto.drawGrid = function drawGrid(grid) {\n      var self = this;\n      var gridPoints = self.gridPoints,\n          ticks = self.ticks;\n      var gridCfg = grid;\n      var count = gridPoints.length;\n      each(gridPoints, function (subPoints, index) {\n        if (isFunction(grid)) {\n          var tick = ticks[index] || {};\n          var executedGrid = grid(tick.text, index, count);\n          gridCfg = executedGrid ? mix({}, Global._defaultAxis.grid, executedGrid) : null;\n        }\n\n        if (gridCfg) {\n          var type = gridCfg.type; // has two types: 'line' and 'arc'\n\n          var points = subPoints.points;\n          var container = self.getContainer(gridCfg.top);\n          var shape;\n\n          if (type === 'arc') {\n            var center = self.center,\n                startAngle = self.startAngle,\n                endAngle = self.endAngle;\n            var radius = Vector2.length([points[0].x - center.x, points[0].y - center.y]);\n            shape = container.addShape('Arc', {\n              className: 'axis-grid',\n              attrs: mix({\n                x: center.x,\n                y: center.y,\n                startAngle: startAngle,\n                endAngle: endAngle,\n                r: radius\n              }, gridCfg)\n            });\n          } else {\n            shape = container.addShape('Polyline', {\n              className: 'axis-grid',\n              attrs: mix({\n                points: points\n              }, gridCfg)\n            });\n          }\n\n          shape._id = subPoints._id;\n        }\n      });\n    };\n\n    _proto.getOffsetPoint = function getOffsetPoint() {};\n\n    _proto.getAxisVector = function getAxisVector() {};\n\n    _proto.getOffsetVector = function getOffsetVector(point, offset) {\n      var self = this;\n      var axisVector = self.getAxisVector(point);\n      var normal = Vector2.normalize([], axisVector);\n      var factor = self.offsetFactor;\n      var verticalVector = [normal[1] * -1 * factor, normal[0] * factor];\n      return Vector2.scale([], verticalVector, offset);\n    };\n\n    _proto.getSidePoint = function getSidePoint(point, offset) {\n      var self = this;\n      var offsetVector = self.getOffsetVector(point, offset);\n      return {\n        x: point.x + offsetVector[0],\n        y: point.y + offsetVector[1]\n      };\n    };\n\n    _proto.getTextAlignInfo = function getTextAlignInfo(point, offset) {\n      var self = this;\n      var offsetVector = self.getOffsetVector(point, offset);\n      var align;\n      var baseLine;\n\n      if (offsetVector[0] > 0) {\n        align = 'left';\n      } else if (offsetVector[0] < 0) {\n        align = 'right';\n      } else {\n        align = 'center';\n      }\n\n      if (offsetVector[1] > 0) {\n        baseLine = 'top';\n      } else if (offsetVector[1] < 0) {\n        baseLine = 'bottom';\n      } else {\n        baseLine = 'middle';\n      }\n\n      return {\n        textAlign: align,\n        textBaseline: baseLine\n      };\n    };\n\n    _proto.getContainer = function getContainer(isTop) {\n      var frontContainer = this.frontContainer,\n          backContainer = this.backContainer;\n      return isTop ? frontContainer : backContainer;\n    };\n\n    return Abastract;\n  }();\n\n  var Line = /*#__PURE__*/function (_Abstract) {\n    _inheritsLoose(Line, _Abstract);\n\n    function Line() {\n      return _Abstract.apply(this, arguments) || this;\n    }\n\n    var _proto = Line.prototype;\n\n    _proto._initDefaultCfg = function _initDefaultCfg() {\n      _Abstract.prototype._initDefaultCfg.call(this);\n\n      this.start = null;\n      this.end = null;\n    };\n\n    _proto.getOffsetPoint = function getOffsetPoint(value) {\n      var start = this.start,\n          end = this.end;\n      return {\n        x: start.x + (end.x - start.x) * value,\n        y: start.y + (end.y - start.y) * value\n      };\n    };\n\n    _proto.getAxisVector = function getAxisVector() {\n      var start = this.start,\n          end = this.end;\n      return [end.x - start.x, end.y - start.y];\n    };\n\n    _proto.drawLine = function drawLine(lineCfg) {\n      var container = this.getContainer(lineCfg.top);\n      var start = this.start,\n          end = this.end;\n      container.addShape('line', {\n        className: 'axis-line',\n        attrs: mix({\n          x1: start.x,\n          y1: start.y,\n          x2: end.x,\n          y2: end.y\n        }, lineCfg)\n      });\n    };\n\n    return Line;\n  }(Abastract);\n\n  Abastract.Line = Line;\n\n  function formatTicks(ticks) {\n    var tmp = ticks.slice(0);\n\n    if (tmp.length > 0) {\n      var first = tmp[0];\n      var last = tmp[tmp.length - 1];\n\n      if (first.value !== 0) {\n        tmp.unshift({\n          value: 0\n        });\n      }\n\n      if (last.value !== 1) {\n        tmp.push({\n          value: 1\n        });\n      }\n    }\n\n    return tmp;\n  }\n\n  var AxisController = /*#__PURE__*/function () {\n    function AxisController(cfg) {\n      this.axisCfg = {};\n      this.frontPlot = null;\n      this.backPlot = null;\n      this.axes = {}; // store the axes's options\n\n      mix(this, cfg);\n    }\n\n    var _proto = AxisController.prototype;\n\n    _proto._isHide = function _isHide(field) {\n      var axisCfg = this.axisCfg;\n      return !axisCfg || axisCfg[field] === false;\n    };\n\n    _proto._getLinePosition = function _getLinePosition(scale, dimType, index, transposed) {\n      var position = '';\n      var field = scale.field;\n      var axisCfg = this.axisCfg;\n\n      if (axisCfg[field] && axisCfg[field].position) {\n        position = axisCfg[field].position;\n      } else if (dimType === 'x') {\n        position = transposed ? 'left' : 'bottom';\n      } else if (dimType === 'y') {\n        position = index ? 'right' : 'left';\n\n        if (transposed) {\n          position = 'bottom';\n        }\n      }\n\n      return position;\n    };\n\n    _proto._getLineCfg = function _getLineCfg(coord, dimType, position) {\n      var start;\n      var end;\n      var factor = 1; // Mark clockwise or counterclockwise\n\n      if (dimType === 'x') {\n        start = {\n          x: 0,\n          y: 0\n        };\n        end = {\n          x: 1,\n          y: 0\n        };\n      } else {\n        if (position === 'right') {\n          // there will be several y axes\n          start = {\n            x: 1,\n            y: 0\n          };\n          end = {\n            x: 1,\n            y: 1\n          };\n        } else {\n          start = {\n            x: 0,\n            y: 0\n          };\n          end = {\n            x: 0,\n            y: 1\n          };\n          factor = -1;\n        }\n      }\n\n      if (coord.transposed) {\n        factor *= -1;\n      }\n\n      return {\n        offsetFactor: factor,\n        start: coord.convertPoint(start),\n        end: coord.convertPoint(end)\n      };\n    };\n\n    _proto._getCircleCfg = function _getCircleCfg(coord) {\n      return {\n        startAngle: coord.startAngle,\n        endAngle: coord.endAngle,\n        center: coord.center,\n        radius: coord.circleRadius\n      };\n    };\n\n    _proto._getRadiusCfg = function _getRadiusCfg(coord) {\n      var transposed = coord.transposed;\n      var start;\n      var end;\n\n      if (transposed) {\n        start = {\n          x: 0,\n          y: 0\n        };\n        end = {\n          x: 1,\n          y: 0\n        };\n      } else {\n        start = {\n          x: 0,\n          y: 0\n        };\n        end = {\n          x: 0,\n          y: 1\n        };\n      }\n\n      return {\n        offsetFactor: -1,\n        start: coord.convertPoint(start),\n        end: coord.convertPoint(end)\n      };\n    };\n\n    _proto._getAxisCfg = function _getAxisCfg(coord, scale, verticalScale, dimType, defaultCfg) {\n      var _this = this;\n\n      var self = this;\n      var axisCfg = this.axisCfg;\n      var ticks = scale.getTicks();\n      var cfg = deepMix({\n        ticks: ticks,\n        frontContainer: this.frontPlot,\n        backContainer: this.backPlot\n      }, defaultCfg, axisCfg[scale.field]);\n      var labels = [];\n      var label = cfg.label;\n      var count = ticks.length;\n      var maxWidth = 0;\n      var maxHeight = 0;\n      var labelCfg = label;\n      each(ticks, function (tick, index) {\n        if (isFunction(label)) {\n          var executedLabel = label(tick.text, index, count);\n          labelCfg = executedLabel ? mix({}, Global._defaultAxis.label, executedLabel) : null;\n        }\n\n        if (labelCfg) {\n          var textStyle = {};\n\n          if (labelCfg.textAlign) {\n            textStyle.textAlign = labelCfg.textAlign;\n          }\n\n          if (labelCfg.textBaseline) {\n            textStyle.textBaseline = labelCfg.textBaseline;\n          }\n\n          var container = labelCfg.top ? _this.frontPlot : _this.backPlot;\n          var axisLabel = container.addShape('text', {\n            className: 'axis-label',\n            aria: false,\n            attrs: mix({\n              x: 0,\n              y: 0,\n              text: tick.text,\n              fontFamily: self.chart.get('canvas').get('fontFamily')\n            }, labelCfg),\n            value: tick.value,\n            textStyle: textStyle,\n            top: labelCfg.top,\n            context: self.chart.get('canvas').get('context')\n          });\n          labels.push(axisLabel);\n\n          var _axisLabel$getBBox = axisLabel.getBBox(),\n              width = _axisLabel$getBBox.width,\n              height = _axisLabel$getBBox.height;\n\n          maxWidth = Math.max(maxWidth, width);\n          maxHeight = Math.max(maxHeight, height);\n        }\n      });\n      cfg.labels = labels;\n      cfg.maxWidth = maxWidth;\n      cfg.maxHeight = maxHeight;\n      return cfg;\n    };\n\n    _proto._createAxis = function _createAxis(coord, scale, verticalScale, dimType, index) {\n      if (index === void 0) {\n        index = '';\n      }\n\n      var self = this;\n      var coordType = coord.type;\n      var transposed = coord.transposed;\n      var type;\n      var key;\n      var defaultCfg;\n\n      if (coordType === 'cartesian' || coordType === 'rect') {\n        var position = self._getLinePosition(scale, dimType, index, transposed);\n\n        defaultCfg = Global.axis[position];\n        defaultCfg.position = position;\n        type = 'Line';\n        key = position;\n      } else {\n        if (dimType === 'x' && !transposed || dimType === 'y' && transposed) {\n          defaultCfg = Global.axis.circle;\n          type = 'Circle';\n          key = 'circle';\n        } else {\n          defaultCfg = Global.axis.radius;\n          type = 'Line';\n          key = 'radius';\n        }\n      }\n\n      var cfg = self._getAxisCfg(coord, scale, verticalScale, dimType, defaultCfg);\n\n      cfg.type = type;\n      cfg.dimType = dimType;\n      cfg.verticalScale = verticalScale;\n      cfg.index = index;\n      this.axes[key] = cfg;\n    };\n\n    _proto.createAxis = function createAxis(coord, xScale, yScales) {\n      var self = this;\n\n      if (xScale && !self._isHide(xScale.field)) {\n        self._createAxis(coord, xScale, yScales[0], 'x');\n      }\n\n      each(yScales, function (yScale, index) {\n        if (!self._isHide(yScale.field)) {\n          self._createAxis(coord, yScale, xScale, 'y', index);\n        }\n      });\n      var axes = this.axes;\n      var chart = self.chart;\n\n      if (chart._isAutoPadding()) {\n        var userPadding = parsePadding(chart.get('padding'));\n        var appendPadding = parsePadding(chart.get('appendPadding'));\n        var legendRange = chart.get('legendRange') || {\n          top: 0,\n          right: 0,\n          bottom: 0,\n          left: 0\n        };\n        var padding = [userPadding[0] === 'auto' ? legendRange.top + appendPadding[0] * 2 : userPadding[0], userPadding[1] === 'auto' ? legendRange.right + appendPadding[1] : userPadding[1], userPadding[2] === 'auto' ? legendRange.bottom + appendPadding[2] : userPadding[2], userPadding[3] === 'auto' ? legendRange.left + appendPadding[3] : userPadding[3]];\n\n        if (coord.isPolar) {\n          var circleAxis = axes.circle;\n\n          if (circleAxis) {\n            var maxHeight = circleAxis.maxHeight,\n                maxWidth = circleAxis.maxWidth,\n                labelOffset = circleAxis.labelOffset;\n            padding[0] += maxHeight + labelOffset;\n            padding[1] += maxWidth + labelOffset;\n            padding[2] += maxHeight + labelOffset;\n            padding[3] += maxWidth + labelOffset;\n          }\n        } else {\n          if (axes.right && userPadding[1] === 'auto') {\n            var _axes$right = axes.right,\n                _maxWidth = _axes$right.maxWidth,\n                _labelOffset = _axes$right.labelOffset;\n            padding[1] += _maxWidth + _labelOffset;\n          }\n\n          if (axes.left && userPadding[3] === 'auto') {\n            var _axes$left = axes.left,\n                _maxWidth2 = _axes$left.maxWidth,\n                _labelOffset2 = _axes$left.labelOffset;\n            padding[3] += _maxWidth2 + _labelOffset2;\n          }\n\n          if (axes.bottom && userPadding[2] === 'auto') {\n            var _axes$bottom = axes.bottom,\n                _maxHeight = _axes$bottom.maxHeight,\n                _labelOffset3 = _axes$bottom.labelOffset;\n            padding[2] += _maxHeight + _labelOffset3;\n          }\n        }\n\n        chart.set('_padding', padding);\n\n        chart._updateLayout(padding);\n      }\n\n      each(axes, function (axis) {\n        var type = axis.type,\n            grid = axis.grid,\n            verticalScale = axis.verticalScale,\n            ticks = axis.ticks,\n            dimType = axis.dimType,\n            position = axis.position,\n            index = axis.index;\n        var appendCfg;\n\n        if (coord.isPolar) {\n          if (type === 'Line') {\n            appendCfg = self._getRadiusCfg(coord);\n          } else if (type === 'Circle') {\n            appendCfg = self._getCircleCfg(coord);\n          }\n        } else {\n          appendCfg = self._getLineCfg(coord, dimType, position);\n        }\n\n        if (grid && verticalScale) {\n          var gridPoints = [];\n          var verticalTicks = formatTicks(verticalScale.getTicks());\n          each(ticks, function (tick) {\n            var subPoints = [];\n            each(verticalTicks, function (verticalTick) {\n              var x = dimType === 'x' ? tick.value : verticalTick.value;\n              var y = dimType === 'x' ? verticalTick.value : tick.value;\n\n              if (x >= 0 && x <= 1 && y >= 0 && y <= 1) {\n                var point = coord.convertPoint({\n                  x: x,\n                  y: y\n                });\n                subPoints.push(point);\n              }\n            });\n            gridPoints.push({\n              points: subPoints,\n              _id: 'axis-' + dimType + index + '-grid-' + tick.tickValue\n            });\n          });\n          axis.gridPoints = gridPoints;\n\n          if (coord.isPolar) {\n            axis.center = coord.center;\n            axis.startAngle = coord.startAngle;\n            axis.endAngle = coord.endAngle;\n          }\n        }\n\n        appendCfg._id = 'axis-' + dimType;\n\n        if (!isNil(index)) {\n          appendCfg._id = 'axis-' + dimType + index;\n        }\n\n        new Abastract[type](mix(axis, appendCfg));\n      });\n    };\n\n    _proto.clear = function clear() {\n      this.axes = {};\n      this.frontPlot.clear();\n      this.backPlot.clear();\n    };\n\n    return AxisController;\n  }();\n\n  var calcDirection = function calcDirection(start, end) {\n    var xDistance = end.x - start.x;\n    var yDistance = end.y - start.y; // x 的距离大于y 说明是横向，否则就是纵向\n\n    if (Math.abs(xDistance) > Math.abs(yDistance)) {\n      return xDistance > 0 ? 'right' : 'left';\n    }\n\n    return yDistance > 0 ? 'down' : 'up';\n  }; // 计算2点之间的距离\n\n\n  var calcDistance = function calcDistance(point1, point2) {\n    var xDistance = Math.abs(point2.x - point1.x);\n    var yDistance = Math.abs(point2.y - point1.y);\n    return Math.sqrt(xDistance * xDistance + yDistance * yDistance);\n  };\n\n  var getCenter = function getCenter(point1, point2) {\n    var x = point1.x + (point2.x - point1.x) / 2;\n    var y = point1.y + (point2.y - point1.y) / 2;\n    return {\n      x: x,\n      y: y\n    };\n  };\n\n  var PRESS_DELAY = 250;\n\n  var EventController = /*#__PURE__*/function () {\n    function EventController(_ref) {\n      var _this = this;\n\n      var canvas = _ref.canvas,\n          el = _ref.el;\n\n      _defineProperty(this, \"_click\", function (ev) {\n        var points = convertPoints(ev, _this.canvas);\n        ev.points = points;\n\n        _this.emitEvent('click', ev);\n      });\n\n      _defineProperty(this, \"_start\", function (ev) {\n        var points = convertPoints(ev, _this.canvas);\n\n        if (!points) {\n          return;\n        }\n\n        ev.points = points;\n\n        _this.emitEvent('touchstart', ev); // 防止上次的内容没有清理掉，重新reset下\n\n\n        _this.reset(); // 记录touch start 的时间\n\n\n        _this.startTime = Date.now(); // 记录touch start 的点\n\n        _this.startPoints = points;\n\n        if (points.length > 1) {\n          _this.startDistance = calcDistance(points[0], points[1]);\n          _this.center = getCenter(points[0], points[1]);\n        } else {\n          // 如果touchstart后停顿250ms, 则也触发press事件\n          _this.pressTimeout = setTimeout(function () {\n            // 这里固定触发press事件\n            var eventType = 'press';\n            var direction = 'none';\n            ev.direction = direction;\n\n            _this.emitStart(eventType, ev);\n\n            _this.emitEvent(eventType, ev);\n\n            _this.eventType = eventType;\n            _this.direction = direction;\n          }, PRESS_DELAY);\n        }\n      });\n\n      _defineProperty(this, \"_move\", function (ev) {\n        var points = convertPoints(ev, _this.canvas);\n        if (!points) return;\n\n        _this.clearPressTimeout();\n\n        ev.points = points;\n\n        _this.emitEvent('touchmove', ev);\n\n        var startPoints = _this.startPoints;\n        if (!startPoints) return; // 多指触控\n\n        if (points.length > 1) {\n          // touchstart的距离\n          var startDistance = _this.startDistance;\n          var currentDistance = calcDistance(points[0], points[1]);\n          ev.zoom = currentDistance / startDistance;\n          ev.center = _this.center; // 触发缩放事件\n\n          _this.emitStart('pinch', ev);\n\n          _this.emitEvent('pinch', ev);\n        } else {\n          var deltaX = points[0].x - startPoints[0].x;\n          var deltaY = points[0].y - startPoints[0].y;\n          var direction = _this.direction || calcDirection(startPoints[0], points[0]);\n          _this.direction = direction; // 获取press或者pan的事件类型\n          // press 按住滑动, pan表示平移\n          // 如果start后立刻move，则触发pan, 如果有停顿，则触发press\n\n          var eventType = _this.getEventType(points);\n\n          ev.direction = direction;\n          ev.deltaX = deltaX;\n          ev.deltaY = deltaY;\n\n          _this.emitStart(eventType, ev);\n\n          _this.emitEvent(eventType, ev); // 记录最后2次move的时间和坐标，为了给swipe事件用\n\n\n          var prevMoveTime = _this.lastMoveTime;\n          var now = Date.now(); // 最后2次的时间间隔一定要大于0，否则swipe没发计算\n\n          if (now - prevMoveTime > 0) {\n            _this.prevMoveTime = prevMoveTime;\n            _this.prevMovePoints = _this.lastMovePoints;\n            _this.lastMoveTime = now;\n            _this.lastMovePoints = points;\n          }\n        }\n      });\n\n      _defineProperty(this, \"_end\", function (ev) {\n        var points = convertPoints(ev, _this.canvas);\n        ev.points = points;\n\n        _this.emitEnd(ev);\n\n        _this.emitEvent('touchend', ev); // swipe事件处理, 在touchend之后触发\n\n\n        var lastMoveTime = _this.lastMoveTime;\n        var now = Date.now(); // 做这个判断是为了最后一次touchmove后到end前，还有一个停顿的过程\n        // 100 是拍的一个值，理论这个值会很短，一般不卡顿的话在10ms以内\n\n        if (now - lastMoveTime < 100) {\n          var prevMoveTime = _this.prevMoveTime || _this.startTime;\n          var intervalTime = lastMoveTime - prevMoveTime; // 时间间隔一定要大于0, 否则计算没意义\n\n          if (intervalTime > 0) {\n            var prevMovePoints = _this.prevMovePoints || _this.startPoints;\n            var lastMovePoints = _this.lastMovePoints; // move速率\n\n            var velocity = calcDistance(prevMovePoints[0], lastMovePoints[0]) / intervalTime; // 0.3 是参考hammerjs的设置\n\n            if (velocity > 0.3) {\n              ev.velocity = velocity;\n              ev.direction = calcDirection(prevMovePoints[0], lastMovePoints[0]);\n\n              _this.emitEvent('swipe', ev);\n            }\n          }\n        }\n\n        _this.reset();\n\n        var touches = ev.touches; // 当多指只释放了1指时也会触发end, 这时重新触发一次start\n\n        if (touches && touches.length > 0) {\n          _this._start(ev);\n        }\n      });\n\n      _defineProperty(this, \"_cancel\", function (ev) {\n        _this.emitEvent('touchcancel', ev);\n\n        _this.reset();\n      }); // canvasEl\n\n\n      this.canvas = canvas;\n      this.delegateEvent(el); // 用来记录当前触发的事件\n\n      this.processEvent = {};\n    }\n\n    var _proto = EventController.prototype;\n\n    _proto.delegateEvent = function delegateEvent(canvasEl) {\n      // 代理这几个事件\n      canvasEl.addEventListener('click', this._click);\n      canvasEl.addEventListener('touchstart', this._start);\n      canvasEl.addEventListener('touchmove', this._move);\n      canvasEl.addEventListener('touchend', this._end);\n      canvasEl.addEventListener('touchcancel', this._cancel);\n    };\n\n    _proto.emitEvent = function emitEvent(type, ev) {\n      var canvas = this.canvas;\n      canvas.emit(type, ev);\n    };\n\n    _proto.getEventType = function getEventType(points) {\n      var eventType = this.eventType,\n          canvas = this.canvas,\n          startTime = this.startTime,\n          startPoints = this.startPoints;\n\n      if (eventType) {\n        return eventType;\n      }\n\n      var type;\n      var panEventListeners = canvas.__events.pan; // 如果没有pan事件的监听，默认都是press\n\n      if (!panEventListeners || !panEventListeners.length) {\n        type = 'press';\n      } else {\n        // 如果有pan事件的处理，press则需要停顿250ms, 且移动距离小于10\n        var now = Date.now();\n\n        if (now - startTime > PRESS_DELAY && calcDistance(startPoints[0], points[0]) < 10) {\n          type = 'press';\n        } else {\n          type = 'pan';\n        }\n      }\n\n      this.eventType = type;\n      return type;\n    };\n\n    _proto.enable = function enable(eventType) {\n      this.processEvent[eventType] = true;\n    } // 是否进行中的事件\n    ;\n\n    _proto.isProcess = function isProcess(eventType) {\n      return this.processEvent[eventType];\n    } // 触发start事件\n    ;\n\n    _proto.emitStart = function emitStart(type, ev) {\n      if (this.isProcess(type)) {\n        return;\n      }\n\n      this.enable(type);\n      this.emitEvent(type + \"start\", ev);\n    } // 触发end事件\n    ;\n\n    _proto.emitEnd = function emitEnd(ev) {\n      var _this2 = this;\n\n      var processEvent = this.processEvent;\n      Object.keys(processEvent).forEach(function (type) {\n        _this2.emitEvent(type + \"end\", ev);\n\n        delete processEvent[type];\n      });\n    };\n\n    _proto.clearPressTimeout = function clearPressTimeout() {\n      if (this.pressTimeout) {\n        clearTimeout(this.pressTimeout);\n        this.pressTimeout = 0;\n      }\n    };\n\n    _proto.reset = function reset() {\n      this.clearPressTimeout();\n      this.startTime = 0;\n      this.startPoints = null;\n      this.startDistance = 0;\n      this.direction = null;\n      this.eventType = null;\n      this.pinch = false;\n      this.prevMoveTime = 0;\n      this.prevMovePoints = null;\n      this.lastMoveTime = 0;\n      this.lastMovePoints = null;\n    };\n\n    return EventController;\n  }();\n\n  var CanvasElement = /*#__PURE__*/function (_EventEmit) {\n    _inheritsLoose(CanvasElement, _EventEmit);\n\n    function CanvasElement(ctx) {\n      var _this;\n\n      _this = _EventEmit.call(this) || this;\n      _this.context = ctx; // canvas实际的宽高 (width/height) * pixelRatio\n\n      _this.width = 0;\n      _this.height = 0;\n      _this.style = {};\n      _this.currentStyle = {};\n      _this.attrs = {}; // 用来标识是CanvasElement实例\n\n      _this.isCanvasElement = true;\n      return _this;\n    }\n\n    var _proto = CanvasElement.prototype;\n\n    _proto.getContext = function getContext()\n    /* type */\n    {\n      return this.context;\n    };\n\n    _proto.getBoundingClientRect = function getBoundingClientRect() {\n      var width = this.width;\n      var height = this.height; // 默认都处理成可视窗口的顶部位置\n\n      return {\n        top: 0,\n        right: width,\n        bottom: height,\n        left: 0\n      };\n    };\n\n    _proto.setAttribute = function setAttribute(key, value) {\n      this.attrs[key] = value;\n    };\n\n    _proto.addEventListener = function addEventListener(type, listener) {\n      this.on(type, listener);\n    };\n\n    _proto.removeEventListener = function removeEventListener(type, listener) {\n      this.off(type, listener);\n    };\n\n    _proto.dispatchEvent = function dispatchEvent(type, e) {\n      this.emit(type, e);\n    };\n\n    return CanvasElement;\n  }(EventEmit);\n\n  function supportEventListener(canvas) {\n    if (!canvas) {\n      return false;\n    } // 非 HTMLCanvasElement\n\n\n    if (canvas.nodeType !== 1 || !canvas.nodeName || canvas.nodeName.toLowerCase() !== 'canvas') {\n      return false;\n    } // 微信小程序canvas.getContext('2d')时也是CanvasRenderingContext2D\n    // 也会有ctx.canvas, 而且nodeType也是1，所以还要在看下是否支持addEventListener\n\n\n    var support = false;\n\n    try {\n      canvas.addEventListener('eventTest', function () {\n        support = true;\n      });\n      canvas.dispatchEvent(new Event('eventTest'));\n    } catch (error) {\n      support = false;\n    }\n\n    return support;\n  }\n\n  var CanvasElement$1 = {\n    create: function create(ctx) {\n      if (!ctx) {\n        return null;\n      }\n\n      if (supportEventListener(ctx.canvas)) {\n        return ctx.canvas;\n      }\n\n      return new CanvasElement(ctx);\n    }\n  };\n\n  function _mod(n, m) {\n    return (n % m + m) % m;\n  }\n\n  function _addStop(steps, gradient) {\n    each(steps, function (item) {\n      item = item.split(':');\n      gradient.addColorStop(Number(item[0]), item[1]);\n    });\n  } // the string format: 'l(0) 0:#ffffff 0.5:#7ec2f3 1:#1890ff'\n\n\n  function _parseLineGradient(color, shape, context) {\n    var arr = color.split(' ');\n    var angle = arr[0].slice(2, arr[0].length - 1);\n    angle = _mod(parseFloat(angle) * Math.PI / 180, Math.PI * 2);\n    var steps = arr.slice(1);\n\n    var _shape$getBBox = shape.getBBox(),\n        minX = _shape$getBBox.minX,\n        minY = _shape$getBBox.minY,\n        maxX = _shape$getBBox.maxX,\n        maxY = _shape$getBBox.maxY;\n\n    var start;\n    var end;\n\n    if (angle >= 0 && angle < 0.5 * Math.PI) {\n      start = {\n        x: minX,\n        y: minY\n      };\n      end = {\n        x: maxX,\n        y: maxY\n      };\n    } else if (0.5 * Math.PI <= angle && angle < Math.PI) {\n      start = {\n        x: maxX,\n        y: minY\n      };\n      end = {\n        x: minX,\n        y: maxY\n      };\n    } else if (Math.PI <= angle && angle < 1.5 * Math.PI) {\n      start = {\n        x: maxX,\n        y: maxY\n      };\n      end = {\n        x: minX,\n        y: minY\n      };\n    } else {\n      start = {\n        x: minX,\n        y: maxY\n      };\n      end = {\n        x: maxX,\n        y: minY\n      };\n    }\n\n    var tanTheta = Math.tan(angle);\n    var tanTheta2 = tanTheta * tanTheta;\n    var x = (end.x - start.x + tanTheta * (end.y - start.y)) / (tanTheta2 + 1) + start.x;\n    var y = tanTheta * (end.x - start.x + tanTheta * (end.y - start.y)) / (tanTheta2 + 1) + start.y;\n    var gradient = context.createLinearGradient(start.x, start.y, x, y);\n\n    _addStop(steps, gradient);\n\n    return gradient;\n  } // the string format: 'r(0.5, 0.5, 0.1) 0:#ffffff 1:#1890ff'\n\n\n  function _parseRadialGradient(color, shape, context) {\n    var arr = color.split(' ');\n    var circleCfg = arr[0].slice(2, arr[0].length - 1);\n    circleCfg = circleCfg.split(',');\n    var fx = parseFloat(circleCfg[0]);\n    var fy = parseFloat(circleCfg[1]);\n    var fr = parseFloat(circleCfg[2]);\n    var steps = arr.slice(1); // if radius is 0, no gradient, stroke with the last color\n\n    if (fr === 0) {\n      var _color = steps[steps.length - 1];\n      return _color.split(':')[1];\n    }\n\n    var _shape$getBBox2 = shape.getBBox(),\n        width = _shape$getBBox2.width,\n        height = _shape$getBBox2.height,\n        minX = _shape$getBBox2.minX,\n        minY = _shape$getBBox2.minY;\n\n    var r = Math.sqrt(width * width + height * height) / 2;\n    var gradient = context.createRadialGradient(minX + width * fx, minY + height * fy, fr * r, minX + width / 2, minY + height / 2, r);\n\n    _addStop(steps, gradient);\n\n    return gradient;\n  }\n\n  function parseStyle(color, shape, context) {\n    if (color[1] === '(') {\n      try {\n        var firstCode = color[0];\n\n        if (firstCode === 'l') {\n          return _parseLineGradient(color, shape, context);\n        } else if (firstCode === 'r') {\n          return _parseRadialGradient(color, shape, context);\n        }\n      } catch (ev) {\n        console.error('error in parsing gradient string, please check if there are any extra whitespaces.');\n        console.error(ev);\n      }\n    }\n\n    return color;\n  }\n\n  var ALIAS_ATTRS_MAP = {\n    stroke: 'strokeStyle',\n    fill: 'fillStyle',\n    opacity: 'globalAlpha'\n  };\n  var SHAPE_ATTRS = ['fillStyle', 'font', 'globalAlpha', 'lineCap', 'lineWidth', 'lineJoin', 'miterLimit', 'shadowBlur', 'shadowColor', 'shadowOffsetX', 'shadowOffsetY', 'strokeStyle', 'textAlign', 'textBaseline', 'lineDash', 'shadow' // 兼容支付宝小程序\n  ];\n  var CLIP_SHAPES = ['circle', 'sector', 'polygon', 'rect', 'polyline'];\n\n  var Element = /*#__PURE__*/function () {\n    var _proto = Element.prototype;\n\n    _proto._initProperties = function _initProperties() {\n      this._attrs = {\n        zIndex: 0,\n        visible: true,\n        destroyed: false\n      };\n    };\n\n    function Element(cfg) {\n      this._initProperties();\n\n      mix(this._attrs, cfg);\n      var attrs = this._attrs.attrs;\n\n      if (attrs) {\n        this.initAttrs(attrs);\n      }\n\n      this.initTransform();\n    }\n\n    _proto.get = function get(name) {\n      return this._attrs[name];\n    };\n\n    _proto.set = function set(name, value) {\n      this._attrs[name] = value;\n    };\n\n    _proto.isGroup = function isGroup() {\n      return this.get('isGroup');\n    };\n\n    _proto.isShape = function isShape() {\n      return this.get('isShape');\n    };\n\n    _proto.initAttrs = function initAttrs(attrs) {\n      this.attr(mix(this.getDefaultAttrs(), attrs));\n    };\n\n    _proto.getDefaultAttrs = function getDefaultAttrs() {\n      return {};\n    };\n\n    _proto._setAttr = function _setAttr(name, value) {\n      var attrs = this._attrs.attrs;\n\n      if (name === 'clip') {\n        value = this._setAttrClip(value);\n      } else {\n        var alias = ALIAS_ATTRS_MAP[name];\n\n        if (alias) {\n          attrs[alias] = value;\n        }\n      }\n\n      attrs[name] = value;\n    };\n\n    _proto._getAttr = function _getAttr(name) {\n      return this._attrs.attrs[name];\n    } // _afterAttrsSet() {}\n    ;\n\n    _proto._setAttrClip = function _setAttrClip(clip) {\n      if (clip && CLIP_SHAPES.indexOf(clip._attrs.type) > -1) {\n        if (clip.get('canvas') === null) {\n          clip = Object.assign({}, clip);\n        }\n\n        clip.set('parent', this.get('parent'));\n        clip.set('context', this.get('context'));\n        return clip;\n      }\n\n      return null;\n    };\n\n    _proto.attr = function attr(name, value) {\n      var self = this;\n      if (self.get('destroyed')) return null;\n      var argumentsLen = arguments.length;\n\n      if (argumentsLen === 0) {\n        return self._attrs.attrs;\n      }\n\n      if (isObject(name)) {\n        this._attrs.bbox = null;\n\n        for (var k in name) {\n          self._setAttr(k, name[k]);\n        }\n\n        if (self._afterAttrsSet) {\n          self._afterAttrsSet();\n        }\n\n        return self;\n      }\n\n      if (argumentsLen === 2) {\n        this._attrs.bbox = null;\n\n        self._setAttr(name, value);\n\n        if (self._afterAttrsSet) {\n          self._afterAttrsSet();\n        }\n\n        return self;\n      }\n\n      return self._getAttr(name);\n    };\n\n    _proto.getParent = function getParent() {\n      return this.get('parent');\n    };\n\n    _proto.draw = function draw(context) {\n      if (this.get('destroyed')) {\n        return;\n      }\n\n      if (this.get('visible')) {\n        this.setContext(context);\n        this.drawInner(context);\n        this.restoreContext(context);\n      }\n    };\n\n    _proto.setContext = function setContext(context) {\n      var clip = this._attrs.attrs.clip;\n      context.save();\n\n      if (clip) {\n        clip.resetTransform(context);\n        clip.createPath(context);\n        context.clip();\n      }\n\n      this.resetContext(context);\n      this.resetTransform(context);\n    };\n\n    _proto.restoreContext = function restoreContext(context) {\n      context.restore();\n    };\n\n    _proto.resetContext = function resetContext(context) {\n      var elAttrs = this._attrs.attrs;\n\n      if (!this._attrs.isGroup) {\n        for (var k in elAttrs) {\n          if (SHAPE_ATTRS.indexOf(k) > -1) {\n            var v = elAttrs[k];\n\n            if ((k === 'fillStyle' || k === 'strokeStyle') && v) {\n              v = parseStyle(v, this, context);\n            }\n\n            if (k === 'lineDash' && context.setLineDash && isArray(v)) {\n              context.setLineDash(v);\n            } else {\n              context[k] = v;\n            }\n          }\n        }\n      }\n    };\n\n    _proto.hasFill = function hasFill() {\n      return this.get('canFill') && this._attrs.attrs.fillStyle;\n    };\n\n    _proto.hasStroke = function hasStroke() {\n      return this.get('canStroke') && this._attrs.attrs.strokeStyle;\n    };\n\n    _proto.drawInner = function drawInner()\n    /* context */\n    {};\n\n    _proto.show = function show() {\n      this.set('visible', true);\n      return this;\n    };\n\n    _proto.hide = function hide() {\n      this.set('visible', false);\n      return this;\n    };\n\n    _proto.isVisible = function isVisible() {\n      return this.get('visible');\n    };\n\n    _proto.getAriaLabel = function getAriaLabel() {\n      var _this$_attrs = this._attrs,\n          destroyed = _this$_attrs.destroyed,\n          visible = _this$_attrs.visible,\n          isShape = _this$_attrs.isShape,\n          aria = _this$_attrs.aria;\n\n      if (destroyed || !visible || isShape && !aria) {\n        return;\n      }\n\n      return this._getAriaLabel();\n    };\n\n    _proto._getAriaLabel = function _getAriaLabel() {\n      return this._attrs.ariaLabel;\n    };\n\n    _proto._removeFromParent = function _removeFromParent() {\n      var parent = this.get('parent');\n\n      if (parent) {\n        var children = parent.get('children');\n        remove(children, this);\n      }\n\n      return this;\n    };\n\n    _proto.remove = function remove(destroy) {\n      if (destroy) {\n        this.destroy();\n      } else {\n        this._removeFromParent();\n      }\n    };\n\n    _proto.destroy = function destroy() {\n      var destroyed = this.get('destroyed');\n\n      if (destroyed) {\n        return null;\n      }\n\n      this._removeFromParent();\n\n      this._attrs = {};\n      this.set('destroyed', true);\n    };\n\n    _proto.getBBox = function getBBox() {\n      return {\n        minX: 0,\n        maxX: 0,\n        minY: 0,\n        maxY: 0,\n        width: 0,\n        height: 0\n      };\n    };\n\n    _proto.initTransform = function initTransform() {\n      var attrs = this._attrs.attrs || {};\n\n      if (!attrs.matrix) {\n        attrs.matrix = [1, 0, 0, 1, 0, 0];\n      }\n\n      this._attrs.attrs = attrs;\n    };\n\n    _proto.getMatrix = function getMatrix() {\n      return this._attrs.attrs.matrix;\n    };\n\n    _proto.setMatrix = function setMatrix(m) {\n      this._attrs.attrs.matrix = [m[0], m[1], m[2], m[3], m[4], m[5]];\n    };\n\n    _proto.transform = function transform(actions) {\n      var matrix = this._attrs.attrs.matrix;\n      this._attrs.attrs.matrix = Matrix.transform(matrix, actions);\n      return this;\n    };\n\n    _proto.setTransform = function setTransform(actions) {\n      this._attrs.attrs.matrix = [1, 0, 0, 1, 0, 0];\n      return this.transform(actions);\n    };\n\n    _proto.translate = function translate(x, y) {\n      var matrix = this._attrs.attrs.matrix;\n      Matrix.translate(matrix, matrix, [x, y]);\n    };\n\n    _proto.rotate = function rotate(rad) {\n      var matrix = this._attrs.attrs.matrix;\n      Matrix.rotate(matrix, matrix, rad);\n    };\n\n    _proto.scale = function scale(sx, sy) {\n      var matrix = this._attrs.attrs.matrix;\n      Matrix.scale(matrix, matrix, [sx, sy]);\n    };\n\n    _proto.moveTo = function moveTo(x, y) {\n      var cx = this._attrs.x || 0;\n      var cy = this._attrs.y || 0;\n      this.translate(x - cx, y - cy);\n      this.set('x', x);\n      this.set('y', y);\n    };\n\n    _proto.apply = function apply(v) {\n      var m = this._attrs.attrs.matrix;\n      Vector2.transformMat2d(v, v, m);\n      return this;\n    };\n\n    _proto.resetTransform = function resetTransform(context) {\n      var mo = this._attrs.attrs.matrix;\n\n      if (Matrix.isChanged(mo)) {\n        context.transform(mo[0], mo[1], mo[2], mo[3], mo[4], mo[5]);\n      }\n    };\n\n    _proto.isDestroyed = function isDestroyed() {\n      return this.get('destroyed');\n    };\n\n    return Element;\n  }();\n\n  var Shape$2 = /*#__PURE__*/function (_Element) {\n    _inheritsLoose(Shape, _Element);\n\n    function Shape() {\n      return _Element.apply(this, arguments) || this;\n    }\n\n    var _proto = Shape.prototype;\n\n    _proto._initProperties = function _initProperties() {\n      this._attrs = {\n        zIndex: 0,\n        visible: true,\n        destroyed: false,\n        isShape: true,\n        attrs: {}\n      };\n    };\n\n    _proto.getType = function getType() {\n      return this._attrs.type;\n    };\n\n    _proto.drawInner = function drawInner(context) {\n      var self = this;\n      var attrs = self.get('attrs');\n      self.createPath(context);\n      var originOpacity = context.globalAlpha;\n\n      if (self.hasFill()) {\n        var fillOpacity = attrs.fillOpacity;\n\n        if (!isNil(fillOpacity) && fillOpacity !== 1) {\n          context.globalAlpha = fillOpacity;\n          context.fill();\n          context.globalAlpha = originOpacity;\n        } else {\n          context.fill();\n        }\n      }\n\n      if (self.hasStroke()) {\n        var lineWidth = attrs.lineWidth;\n\n        if (lineWidth > 0) {\n          var strokeOpacity = attrs.strokeOpacity;\n\n          if (!isNil(strokeOpacity) && strokeOpacity !== 1) {\n            context.globalAlpha = strokeOpacity;\n          }\n\n          context.stroke();\n        }\n      }\n    };\n\n    _proto.getBBox = function getBBox() {\n      var bbox = this._attrs.bbox;\n\n      if (!bbox) {\n        bbox = this.calculateBox();\n\n        if (bbox) {\n          bbox.x = bbox.minX;\n          bbox.y = bbox.minY;\n          bbox.width = bbox.maxX - bbox.minX;\n          bbox.height = bbox.maxY - bbox.minY;\n        }\n\n        this._attrs.bbox = bbox;\n      }\n\n      return bbox;\n    };\n\n    _proto.calculateBox = function calculateBox() {\n      return null;\n    };\n\n    _proto.createPath = function createPath() {};\n\n    return Shape;\n  }(Element);\n\n  function parseRadius(radius, width, height) {\n    radius = parsePadding(radius); // 都为0\n\n    if (!radius[0] && !radius[1] && !radius[2] && !radius[3]) {\n      return radius;\n    }\n\n    var minWidth = Math.max(radius[0] + radius[1], radius[2] + radius[3]);\n    var minHeight = Math.max(radius[0] + radius[3], radius[1] + radius[2]);\n    var scale = Math.min(width / minWidth, height / minHeight);\n\n    if (scale < 1) {\n      return radius.map(function (r) {\n        return r * scale;\n      });\n    }\n\n    return radius;\n  }\n\n  var Rect = /*#__PURE__*/function (_Shape) {\n    _inheritsLoose(Rect, _Shape);\n\n    function Rect() {\n      return _Shape.apply(this, arguments) || this;\n    }\n\n    var _proto = Rect.prototype;\n\n    _proto._initProperties = function _initProperties() {\n      _Shape.prototype._initProperties.call(this);\n\n      this._attrs.canFill = true;\n      this._attrs.canStroke = true;\n      this._attrs.type = 'rect';\n    };\n\n    _proto.getDefaultAttrs = function getDefaultAttrs() {\n      return {\n        x: 0,\n        y: 0,\n        width: 0,\n        height: 0,\n        radius: 0,\n        lineWidth: 0\n      };\n    };\n\n    _proto.createRadiusPath = function createRadiusPath(context, x, y, width, height, radius) {\n      radius = parseRadius(radius, width, height);\n      context.moveTo(x + radius[0], y);\n      context.lineTo(x + width - radius[1], y);\n      context.arc(x + width - radius[1], y + radius[1], radius[1], -Math.PI / 2, 0, false);\n      context.lineTo(x + width, y + height - radius[2]);\n      context.arc(x + width - radius[2], y + height - radius[2], radius[2], 0, Math.PI / 2, false);\n      context.lineTo(x + radius[3], y + height);\n      context.arc(x + radius[3], y + height - radius[3], radius[3], Math.PI / 2, Math.PI, false);\n      context.lineTo(x, y + radius[0]);\n      context.arc(x + radius[0], y + radius[0], radius[0], Math.PI, Math.PI * 3 / 2, false);\n      context.closePath();\n    };\n\n    _proto.createPath = function createPath(context) {\n      var self = this;\n      var attrs = self.get('attrs');\n      var x = attrs.x,\n          y = attrs.y,\n          width = attrs.width,\n          height = attrs.height,\n          radius = attrs.radius;\n      context.beginPath();\n\n      if (!radius || !(width * height)) {\n        context.rect(x, y, width, height);\n      } else {\n        this.createRadiusPath(context, x, y, width, height, radius);\n      }\n    };\n\n    _proto.calculateBox = function calculateBox() {\n      var attrs = this.get('attrs');\n      var x = attrs.x,\n          y = attrs.y,\n          width = attrs.width,\n          height = attrs.height;\n      return {\n        minX: x,\n        minY: y,\n        maxX: x + width,\n        maxY: y + height\n      };\n    };\n\n    return Rect;\n  }(Shape$2);\n\n  var ImageShape = /*#__PURE__*/function (_Rect) {\n    _inheritsLoose(ImageShape, _Rect);\n\n    function ImageShape() {\n      return _Rect.apply(this, arguments) || this;\n    }\n\n    var _proto = ImageShape.prototype;\n\n    _proto._initProperties = function _initProperties() {\n      _Rect.prototype._initProperties.call(this);\n\n      this._attrs.canFill = false;\n      this._attrs.canStroke = false;\n      this._attrs.loading = false;\n      this._attrs.image = null;\n      this._attrs.type = 'image';\n    };\n\n    _proto.createPath = function createPath(context) {\n      var _this = this;\n\n      var attrs = this.get('attrs');\n      var src = attrs.src;\n\n      if (this.get('loading')) {\n        return;\n      }\n\n      var image = this.get('image');\n\n      if (image) {\n        this.drawImage(context, image);\n      } else {\n        if (src && Image) {\n          this.set('loading', true);\n\n          var _image = new Image();\n\n          _image.src = src; // 设置跨域\n\n          _image.crossOrigin = 'Anonymous';\n\n          _image.onload = function () {\n            _this.set('loading', false);\n\n            _this.set('image', _image);\n\n            _this.drawImage(context, _image);\n          };\n        }\n      }\n    };\n\n    _proto.drawImage = function drawImage(context, image) {\n      var _this$_attrs = this._attrs,\n          attrs = _this$_attrs.attrs,\n          destroyed = _this$_attrs.destroyed;\n\n      if (destroyed) {\n        return;\n      }\n\n      var x = attrs.x,\n          y = attrs.y,\n          width = attrs.width,\n          height = attrs.height,\n          sx = attrs.sx,\n          sy = attrs.sy,\n          swidth = attrs.swidth,\n          sheight = attrs.sheight,\n          radius = attrs.radius;\n\n      if (radius) {\n        context.save();\n        this.createRadiusPath(context, x, y, width, height, radius);\n        context.clip();\n      }\n\n      if (!isNil(sx) && !isNil(sy) && !isNil(swidth) && !isNil(sheight)) {\n        context.drawImage(image, sx, sy, swidth, sheight, x, y, width, height);\n      } else {\n        context.drawImage(image, x, y, width, height);\n      }\n\n      if (radius) {\n        // 因为 save 和 restore 会一定程度上影响绘图性能，所以只在必要是调用\n        context.restore();\n      }\n    };\n\n    return ImageShape;\n  }(Rect);\n\n  var Circle = /*#__PURE__*/function (_Shape) {\n    _inheritsLoose(Circle, _Shape);\n\n    function Circle() {\n      return _Shape.apply(this, arguments) || this;\n    }\n\n    var _proto = Circle.prototype;\n\n    _proto._initProperties = function _initProperties() {\n      _Shape.prototype._initProperties.call(this);\n\n      this._attrs.canFill = true;\n      this._attrs.canStroke = true;\n      this._attrs.type = 'circle';\n    };\n\n    _proto.getDefaultAttrs = function getDefaultAttrs() {\n      return {\n        x: 0,\n        y: 0,\n        r: 0,\n        lineWidth: 0\n      };\n    };\n\n    _proto.createPath = function createPath(context) {\n      var attrs = this.get('attrs');\n      var x = attrs.x,\n          y = attrs.y,\n          r = attrs.r;\n      context.beginPath();\n      context.arc(x, y, r, 0, Math.PI * 2, false);\n      context.closePath();\n    };\n\n    _proto.calculateBox = function calculateBox() {\n      var attrs = this.get('attrs');\n      var x = attrs.x,\n          y = attrs.y,\n          r = attrs.r;\n      return {\n        minX: x - r,\n        maxX: x + r,\n        minY: y - r,\n        maxY: y + r\n      };\n    };\n\n    return Circle;\n  }(Shape$2);\n\n  var start = Vector2.create();\n  var end = Vector2.create();\n  var extremity = Vector2.create();\n\n  function getCubicBezierXYatT(startPt, controlPt1, controlPt2, endPt, T) {\n    var x = CubicN(T, startPt.x, controlPt1.x, controlPt2.x, endPt.x);\n    var y = CubicN(T, startPt.y, controlPt1.y, controlPt2.y, endPt.y);\n    return {\n      x: x,\n      y: y\n    };\n  } // cubic helper formula at T distance\n\n\n  function CubicN(T, a, b, c, d) {\n    var t2 = T * T;\n    var t3 = t2 * T;\n    return a + (-a * 3 + T * (3 * a - a * T)) * T + (3 * b + T * (-6 * b + b * 3 * T)) * T + (c * 3 - c * 3 * T) * t2 + d * t3;\n  }\n\n  function cubicBezierBounds(c) {\n    var minX = Infinity;\n    var maxX = -Infinity;\n    var minY = Infinity;\n    var maxY = -Infinity;\n    var s = {\n      x: c[0],\n      y: c[1]\n    };\n    var c1 = {\n      x: c[2],\n      y: c[3]\n    };\n    var c2 = {\n      x: c[4],\n      y: c[5]\n    };\n    var e = {\n      x: c[6],\n      y: c[7]\n    };\n\n    for (var t = 0; t < 100; t++) {\n      var pt = getCubicBezierXYatT(s, c1, c2, e, t / 100);\n\n      if (pt.x < minX) {\n        minX = pt.x;\n      }\n\n      if (pt.x > maxX) {\n        maxX = pt.x;\n      }\n\n      if (pt.y < minY) {\n        minY = pt.y;\n      }\n\n      if (pt.y > maxY) {\n        maxY = pt.y;\n      }\n    }\n\n    return {\n      minX: minX,\n      minY: minY,\n      maxX: maxX,\n      maxY: maxY\n    };\n  }\n\n  function getBBoxFromPoints(points, lineWidth) {\n    if (points.length === 0) {\n      return;\n    }\n\n    var p = points[0];\n    var left = p.x;\n    var right = p.x;\n    var top = p.y;\n    var bottom = p.y;\n    var len = points.length;\n\n    for (var i = 1; i < len; i++) {\n      p = points[i];\n      left = Math.min(left, p.x);\n      right = Math.max(right, p.x);\n      top = Math.min(top, p.y);\n      bottom = Math.max(bottom, p.y);\n    }\n\n    lineWidth = lineWidth / 2 || 0;\n    return {\n      minX: left - lineWidth,\n      minY: top - lineWidth,\n      maxX: right + lineWidth,\n      maxY: bottom + lineWidth\n    };\n  }\n\n  function getBBoxFromLine(x0, y0, x1, y1, lineWidth) {\n    lineWidth = lineWidth / 2 || 0;\n    return {\n      minX: Math.min(x0, x1) - lineWidth,\n      minY: Math.min(y0, y1) - lineWidth,\n      maxX: Math.max(x0, x1) + lineWidth,\n      maxY: Math.max(y0, y1) + lineWidth\n    };\n  }\n\n  function getBBoxFromArc(x, y, r, startAngle, endAngle, anticlockwise) {\n    var diff = Math.abs(startAngle - endAngle);\n\n    if (diff % (Math.PI * 2) < 1e-4 && diff > 1e-4) {\n      // Is a circle\n      return {\n        minX: x - r,\n        minY: y - r,\n        maxX: x + r,\n        maxY: y + r\n      };\n    }\n\n    start[0] = Math.cos(startAngle) * r + x;\n    start[1] = Math.sin(startAngle) * r + y;\n    end[0] = Math.cos(endAngle) * r + x;\n    end[1] = Math.sin(endAngle) * r + y;\n    var min = [0, 0];\n    var max = [0, 0];\n    Vector2.min(min, start, end);\n    Vector2.max(max, start, end); // Thresh to [0, Math.PI * 2]\n\n    startAngle = startAngle % (Math.PI * 2);\n\n    if (startAngle < 0) {\n      startAngle = startAngle + Math.PI * 2;\n    }\n\n    endAngle = endAngle % (Math.PI * 2);\n\n    if (endAngle < 0) {\n      endAngle = endAngle + Math.PI * 2;\n    }\n\n    if (startAngle > endAngle && !anticlockwise) {\n      endAngle += Math.PI * 2;\n    } else if (startAngle < endAngle && anticlockwise) {\n      startAngle += Math.PI * 2;\n    }\n\n    if (anticlockwise) {\n      var tmp = endAngle;\n      endAngle = startAngle;\n      startAngle = tmp;\n    }\n\n    for (var angle = 0; angle < endAngle; angle += Math.PI / 2) {\n      if (angle > startAngle) {\n        extremity[0] = Math.cos(angle) * r + x;\n        extremity[1] = Math.sin(angle) * r + y;\n        Vector2.min(min, extremity, min);\n        Vector2.max(max, extremity, max);\n      }\n    }\n\n    return {\n      minX: min[0],\n      minY: min[1],\n      maxX: max[0],\n      maxY: max[1]\n    };\n  }\n\n  function getBBoxFromBezierGroup(points, lineWidth) {\n    var minX = Infinity;\n    var maxX = -Infinity;\n    var minY = Infinity;\n    var maxY = -Infinity;\n\n    for (var i = 0, len = points.length; i < len; i++) {\n      var bbox = cubicBezierBounds(points[i]);\n\n      if (bbox.minX < minX) {\n        minX = bbox.minX;\n      }\n\n      if (bbox.maxX > maxX) {\n        maxX = bbox.maxX;\n      }\n\n      if (bbox.minY < minY) {\n        minY = bbox.minY;\n      }\n\n      if (bbox.maxY > maxY) {\n        maxY = bbox.maxY;\n      }\n    }\n\n    lineWidth = lineWidth / 2 || 0;\n    return {\n      minX: minX - lineWidth,\n      minY: minY - lineWidth,\n      maxX: maxX + lineWidth,\n      maxY: maxY + lineWidth\n    };\n  }\n\n  var Line$1 = /*#__PURE__*/function (_Shape) {\n    _inheritsLoose(Line, _Shape);\n\n    function Line() {\n      return _Shape.apply(this, arguments) || this;\n    }\n\n    var _proto = Line.prototype;\n\n    _proto._initProperties = function _initProperties() {\n      _Shape.prototype._initProperties.call(this);\n\n      this._attrs.canStroke = true;\n      this._attrs.type = 'line';\n    };\n\n    _proto.getDefaultAttrs = function getDefaultAttrs() {\n      return {\n        x1: 0,\n        y1: 0,\n        x2: 0,\n        y2: 0,\n        lineWidth: 1\n      };\n    };\n\n    _proto.createPath = function createPath(context) {\n      var attrs = this.get('attrs');\n      var x1 = attrs.x1,\n          y1 = attrs.y1,\n          x2 = attrs.x2,\n          y2 = attrs.y2;\n      context.beginPath();\n      context.moveTo(x1, y1);\n      context.lineTo(x2, y2);\n    };\n\n    _proto.calculateBox = function calculateBox() {\n      var attrs = this.get('attrs');\n      var x1 = attrs.x1,\n          y1 = attrs.y1,\n          x2 = attrs.x2,\n          y2 = attrs.y2,\n          lineWidth = attrs.lineWidth;\n      return getBBoxFromLine(x1, y1, x2, y2, lineWidth);\n    };\n\n    return Line;\n  }(Shape$2);\n\n  var Polygon = /*#__PURE__*/function (_Shape) {\n    _inheritsLoose(Polygon, _Shape);\n\n    function Polygon() {\n      return _Shape.apply(this, arguments) || this;\n    }\n\n    var _proto = Polygon.prototype;\n\n    _proto._initProperties = function _initProperties() {\n      _Shape.prototype._initProperties.call(this);\n\n      this._attrs.canFill = true;\n      this._attrs.canStroke = true;\n      this._attrs.type = 'polygon';\n    };\n\n    _proto.getDefaultAttrs = function getDefaultAttrs() {\n      return {\n        points: null,\n        lineWidth: 0\n      };\n    };\n\n    _proto.createPath = function createPath(context) {\n      var self = this;\n      var attrs = self.get('attrs');\n      var points = attrs.points;\n      context.beginPath();\n\n      for (var i = 0, len = points.length; i < len; i++) {\n        var point = points[i];\n\n        if (i === 0) {\n          context.moveTo(point.x, point.y);\n        } else {\n          context.lineTo(point.x, point.y);\n        }\n      }\n\n      context.closePath();\n    };\n\n    _proto.calculateBox = function calculateBox() {\n      var attrs = this.get('attrs');\n      var points = attrs.points;\n      return getBBoxFromPoints(points);\n    };\n\n    return Polygon;\n  }(Shape$2);\n  /**\n   * @fileOverview convert the line to curve\n   * @author dxq613@gmail.com\n   */\n\n\n  function getPoint(v) {\n    return [v.x, v.y];\n  }\n\n  function smoothBezier(points, smooth, isLoop, constraint) {\n    var cps = [];\n    var prevPoint;\n    var nextPoint;\n    var hasConstraint = !!constraint;\n    var min;\n    var max;\n    var point;\n    var len;\n    var l;\n    var i;\n\n    if (hasConstraint) {\n      min = [Infinity, Infinity];\n      max = [-Infinity, -Infinity];\n\n      for (i = 0, l = points.length; i < l; i++) {\n        point = getPoint(points[i]);\n        Vector2.min(min, min, point);\n        Vector2.max(max, max, point);\n      }\n\n      Vector2.min(min, min, constraint[0]);\n      Vector2.max(max, max, constraint[1]);\n    }\n\n    for (i = 0, len = points.length; i < len; i++) {\n      point = getPoint(points[i]);\n\n      if (isLoop) {\n        prevPoint = getPoint(points[i ? i - 1 : len - 1]);\n        nextPoint = getPoint(points[(i + 1) % len]);\n      } else {\n        if (i === 0 || i === len - 1) {\n          cps.push([point[0], point[1]]);\n          continue;\n        } else {\n          prevPoint = getPoint(points[i - 1]);\n          nextPoint = getPoint(points[i + 1]);\n        }\n      }\n\n      var v = Vector2.sub([], nextPoint, prevPoint);\n      Vector2.scale(v, v, smooth);\n      var d0 = Vector2.distance(point, prevPoint);\n      var d1 = Vector2.distance(point, nextPoint);\n      var sum = d0 + d1;\n\n      if (sum !== 0) {\n        d0 /= sum;\n        d1 /= sum;\n      }\n\n      var v1 = Vector2.scale([], v, -d0);\n      var v2 = Vector2.scale([], v, d1);\n      var cp0 = Vector2.add([], point, v1);\n      var cp1 = Vector2.add([], point, v2);\n\n      if (hasConstraint) {\n        Vector2.max(cp0, cp0, min);\n        Vector2.min(cp0, cp0, max);\n        Vector2.max(cp1, cp1, min);\n        Vector2.min(cp1, cp1, max);\n      }\n\n      cps.push([cp0[0], cp0[1]]);\n      cps.push([cp1[0], cp1[1]]);\n    }\n\n    if (isLoop) {\n      cps.push(cps.shift());\n    }\n\n    return cps;\n  }\n\n  function catmullRom2bezier(pointList, z, constraint) {\n    var isLoop = !!z;\n    var controlPointList = smoothBezier(pointList, 0.4, isLoop, constraint);\n    var len = pointList.length;\n    var d1 = [];\n    var cp1;\n    var cp2;\n    var p;\n\n    for (var i = 0; i < len - 1; i++) {\n      cp1 = controlPointList[i * 2];\n      cp2 = controlPointList[i * 2 + 1];\n      p = pointList[i + 1];\n      d1.push(['C', cp1[0], cp1[1], cp2[0], cp2[1], p.x, p.y]);\n    }\n\n    if (isLoop) {\n      cp1 = controlPointList[len];\n      cp2 = controlPointList[len + 1];\n      p = pointList[0];\n      d1.push(['C', cp1[0], cp1[1], cp2[0], cp2[1], p.x, p.y]);\n    }\n\n    return d1;\n  }\n\n  function _filterPoints(points) {\n    var filteredPoints = [];\n\n    for (var i = 0, len = points.length; i < len; i++) {\n      var point = points[i];\n\n      if (!isNaN(point.x) && !isNaN(point.y)) {\n        filteredPoints.push(point);\n      }\n    }\n\n    return filteredPoints;\n  }\n\n  var Polyline = /*#__PURE__*/function (_Shape) {\n    _inheritsLoose(Polyline, _Shape);\n\n    function Polyline() {\n      return _Shape.apply(this, arguments) || this;\n    }\n\n    var _proto = Polyline.prototype;\n\n    _proto._initProperties = function _initProperties() {\n      _Shape.prototype._initProperties.call(this);\n\n      this._attrs.canFill = true;\n      this._attrs.canStroke = true;\n      this._attrs.type = 'polyline';\n    };\n\n    _proto.getDefaultAttrs = function getDefaultAttrs() {\n      return {\n        points: null,\n        lineWidth: 1,\n        smooth: false\n      };\n    };\n\n    _proto.createPath = function createPath(context) {\n      var self = this;\n      var attrs = self.get('attrs');\n      var points = attrs.points,\n          smooth = attrs.smooth;\n\n      var filteredPoints = _filterPoints(points);\n\n      context.beginPath();\n\n      if (filteredPoints.length) {\n        context.moveTo(filteredPoints[0].x, filteredPoints[0].y);\n\n        if (smooth) {\n          var constaint = [[0, 0], [1, 1]];\n          var sps = catmullRom2bezier(filteredPoints, false, constaint);\n\n          for (var i = 0, n = sps.length; i < n; i++) {\n            var sp = sps[i];\n            context.bezierCurveTo(sp[1], sp[2], sp[3], sp[4], sp[5], sp[6]);\n          }\n        } else {\n          var _i;\n\n          var l;\n\n          for (_i = 1, l = filteredPoints.length - 1; _i < l; _i++) {\n            context.lineTo(filteredPoints[_i].x, filteredPoints[_i].y);\n          }\n\n          context.lineTo(filteredPoints[l].x, filteredPoints[l].y);\n        }\n      }\n    };\n\n    _proto.calculateBox = function calculateBox() {\n      var attrs = this.get('attrs');\n      var points = attrs.points,\n          smooth = attrs.smooth,\n          lineWidth = attrs.lineWidth;\n\n      var filteredPoints = _filterPoints(points);\n\n      if (smooth) {\n        var newPoints = [];\n        var constaint = [[0, 0], [1, 1]];\n        var sps = catmullRom2bezier(filteredPoints, false, constaint);\n\n        for (var i = 0, n = sps.length; i < n; i++) {\n          var sp = sps[i];\n\n          if (i === 0) {\n            newPoints.push([filteredPoints[0].x, filteredPoints[0].y, sp[1], sp[2], sp[3], sp[4], sp[5], sp[6]]);\n          } else {\n            var lastPoint = sps[i - 1];\n            newPoints.push([lastPoint[5], lastPoint[6], sp[1], sp[2], sp[3], sp[4], sp[5], sp[6]]);\n          }\n        }\n\n        return getBBoxFromBezierGroup(newPoints, lineWidth);\n      }\n\n      return getBBoxFromPoints(filteredPoints, lineWidth);\n    };\n\n    return Polyline;\n  }(Shape$2);\n\n  var Arc = /*#__PURE__*/function (_Shape) {\n    _inheritsLoose(Arc, _Shape);\n\n    function Arc() {\n      return _Shape.apply(this, arguments) || this;\n    }\n\n    var _proto = Arc.prototype;\n\n    _proto._initProperties = function _initProperties() {\n      _Shape.prototype._initProperties.call(this);\n\n      this._attrs.canStroke = true;\n      this._attrs.canFill = true;\n      this._attrs.type = 'arc';\n    };\n\n    _proto.getDefaultAttrs = function getDefaultAttrs() {\n      return {\n        x: 0,\n        y: 0,\n        r: 0,\n        startAngle: 0,\n        endAngle: Math.PI * 2,\n        anticlockwise: false,\n        lineWidth: 1\n      };\n    };\n\n    _proto.createPath = function createPath(context) {\n      var attrs = this.get('attrs');\n      var x = attrs.x,\n          y = attrs.y,\n          r = attrs.r,\n          startAngle = attrs.startAngle,\n          endAngle = attrs.endAngle,\n          anticlockwise = attrs.anticlockwise;\n      context.beginPath();\n\n      if (startAngle !== endAngle) {\n        context.arc(x, y, r, startAngle, endAngle, anticlockwise);\n      }\n    };\n\n    _proto.calculateBox = function calculateBox() {\n      var attrs = this.get('attrs');\n      var x = attrs.x,\n          y = attrs.y,\n          r = attrs.r,\n          startAngle = attrs.startAngle,\n          endAngle = attrs.endAngle,\n          anticlockwise = attrs.anticlockwise;\n      return getBBoxFromArc(x, y, r, startAngle, endAngle, anticlockwise);\n    };\n\n    return Arc;\n  }(Shape$2);\n\n  var Sector = /*#__PURE__*/function (_Shape) {\n    _inheritsLoose(Sector, _Shape);\n\n    function Sector() {\n      return _Shape.apply(this, arguments) || this;\n    }\n\n    var _proto = Sector.prototype;\n\n    _proto._initProperties = function _initProperties() {\n      _Shape.prototype._initProperties.call(this);\n\n      this._attrs.canFill = true;\n      this._attrs.canStroke = true;\n      this._attrs.type = 'sector';\n    };\n\n    _proto.getDefaultAttrs = function getDefaultAttrs() {\n      return {\n        x: 0,\n        y: 0,\n        lineWidth: 0,\n        r: 0,\n        r0: 0,\n        startAngle: 0,\n        endAngle: Math.PI * 2,\n        anticlockwise: false\n      };\n    };\n\n    _proto.createPath = function createPath(context) {\n      var attrs = this.get('attrs');\n      var x = attrs.x,\n          y = attrs.y,\n          startAngle = attrs.startAngle,\n          endAngle = attrs.endAngle,\n          r = attrs.r,\n          r0 = attrs.r0,\n          anticlockwise = attrs.anticlockwise;\n      context.beginPath();\n      var unitX = Math.cos(startAngle);\n      var unitY = Math.sin(startAngle);\n      context.moveTo(unitX * r0 + x, unitY * r0 + y);\n      context.lineTo(unitX * r + x, unitY * r + y); // 当扇形的角度非常小的时候，就不进行弧线的绘制；或者整个只有1个扇形时，会出现end<0的情况不绘制\n\n      if (Math.abs(endAngle - startAngle) > 0.0001 || startAngle === 0 && endAngle < 0) {\n        context.arc(x, y, r, startAngle, endAngle, anticlockwise);\n        context.lineTo(Math.cos(endAngle) * r0 + x, Math.sin(endAngle) * r0 + y);\n\n        if (r0 !== 0) {\n          context.arc(x, y, r0, endAngle, startAngle, !anticlockwise);\n        }\n      }\n\n      context.closePath();\n    };\n\n    _proto.calculateBox = function calculateBox() {\n      var attrs = this.get('attrs');\n      var x = attrs.x,\n          y = attrs.y,\n          r = attrs.r,\n          r0 = attrs.r0,\n          startAngle = attrs.startAngle,\n          endAngle = attrs.endAngle,\n          anticlockwise = attrs.anticlockwise;\n      var outerBBox = getBBoxFromArc(x, y, r, startAngle, endAngle, anticlockwise);\n      var innerBBox = getBBoxFromArc(x, y, r0, startAngle, endAngle, anticlockwise);\n      return {\n        minX: Math.min(outerBBox.minX, innerBBox.minX),\n        minY: Math.min(outerBBox.minY, innerBBox.minY),\n        maxX: Math.max(outerBBox.maxX, innerBBox.maxX),\n        maxY: Math.max(outerBBox.maxY, innerBBox.maxY)\n      };\n    };\n\n    return Sector;\n  }(Shape$2);\n\n  var Rect$1 = {\n    calcRotatedBox: function calcRotatedBox(_ref) {\n      var width = _ref.width,\n          height = _ref.height,\n          rotate = _ref.rotate;\n      var absRotate = Math.abs(rotate);\n      return {\n        width: Math.abs(width * Math.cos(absRotate) + height * Math.sin(absRotate)),\n        height: Math.abs(height * Math.cos(absRotate) + width * Math.sin(absRotate))\n      };\n    }\n  };\n  var textWidthCacheCounter = 0;\n  var textWidthCache = {};\n  var TEXT_CACHE_MAX = 5000;\n\n  var Text = /*#__PURE__*/function (_Shape) {\n    _inheritsLoose(Text, _Shape);\n\n    function Text() {\n      return _Shape.apply(this, arguments) || this;\n    }\n\n    var _proto = Text.prototype;\n\n    _proto._initProperties = function _initProperties() {\n      _Shape.prototype._initProperties.call(this);\n\n      this._attrs.canFill = true;\n      this._attrs.canStroke = true;\n      this._attrs.type = 'text';\n    };\n\n    _proto.getDefaultAttrs = function getDefaultAttrs() {\n      return {\n        lineWidth: 0,\n        lineCount: 1,\n        fontSize: 12,\n        fontFamily: 'sans-serif',\n        fontStyle: 'normal',\n        fontWeight: 'normal',\n        fontVariant: 'normal',\n        textAlign: 'start',\n        textBaseline: 'bottom',\n        lineHeight: null,\n        textArr: null\n      };\n    };\n\n    _proto._getFontStyle = function _getFontStyle() {\n      var attrs = this._attrs.attrs;\n      var fontSize = attrs.fontSize,\n          fontFamily = attrs.fontFamily,\n          fontWeight = attrs.fontWeight,\n          fontStyle = attrs.fontStyle,\n          fontVariant = attrs.fontVariant;\n      return fontStyle + \" \" + fontVariant + \" \" + fontWeight + \" \" + fontSize + \"px \" + fontFamily;\n    };\n\n    _proto._afterAttrsSet = function _afterAttrsSet() {\n      var attrs = this._attrs.attrs;\n      attrs.font = this._getFontStyle();\n\n      if (attrs.text) {\n        var text = attrs.text;\n        var textArr = null;\n        var lineCount = 1;\n\n        if (isString(text) && text.indexOf('\\n') !== -1) {\n          textArr = text.split('\\n');\n          lineCount = textArr.length;\n        }\n\n        attrs.lineCount = lineCount;\n        attrs.textArr = textArr;\n      }\n\n      this.set('attrs', attrs);\n    };\n\n    _proto._getTextHeight = function _getTextHeight() {\n      var attrs = this._attrs.attrs;\n\n      if (attrs.height) {\n        return attrs.height;\n      }\n\n      var lineCount = attrs.lineCount;\n      var fontSize = attrs.fontSize * 1;\n\n      if (lineCount > 1) {\n        var spaceingY = this._getSpaceingY();\n\n        return fontSize * lineCount + spaceingY * (lineCount - 1);\n      }\n\n      return fontSize;\n    };\n\n    _proto._getSpaceingY = function _getSpaceingY() {\n      var attrs = this._attrs.attrs;\n      var lineHeight = attrs.lineHeight;\n      var fontSize = attrs.fontSize * 1;\n      return lineHeight ? lineHeight - fontSize : fontSize * 0.14;\n    };\n\n    _proto.drawInner = function drawInner(context) {\n      var self = this;\n      var attrs = self._attrs.attrs;\n      var text = attrs.text;\n      var x = attrs.x;\n      var y = attrs.y;\n\n      if (isNil(text) || isNaN(x) || isNaN(y)) {\n        // text will be 0\n        return;\n      }\n\n      var textArr = attrs.textArr;\n      var fontSize = attrs.fontSize * 1;\n\n      var spaceingY = self._getSpaceingY();\n\n      if (attrs.rotate) {\n        // do rotation\n        context.translate(x, y);\n        context.rotate(attrs.rotate);\n        x = 0;\n        y = 0;\n      }\n\n      var textBaseline = attrs.textBaseline;\n      var height;\n\n      if (textArr) {\n        height = self._getTextHeight();\n      }\n\n      var subY; // context.beginPath();\n\n      if (self.hasFill()) {\n        var fillOpacity = attrs.fillOpacity;\n\n        if (!isNil(fillOpacity) && fillOpacity !== 1) {\n          context.globalAlpha = fillOpacity;\n        }\n\n        if (textArr) {\n          for (var i = 0, len = textArr.length; i < len; i++) {\n            var subText = textArr[i];\n            subY = y + i * (spaceingY + fontSize) - height + fontSize; // bottom;\n\n            if (textBaseline === 'middle') {\n              subY += height - fontSize - (height - fontSize) / 2;\n            }\n\n            if (textBaseline === 'top') {\n              subY += height - fontSize;\n            }\n\n            context.fillText(subText, x, subY);\n          }\n        } else {\n          context.fillText(text, x, y);\n        }\n      }\n\n      if (self.hasStroke()) {\n        if (textArr) {\n          for (var _i = 0, _len = textArr.length; _i < _len; _i++) {\n            var _subText = textArr[_i];\n            subY = y + _i * (spaceingY + fontSize) - height + fontSize; // bottom;\n\n            if (textBaseline === 'middle') {\n              subY += height - fontSize - (height - fontSize) / 2;\n            }\n\n            if (textBaseline === 'top') {\n              subY += height - fontSize;\n            }\n\n            context.strokeText(_subText, x, subY);\n          }\n        } else {\n          context.strokeText(text, x, y);\n        }\n      }\n    };\n\n    _proto._getAriaLabel = function _getAriaLabel() {\n      return this._attrs.attrs.text;\n    };\n\n    _proto.calculateBox = function calculateBox() {\n      var self = this;\n      var attrs = self._attrs.attrs;\n      var x = attrs.x,\n          y = attrs.y,\n          textAlign = attrs.textAlign,\n          textBaseline = attrs.textBaseline;\n\n      var width = self._getTextWidth(); // attrs.width\n\n\n      if (!width) {\n        return {\n          minX: x,\n          minY: y,\n          maxX: x,\n          maxY: y\n        };\n      }\n\n      var height = self._getTextHeight(); // attrs.height\n\n\n      if (attrs.rotate) {\n        var rotatedBox = Rect$1.calcRotatedBox({\n          width: width,\n          height: height,\n          rotate: attrs.rotate\n        });\n        width = rotatedBox.width;\n        height = rotatedBox.height;\n      }\n\n      var point = {\n        x: x,\n        y: y - height\n      }; // default textAlign: start, textBaseline: bottom\n\n      if (textAlign) {\n        if (textAlign === 'end' || textAlign === 'right') {\n          point.x -= width;\n        } else if (textAlign === 'center') {\n          point.x -= width / 2;\n        }\n      }\n\n      if (textBaseline) {\n        if (textBaseline === 'top') {\n          point.y += height;\n        } else if (textBaseline === 'middle') {\n          point.y += height / 2;\n        }\n      }\n\n      return {\n        minX: point.x,\n        minY: point.y,\n        maxX: point.x + width,\n        maxY: point.y + height\n      };\n    };\n\n    _proto._getTextWidth = function _getTextWidth() {\n      var attrs = this._attrs.attrs;\n\n      if (attrs.width) {\n        return attrs.width;\n      }\n\n      var text = attrs.text;\n      var context = this.get('context');\n      if (isNil(text)) return undefined;\n      var font = attrs.font;\n      var textArr = attrs.textArr;\n      var key = text + '' + font;\n\n      if (textWidthCache[key]) {\n        return textWidthCache[key];\n      }\n\n      var width = 0;\n\n      if (textArr) {\n        for (var i = 0, length = textArr.length; i < length; i++) {\n          var subText = textArr[i];\n          width = Math.max(width, measureText(subText, font, context).width);\n        }\n      } else {\n        width = measureText(text, font, context).width;\n      }\n\n      if (textWidthCacheCounter > TEXT_CACHE_MAX) {\n        textWidthCacheCounter = 0;\n        textWidthCache = {};\n      }\n\n      textWidthCacheCounter++;\n      textWidthCache[key] = width;\n      return width;\n    };\n\n    return Text;\n  }(Shape$2);\n\n  var Custom = /*#__PURE__*/function (_Shape) {\n    _inheritsLoose(Custom, _Shape);\n\n    function Custom() {\n      return _Shape.apply(this, arguments) || this;\n    }\n\n    var _proto = Custom.prototype;\n\n    _proto._initProperties = function _initProperties() {\n      _Shape.prototype._initProperties.call(this);\n\n      this._attrs.canFill = true;\n      this._attrs.canStroke = true;\n      this._attrs.createPath = null;\n      this._attrs.type = 'custom';\n    };\n\n    _proto.createPath = function createPath(context) {\n      var createPath = this.get('createPath');\n      createPath && createPath.call(this, context);\n    };\n\n    _proto.calculateBox = function calculateBox() {\n      var calculateBox = this.get('calculateBox');\n      return calculateBox && calculateBox.call(this);\n    };\n\n    return Custom;\n  }(Shape$2);\n\n  var SYMBOLS = {\n    circle: function circle(x, y, r, ctx) {\n      ctx.arc(x, y, r, 0, Math.PI * 2, false);\n    },\n    square: function square(x, y, r, ctx) {\n      ctx.moveTo(x - r, y - r);\n      ctx.lineTo(x + r, y - r);\n      ctx.lineTo(x + r, y + r);\n      ctx.lineTo(x - r, y + r);\n      ctx.closePath();\n    }\n  };\n\n  var Marker = /*#__PURE__*/function (_Shape) {\n    _inheritsLoose(Marker, _Shape);\n\n    function Marker() {\n      return _Shape.apply(this, arguments) || this;\n    }\n\n    var _proto = Marker.prototype;\n\n    _proto._initProperties = function _initProperties() {\n      _Shape.prototype._initProperties.call(this);\n\n      this._attrs.canFill = true;\n      this._attrs.canStroke = true;\n      this._attrs.type = 'marker';\n    };\n\n    _proto.getDefaultAttrs = function getDefaultAttrs() {\n      return {\n        x: 0,\n        y: 0,\n        lineWidth: 0\n      };\n    };\n\n    _proto.createPath = function createPath(context) {\n      var attrs = this.get('attrs');\n      var x = attrs.x,\n          y = attrs.y,\n          radius = attrs.radius;\n      var symbol = attrs.symbol || 'circle';\n      var method;\n\n      if (isFunction(symbol)) {\n        method = symbol;\n      } else {\n        method = SYMBOLS[symbol];\n      }\n\n      context.beginPath();\n      method(x, y, radius, context, this);\n    };\n\n    _proto.calculateBox = function calculateBox() {\n      var attrs = this.get('attrs');\n      var x = attrs.x,\n          y = attrs.y,\n          radius = attrs.radius;\n      return {\n        minX: x - radius,\n        minY: y - radius,\n        maxX: x + radius,\n        maxY: y + radius\n      };\n    };\n\n    return Marker;\n  }(Shape$2);\n\n  Shape$2.Rect = Rect;\n  Shape$2.Image = ImageShape;\n  Shape$2.Circle = Circle;\n  Shape$2.Line = Line$1;\n  Shape$2.Polygon = Polygon;\n  Shape$2.Polyline = Polyline;\n  Shape$2.Arc = Arc;\n  Shape$2.Sector = Sector;\n  Shape$2.Text = Text;\n  Shape$2.Custom = Custom;\n  Shape$2.Marker = Marker;\n  var SHAPE_MAP = {};\n  var INDEX = '_INDEX';\n\n  function getComparer(compare) {\n    return function (left, right) {\n      var result = compare(left, right);\n      return result === 0 ? left[INDEX] - right[INDEX] : result;\n    };\n  }\n\n  var Container = {\n    getGroupClass: function getGroupClass() {},\n    getChildren: function getChildren() {\n      return this.get('children');\n    },\n    addShape: function addShape(type, cfg) {\n      if (cfg === void 0) {\n        cfg = {};\n      }\n\n      var shapeType = SHAPE_MAP[type];\n\n      if (!shapeType) {\n        shapeType = upperFirst(type);\n        SHAPE_MAP[type] = shapeType;\n      }\n\n      var shape = new Shape$2[shapeType](cfg);\n      this.add(shape);\n      return shape;\n    },\n    addGroup: function addGroup(cfg) {\n      var groupClass = this.getGroupClass();\n      var rst = new groupClass(cfg);\n      this.add(rst);\n      return rst;\n    },\n    contain: function contain(item) {\n      var children = this.get('children');\n      return children.indexOf(item) > -1;\n    },\n    sort: function sort() {\n      var children = this.get('children');\n\n      for (var i = 0, len = children.length; i < len; i++) {\n        var child = children[i];\n        child[INDEX] = i;\n      }\n\n      children.sort(getComparer(function (obj1, obj2) {\n        return obj1.get('zIndex') - obj2.get('zIndex');\n      }));\n      return this;\n    },\n    drawChildren: function drawChildren(context) {\n      var children = this.get('children');\n\n      for (var i = 0, len = children.length; i < len; i++) {\n        var child = children[i];\n        child.draw(context);\n      }\n\n      return this;\n    },\n    clear: function clear() {\n      var children = this.get('children');\n\n      while (children.length !== 0) {\n        children[children.length - 1].remove(true);\n      }\n\n      return this;\n    },\n    add: function add(items) {\n      var self = this;\n      var children = self.get('children');\n\n      if (!isArray(items)) {\n        items = [items];\n      }\n\n      for (var i = 0, len = items.length; i < len; i++) {\n        var item = items[i];\n        var parent = item.get('parent');\n\n        if (parent) {\n          var descendants = parent.get('children');\n          remove(descendants, item);\n        }\n\n        self._setEvn(item);\n\n        children.push(item);\n      }\n\n      return self;\n    },\n    _setEvn: function _setEvn(item) {\n      var self = this;\n      var _self$_attrs = self._attrs,\n          context = _self$_attrs.context,\n          canvas = _self$_attrs.canvas,\n          aria = _self$_attrs.aria;\n      var _item$_attrs = item._attrs,\n          isGroup = _item$_attrs.isGroup,\n          type = _item$_attrs.type;\n      item._attrs.parent = self;\n      item._attrs.context = context;\n      item._attrs.canvas = canvas; // 是否需要无障碍处理\n\n      if (aria && item._attrs.aria !== false) {\n        item._attrs.aria = aria;\n      }\n\n      if (type === 'text' && canvas && canvas.get('fontFamily')) {\n        item._attrs.attrs.fontFamily = item._attrs.attrs.fontFamily || canvas.get('fontFamily');\n      }\n\n      var clip = item._attrs.attrs.clip;\n\n      if (clip) {\n        clip._attrs.parent = self;\n        clip._attrs.context = context;\n        clip._attrs.canvas = canvas;\n      }\n\n      if (isGroup) {\n        var children = item._attrs.children;\n\n        for (var i = 0, len = children.length; i < len; i++) {\n          item._setEvn(children[i]);\n        }\n      }\n    },\n    _getAriaLabel: function _getAriaLabel() {\n      var _this$_attrs = this._attrs,\n          aria = _this$_attrs.aria,\n          ariaLabel = _this$_attrs.ariaLabel,\n          children = _this$_attrs.children; // 主动关闭\n\n      if (!aria) return;\n      var childAriaLabels = [];\n\n      if (children && children.length) {\n        for (var i = 0, len = children.length; i < len; i++) {\n          var _childAriaLabel = children[i].getAriaLabel();\n\n          if (_childAriaLabel) {\n            childAriaLabels.push(_childAriaLabel);\n          }\n        }\n      }\n\n      var childAriaLabel = childAriaLabels.join(' '); // 2个都有时拼接成完整句子\n\n      if (ariaLabel && childAriaLabel) {\n        return ariaLabel + \" \" + childAriaLabel + \" \";\n      } // 只有1个，或者都没有\n\n\n      return ariaLabel || childAriaLabel;\n    }\n  };\n\n  var Group = /*#__PURE__*/function (_Rect) {\n    _inheritsLoose(Group, _Rect);\n\n    function Group() {\n      return _Rect.apply(this, arguments) || this;\n    }\n\n    var _proto = Group.prototype;\n\n    _proto._initProperties = function _initProperties() {\n      this._attrs = {\n        type: 'group',\n        zIndex: 0,\n        visible: true,\n        destroyed: false,\n        isGroup: true,\n        canFill: true,\n        canStroke: true,\n        attrs: {},\n        children: []\n      };\n    };\n\n    _proto.getBBox = function getBBox() {\n      var self = this;\n      var minX = Infinity;\n      var maxX = -Infinity;\n      var minY = Infinity;\n      var maxY = -Infinity;\n      var children = self.get('children');\n\n      for (var i = 0, length = children.length; i < length; i++) {\n        var child = children[i];\n\n        if (child.get('visible')) {\n          var box = child.getBBox();\n\n          if (!box) {\n            continue;\n          }\n\n          var leftTop = [box.minX, box.minY];\n          var leftBottom = [box.minX, box.maxY];\n          var rightTop = [box.maxX, box.minY];\n          var rightBottom = [box.maxX, box.maxY];\n          var matrix = child.attr('matrix');\n          Vector2.transformMat2d(leftTop, leftTop, matrix);\n          Vector2.transformMat2d(leftBottom, leftBottom, matrix);\n          Vector2.transformMat2d(rightTop, rightTop, matrix);\n          Vector2.transformMat2d(rightBottom, rightBottom, matrix);\n          minX = Math.min(leftTop[0], leftBottom[0], rightTop[0], rightBottom[0], minX);\n          maxX = Math.max(leftTop[0], leftBottom[0], rightTop[0], rightBottom[0], maxX);\n          minY = Math.min(leftTop[1], leftBottom[1], rightTop[1], rightBottom[1], minY);\n          maxY = Math.max(leftTop[1], leftBottom[1], rightTop[1], rightBottom[1], maxY);\n        }\n      }\n\n      return {\n        minX: minX,\n        minY: minY,\n        maxX: maxX,\n        maxY: maxY,\n        x: minX,\n        y: minY,\n        width: maxX - minX,\n        height: maxY - minY\n      };\n    };\n\n    _proto.createPath = function createPath(context) {\n      var attrs = this.get('attrs'); // 只有在有fillStyle或strokeStyle 时才需要绘制\n\n      if (!attrs.fillStyle && !attrs.strokeStyle) {\n        return;\n      }\n\n      _Rect.prototype.createPath.call(this, context);\n    };\n\n    _proto.drawInner = function drawInner(context) {\n      _Rect.prototype.drawInner.call(this, context);\n\n      this.drawChildren(context);\n    };\n\n    _proto.destroy = function destroy() {\n      if (this.get('destroyed')) {\n        return;\n      }\n\n      this.clear();\n\n      _Rect.prototype.destroy.call(this);\n    };\n\n    return Group;\n  }(Rect);\n\n  mix(Group.prototype, Container, {\n    getGroupClass: function getGroupClass() {\n      return Group;\n    }\n  });\n  var requestAnimationFrame = typeof window === 'object' && window.requestAnimationFrame ? window.requestAnimationFrame : function (fn) {\n    return setTimeout(fn, 16);\n  };\n\n  var Canvas = /*#__PURE__*/function (_EventEmit) {\n    _inheritsLoose(Canvas, _EventEmit);\n\n    var _proto = Canvas.prototype;\n\n    _proto.get = function get(name) {\n      return this._attrs[name];\n    };\n\n    _proto.set = function set(name, value) {\n      this._attrs[name] = value;\n    };\n\n    function Canvas(cfg) {\n      var _this;\n\n      _this = _EventEmit.call(this) || this;\n      var title = cfg.title;\n      var ariaLabel = title ? substitute(lang.general.withTitle, {\n        title: title\n      }) : lang.general.title;\n      _this._attrs = mix({\n        type: 'canvas',\n        children: [],\n        ariaLabel: ariaLabel\n      }, cfg);\n\n      _this._initPixelRatio();\n\n      _this._initCanvas();\n\n      return _this;\n    }\n\n    _proto._initPixelRatio = function _initPixelRatio() {\n      var pixelRatio = this.get('pixelRatio');\n\n      if (!pixelRatio) {\n        this.set('pixelRatio', getPixelRatio());\n      }\n    };\n\n    _proto.beforeDraw = function beforeDraw() {\n      var context = this._attrs.context;\n      var el = this._attrs.el;\n      context && context.clearRect && context.clearRect(0, 0, el.width, el.height);\n    };\n\n    _proto._initCanvas = function _initCanvas() {\n      var self = this;\n      var el = self.get('el');\n      var context = self.get('context');\n\n      if (!el && !context) {\n        throw new Error('Please specify the id, el or context of the chart!');\n      }\n\n      var canvas;\n\n      if (el) {\n        // DOMElement or String\n        canvas = isString(el) ? getDomById(el) : el;\n      } else {\n        // 说明没有指定el\n        canvas = CanvasElement$1.create(context);\n      }\n\n      if (context && canvas && !canvas.getContext) {\n        canvas.getContext = function () {\n          return context;\n        };\n      }\n\n      var width = self.get('width');\n\n      if (!width) {\n        width = getWidth(canvas);\n      }\n\n      var height = self.get('height');\n\n      if (!height) {\n        height = getHeight(canvas);\n      }\n\n      self.set('canvas', this);\n      self.set('el', canvas);\n      self.set('context', context || canvas.getContext('2d'));\n      self.changeSize(width, height); // 初始化事件控制器\n\n      var eventController = new EventController({\n        canvas: this,\n        el: canvas\n      });\n      self.set('eventController', eventController);\n    };\n\n    _proto.changeSize = function changeSize(width, height) {\n      var pixelRatio = this.get('pixelRatio');\n      var canvasDOM = this.get('el'); // HTMLCanvasElement or canvasElement\n      // 浏览器环境设置style样式\n\n      if (canvasDOM.style) {\n        canvasDOM.style.width = width + 'px';\n        canvasDOM.style.height = height + 'px';\n      }\n\n      if (isCanvasElement(canvasDOM)) {\n        canvasDOM.width = width * pixelRatio;\n        canvasDOM.height = height * pixelRatio;\n\n        if (pixelRatio !== 1) {\n          var ctx = this.get('context');\n          ctx.scale(pixelRatio, pixelRatio);\n        }\n      }\n\n      this.set('width', width);\n      this.set('height', height);\n    };\n\n    _proto.getWidth = function getWidth() {\n      var pixelRatio = this.get('pixelRatio');\n      var width = this.get('width');\n      return width * pixelRatio;\n    };\n\n    _proto.getHeight = function getHeight() {\n      var pixelRatio = this.get('pixelRatio');\n      var height = this.get('height');\n      return height * pixelRatio;\n    };\n\n    _proto.getPointByClient = function getPointByClient(clientX, clientY) {\n      var el = this.get('el');\n      var bbox = el.getBoundingClientRect();\n      var width = bbox.right - bbox.left;\n      var height = bbox.bottom - bbox.top;\n      return {\n        x: (clientX - bbox.left) * (el.width / width),\n        y: (clientY - bbox.top) * (el.height / height)\n      };\n    };\n\n    _proto._beginDraw = function _beginDraw() {\n      this._attrs.toDraw = true;\n    };\n\n    _proto._endDraw = function _endDraw() {\n      this._attrs.toDraw = false;\n    };\n\n    _proto.draw = function draw() {\n      var self = this;\n\n      function drawInner() {\n        self.set('animateHandler', requestAnimationFrame(function () {\n          self.set('animateHandler', undefined);\n\n          if (self.get('toDraw')) {\n            drawInner();\n          }\n        }));\n        self.beforeDraw();\n\n        try {\n          var context = self._attrs.context;\n          self.drawChildren(context); // 支付宝，微信小程序，需要调context.draw才能完成绘制， 所以这里直接判断是否有.draw方法\n\n          if (context.draw) {\n            context.draw();\n          } // 设置无障碍文本\n\n\n          self.setAriaLabel();\n        } catch (ev) {\n          console.warn('error in draw canvas, detail as:');\n          console.warn(ev);\n\n          self._endDraw();\n        }\n\n        self._endDraw();\n      }\n\n      if (self.get('destroyed')) {\n        return;\n      }\n\n      if (self.get('animateHandler')) {\n        this._beginDraw();\n      } else {\n        drawInner();\n      }\n    } // 设置无障碍文本\n    ;\n\n    _proto.setAriaLabel = function setAriaLabel() {\n      var el = this._attrs.el;\n\n      var ariaLabel = this._getAriaLabel();\n\n      if (ariaLabel && el.setAttribute) {\n        el.setAttribute('aria-label', ariaLabel);\n      }\n    };\n\n    _proto.destroy = function destroy() {\n      if (this.get('destroyed')) {\n        return;\n      } // 需要清理 canvas 画布内容，否则会导致 spa 应用 ios 下 canvas 白屏\n      // https://stackoverflow.com/questions/52532614/total-canvas-memory-use-exceeds-the-maximum-limit-safari-12\n      // https://github.com/antvis/F2/issues/630\n\n\n      var el = this.get('el');\n      el.width = 0;\n      el.height = 0;\n      this.clear();\n      this._attrs = {};\n      this.set('destroyed', true);\n    };\n\n    _proto.isDestroyed = function isDestroyed() {\n      return this.get('destroyed');\n    };\n\n    return Canvas;\n  }(EventEmit);\n\n  mix(Canvas.prototype, Container, {\n    getGroupClass: function getGroupClass() {\n      return Group;\n    }\n  });\n  var engines = {};\n\n  function registerEngine(name, engine) {\n    engines[name] = engine;\n  }\n\n  function getEngine(name) {\n    var G = engines[name];\n\n    if (G) {\n      return G;\n    }\n\n    return {\n      Canvas: Canvas,\n      Group: Group,\n      Shape: Shape$2\n    };\n  }\n\n  function createCanvas(cfg) {\n    var renderer = cfg.renderer;\n    var G = getEngine(renderer);\n    return new G.Canvas(cfg);\n  }\n\n  var G = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    registerEngine: registerEngine,\n    getEngine: getEngine,\n    createCanvas: createCanvas,\n    Canvas: Canvas,\n    Group: Group,\n    Shape: Shape$2,\n    Matrix: Matrix,\n    Vector2: Vector2\n  });\n\n  function getClip(coord) {\n    var start = coord.start;\n    var end = coord.end;\n    var width = end.x - start.x;\n    var height = Math.abs(end.y - start.y);\n    var margin = 10;\n    var clip;\n\n    if (coord.isPolar) {\n      var circleRadius = coord.circleRadius,\n          center = coord.center,\n          startAngle = coord.startAngle,\n          endAngle = coord.endAngle;\n      clip = new Shape$2.Sector({\n        attrs: {\n          x: center.x,\n          y: center.y,\n          r: circleRadius,\n          r0: 0,\n          startAngle: startAngle,\n          endAngle: endAngle\n        }\n      });\n    } else {\n      clip = new Shape$2.Rect({\n        attrs: {\n          x: start.x,\n          y: end.y - margin,\n          width: width,\n          height: height + 2 * margin\n        }\n      });\n    }\n\n    clip.isClip = true;\n    return clip;\n  }\n\n  function isPointInPlot(point, plot) {\n    var x = point.x,\n        y = point.y;\n    var tl = plot.tl,\n        tr = plot.tr,\n        br = plot.br;\n    return x >= tl.x && x <= tr.x && y >= tl.y && y <= br.y;\n  }\n\n  var Helper = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    getClip: getClip,\n    isPointInPlot: isPointInPlot\n  });\n\n  function compare(a, b) {\n    return a - b;\n  }\n\n  function _isScaleExist(scales, compareScale) {\n    var flag = false;\n    each(scales, function (scale) {\n      var scaleValues = [].concat(scale.values);\n      var compareScaleValues = [].concat(compareScale.values);\n\n      if (scale.type === compareScale.type && scale.field === compareScale.field && scaleValues.sort(compare).toString() === compareScaleValues.sort(compare).toString()) {\n        flag = true;\n        return;\n      }\n    });\n    return flag;\n  }\n\n  var Chart = /*#__PURE__*/function (_Base) {\n    _inheritsLoose(Chart, _Base);\n\n    Chart.initPlugins = function initPlugins() {\n      return {\n        _plugins: [],\n        _cacheId: 0,\n        register: function register(plugins) {\n          var p = this._plugins;\n          [].concat(plugins).forEach(function (plugin) {\n            if (p.indexOf(plugin) === -1) {\n              p.push(plugin);\n            }\n          });\n          this._cacheId++;\n        },\n        unregister: function unregister(plugins) {\n          var p = this._plugins;\n          [].concat(plugins).forEach(function (plugin) {\n            var idx = p.indexOf(plugin);\n\n            if (idx !== -1) {\n              p.splice(idx, 1);\n            }\n          });\n          this._cacheId++;\n        },\n        clear: function clear() {\n          this._plugins = [];\n          this._cacheId++;\n        },\n        count: function count() {\n          return this._plugins.length;\n        },\n        getAll: function getAll() {\n          return this._plugins;\n        },\n        notify: function notify(chart, hook, args) {\n          var descriptors = this.descriptors(chart);\n          var ilen = descriptors.length;\n          var i;\n          var descriptor;\n          var plugin;\n          var params;\n          var method;\n\n          for (i = 0; i < ilen; ++i) {\n            descriptor = descriptors[i];\n            plugin = descriptor.plugin;\n            method = plugin[hook];\n\n            if (typeof method === 'function') {\n              params = [chart].concat(args || []);\n\n              if (method.apply(plugin, params) === false) {\n                return false;\n              }\n            }\n          }\n\n          return true;\n        },\n        descriptors: function descriptors(chart) {\n          var cache = chart._plugins || (chart._plugins = {});\n\n          if (cache.id === this._cacheId) {\n            return cache.descriptors;\n          }\n\n          var plugins = [];\n          var descriptors = [];\n\n          this._plugins.concat(chart && chart.get('plugins') || []).forEach(function (plugin) {\n            var idx = plugins.indexOf(plugin);\n\n            if (idx !== -1) {\n              return;\n            }\n\n            plugins.push(plugin);\n            descriptors.push({\n              plugin: plugin\n            });\n          });\n\n          cache.descriptors = descriptors;\n          cache.id = this._cacheId;\n          return descriptors;\n        }\n      };\n    };\n\n    var _proto = Chart.prototype;\n\n    _proto.getDefaultCfg = function getDefaultCfg() {\n      return {\n        /**\n         * the id of canvas\n         * @type {String}\n         */\n        id: null,\n\n        /** 图表渲染引擎 */\n        renderer: 'canvas',\n        rendered: false,\n\n        /**\n         * padding\n         * @type {Array|Number}\n         */\n        padding: Global.padding,\n\n        /**\n         * data\n         * @type {Array}\n         */\n        data: null,\n\n        /**\n         * scales of chart\n         * @type {Object}\n         */\n        scales: {},\n\n        /**\n         * @private\n         * geometry instances\n         * @type {Array}\n         */\n        geoms: [],\n\n        /**\n         * scale configuration\n         * @type {Object}\n         */\n        colDefs: null,\n        pixelRatio: Global.pixelRatio,\n\n        /**\n         * filter options\n         * @type {Object}\n         */\n        filters: null,\n        appendPadding: Global.appendPadding\n      };\n    };\n\n    _proto._syncYScales = function _syncYScales() {\n      var syncY = this.get('syncY');\n\n      if (!syncY) {\n        return;\n      }\n\n      var geoms = this.get('geoms');\n      var syncScales = [];\n      var min = [];\n      var max = [];\n      each(geoms, function (geom) {\n        var yScale = geom.getYScale();\n\n        if (yScale.isLinear) {\n          syncScales.push(yScale);\n          min.push(yScale.min);\n          max.push(yScale.max);\n        }\n      });\n      min = Math.min.apply(null, min);\n      max = Math.max.apply(null, max);\n      each(syncScales, function (scale) {\n        scale.change({\n          min: min\n        });\n        scale.change({\n          max: max\n        });\n      });\n    };\n\n    _proto._getFieldsForLegend = function _getFieldsForLegend() {\n      var fields = [];\n      var geoms = this.get('geoms');\n      each(geoms, function (geom) {\n        var attrOptions = geom.get('attrOptions');\n        var attrCfg = attrOptions.color;\n\n        if (attrCfg && attrCfg.field && isString(attrCfg.field)) {\n          var arr = attrCfg.field.split('*');\n          each(arr, function (item) {\n            if (fields.indexOf(item) === -1) {\n              fields.push(item);\n            }\n          });\n        }\n      });\n      return fields;\n    };\n\n    _proto._getScaleData = function _getScaleData(field) {\n      var data = this.get('data');\n      var filteredData = this.get('filteredData');\n\n      if (filteredData.length) {\n        var legendFields = this._getFieldsForLegend();\n\n        if (legendFields.indexOf(field) === -1) {\n          data = filteredData;\n        }\n      }\n\n      return data;\n    } // _updateScales() {\n    //   const scaleController = this.get('scaleController');\n    //   scaleController.updateScales();\n    //   this._adjustScale();\n    // }\n    ;\n\n    _proto._adjustScale = function _adjustScale() {\n      var self = this;\n      var scaleController = self.get('scaleController'); // 看起来是为了让柱状图最小或最大都默认从0开始\n\n      var geoms = this.get('geoms');\n\n      for (var i = 0; i < geoms.length; i++) {\n        var geom = geoms[i];\n\n        if (geom.get('type') === 'interval') {\n          var yScale = geom.getYScale();\n          scaleController.adjustStartZero(yScale);\n        }\n      }\n    };\n\n    _proto._removeGeoms = function _removeGeoms() {\n      var geoms = this.get('geoms');\n\n      while (geoms.length > 0) {\n        var geom = geoms.shift();\n        geom.destroy();\n      }\n    };\n\n    _proto._clearGeoms = function _clearGeoms() {\n      var geoms = this.get('geoms');\n\n      for (var i = 0, length = geoms.length; i < length; i++) {\n        var geom = geoms[i];\n        geom.clear();\n      }\n    };\n\n    _proto._clearInner = function _clearInner() {\n      this._clearGeoms();\n\n      Chart.plugins.notify(this, 'clearInner');\n      this.emit(EVENT_CLEAR_INNER);\n      this.get('axisController') && this.get('axisController').clear();\n    };\n\n    _proto._initFilteredData = function _initFilteredData() {\n      var filters = this.get('filters');\n      var data = this.get('data') || [];\n\n      if (filters) {\n        data = data.filter(function (obj) {\n          var rst = true;\n          each(filters, function (fn, k) {\n            if (fn) {\n              rst = fn(obj[k], obj);\n\n              if (!rst) {\n                return false;\n              }\n            }\n          });\n          return rst;\n        });\n      }\n\n      this.set('filteredData', data);\n    };\n\n    _proto._changeGeomsData = function _changeGeomsData() {\n      var geoms = this.get('geoms');\n      var data = this.get('filteredData');\n\n      for (var i = 0, length = geoms.length; i < length; i++) {\n        var geom = geoms[i];\n        geom.changeData(data);\n      }\n    };\n\n    _proto._initGeom = function _initGeom(geom) {\n      if (geom.get('isInit')) {\n        return;\n      }\n\n      var coord = this.get('coord');\n      var data = this.get('filteredData');\n      var colDefs = this.get('colDefs');\n      var middlePlot = this.get('middlePlot');\n      geom.set('chart', this);\n      geom.set('container', middlePlot.addGroup());\n      geom.set('data', data);\n      geom.set('coord', coord);\n      geom.set('colDefs', colDefs);\n      geom.init();\n      this.emit(EVENT_AFTER_GEOM_INIT, geom);\n    };\n\n    _proto._initGeoms = function _initGeoms() {\n      var geoms = this.get('geoms');\n\n      for (var i = 0, length = geoms.length; i < length; i++) {\n        this._initGeom(geoms[i]);\n      }\n    };\n\n    _proto._initCoord = function _initCoord() {\n      var plot = this.get('plotRange');\n      var coordCfg = mix({\n        type: 'cartesian'\n      }, this.get('coordCfg'), {\n        plot: plot\n      });\n      var type = coordCfg.type;\n      var C = Base$1[upperFirst(type)];\n      var coord = new C(coordCfg);\n      this.set('coord', coord);\n    };\n\n    _proto._initLayout = function _initLayout() {\n      var padding = this.get('_padding');\n\n      if (!padding) {\n        padding = this.get('margin') || this.get('padding');\n        padding = parsePadding(padding);\n      }\n\n      var top = padding[0] === 'auto' ? 0 : padding[0];\n      var right = padding[1] === 'auto' ? 0 : padding[1];\n      var bottom = padding[2] === 'auto' ? 0 : padding[2];\n      var left = padding[3] === 'auto' ? 0 : padding[3];\n      var width = this.get('width');\n      var height = this.get('height');\n      var start = {\n        x: left,\n        y: top\n      };\n      var end = {\n        x: width - right,\n        y: height - bottom\n      };\n      var plot = this.get('plot');\n\n      if (plot) {\n        plot.reset(start, end);\n        return;\n      }\n\n      var newPlot = new Plot({\n        start: start,\n        end: end\n      });\n      this.set('plotRange', newPlot);\n      this.set('plot', newPlot);\n    };\n\n    _proto._initCanvas = function _initCanvas() {\n      var self = this;\n\n      try {\n        var canvas = createCanvas({\n          renderer: self.get('renderer'),\n          el: self.get('el') || self.get('id'),\n          context: self.get('context'),\n          pixelRatio: self.get('pixelRatio'),\n          width: self.get('width'),\n          height: self.get('height'),\n          fontFamily: Global.fontFamily,\n          aria: self.get('aria'),\n          title: self.get('title'),\n          landscape: self.get('landscape')\n        });\n        self.set('canvas', canvas);\n        self.set('el', canvas.get('el'));\n        self.set('width', canvas.get('width'));\n        self.set('height', canvas.get('height'));\n      } catch (error) {\n        throw error;\n      }\n\n      Chart.plugins.notify(self, 'afterCanvasInit');\n    };\n\n    _proto._initLayers = function _initLayers() {\n      var canvas = this.get('canvas');\n      this.set('backPlot', canvas.addGroup());\n      this.set('middlePlot', canvas.addGroup({\n        zIndex: 10\n      }));\n      this.set('frontPlot', canvas.addGroup({\n        zIndex: 20\n      }));\n    };\n\n    _proto._initEvents = function _initEvents() {\n      var _this2 = this; // 数据更新后的一些更新\n\n\n      this.on(EVENT_AFTER_DATA_CHANGE, function () {\n        // 数据更新后，重新设置filterdata\n        _this2._initFilteredData(); // 更新geoms里的数据\n\n\n        _this2._changeGeomsData();\n      }); // 大小变化后的一些更新\n\n      this.on(EVENT_AFTER_SIZE_CHANGE, function () {\n        _this2._initLayout(); // layout变化后，坐标轴也需要做相应的变化\n\n\n        var coord = _this2.get('coord');\n\n        if (coord) {\n          coord.reset(_this2.get('plot'));\n        }\n      });\n    };\n\n    _proto._initScaleController = function _initScaleController() {\n      var scaleController = new ScaleController({\n        chart: this\n      }); // 让colDefs 和 scaleController.defs 用同一个对象，这样就不用考虑同步的问题\n\n      this.set('colDefs', scaleController.defs); // 已经实例化的scales 也保持统一个对象\n\n      this.set('scales', scaleController.scales);\n      this.set('scaleController', scaleController);\n    };\n\n    _proto._clearScaleController = function _clearScaleController() {\n      var scaleController = this.get('scaleController');\n      scaleController.clear();\n    };\n\n    _proto._init = function _init() {\n      var self = this;\n\n      self._initCanvas();\n\n      self._initLayout();\n\n      self._initLayers();\n\n      self._initEvents();\n\n      self._initScaleController();\n\n      self.set('axisController', new AxisController({\n        frontPlot: self.get('frontPlot').addGroup({\n          className: 'axisContainer'\n        }),\n        backPlot: self.get('backPlot').addGroup({\n          className: 'axisContainer'\n        }),\n        chart: self\n      }));\n      Chart.plugins.notify(self, 'init');\n    };\n\n    function Chart(cfg) {\n      var _this;\n\n      _this = _Base.call(this, cfg) || this;\n\n      var self = _assertThisInitialized(_this);\n\n      each(Geom, function (geomConstructor, className) {\n        var methodName = lowerFirst(className);\n\n        self[methodName] = function (cfg) {\n          var geom = new geomConstructor(cfg);\n          self.addGeom(geom);\n          return geom;\n        };\n      });\n\n      self._init();\n\n      return _this;\n    }\n\n    _proto.init = function init() {\n      // 初始filterData\n      this._initFilteredData(); // initialization coordinate instance\n\n\n      this._initCoord();\n\n      Chart.plugins.notify(this, 'beforeGeomInit'); // init all geometry instances\n\n      this._initGeoms(); // 多 Y 轴的情况时，统一 Y 轴的数值范围。\n\n\n      this._syncYScales(); // do some adjust for data\n\n\n      this._adjustScale();\n\n      this.emit(EVENT_AFTER_INIT);\n    }\n    /**\n     * set data and some scale configuration\n     * @chainable\n     * @param  {Array} data the dataset to visualize\n     * @param  {Object} colDefs the configuration for scales\n     * @return {Chart} return the chart instance\n     */\n    ;\n\n    _proto.source = function source(data, colDefs) {\n      this.set('data', data);\n\n      if (colDefs) {\n        this.scale(colDefs);\n      }\n\n      return this;\n    };\n\n    _proto.scale = function scale(field, cfg) {\n      var scaleController = this.get('scaleController');\n      scaleController.setFieldDef(field, cfg);\n      return this;\n    }\n    /**\n     * configure the axis\n     * @chainable\n     * @param  {String|Boolean} field the field name of data\n     * @param  {Object} cfg configuration for axis\n     * @return {Chart} return the chart instance\n     */\n    ;\n\n    _proto.axis = function axis(field, cfg) {\n      var axisController = this.get('axisController');\n\n      if (!field) {\n        axisController.axisCfg = null;\n      } else {\n        axisController.axisCfg = axisController.axisCfg || {};\n        axisController.axisCfg[field] = cfg;\n      }\n\n      return this;\n    }\n    /**\n     * configure the coordinate\n     * @chainable\n     * @param  {String} type set the type of coodinate\n     * @param  {Object} cfg configuration for coordinate\n     * @return {Chart} return the chart instance\n     */\n    ;\n\n    _proto.coord = function coord(type, cfg) {\n      var coordCfg;\n\n      if (isObject(type)) {\n        coordCfg = type;\n      } else {\n        coordCfg = cfg || {};\n        coordCfg.type = type || 'cartesian';\n      }\n\n      this.set('coordCfg', coordCfg);\n      return this;\n    };\n\n    _proto.filter = function filter(field, condition) {\n      var filters = this.get('filters') || {};\n      filters[field] = condition;\n      this.set('filters', filters); // 如果已经render过，则再重新触发一次change\n\n      if (this.get('rendered')) {\n        this.emit(EVENT_AFTER_DATA_CHANGE, this.get('data'));\n      }\n    }\n    /**\n     * render the chart\n     * @chainable\n     * @return {Chart} return the chart instance\n     */\n    ;\n\n    _proto.render = function render() {\n      var rendered = this.get('rendered');\n      var canvas = this.get('canvas');\n      var geoms = this.get('geoms'); // 已经渲染过\n\n      if (rendered) {\n        this._initGeoms();\n\n        this._adjustScale();\n      } else {\n        this.init();\n        this.set('rendered', true);\n      }\n\n      this.emit(EVENT_BEFORE_RENDER);\n      Chart.plugins.notify(this, 'beforeGeomDraw');\n\n      this._renderAxis();\n\n      var middlePlot = this.get('middlePlot');\n\n      if (this.get('limitInPlot') && !middlePlot.attr('clip')) {\n        var coord = this.get('coord');\n        var clip = getClip(coord);\n        clip.set('canvas', middlePlot.get('canvas'));\n        middlePlot.attr('clip', clip);\n      }\n\n      this.emit(EVENT_BEFORE_GEOM_DRAW);\n\n      for (var i = 0, length = geoms.length; i < length; i++) {\n        var geom = geoms[i];\n        geom.paint();\n      }\n\n      this.emit(EVENT_AFTER_GEOM_DRAW);\n      Chart.plugins.notify(this, 'afterGeomDraw');\n      canvas.sort();\n      this.get('frontPlot').sort();\n      Chart.plugins.notify(this, 'beforeCanvasDraw');\n      canvas.draw();\n      this.emit(EVENT_AFTER_RENDER);\n      return this;\n    }\n    /**\n     * clear the chart, include geometris and all the shapes\n     * @chainable\n     * @return {Chart} return the chart\n     */\n    ;\n\n    _proto.clear = function clear() {\n      Chart.plugins.notify(this, 'clear');\n      this.emit(EVENT_CLEAR);\n\n      this._clearInner();\n\n      this._removeGeoms();\n\n      this._clearScaleController();\n\n      this.set('legendItems', null);\n      this.set('filters', null);\n      this.set('isUpdate', false);\n      this.set('_padding', null);\n      this.set('rendered', false);\n      var canvas = this.get('canvas');\n      canvas.draw();\n      return this;\n    };\n\n    _proto.repaint = function repaint() {\n      // 如果在没有render之前就repaint的，就直接return退出\n      var rendered = this.get('rendered');\n\n      if (!rendered) {\n        return;\n      }\n\n      this.set('isUpdate', true);\n      this.set('legendItems', null);\n      Chart.plugins.notify(this, 'repaint');\n\n      this._clearInner();\n\n      this.emit(EVENT_REPAINT);\n      this.render();\n    };\n\n    _proto.changeData = function changeData(data) {\n      this.emit(EVENT_BEFORE_DATA_CHANGE, data);\n      this.set('data', data);\n      Chart.plugins.notify(this, 'changeData');\n      this.emit(EVENT_AFTER_DATA_CHANGE, data);\n      this.set('_padding', null);\n      this.repaint();\n    };\n\n    _proto.changeSize = function changeSize(width, height) {\n      if (width) {\n        this.set('width', width);\n      } else {\n        width = this.get('width');\n      }\n\n      if (height) {\n        this.set('height', height);\n      } else {\n        height = this.get('height');\n      }\n\n      var canvas = this.get('canvas');\n      canvas.changeSize(width, height);\n      this.emit(EVENT_AFTER_SIZE_CHANGE, {\n        width: width,\n        height: height\n      });\n      this.repaint();\n      return this;\n    };\n\n    _proto.destroy = function destroy() {\n      this.clear();\n      var canvas = this.get('canvas');\n      canvas.destroy();\n      Chart.plugins.notify(this, 'afterCanvasDestroyed');\n\n      if (this._interactions) {\n        each(this._interactions, function (interaction) {\n          interaction.destroy();\n        });\n      }\n\n      _Base.prototype.destroy.call(this);\n    }\n    /**\n     * calculate dataset's position on canvas\n     * @param  {Object} record the dataset\n     * @return {Object} return the position\n     */\n    ;\n\n    _proto.getPosition = function getPosition(record) {\n      var self = this;\n      var coord = self.get('coord');\n      var xScale = self.getXScale();\n      var xField = xScale.field;\n      var yScales = self.getYScales(); // default first\n\n      var yScale = yScales[0];\n      var yField = yScale.field;\n\n      for (var i = 0, len = yScales.length; i < len; i++) {\n        var scale = yScales[i];\n        var field = scale.field;\n\n        if (record[field]) {\n          yScale = scale;\n          yField = field;\n          break;\n        }\n      }\n\n      var x = xScale.scale(record[xField]);\n      var y = yScale.scale(record[yField]);\n      return coord.convertPoint({\n        x: x,\n        y: y\n      });\n    }\n    /**\n     * get the data item of the point\n     * @param  {Object} point canvas position\n     * @return {Object} return the data item\n     */\n    ;\n\n    _proto.getRecord = function getRecord(point) {\n      var self = this;\n      var coord = self.get('coord');\n      var xScale = self.getXScale();\n      var yScale = self.getYScales()[0];\n      var invertPoint = coord.invertPoint(point);\n      var record = {};\n      record[xScale.field] = xScale.invert(invertPoint.x);\n      record[yScale.field] = yScale.invert(invertPoint.y);\n      return record;\n    }\n    /**\n     * get the dataset of the point\n     * @param  {Object} point canvas position\n     * @return {Array} return the dataset\n    **/\n    ;\n\n    _proto.getSnapRecords = function getSnapRecords(point) {\n      var geom = this.get('geoms')[0];\n      var data = [];\n\n      if (geom) {\n        // need to judge\n        data = geom.getSnapRecords(point);\n      }\n\n      return data;\n    }\n    /**\n     * creat scale instances\n     * @param  {String} field field name of data\n     * @return {Scale} return the scale\n     */\n    ;\n\n    _proto.createScale = function createScale(field) {\n      var data = this._getScaleData(field);\n\n      var scaleController = this.get('scaleController');\n      return scaleController.createScale(field, data);\n    }\n    /**\n     * @protected\n     * add geometry instance to geoms\n     * @param {Geom} geom geometry instance\n     */\n    ;\n\n    _proto.addGeom = function addGeom(geom) {\n      var geoms = this.get('geoms');\n      geoms.push(geom);\n    }\n    /**\n     * get the scale of x axis\n     * @return {Scale} return the scale\n     */\n    ;\n\n    _proto.getXScale = function getXScale() {\n      var self = this;\n      var geoms = self.get('geoms');\n      var xScale = geoms[0].getXScale();\n      return xScale;\n    }\n    /**\n     * get the scale of y axis\n     * @return {Array} return the scale\n     */\n    ;\n\n    _proto.getYScales = function getYScales() {\n      var geoms = this.get('geoms');\n      var rst = [];\n      each(geoms, function (geom) {\n        var yScale = geom.getYScale();\n\n        if (rst.indexOf(yScale) === -1) {\n          rst.push(yScale);\n        }\n      });\n      return rst;\n    };\n\n    _proto.getLegendItems = function getLegendItems() {\n      if (this.get('legendItems')) {\n        return this.get('legendItems');\n      }\n\n      var legendItems = {};\n      var scales = [];\n      var geoms = this.get('geoms');\n      each(geoms, function (geom) {\n        var colorAttr = geom.getAttr('color');\n\n        if (colorAttr) {\n          var scale = colorAttr.getScale('color'); // 只支持分类图例\n\n          if (scale.isCategory && !_isScaleExist(scales, scale)) {\n            scales.push(scale);\n            var field = scale.field;\n            var ticks = scale.getTicks();\n            var items = [];\n            each(ticks, function (tick) {\n              var text = tick.text;\n              var name = text;\n              var scaleValue = tick.value;\n              var value = scale.invert(scaleValue);\n              var color = colorAttr.mapping(value).join('') || Global.defaultColor;\n              var marker = {\n                fill: color,\n                radius: 3,\n                symbol: 'circle',\n                stroke: '#fff'\n              };\n              items.push({\n                name: name,\n                // for display\n                dataValue: value,\n                // the origin value\n                checked: true,\n                marker: marker\n              });\n            });\n            legendItems[field] = items;\n          }\n        }\n      });\n      this.set('legendItems', legendItems);\n      return legendItems;\n    } // register the plugins\n    ;\n\n    _proto.registerPlugins = function registerPlugins(plugins) {\n      var self = this;\n      var chartPlugins = self.get('plugins') || [];\n\n      if (!isArray(chartPlugins)) {\n        chartPlugins = [chartPlugins];\n      }\n\n      [].concat(plugins).forEach(function (plugin) {\n        if (chartPlugins.indexOf(plugin) === -1) {\n          plugin.init && plugin.init(self); // init\n\n          chartPlugins.push(plugin);\n        }\n      });\n      Chart.plugins._cacheId++;\n      self.set('plugins', chartPlugins);\n    };\n\n    _proto._renderAxis = function _renderAxis() {\n      var axisController = this.get('axisController');\n      var xScale = this.getXScale();\n      var yScales = this.getYScales();\n      var coord = this.get('coord');\n      Chart.plugins.notify(this, 'beforeRenderAxis');\n      axisController.createAxis(coord, xScale, yScales);\n    };\n\n    _proto._isAutoPadding = function _isAutoPadding() {\n      if (this.get('_padding')) {\n        return false;\n      }\n\n      var padding = this.get('padding');\n\n      if (isArray(padding)) {\n        return padding.indexOf('auto') !== -1;\n      }\n\n      return padding === 'auto';\n    };\n\n    _proto._updateLayout = function _updateLayout(padding) {\n      var width = this.get('width');\n      var height = this.get('height');\n      var start = {\n        x: padding[3],\n        y: padding[0]\n      };\n      var end = {\n        x: width - padding[1],\n        y: height - padding[2]\n      };\n      var plot = this.get('plot');\n      var coord = this.get('coord');\n      plot.reset(start, end);\n      coord.reset(plot);\n    }\n    /**\n     * 是否为横屏展示\n     *\n     * @param {Boolean} landscape 是否为横屏\n     */\n    ;\n\n    _proto.landscape = function landscape(_landscape) {\n      var canvas = this.get('canvas');\n      canvas.set('landscape', _landscape);\n    };\n\n    return Chart;\n  }(Base);\n\n  Chart.plugins = Chart.initPlugins();\n\n  var track = function track() {\n    return null;\n  };\n  /**\n   * @fileOverview shape util\n   * @author dxq613@gmail.com\n   */\n\n\n  function splitPoints(obj) {\n    var points = [];\n    var x = obj.x;\n    var y = obj.y;\n    y = isArray(y) ? y : [y];\n    y.forEach(function (yItem, index) {\n      var point = {\n        x: isArray(x) ? x[index] : x,\n        y: yItem\n      };\n      points.push(point);\n    });\n    return points;\n  }\n\n  function splitArray(data, yField, connectNulls) {\n    if (!data.length) return [];\n    var arr = [];\n    var tmp = [];\n    var yValue;\n    each(data, function (obj) {\n      yValue = obj._origin ? obj._origin[yField] : obj[yField];\n\n      if (connectNulls) {\n        if (!isNil(yValue)) {\n          tmp.push(obj);\n        }\n      } else {\n        if (isArray(yValue) && isNil(yValue[0]) || isNil(yValue)) {\n          if (tmp.length) {\n            arr.push(tmp);\n            tmp = [];\n          }\n        } else {\n          tmp.push(obj);\n        }\n      }\n    });\n\n    if (tmp.length) {\n      arr.push(tmp);\n    }\n\n    return arr;\n  }\n\n  var SHAPES = ['circle', 'hollowCircle', 'rect'];\n  var Point = Shape$1.registerFactory('point', {\n    defaultShapeType: 'circle',\n    getDefaultPoints: function getDefaultPoints(pointInfo) {\n      return splitPoints(pointInfo);\n    }\n  });\n\n  function getPointsCfg(cfg) {\n    var style = {\n      lineWidth: 0,\n      stroke: cfg.color,\n      fill: cfg.color\n    };\n\n    if (cfg.size) {\n      style.size = cfg.size;\n    }\n\n    mix(style, cfg.style);\n    return mix({}, Global.shape.point, style);\n  }\n\n  function drawShape(cfg, container, shape) {\n    if (cfg.size === 0) return;\n    var pointCfg = getPointsCfg(cfg);\n    var size = pointCfg.r || pointCfg.size;\n    var x = cfg.x;\n    var y = !isArray(cfg.y) ? [cfg.y] : cfg.y;\n\n    if (shape === 'hollowCircle') {\n      pointCfg.lineWidth = 1;\n      pointCfg.fill = null;\n    }\n\n    for (var i = 0, len = y.length; i < len; i++) {\n      if (shape === 'rect') {\n        return container.addShape('Rect', {\n          className: 'point',\n          attrs: mix({\n            x: x - size,\n            y: y[i] - size,\n            width: size * 2,\n            height: size * 2\n          }, pointCfg)\n        });\n      }\n\n      return container.addShape('Circle', {\n        className: 'point',\n        attrs: mix({\n          x: x,\n          y: y[i],\n          r: size\n        }, pointCfg)\n      });\n    }\n  }\n\n  each(SHAPES, function (shapeType) {\n    Shape$1.registerShape('point', shapeType, {\n      draw: function draw(cfg, container) {\n        return drawShape(cfg, container, shapeType);\n      }\n    });\n  });\n\n  var Point$1 = /*#__PURE__*/function (_Geom) {\n    _inheritsLoose(Point, _Geom);\n\n    function Point() {\n      return _Geom.apply(this, arguments) || this;\n    }\n\n    var _proto = Point.prototype;\n\n    _proto.getDefaultCfg = function getDefaultCfg() {\n      var cfg = _Geom.prototype.getDefaultCfg.call(this);\n\n      cfg.type = 'point';\n      cfg.shapeType = 'point';\n      cfg.generatePoints = false;\n      return cfg;\n    };\n\n    _proto.draw = function draw(data, shapeFactory) {\n      var self = this;\n      var container = self.get('container');\n      each(data, function (obj) {\n        var shape = obj.shape;\n        var cfg = self.getDrawCfg(obj);\n\n        if (isArray(obj.y)) {\n          var hasStack = self.hasAdjust('stack');\n          each(obj.y, function (y, idx) {\n            cfg.y = y;\n\n            if (!hasStack || idx !== 0) {\n              self.drawShape(shape, obj, cfg, container, shapeFactory);\n            }\n          });\n        } else if (!isNil(obj.y)) {\n          self.drawShape(shape, obj, cfg, container, shapeFactory);\n        }\n      });\n    };\n\n    return Point;\n  }(Geom);\n\n  Geom.Point = Point$1;\n  var Line$2 = Shape$1.registerFactory('line', {\n    defaultShapeType: 'line'\n  });\n\n  function getStyle$1(cfg) {\n    var style = {\n      strokeStyle: cfg.color\n    };\n\n    if (cfg.size >= 0) {\n      style.lineWidth = cfg.size;\n    }\n\n    mix(style, cfg.style);\n    return mix({}, Global.shape.line, style);\n  }\n\n  function drawLines(cfg, container, style, smooth) {\n    var points = cfg.points;\n\n    if (points.length && isArray(points[0].y)) {\n      var topPoints = [];\n      var bottomPoints = [];\n\n      for (var i = 0, len = points.length; i < len; i++) {\n        var point = points[i];\n        var tmp = splitPoints(point);\n        bottomPoints.push(tmp[0]);\n        topPoints.push(tmp[1]);\n      }\n\n      if (cfg.isInCircle) {\n        topPoints.push(topPoints[0]);\n        bottomPoints.push(bottomPoints[0]);\n      }\n\n      if (cfg.isStack) {\n        return container.addShape('Polyline', {\n          className: 'line',\n          attrs: mix({\n            points: topPoints,\n            smooth: smooth\n          }, style)\n        });\n      }\n\n      var topShape = container.addShape('Polyline', {\n        className: 'line',\n        attrs: mix({\n          points: topPoints,\n          smooth: smooth\n        }, style)\n      });\n      var bottomShape = container.addShape('Polyline', {\n        className: 'line',\n        attrs: mix({\n          points: bottomPoints,\n          smooth: smooth\n        }, style)\n      });\n      return [topShape, bottomShape];\n    }\n\n    if (cfg.isInCircle) {\n      points.push(points[0]);\n    }\n\n    return container.addShape('Polyline', {\n      className: 'line',\n      attrs: mix({\n        points: points,\n        smooth: smooth\n      }, style)\n    });\n  }\n\n  var SHAPES$1 = ['line', 'smooth', 'dash'];\n  each(SHAPES$1, function (shapeType) {\n    Shape$1.registerShape('line', shapeType, {\n      draw: function draw(cfg, container) {\n        var smooth = shapeType === 'smooth';\n        var style = getStyle$1(cfg);\n\n        if (shapeType === 'dash') {\n          style.lineDash = Global.lineDash;\n        }\n\n        return drawLines(cfg, container, style, smooth);\n      }\n    });\n  });\n\n  var Path = /*#__PURE__*/function (_Geom) {\n    _inheritsLoose(Path, _Geom);\n\n    function Path() {\n      return _Geom.apply(this, arguments) || this;\n    }\n\n    var _proto = Path.prototype;\n\n    _proto.getDefaultCfg = function getDefaultCfg() {\n      var cfg = _Geom.prototype.getDefaultCfg.call(this);\n\n      cfg.type = 'path';\n      cfg.shapeType = 'line';\n      return cfg;\n    };\n\n    _proto.getDrawCfg = function getDrawCfg(obj) {\n      var cfg = _Geom.prototype.getDrawCfg.call(this, obj);\n\n      cfg.isStack = this.hasAdjust('stack');\n      return cfg;\n    };\n\n    _proto.draw = function draw(data, shapeFactory) {\n      var self = this;\n      var container = self.get('container');\n      var yScale = self.getYScale();\n      var connectNulls = self.get('connectNulls');\n      var splitArrayObj = splitArray(data, yScale.field, connectNulls);\n      var cfg = this.getDrawCfg(data[0]);\n      cfg.origin = data;\n      each(splitArrayObj, function (subData, splitedIndex) {\n        cfg.splitedIndex = splitedIndex;\n        cfg.points = subData;\n        self.drawShape(cfg.shape, data[0], cfg, container, shapeFactory);\n      });\n    };\n\n    return Path;\n  }(Geom);\n\n  Geom.Path = Path;\n\n  var Line$3 = /*#__PURE__*/function (_Path) {\n    _inheritsLoose(Line, _Path);\n\n    function Line() {\n      return _Path.apply(this, arguments) || this;\n    }\n\n    var _proto = Line.prototype;\n\n    _proto.getDefaultCfg = function getDefaultCfg() {\n      var cfg = _Path.prototype.getDefaultCfg.call(this);\n\n      cfg.type = 'line';\n      cfg.sortable = true;\n      return cfg;\n    };\n\n    return Line;\n  }(Path);\n\n  Geom.Line = Line$3;\n\n  function equals(v1, v2) {\n    return Math.abs(v1 - v2) < 0.00001;\n  }\n\n  function notEmpty(value) {\n    return !isNaN(value) && !isNil(value);\n  }\n\n  function filterPoints(points) {\n    var filteredPoints = []; // filter the point which x or y is NaN\n\n    for (var i = 0, len = points.length; i < len; i++) {\n      var point = points[i];\n\n      if (notEmpty(point.x) && notEmpty(point.y)) {\n        filteredPoints.push(point);\n      }\n    }\n\n    return filteredPoints;\n  }\n\n  function equalsCenter(points, center) {\n    var eqls = true;\n    each(points, function (point) {\n      if (!equals(point.x, center.x) || !equals(point.y, center.y)) {\n        eqls = false;\n        return false;\n      }\n    });\n    return eqls;\n  }\n\n  function drawRectShape(topPoints, bottomPoints, container, style, isSmooth) {\n    var shape;\n    var points = topPoints.concat(bottomPoints);\n\n    if (isSmooth) {\n      shape = container.addShape('Custom', {\n        className: 'area',\n        attrs: mix({\n          points: points\n        }, style),\n        createPath: function createPath(context) {\n          var constaint = [[0, 0], [1, 1]];\n          var points = filterPoints(this._attrs.attrs.points);\n          var pointsLen = points.length;\n          var topPoints = points.slice(0, pointsLen / 2);\n          var bottomPoints = points.slice(pointsLen / 2, pointsLen);\n          var topSps = catmullRom2bezier(topPoints, false, constaint);\n          context.beginPath();\n          context.moveTo(topPoints[0].x, topPoints[0].y);\n\n          for (var i = 0, n = topSps.length; i < n; i++) {\n            var sp = topSps[i];\n            context.bezierCurveTo(sp[1], sp[2], sp[3], sp[4], sp[5], sp[6]);\n          }\n\n          if (bottomPoints.length) {\n            var bottomSps = catmullRom2bezier(bottomPoints, false, constaint);\n            context.lineTo(bottomPoints[0].x, bottomPoints[0].y);\n\n            for (var _i = 0, _n = bottomSps.length; _i < _n; _i++) {\n              var _sp = bottomSps[_i];\n              context.bezierCurveTo(_sp[1], _sp[2], _sp[3], _sp[4], _sp[5], _sp[6]);\n            }\n          }\n\n          context.closePath();\n        },\n        calculateBox: function calculateBox() {\n          var points = filterPoints(this._attrs.attrs.points);\n          return getBBoxFromPoints(points);\n        }\n      });\n    } else {\n      shape = container.addShape('Polyline', {\n        className: 'area',\n        attrs: mix({\n          points: points\n        }, style)\n      });\n    }\n\n    return shape;\n  }\n\n  function drawShape$1(cfg, container, isSmooth) {\n    var self = this;\n    var points = cfg.points;\n    var topPoints = [];\n    var bottomPoints = [];\n    each(points, function (point) {\n      bottomPoints.push(point[0]);\n      topPoints.push(point[1]);\n    });\n    var style = mix({\n      fillStyle: cfg.color\n    }, Global.shape.area, cfg.style);\n    bottomPoints.reverse();\n    topPoints = self.parsePoints(topPoints);\n    bottomPoints = self.parsePoints(bottomPoints);\n\n    if (cfg.isInCircle) {\n      topPoints.push(topPoints[0]);\n      bottomPoints.unshift(bottomPoints[bottomPoints.length - 1]);\n\n      if (equalsCenter(bottomPoints, cfg.center)) {\n        bottomPoints = [];\n      }\n    }\n\n    return drawRectShape(topPoints, bottomPoints, container, style, isSmooth);\n  }\n\n  var Area = Shape$1.registerFactory('area', {\n    defaultShapeType: 'area',\n    getDefaultPoints: function getDefaultPoints(obj) {\n      var x = obj.x;\n      var y = obj.y;\n      var y0 = obj.y0;\n      y = isArray(y) ? y : [y0, y];\n      var points = [];\n      points.push({\n        x: x,\n        y: y[0]\n      }, {\n        x: x,\n        y: y[1]\n      });\n      return points;\n    }\n  });\n  var SHAPES$2 = ['area', 'smooth'];\n  each(SHAPES$2, function (shapeType) {\n    Shape$1.registerShape('area', shapeType, {\n      draw: function draw(cfg, container) {\n        var smooth = shapeType === 'smooth';\n        return drawShape$1.call(this, cfg, container, smooth);\n      }\n    });\n  });\n\n  var Area$1 = /*#__PURE__*/function (_Geom) {\n    _inheritsLoose(Area, _Geom);\n\n    function Area() {\n      return _Geom.apply(this, arguments) || this;\n    }\n\n    var _proto = Area.prototype;\n    /**\n     * get the default configuration\n     * @protected\n     * @return {Object} return the result\n     */\n\n    _proto.getDefaultCfg = function getDefaultCfg() {\n      var cfg = _Geom.prototype.getDefaultCfg.call(this);\n\n      cfg.type = 'area';\n      cfg.shapeType = 'area';\n      cfg.generatePoints = true;\n      cfg.sortable = true;\n      return cfg;\n    };\n\n    _proto.draw = function draw(data, shapeFactory) {\n      var self = this;\n      var container = self.get('container');\n      var cfg = this.getDrawCfg(data[0]);\n      var yScale = self.getYScale();\n      var connectNulls = self.get('connectNulls');\n      var splitArrayfn = splitArray(data, yScale.field, connectNulls);\n      cfg.origin = data;\n      each(splitArrayfn, function (subData, splitedIndex) {\n        cfg.splitedIndex = splitedIndex;\n        var points = subData.map(function (obj) {\n          return obj.points;\n        });\n        cfg.points = points;\n        self.drawShape(cfg.shape, data[0], cfg, container, shapeFactory);\n      });\n    };\n\n    return Area;\n  }(Geom);\n\n  Geom.Area = Area$1;\n  /**\n   * @fileOverview Utility for calculate the with ratui in x axis\n   * @author sima.zhang1990@gmail.com\n   * @author dxq613@gmail.com\n   */\n\n  var SizeMixin = {\n    initEvent: function initEvent() {\n      var _this = this;\n\n      var chart = this.get('chart');\n\n      if (!chart) {\n        return;\n      }\n\n      chart.on(EVENT_AFTER_SIZE_CHANGE, function () {\n        _this.set('_width', null);\n      });\n    },\n    getDefaultSize: function getDefaultSize() {\n      var defaultSize = this.get('defaultSize');\n\n      if (!defaultSize) {\n        var coord = this.get('coord');\n        var xScale = this.getXScale();\n        var dataArray = this.get('dataArray');\n        var values = uniq(xScale.values);\n        var count = values.length;\n        var range = xScale.range;\n        var normalizeSize = 1 / count;\n        var widthRatio = 1;\n\n        if (coord && coord.isPolar) {\n          if (coord.transposed && count > 1) {\n            widthRatio = Global.widthRatio.multiplePie;\n          } else {\n            widthRatio = Global.widthRatio.rose;\n          }\n        } else {\n          if (xScale.isLinear) {\n            normalizeSize *= range[1] - range[0];\n          }\n\n          widthRatio = Global.widthRatio.column;\n        }\n\n        normalizeSize *= widthRatio;\n\n        if (this.hasAdjust('dodge')) {\n          normalizeSize = normalizeSize / dataArray.length;\n        }\n\n        defaultSize = normalizeSize;\n        this.set('defaultSize', defaultSize);\n      }\n\n      return defaultSize;\n    },\n    getDimWidth: function getDimWidth(dimName) {\n      var coord = this.get('coord');\n      var start = coord.convertPoint({\n        x: 0,\n        y: 0\n      });\n      var end = coord.convertPoint({\n        x: dimName === 'x' ? 1 : 0,\n        y: dimName === 'x' ? 0 : 1\n      });\n      var width = 0;\n\n      if (start && end) {\n        width = Math.sqrt(Math.pow(end.x - start.x, 2) + Math.pow(end.y - start.y, 2));\n      }\n\n      return width;\n    },\n    _getWidth: function _getWidth() {\n      var width = this.get('_width');\n\n      if (!width) {\n        var coord = this.get('coord');\n\n        if (coord && coord.isPolar && !coord.transposed) {\n          width = (coord.endAngle - coord.startAngle) * coord.circleRadius;\n        } else {\n          width = this.getDimWidth('x');\n        }\n\n        this.set('_width', width);\n      }\n\n      return width;\n    },\n    _toNormalizedSize: function _toNormalizedSize(size) {\n      var width = this._getWidth();\n\n      return size / width;\n    },\n    _toCoordSize: function _toCoordSize(normalizeSize) {\n      var width = this._getWidth();\n\n      return width * normalizeSize;\n    },\n    getNormalizedSize: function getNormalizedSize(obj) {\n      var size = this.getAttrValue('size', obj);\n\n      if (isNil(size)) {\n        size = this.getDefaultSize();\n      } else {\n        size = this._toNormalizedSize(size);\n      }\n\n      return size;\n    },\n    getSize: function getSize(obj) {\n      var size = this.getAttrValue('size', obj);\n\n      if (isNil(size)) {\n        var normalizeSize = this.getDefaultSize();\n        size = this._toCoordSize(normalizeSize);\n      }\n\n      return size;\n    }\n  };\n\n  function getRectPoints(cfg) {\n    var x = cfg.x,\n        y = cfg.y,\n        y0 = cfg.y0,\n        size = cfg.size;\n    var ymin = y0;\n    var ymax = y;\n\n    if (isArray(y)) {\n      ymax = y[1];\n      ymin = y[0];\n    }\n\n    var xmin;\n    var xmax;\n\n    if (isArray(x)) {\n      xmin = x[0];\n      xmax = x[1];\n    } else {\n      xmin = x - size / 2;\n      xmax = x + size / 2;\n    }\n\n    return [{\n      x: xmin,\n      y: ymin\n    }, {\n      x: xmin,\n      y: ymax\n    }, {\n      x: xmax,\n      y: ymax\n    }, {\n      x: xmax,\n      y: ymin\n    }];\n  }\n\n  function getRectRange(points) {\n    var xValues = [];\n    var yValues = [];\n\n    for (var i = 0, len = points.length; i < len; i++) {\n      var point = points[i];\n      xValues.push(point.x);\n      yValues.push(point.y);\n    }\n\n    var xMin = Math.min.apply(null, xValues);\n    var yMin = Math.min.apply(null, yValues);\n    var xMax = Math.max.apply(null, xValues);\n    var yMax = Math.max.apply(null, yValues);\n    return {\n      x: xMin,\n      y: yMin,\n      width: xMax - xMin,\n      height: yMax - yMin\n    };\n  }\n\n  function getMiddlePoint(a, b) {\n    var x = (a.x - b.x) / 2 + b.x;\n    var y = (a.y - b.y) / 2 + b.y;\n    return {\n      x: x,\n      y: y\n    };\n  }\n\n  var Interval = Shape$1.registerFactory('interval', {\n    defaultShapeType: 'rect',\n    getDefaultPoints: function getDefaultPoints(cfg) {\n      return getRectPoints(cfg);\n    }\n  });\n  Shape$1.registerShape('interval', 'rect', {\n    draw: function draw(cfg, container) {\n      var points = this.parsePoints(cfg.points);\n      var style = mix({\n        fill: cfg.color\n      }, Global.shape.interval, cfg.style);\n\n      if (cfg.isInCircle) {\n        var newPoints = points.slice(0);\n\n        if (this._coord.transposed) {\n          newPoints = [points[0], points[3], points[2], points[1]];\n        }\n\n        var _cfg$center = cfg.center,\n            x = _cfg$center.x,\n            y = _cfg$center.y;\n        var v = [1, 0];\n        var v0 = [newPoints[0].x - x, newPoints[0].y - y];\n        var v1 = [newPoints[1].x - x, newPoints[1].y - y];\n        var v2 = [newPoints[2].x - x, newPoints[2].y - y];\n        var startAngle = Vector2.angleTo(v, v1);\n        var endAngle = Vector2.angleTo(v, v2);\n        var r0 = Vector2.length(v0);\n        var r = Vector2.length(v1);\n\n        if (startAngle >= 1.5 * Math.PI) {\n          startAngle = startAngle - 2 * Math.PI;\n        }\n\n        if (endAngle >= 1.5 * Math.PI) {\n          endAngle = endAngle - 2 * Math.PI;\n        }\n\n        return container.addShape('Sector', {\n          className: 'interval',\n          attrs: mix({\n            x: x,\n            y: y,\n            r: r,\n            r0: r0,\n            startAngle: startAngle,\n            endAngle: endAngle\n          }, style)\n        });\n      }\n\n      var rectCfg = getRectRange(points);\n      return container.addShape('rect', {\n        className: 'interval',\n        attrs: mix(rectCfg, style)\n      });\n    }\n  }); // 金字塔 和 漏斗图\n\n  ['pyramid', 'funnel'].forEach(function (shapeType) {\n    Shape$1.registerShape('interval', shapeType, {\n      getPoints: function getPoints(cfg) {\n        cfg.size = cfg.size * 2; // 漏斗图的 size 是柱状图的两倍\n\n        return getRectPoints(cfg);\n      },\n      draw: function draw(cfg, container) {\n        var points = this.parsePoints(cfg.points);\n        var nextPoints = this.parsePoints(cfg.nextPoints);\n        var polygonPoints = null;\n\n        if (nextPoints) {\n          polygonPoints = [points[0], points[1], nextPoints[1], nextPoints[0]];\n        } else {\n          polygonPoints = [points[0], points[1]]; // pyramid 顶部是三角形，所以取中心点就好了，funnel顶部是长方形\n\n          if (shapeType === 'pyramid') {\n            polygonPoints.push(getMiddlePoint(points[2], points[3]));\n          } else {\n            polygonPoints.push(points[2], points[3]);\n          }\n        }\n\n        var attrs = mix({\n          fill: cfg.color,\n          points: polygonPoints\n        }, Global.shape.interval, cfg.style);\n        return container.addShape('polygon', {\n          className: 'interval',\n          attrs: attrs\n        });\n      }\n    });\n  });\n\n  var Interval$1 = /*#__PURE__*/function (_Geom) {\n    _inheritsLoose(Interval, _Geom);\n\n    var _proto = Interval.prototype;\n\n    _proto.getDefaultCfg = function getDefaultCfg() {\n      var cfg = _Geom.prototype.getDefaultCfg.call(this);\n\n      cfg.type = 'interval';\n      cfg.shapeType = 'interval';\n      cfg.generatePoints = true;\n      return cfg;\n    };\n\n    function Interval(cfg) {\n      var _this;\n\n      _this = _Geom.call(this, cfg) || this;\n      mix(_assertThisInitialized(_this), SizeMixin);\n      return _this;\n    }\n\n    _proto.init = function init() {\n      _Geom.prototype.init.call(this); // 绑定事件\n\n\n      this.initEvent();\n    };\n\n    _proto.createShapePointsCfg = function createShapePointsCfg(obj) {\n      var cfg = _Geom.prototype.createShapePointsCfg.call(this, obj);\n\n      cfg.size = this.getNormalizedSize(obj);\n      return cfg;\n    };\n\n    _proto.clearInner = function clearInner() {\n      _Geom.prototype.clearInner.call(this);\n\n      this.set('defaultSize', null);\n    };\n\n    return Interval;\n  }(Geom);\n\n  Geom.Interval = Interval$1;\n  var Polygon$1 = Shape$1.registerFactory('polygon', {\n    defaultShapeType: 'polygon',\n    getDefaultPoints: function getDefaultPoints(pointInfo) {\n      var points = [];\n      var x = pointInfo.x,\n          y = pointInfo.y;\n\n      for (var i = 0, len = x.length; i < len; i++) {\n        points.push({\n          x: x[i],\n          y: y[i]\n        });\n      }\n\n      return points;\n    }\n  });\n  Shape$1.registerShape('polygon', 'polygon', {\n    draw: function draw(cfg, container) {\n      var points = this.parsePoints(cfg.points);\n      var style = mix({\n        fill: cfg.color,\n        points: points\n      }, cfg.style);\n      return container.addShape('Polygon', {\n        className: 'polygon',\n        attrs: style\n      });\n    }\n  });\n\n  var Polygon$2 = /*#__PURE__*/function (_Geom) {\n    _inheritsLoose(Polygon, _Geom);\n\n    function Polygon() {\n      return _Geom.apply(this, arguments) || this;\n    }\n\n    var _proto = Polygon.prototype;\n\n    _proto.getDefaultCfg = function getDefaultCfg() {\n      var cfg = _Geom.prototype.getDefaultCfg.call(this);\n\n      cfg.type = 'polygon';\n      cfg.shapeType = 'polygon';\n      cfg.generatePoints = true;\n      return cfg;\n    };\n\n    _proto.createShapePointsCfg = function createShapePointsCfg(obj) {\n      var cfg = _Geom.prototype.createShapePointsCfg.call(this, obj);\n\n      var self = this;\n      var x = cfg.x;\n      var y = cfg.y;\n      var temp;\n\n      if (!(isArray(x) && isArray(y))) {\n        var xScale = self.getXScale();\n        var yScale = self.getYScale();\n        var xCount = xScale.values ? xScale.values.length : xScale.ticks.length;\n        var yCount = yScale.values ? yScale.values.length : yScale.ticks.length;\n        var xOffset = 0.5 * 1 / xCount;\n        var yOffset = 0.5 * 1 / yCount;\n\n        if (xScale.isCategory && yScale.isCategory) {\n          x = [x - xOffset, x - xOffset, x + xOffset, x + xOffset];\n          y = [y - yOffset, y + yOffset, y + yOffset, y - yOffset];\n        } else if (isArray(x)) {\n          temp = x;\n          x = [temp[0], temp[0], temp[1], temp[1]];\n          y = [y - yOffset / 2, y + yOffset / 2, y + yOffset / 2, y - yOffset / 2];\n        } else if (isArray(y)) {\n          temp = y;\n          y = [temp[0], temp[1], temp[1], temp[0]];\n          x = [x - xOffset / 2, x - xOffset / 2, x + xOffset / 2, x + xOffset / 2];\n        }\n\n        cfg.x = x;\n        cfg.y = y;\n      }\n\n      return cfg;\n    };\n\n    return Polygon;\n  }(Geom);\n\n  Geom.Polygon = Polygon$2;\n\n  function _sortValue(value) {\n    var sorted = value.sort(function (a, b) {\n      return a < b ? 1 : -1;\n    });\n    var length = sorted.length;\n\n    if (length < 4) {\n      var min = sorted[length - 1];\n\n      for (var i = 0; i < 4 - length; i++) {\n        sorted.push(min);\n      }\n    }\n\n    return sorted;\n  } // from left bottom corner, and clockwise\n\n\n  function getCandlePoints(x, y, width) {\n    var yValues = _sortValue(y);\n\n    var points = [{\n      x: x,\n      y: yValues[0]\n    }, {\n      x: x,\n      y: yValues[1]\n    }, {\n      x: x - width / 2,\n      y: yValues[2]\n    }, {\n      x: x - width / 2,\n      y: yValues[1]\n    }, {\n      x: x + width / 2,\n      y: yValues[1]\n    }, {\n      x: x + width / 2,\n      y: yValues[2]\n    }, {\n      x: x,\n      y: yValues[2]\n    }, {\n      x: x,\n      y: yValues[3]\n    }];\n    return points;\n  }\n\n  var Schema = Shape$1.registerFactory('schema', {});\n  Shape$1.registerShape('schema', 'candle', {\n    getPoints: function getPoints(cfg) {\n      return getCandlePoints(cfg.x, cfg.y, cfg.size);\n    },\n    draw: function draw(cfg, container) {\n      var points = this.parsePoints(cfg.points);\n      var style = mix({\n        stroke: cfg.color,\n        fill: cfg.color,\n        lineWidth: 1\n      }, cfg.style);\n      return container.addShape('Custom', {\n        className: 'schema',\n        attrs: style,\n        createPath: function createPath(ctx) {\n          ctx.beginPath();\n          ctx.moveTo(points[0].x, points[0].y);\n          ctx.lineTo(points[1].x, points[1].y);\n          ctx.moveTo(points[2].x, points[2].y);\n\n          for (var i = 3; i < 6; i++) {\n            ctx.lineTo(points[i].x, points[i].y);\n          }\n\n          ctx.closePath();\n          ctx.moveTo(points[6].x, points[6].y);\n          ctx.lineTo(points[7].x, points[7].y);\n        }\n      });\n    }\n  });\n\n  var Schema$1 = /*#__PURE__*/function (_Geom) {\n    _inheritsLoose(Schema, _Geom);\n\n    var _proto = Schema.prototype;\n\n    _proto.getDefaultCfg = function getDefaultCfg() {\n      var cfg = _Geom.prototype.getDefaultCfg.call(this);\n\n      cfg.type = 'schema';\n      cfg.shapeType = 'schema';\n      cfg.generatePoints = true;\n      return cfg;\n    };\n\n    function Schema(cfg) {\n      var _this;\n\n      _this = _Geom.call(this, cfg) || this;\n      mix(_assertThisInitialized(_this), SizeMixin);\n      return _this;\n    }\n\n    _proto.init = function init() {\n      _Geom.prototype.init.call(this); // 绑定事件\n\n\n      this.initEvent();\n    };\n\n    _proto.createShapePointsCfg = function createShapePointsCfg(obj) {\n      var cfg = _Geom.prototype.createShapePointsCfg.call(this, obj);\n\n      cfg.size = this.getNormalizedSize(obj);\n      return cfg;\n    };\n\n    _proto.clearInner = function clearInner() {\n      _Geom.prototype.clearInner.call(this);\n\n      this.set('defaultSize', null);\n    };\n\n    return Schema;\n  }(Geom);\n\n  Geom.Schema = Schema$1;\n  var toString$3 = {}.toString;\n\n  var isType$1 = function isType(value, type) {\n    return toString$3.call(value) === '[object ' + type + ']';\n  };\n\n  var isType_1 = isType$1;\n  var isArray$1 = Array.isArray ? Array.isArray : function (value) {\n    return isType_1(value, 'Array');\n  };\n  var isArray_1 = isArray$1; // isFinite,\n\n  var isNil$1 = function isNil(value) {\n    /**\n     * isNil(null) => true\n     * isNil() => true\n     */\n    return value === null || value === undefined;\n  };\n\n  var isNil_1 = isNil$1;\n\n  function _inheritsLoose$1(subClass, superClass) {\n    subClass.prototype = Object.create(superClass.prototype);\n    subClass.prototype.constructor = subClass;\n    subClass.__proto__ = superClass;\n  }\n\n  var Stack = /*#__PURE__*/function (_Adjust) {\n    _inheritsLoose$1(Stack, _Adjust);\n\n    function Stack() {\n      return _Adjust.apply(this, arguments) || this;\n    }\n\n    var _proto = Stack.prototype;\n\n    _proto._initDefaultCfg = function _initDefaultCfg() {\n      this.xField = null; // 调整对应的 x 方向对应的字段名称\n\n      this.yField = null; // 调整对应的 y 方向对应的字段名称\n    };\n\n    _proto.processAdjust = function processAdjust(dataArray) {\n      this.processStack(dataArray);\n    };\n\n    _proto.processStack = function processStack(dataArray) {\n      var self = this;\n      var xField = self.xField;\n      var yField = self.yField;\n      var count = dataArray.length;\n      var stackCache = {\n        positive: {},\n        negative: {}\n      }; // 层叠顺序翻转\n\n      if (self.reverseOrder) {\n        dataArray = dataArray.slice(0).reverse();\n      }\n\n      for (var i = 0; i < count; i++) {\n        var data = dataArray[i];\n\n        for (var j = 0, len = data.length; j < len; j++) {\n          var item = data[j];\n          var x = item[xField] || 0;\n          var y = item[yField];\n          var xkey = x.toString();\n          y = isArray_1(y) ? y[1] : y;\n\n          if (!isNil_1(y)) {\n            var direction = y >= 0 ? 'positive' : 'negative';\n\n            if (!stackCache[direction][xkey]) {\n              stackCache[direction][xkey] = 0;\n            }\n\n            item[yField] = [stackCache[direction][xkey], y + stackCache[direction][xkey]];\n            stackCache[direction][xkey] += y;\n          }\n        }\n      }\n    };\n\n    return Stack;\n  }(base);\n\n  base.Stack = Stack;\n\n  var _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) {\n    return typeof obj;\n  } : function (obj) {\n    return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n  };\n\n  var isObject$1 = function isObject(value) {\n    /**\n     * isObject({}) => true\n     * isObject([1, 2, 3]) => true\n     * isObject(Function) => true\n     * isObject(null) => false\n     */\n    var type = typeof value === 'undefined' ? 'undefined' : _typeof(value);\n    return value !== null && type === 'object' || type === 'function';\n  };\n\n  var isObject_1 = isObject$1;\n\n  var each$1 = function each(elements, func) {\n    if (!elements) {\n      return;\n    }\n\n    var rst = void 0;\n\n    if (isArray_1(elements)) {\n      for (var i = 0, len = elements.length; i < len; i++) {\n        rst = func(elements[i], i);\n\n        if (rst === false) {\n          break;\n        }\n      }\n    } else if (isObject_1(elements)) {\n      for (var k in elements) {\n        if (elements.hasOwnProperty(k)) {\n          rst = func(elements[k], k);\n\n          if (rst === false) {\n            break;\n          }\n        }\n      }\n    }\n  };\n\n  var each_1 = each$1;\n\n  function _inheritsLoose$2(subClass, superClass) {\n    subClass.prototype = Object.create(superClass.prototype);\n    subClass.prototype.constructor = subClass;\n    subClass.__proto__ = superClass;\n  }\n\n  var MARGIN_RATIO = 1 / 2;\n  var DODGE_RATIO = 1 / 2;\n\n  var Dodge = /*#__PURE__*/function (_Adjust) {\n    _inheritsLoose$2(Dodge, _Adjust);\n\n    function Dodge() {\n      return _Adjust.apply(this, arguments) || this;\n    }\n\n    var _proto = Dodge.prototype;\n\n    _proto._initDefaultCfg = function _initDefaultCfg() {\n      /**\n       * 调整过程中,2个数据的间距\n       * @type {Number}\n       */\n      this.marginRatio = MARGIN_RATIO;\n      /**\n       * 调整占单位宽度的比例,例如：占2个分类间距的 1/2\n       * @type {Number}\n       */\n\n      this.dodgeRatio = DODGE_RATIO;\n      this.adjustNames = ['x', 'y']; // 调整的维度，默认,x,y都做调整\n    };\n\n    _proto.getDodgeOffset = function getDodgeOffset(range, index, count) {\n      var self = this;\n      var pre = range.pre;\n      var next = range.next;\n      var tickLength = next - pre;\n      var width = tickLength * self.dodgeRatio / count;\n      var margin = self.marginRatio * width;\n      var offset = 1 / 2 * (tickLength - count * width - (count - 1) * margin) + ((index + 1) * width + index * margin) - 1 / 2 * width - 1 / 2 * tickLength;\n      return (pre + next) / 2 + offset;\n    };\n\n    _proto.processAdjust = function processAdjust(dataArray) {\n      var self = this;\n      var count = dataArray.length;\n      var xField = self.xField;\n      each_1(dataArray, function (data, index) {\n        for (var i = 0, len = data.length; i < len; i++) {\n          var obj = data[i];\n          var value = obj[xField];\n          var range = {\n            pre: len === 1 ? value - 1 : value - 0.5,\n            next: len === 1 ? value + 1 : value + 0.5\n          };\n          var dodgeValue = self.getDodgeOffset(range, index, count);\n          obj[xField] = dodgeValue;\n        }\n      });\n    };\n\n    return Dodge;\n  }(base);\n\n  base.Dodge = Dodge;\n  /**\n   * 是否为函数\n   * @param  {*} fn 对象\n   * @return {Boolean}  是否函数\n   */\n\n  var isFunction$1 = function isFunction(value) {\n    return isType_1(value, 'Function');\n  };\n\n  var isFunction_1 = isFunction$1;\n  /**\n   * @param {Array} arr The array to iterate over.\n   * @param {Function} [fn] The iteratee invoked per element.\n   * @return {*} Returns the maximum value.\n   * @example\n   *\n   * var objects = [{ 'n': 1 }, { 'n': 2 }];\n   *\n   * maxBy(objects, function(o) { return o.n; });\n   * // => { 'n': 2 }\n   *\n   * maxBy(objects, 'n');\n   * // => { 'n': 2 }\n   */\n\n  var maxBy = function maxBy(arr, fn) {\n    if (!isArray_1(arr)) {\n      return undefined;\n    }\n\n    var max = arr[0];\n    var maxData = void 0;\n\n    if (isFunction_1(fn)) {\n      maxData = fn(arr[0]);\n    } else {\n      maxData = arr[0][fn];\n    }\n\n    var data = void 0;\n    each_1(arr, function (val) {\n      if (isFunction_1(fn)) {\n        data = fn(val);\n      } else {\n        data = val[fn];\n      }\n\n      if (data > maxData) {\n        max = val;\n        maxData = data;\n      }\n    });\n    return max;\n  };\n\n  var maxBy_1 = maxBy;\n\n  var merge$1 = function merge(dataArray) {\n    var rst = [];\n\n    for (var i = 0; i < dataArray.length; i++) {\n      rst = rst.concat(dataArray[i]);\n    }\n\n    return rst;\n  };\n\n  var merge_1 = merge$1;\n\n  function _inheritsLoose$3(subClass, superClass) {\n    subClass.prototype = Object.create(superClass.prototype);\n    subClass.prototype.constructor = subClass;\n    subClass.__proto__ = superClass;\n  }\n\n  var ArrayUtil = {\n    merge: merge_1\n  };\n\n  var Symmetric = /*#__PURE__*/function (_Adjust) {\n    _inheritsLoose$3(Symmetric, _Adjust);\n\n    function Symmetric() {\n      return _Adjust.apply(this, arguments) || this;\n    }\n\n    var _proto = Symmetric.prototype;\n\n    _proto._initDefaultCfg = function _initDefaultCfg() {\n      this.xField = null; // 调整对应的 x 方向对应的字段名称\n\n      this.yField = null; // 调整对应的 y 方向对应的字段名称\n\n      this.cacheMax = null; // 缓存的最大值\n\n      this.adjustNames = ['y']; // Only support stack y\n\n      this.groupFields = null; // 参与分组的数据维度\n    }; // 获取最大的y值\n\n\n    _proto._getMax = function _getMax(dim) {\n      var self = this;\n      var mergeData = self.mergeData;\n      var maxRecord = maxBy_1(mergeData, function (obj) {\n        var value = obj[dim];\n\n        if (isArray_1(value)) {\n          return Math.max.apply(null, value);\n        }\n\n        return value;\n      });\n      var maxValue = maxRecord[dim];\n      var max = isArray_1(maxValue) ? Math.max.apply(null, maxValue) : maxValue;\n      return max;\n    }; // 获取每个字段最大的值\n\n\n    _proto._getXValuesMax = function _getXValuesMax() {\n      var self = this;\n      var yField = self.yField;\n      var xField = self.xField;\n      var cache = {};\n      var mergeData = self.mergeData;\n      each_1(mergeData, function (obj) {\n        var xValue = obj[xField];\n        var yValue = obj[yField];\n        var max = isArray_1(yValue) ? Math.max.apply(null, yValue) : yValue;\n        cache[xValue] = cache[xValue] || 0;\n\n        if (cache[xValue] < max) {\n          cache[xValue] = max;\n        }\n      });\n      return cache;\n    }; // 入口函数\n\n\n    _proto.processAdjust = function processAdjust(dataArray) {\n      var self = this;\n      var mergeData = ArrayUtil.merge(dataArray);\n      self.mergeData = mergeData;\n\n      self._processSymmetric(dataArray);\n\n      self.mergeData = null;\n    }; // 处理对称\n\n\n    _proto._processSymmetric = function _processSymmetric(dataArray) {\n      var self = this;\n      var xField = self.xField;\n      var yField = self.yField;\n\n      var max = self._getMax(yField);\n\n      var first = dataArray[0][0];\n      var cache;\n\n      if (first && isArray_1(first[yField])) {\n        cache = self._getXValuesMax();\n      }\n\n      each_1(dataArray, function (data) {\n        each_1(data, function (obj) {\n          var value = obj[yField];\n          var offset;\n\n          if (isArray_1(value)) {\n            var xValue = obj[xField];\n            var valueMax = cache[xValue];\n            offset = (max - valueMax) / 2;\n            var tmp = [];\n            /* eslint-disable no-loop-func */\n\n            each_1(value, function (subVal) {\n              // 多个字段\n              tmp.push(offset + subVal);\n            });\n            /* eslint-enable no-loop-func */\n\n            obj[yField] = tmp;\n          } else {\n            offset = (max - value) / 2;\n            obj[yField] = [offset, value + offset];\n          }\n        });\n      });\n    };\n\n    return Symmetric;\n  }(base);\n\n  base.Symmetric = Symmetric;\n\n  var Polar = /*#__PURE__*/function (_Base) {\n    _inheritsLoose(Polar, _Base);\n\n    function Polar() {\n      return _Base.apply(this, arguments) || this;\n    }\n\n    var _proto = Polar.prototype;\n\n    _proto._initDefaultCfg = function _initDefaultCfg() {\n      this.type = 'polar';\n      this.startAngle = -Math.PI / 2;\n      this.endAngle = Math.PI * 3 / 2;\n      this.inner = 0;\n      this.innerRadius = 0; // alias\n\n      this.isPolar = true;\n      this.transposed = false;\n      this.center = null;\n      this.radius = null; // relative, 0 ~ 1\n    };\n\n    _proto.init = function init(start, end) {\n      _Base.prototype.init.call(this, start, end);\n\n      var self = this;\n      var inner = self.inner || self.innerRadius;\n      var width = Math.abs(end.x - start.x);\n      var height = Math.abs(end.y - start.y);\n      var maxRadius;\n      var center;\n\n      if (self.startAngle === -Math.PI && self.endAngle === 0) {\n        maxRadius = Math.min(width / 2, height);\n        center = {\n          x: (start.x + end.x) / 2,\n          y: start.y\n        };\n      } else {\n        maxRadius = Math.min(width, height) / 2;\n        center = {\n          x: (start.x + end.x) / 2,\n          y: (start.y + end.y) / 2\n        };\n      }\n\n      var radius = self.radius;\n\n      if (radius > 0 && radius <= 1) {\n        maxRadius = maxRadius * radius;\n      }\n\n      this.x = {\n        start: self.startAngle,\n        end: self.endAngle\n      };\n      this.y = {\n        start: maxRadius * inner,\n        end: maxRadius\n      };\n      this.center = center;\n      this.circleRadius = maxRadius; // the radius value in px\n    };\n\n    _proto._convertPoint = function _convertPoint(point) {\n      var self = this;\n      var center = self.center;\n      var transposed = self.transposed;\n      var xDim = transposed ? 'y' : 'x';\n      var yDim = transposed ? 'x' : 'y';\n      var x = self.x;\n      var y = self.y;\n      var angle = x.start + (x.end - x.start) * point[xDim];\n      var radius = y.start + (y.end - y.start) * point[yDim];\n      return {\n        x: center.x + Math.cos(angle) * radius,\n        y: center.y + Math.sin(angle) * radius\n      };\n    };\n\n    _proto._invertPoint = function _invertPoint(point) {\n      var self = this;\n      var center = self.center,\n          transposed = self.transposed,\n          x = self.x,\n          y = self.y;\n      var xDim = transposed ? 'y' : 'x';\n      var yDim = transposed ? 'x' : 'y';\n      var m = [1, 0, 0, 1, 0, 0];\n      Matrix.rotate(m, m, x.start);\n      var startV = [1, 0];\n      Vector2.transformMat2d(startV, startV, m);\n      startV = [startV[0], startV[1]];\n      var pointV = [point.x - center.x, point.y - center.y];\n\n      if (Vector2.zero(pointV)) {\n        return {\n          x: 0,\n          y: 0\n        };\n      }\n\n      var theta = Vector2.angleTo(startV, pointV, x.end < x.start);\n\n      if (Math.abs(theta - Math.PI * 2) < 0.001) {\n        theta = 0;\n      }\n\n      var l = Vector2.length(pointV);\n      var percentX = theta / (x.end - x.start);\n      percentX = x.end - x.start > 0 ? percentX : -percentX;\n      var percentY = (l - y.start) / (y.end - y.start);\n      var rst = {};\n      rst[xDim] = percentX;\n      rst[yDim] = percentY;\n      return rst;\n    };\n\n    return Polar;\n  }(Base$1);\n\n  Base$1.Polar = Polar;\n\n  var Circle$1 = /*#__PURE__*/function (_Abstract) {\n    _inheritsLoose(Circle, _Abstract);\n\n    function Circle() {\n      return _Abstract.apply(this, arguments) || this;\n    }\n\n    var _proto = Circle.prototype;\n\n    _proto._initDefaultCfg = function _initDefaultCfg() {\n      _Abstract.prototype._initDefaultCfg.call(this);\n\n      this.startAngle = -Math.PI / 2; // start angle，in radian\n\n      this.endAngle = Math.PI * 3 / 2; // end angle, in radian\n\n      this.radius = null; // radius\n\n      this.center = null; // center\n    };\n\n    _proto.getOffsetPoint = function getOffsetPoint(value) {\n      var startAngle = this.startAngle,\n          endAngle = this.endAngle;\n      var angle = startAngle + (endAngle - startAngle) * value;\n      return this._getCirclePoint(angle);\n    };\n\n    _proto._getCirclePoint = function _getCirclePoint(angle, radius) {\n      var self = this;\n      var center = self.center;\n      radius = radius || self.radius;\n      return {\n        x: center.x + Math.cos(angle) * radius,\n        y: center.y + Math.sin(angle) * radius\n      };\n    };\n\n    _proto.getTextAlignInfo = function getTextAlignInfo(point, offset) {\n      var self = this;\n      var offsetVector = self.getOffsetVector(point, offset);\n      var align;\n      var baseLine = 'middle';\n\n      if (offsetVector[0] > 0) {\n        align = 'left';\n      } else if (offsetVector[0] < 0) {\n        align = 'right';\n      } else {\n        align = 'center';\n\n        if (offsetVector[1] > 0) {\n          baseLine = 'top';\n        } else if (offsetVector[1] < 0) {\n          baseLine = 'bottom';\n        }\n      }\n\n      return {\n        textAlign: align,\n        textBaseline: baseLine\n      };\n    };\n\n    _proto.getAxisVector = function getAxisVector(point) {\n      var center = this.center;\n      var factor = this.offsetFactor;\n      return [(point.y - center.y) * factor, (point.x - center.x) * -1 * factor];\n    };\n\n    _proto.drawLine = function drawLine(lineCfg) {\n      var center = this.center,\n          radius = this.radius,\n          startAngle = this.startAngle,\n          endAngle = this.endAngle;\n      var container = this.getContainer(lineCfg.top);\n      container.addShape('arc', {\n        className: 'axis-line',\n        attrs: mix({\n          x: center.x,\n          y: center.y,\n          r: radius,\n          startAngle: startAngle,\n          endAngle: endAngle\n        }, lineCfg)\n      });\n    };\n\n    return Circle;\n  }(Abastract);\n\n  Abastract.Circle = Circle$1;\n  var KEYWORDS_PERCENT = {\n    min: 0,\n    median: 0.5,\n    max: 1\n  };\n\n  var GuideBase = /*#__PURE__*/function () {\n    var _proto = GuideBase.prototype;\n\n    _proto._initDefaultCfg = function _initDefaultCfg() {};\n\n    function GuideBase(cfg) {\n      this._initDefaultCfg();\n\n      deepMix(this, cfg);\n    }\n\n    _proto._getNormalizedValue = function _getNormalizedValue(val, scale) {\n      var rst;\n\n      if (isNil(KEYWORDS_PERCENT[val])) {\n        rst = scale.scale(val);\n      } else {\n        rst = KEYWORDS_PERCENT[val];\n      }\n\n      return rst;\n    };\n\n    _proto.parsePercentPoint = function parsePercentPoint(coord, position) {\n      var xPercent = parseFloat(position[0]) / 100;\n      var yPercent = parseFloat(position[1]) / 100;\n      var start = coord.start;\n      var end = coord.end;\n      var width = Math.abs(start.x - end.x);\n      var height = Math.abs(start.y - end.y);\n      var x = width * xPercent + Math.min(start.x, end.x);\n      var y = height * yPercent + Math.min(start.y, end.y);\n      return {\n        x: x,\n        y: y\n      };\n    };\n\n    _proto.parsePoint = function parsePoint(coord, position) {\n      var self = this;\n      var xScale = self.xScale;\n      var yScales = self.yScales;\n\n      if (isFunction(position)) {\n        position = position(xScale, yScales); // position 必须是对象\n      } // 如果数据格式是 ['50%', '50%'] 的格式\n      // fix: 原始数据中可能会包含 'xxx5%xxx' 这样的数据，需要判断下 https://github.com/antvis/f2/issues/590\n\n\n      if (isString(position[0]) && position[0].indexOf('%') !== -1 && !isNaN(position[0].slice(0, -1))) {\n        return this.parsePercentPoint(coord, position);\n      }\n\n      var x = self._getNormalizedValue(position[0], xScale);\n\n      var y = self._getNormalizedValue(position[1], yScales[0]);\n\n      var point = coord.convertPoint({\n        x: x,\n        y: y\n      });\n\n      if (self.limitInPlot) {\n        // limit in chart plotRange\n        if (x >= 0 && x <= 1 && y >= 0 && y <= 1) {\n          return point;\n        }\n\n        return null;\n      }\n\n      return point;\n    }\n    /**\n     * render the guide component\n     * @param  {Coord} coord  coordinate instance\n     * @param  {Canvas.Group} group the container\n     */\n    ;\n\n    _proto.render = function render()\n    /* coord,group */\n    {};\n\n    _proto.repaint = function repaint() {\n      this.remove();\n      var coord = this.coord,\n          container = this.container,\n          canvas = this.canvas;\n\n      if (container && !container.isDestroyed()) {\n        this.render(coord, container);\n        canvas.draw();\n      }\n    };\n\n    _proto.remove = function remove() {\n      var element = this.element;\n      element && element.remove(true);\n    };\n\n    _proto.changeVisible = function changeVisible(visible) {\n      var self = this;\n      self.visible = visible;\n      var element = self.element;\n      if (!element) return;\n\n      if (element.set) {\n        element.set('visible', visible);\n      } else {\n        element.style.display = visible ? '' : 'none';\n      }\n    };\n\n    return GuideBase;\n  }();\n\n  var Arc$1 = /*#__PURE__*/function (_GuideBase) {\n    _inheritsLoose(Arc, _GuideBase);\n\n    function Arc() {\n      return _GuideBase.apply(this, arguments) || this;\n    }\n\n    var _proto = Arc.prototype;\n\n    _proto._initDefaultCfg = function _initDefaultCfg() {\n      this.type = 'arc';\n      /**\n       * start point\n       * @type {Array | Function}\n       */\n\n      this.start = [];\n      /**\n       * end point\n       * @type {Array | Function}\n       */\n\n      this.end = [];\n      /**\n       * style configuration\n       * @type {Object}\n       */\n\n      this.style = {\n        stroke: '#999',\n        lineWidth: 1\n      };\n    };\n\n    _proto.render = function render(coord, container) {\n      var self = this;\n      var start = self.parsePoint(coord, self.start);\n      var end = self.parsePoint(coord, self.end);\n\n      if (!start || !end) {\n        return;\n      }\n\n      var coordCenter = coord.center;\n      var radius = Math.sqrt((start.x - coordCenter.x) * (start.x - coordCenter.x) + (start.y - coordCenter.y) * (start.y - coordCenter.y));\n      var startAngle = Math.atan2(start.y - coordCenter.y, start.x - coordCenter.x);\n      var endAngle = Math.atan2(end.y - coordCenter.y, end.x - coordCenter.x);\n      var shape = container.addShape('arc', {\n        className: 'guide-arc',\n        attrs: mix({\n          x: coordCenter.x,\n          y: coordCenter.y,\n          r: radius,\n          startAngle: startAngle,\n          endAngle: endAngle\n        }, self.style)\n      });\n      self.element = shape;\n      return shape;\n    };\n\n    return Arc;\n  }(GuideBase);\n\n  GuideBase.Arc = Arc$1;\n\n  function getOffsetFromAlign(alignX, alignY, width, height) {\n    var result = [];\n\n    if (alignX === 'left' && alignY === 'top') {\n      result[0] = 0;\n      result[1] = 0;\n    } else if (alignX === 'right' && alignY === 'top') {\n      result[0] = -width;\n      result[1] = 0;\n    } else if (alignX === 'left' && alignY === 'bottom') {\n      result[0] = 0;\n      result[1] = Math.floor(-height);\n    } else if (alignX === 'right' && alignY === 'bottom') {\n      result[0] = Math.floor(-width);\n      result[1] = Math.floor(-height);\n    } else if (alignX === 'right' && alignY === 'middle') {\n      result[0] = Math.floor(-width);\n      result[1] = Math.floor(-height / 2);\n    } else if (alignX === 'left' && alignY === 'middle') {\n      result[0] = 0;\n      result[1] = Math.floor(-height / 2);\n    } else if (alignX === 'center' && alignY === 'bottom') {\n      result[0] = Math.floor(-width / 2);\n      result[1] = Math.floor(-height);\n    } else if (alignX === 'center' && alignY === 'top') {\n      result[0] = Math.floor(-width / 2);\n      result[1] = 0;\n    } else {\n      result[0] = Math.floor(-width / 2);\n      result[1] = Math.floor(-height / 2);\n    }\n\n    return result;\n  }\n\n  function modifyCSS(DOM, CSS) {\n    for (var key in CSS) {\n      if (CSS.hasOwnProperty(key)) {\n        DOM.style[key] = CSS[key];\n      }\n    }\n\n    return DOM;\n  }\n\n  function createDom(str) {\n    var container = document.createElement('div');\n    str = str.replace(/(^\\s*)|(\\s*$)/g, '');\n    container.innerHTML = '' + str;\n    return container.childNodes[0];\n  }\n\n  var Html = /*#__PURE__*/function (_GuideBase) {\n    _inheritsLoose(Html, _GuideBase);\n\n    function Html() {\n      return _GuideBase.apply(this, arguments) || this;\n    }\n\n    var _proto = Html.prototype;\n\n    _proto._initDefaultCfg = function _initDefaultCfg() {\n      this.type = 'html';\n      /**\n       * dom position\n       * @type {Object | Array}\n       */\n\n      this.position = null;\n      /**\n        * alignment for horizontal direction，can be 'left','center','right'\n        * @type {String}\n        */\n\n      this.alignX = 'center';\n      /**\n        * alignment for vertical direction，can be 'top', 'middle', 'bottom'\n        * @type {String}\n        */\n\n      this.alignY = 'middle';\n      /**\n        * offset for horizontal direction\n        * @type {Number}\n        */\n\n      this.offsetX = null;\n      /**\n        * offset for vertical direction\n        * @type {Number}\n        */\n\n      this.offsetY = null;\n      /**\n      * the html string\n      *@type {String | Function}\n      */\n\n      this.html = null;\n    } // override paint\n    ;\n\n    _proto.render = function render(coord, container) {\n      var self = this;\n      var position = self.parsePoint(coord, self.position);\n\n      if (!position) {\n        return;\n      }\n\n      var myNode = createDom(self.html);\n      myNode = modifyCSS(myNode, {\n        position: 'absolute',\n        top: Math.floor(position.y) + 'px',\n        left: Math.floor(position.x) + 'px',\n        visibility: 'hidden'\n      });\n      var canvasDom = container.get('canvas').get('el');\n      var parentNode = canvasDom.parentNode;\n      parentNode = modifyCSS(parentNode, {\n        position: 'relative'\n      });\n      var wrapperNode = createDom('<div class=\"guideWapper\" style=\"position: absolute;top: 0; left: 0;\"></div>');\n      parentNode.appendChild(wrapperNode);\n      wrapperNode.appendChild(myNode);\n      var canvasOffsetTop = canvasDom.offsetTop;\n      var canvasOffsetLeft = canvasDom.offsetLeft;\n      var alignX = self.alignX,\n          alignY = self.alignY,\n          offsetX = self.offsetX,\n          offsetY = self.offsetY;\n      var width = getWidth(myNode);\n      var height = getHeight(myNode);\n      var newOffset = getOffsetFromAlign(alignX, alignY, width, height);\n      position.x = position.x + newOffset[0] + canvasOffsetLeft;\n      position.y = position.y + newOffset[1] + canvasOffsetTop;\n\n      if (offsetX) {\n        position.x += offsetX;\n      }\n\n      if (offsetY) {\n        position.y += offsetY;\n      }\n\n      modifyCSS(myNode, {\n        top: Math.floor(position.y) + 'px',\n        left: Math.floor(position.x) + 'px',\n        visibility: 'visible'\n      });\n      self.element = wrapperNode;\n    };\n\n    _proto.remove = function remove() {\n      var element = this.element;\n      element && element.parentNode && element.parentNode.removeChild(element);\n    };\n\n    return Html;\n  }(GuideBase);\n\n  GuideBase.Html = Html;\n\n  var Line$4 = /*#__PURE__*/function (_GuideBase) {\n    _inheritsLoose(Line, _GuideBase);\n\n    function Line() {\n      return _GuideBase.apply(this, arguments) || this;\n    }\n\n    var _proto = Line.prototype;\n\n    _proto._initDefaultCfg = function _initDefaultCfg() {\n      this.type = 'line';\n      this.start = [];\n      this.end = [];\n      this.style = {\n        stroke: '#000',\n        lineWidth: 1\n      };\n    };\n\n    _proto.render = function render(coord, container) {\n      var points = [];\n      points[0] = this.parsePoint(coord, this.start);\n      points[1] = this.parsePoint(coord, this.end);\n\n      if (!points[0] || !points[1]) {\n        return;\n      }\n\n      var shape = container.addShape('Line', {\n        className: 'guide-line',\n        attrs: mix({\n          x1: points[0].x,\n          y1: points[0].y,\n          x2: points[1].x,\n          y2: points[1].y\n        }, this.style)\n      });\n      this.element = shape;\n      return shape;\n    };\n\n    return Line;\n  }(GuideBase);\n\n  GuideBase.Line = Line$4;\n\n  var Rect$2 = /*#__PURE__*/function (_GuideBase) {\n    _inheritsLoose(Rect, _GuideBase);\n\n    function Rect() {\n      return _GuideBase.apply(this, arguments) || this;\n    }\n\n    var _proto = Rect.prototype;\n\n    _proto._initDefaultCfg = function _initDefaultCfg() {\n      this.type = 'rect';\n      this.start = [];\n      this.end = [];\n      this.style = {\n        fill: '#CCD7EB',\n        opacity: 0.4\n      };\n    };\n\n    _proto.render = function render(coord, container) {\n      var start = this.parsePoint(coord, this.start);\n      var end = this.parsePoint(coord, this.end);\n\n      if (!start || !end) {\n        return;\n      }\n\n      var shape = container.addShape('rect', {\n        className: 'guide-rect',\n        attrs: mix({\n          x: Math.min(start.x, end.x),\n          y: Math.min(start.y, end.y),\n          width: Math.abs(end.x - start.x),\n          height: Math.abs(start.y - end.y)\n        }, this.style)\n      });\n      this.element = shape;\n      return shape;\n    };\n\n    return Rect;\n  }(GuideBase);\n\n  GuideBase.Rect = Rect$2;\n\n  var Text$1 = /*#__PURE__*/function (_GuideBase) {\n    _inheritsLoose(Text, _GuideBase);\n\n    function Text() {\n      return _GuideBase.apply(this, arguments) || this;\n    }\n\n    var _proto = Text.prototype;\n\n    _proto._initDefaultCfg = function _initDefaultCfg() {\n      this.type = 'text';\n      /**\n       * the position of text\n       * @type {Function | Array}\n       */\n\n      this.position = null;\n      /**\n       * the display content\n       * @type {String}\n       */\n\n      this.content = null;\n      /**\n       * style configuration for text\n       * @type {Object}\n       */\n\n      this.style = {\n        fill: '#000'\n      };\n      /**\n       * offset of horizontal direction\n       * @type {Number}\n       */\n\n      this.offsetX = 0;\n      /**\n       * offset of vertical direction\n       * @type {Number}\n       */\n\n      this.offsetY = 0;\n    };\n\n    _proto.render = function render(coord, container) {\n      var position = this.position;\n      var point = this.parsePoint(coord, position);\n\n      if (!point) {\n        return;\n      }\n\n      var content = this.content,\n          style = this.style,\n          offsetX = this.offsetX,\n          offsetY = this.offsetY;\n\n      if (offsetX) {\n        point.x += offsetX;\n      }\n\n      if (offsetY) {\n        point.y += offsetY;\n      }\n\n      var shape = container.addShape('text', {\n        className: 'guide-text',\n        attrs: mix({\n          x: point.x,\n          y: point.y,\n          text: content\n        }, style)\n      });\n      this.element = shape;\n      return shape;\n    };\n\n    return Text;\n  }(GuideBase);\n\n  GuideBase.Text = Text$1;\n\n  var Tag = /*#__PURE__*/function (_GuideBase) {\n    _inheritsLoose(Tag, _GuideBase);\n\n    function Tag() {\n      return _GuideBase.apply(this, arguments) || this;\n    }\n\n    var _proto = Tag.prototype;\n\n    _proto._initDefaultCfg = function _initDefaultCfg() {\n      this.type = 'tag';\n      this.position = null;\n      this.content = null;\n      this.direct = 'tl';\n      this.autoAdjust = true;\n      this.offsetX = 0;\n      this.offsetY = 0;\n      this.side = 4;\n      this.background = {\n        padding: 5,\n        radius: 2,\n        fill: '#1890FF'\n      };\n      this.textStyle = {\n        fontSize: 12,\n        fill: '#fff',\n        textAlign: 'center',\n        textBaseline: 'middle'\n      };\n      this.withPoint = true;\n      this.pointStyle = {\n        fill: '#1890FF',\n        r: 3,\n        lineWidth: 1,\n        stroke: '#fff'\n      };\n    };\n\n    _proto._getDirect = function _getDirect(container, point, tagWidth, tagHeight) {\n      var direct = this.direct;\n      var side = this.side;\n      var canvas = container.get('canvas');\n      var clientWidth = canvas.get('width');\n      var clientHeight = canvas.get('height');\n      var x = point.x,\n          y = point.y;\n      var vertical = direct[0];\n      var horizontal = direct[1]; // adjust for vertical direction\n\n      if (vertical === 't' && y - side - tagHeight < 0) {\n        vertical = 'b';\n      } else if (vertical === 'b' && y + side + tagHeight > clientHeight) {\n        vertical = 't';\n      } // adjust for horizontal direction\n\n\n      var diff = vertical === 'c' ? side : 0;\n\n      if (horizontal === 'l' && x - diff - tagWidth < 0) {\n        horizontal = 'r';\n      } else if (horizontal === 'r' && x + diff + tagWidth > clientWidth) {\n        horizontal = 'l';\n      } else if (horizontal === 'c') {\n        if (tagWidth / 2 + x + diff > clientWidth) {\n          horizontal = 'l';\n        } else if (x - tagWidth / 2 - diff < 0) {\n          horizontal = 'r';\n        }\n      }\n\n      direct = vertical + horizontal;\n      return direct;\n    };\n\n    _proto.render = function render(coord, container) {\n      var position = this.parsePoint(coord, this.position);\n\n      if (!position) {\n        return;\n      } // 数据不在显示范围内时，x/y 会为NaN\n\n\n      if (isNaN(position.x) || isNaN(position.y)) {\n        return;\n      }\n\n      var content = this.content,\n          background = this.background,\n          textStyle = this.textStyle;\n      var shapes = [];\n      var wrapperContainer = container.addGroup({\n        className: 'guide-tag'\n      });\n\n      if (this.withPoint) {\n        var pointShape = wrapperContainer.addShape('Circle', {\n          className: 'guide-tag-point',\n          attrs: mix({\n            x: position.x,\n            y: position.y\n          }, this.pointStyle)\n        });\n        shapes.push(pointShape);\n      }\n\n      var tagContainer = wrapperContainer.addGroup(); // create a text shape\n\n      var tagText = tagContainer.addShape('text', {\n        className: 'guide-tag-text',\n        zIndex: 1,\n        attrs: mix({\n          x: 0,\n          y: 0,\n          text: content\n        }, textStyle)\n      });\n      shapes.push(tagText); // create background box\n\n      var textBBox = tagText.getBBox();\n      var padding = parsePadding(background.padding);\n      var tagWidth = textBBox.width + padding[1] + padding[3];\n      var tagHeight = textBBox.height + padding[0] + padding[2];\n      var yMin = textBBox.minY - padding[0];\n      var xMin = textBBox.minX - padding[3];\n      var tagBg = tagContainer.addShape('rect', {\n        className: 'guide-tag-bg',\n        zIndex: -1,\n        attrs: mix({\n          x: xMin,\n          y: yMin,\n          width: tagWidth,\n          height: tagHeight\n        }, background)\n      });\n      shapes.push(tagBg);\n      var direct = this.autoAdjust ? this._getDirect(container, position, tagWidth, tagHeight) : this.direct;\n      var side = this.side;\n      var x = position.x + this.offsetX;\n      var y = position.y + this.offsetY;\n      var arrowPoints;\n      var radius = parsePadding(background.radius);\n\n      if (direct === 'tl') {\n        arrowPoints = [{\n          x: tagWidth + xMin - side - 1,\n          y: tagHeight + yMin - 1\n        }, // 这个 1 是为了防止出现白边\n        {\n          x: tagWidth + xMin,\n          y: tagHeight + yMin - 1\n        }, {\n          x: tagWidth + xMin,\n          y: tagHeight + side + yMin\n        }];\n        radius[2] = 0;\n        x = x - tagWidth;\n        y = y - side - tagHeight;\n      } else if (direct === 'cl') {\n        arrowPoints = [{\n          x: tagWidth + xMin - 1,\n          y: (tagHeight - side) / 2 + yMin - 1\n        }, {\n          x: tagWidth + xMin - 1,\n          y: (tagHeight + side) / 2 + yMin + 1\n        }, {\n          x: tagWidth + side + xMin,\n          y: tagHeight / 2 + yMin\n        }];\n        x = x - tagWidth - side;\n        y = y - tagHeight / 2;\n      } else if (direct === 'bl') {\n        arrowPoints = [{\n          x: tagWidth + xMin,\n          y: -side + yMin\n        }, {\n          x: tagWidth + xMin - side - 1,\n          y: yMin + 1\n        }, {\n          x: tagWidth + xMin,\n          y: yMin + 1\n        }];\n        radius[1] = 0;\n        x = x - tagWidth;\n        y = y + side;\n      } else if (direct === 'bc') {\n        arrowPoints = [{\n          x: tagWidth / 2 + xMin,\n          y: -side + yMin\n        }, {\n          x: (tagWidth - side) / 2 + xMin - 1,\n          y: yMin + 1\n        }, {\n          x: (tagWidth + side) / 2 + xMin + 1,\n          y: yMin + 1\n        }];\n        x = x - tagWidth / 2;\n        y = y + side;\n      } else if (direct === 'br') {\n        arrowPoints = [{\n          x: xMin,\n          y: yMin - side\n        }, {\n          x: xMin,\n          y: yMin + 1\n        }, {\n          x: xMin + side + 1,\n          y: yMin + 1\n        }];\n        radius[0] = 0;\n        y = y + side;\n      } else if (direct === 'cr') {\n        arrowPoints = [{\n          x: xMin - side,\n          y: tagHeight / 2 + yMin\n        }, {\n          x: xMin + 1,\n          y: (tagHeight - side) / 2 + yMin - 1\n        }, {\n          x: xMin + 1,\n          y: (tagHeight + side) / 2 + yMin + 1\n        }];\n        x = x + side;\n        y = y - tagHeight / 2;\n      } else if (direct === 'tr') {\n        arrowPoints = [{\n          x: xMin,\n          y: tagHeight + side + yMin\n        }, {\n          x: xMin,\n          y: tagHeight + yMin - 1\n        }, {\n          x: side + xMin + 1,\n          y: tagHeight + yMin - 1\n        }];\n        radius[3] = 0;\n        y = y - tagHeight - side;\n      } else if (direct === 'tc') {\n        arrowPoints = [{\n          x: (tagWidth - side) / 2 + xMin - 1,\n          y: tagHeight + yMin - 1\n        }, {\n          x: (tagWidth + side) / 2 + xMin + 1,\n          y: tagHeight + yMin - 1\n        }, {\n          x: tagWidth / 2 + xMin,\n          y: tagHeight + side + yMin\n        }];\n        x = x - tagWidth / 2;\n        y = y - tagHeight - side;\n      }\n\n      var sideShape = tagContainer.addShape('Polygon', {\n        className: 'guide-tag-side',\n        zIndex: 0,\n        attrs: {\n          points: arrowPoints,\n          fill: background.fill\n        }\n      });\n      shapes.push(sideShape);\n      tagBg.attr('radius', radius);\n      tagContainer.moveTo(x - xMin, y - yMin);\n      tagContainer.sort();\n      this.element = wrapperContainer;\n      return shapes;\n    };\n\n    return Tag;\n  }(GuideBase);\n\n  GuideBase.Tag = Tag;\n\n  var Point$2 = /*#__PURE__*/function (_GuideBase) {\n    _inheritsLoose(Point, _GuideBase);\n\n    function Point() {\n      return _GuideBase.apply(this, arguments) || this;\n    }\n\n    var _proto = Point.prototype;\n\n    _proto._initDefaultCfg = function _initDefaultCfg() {\n      this.type = 'point';\n      this.position = null;\n      this.offsetX = 0;\n      this.offsetY = 0;\n      this.style = {\n        fill: '#1890FF',\n        r: 3,\n        lineWidth: 1,\n        stroke: '#fff'\n      };\n    };\n\n    _proto.render = function render(coord, container) {\n      var position = this.parsePoint(coord, this.position);\n      if (!position) return null;\n      var shape = container.addShape('Circle', {\n        className: 'guide-point',\n        attrs: mix({\n          x: position.x + this.offsetX,\n          y: position.y + this.offsetY\n        }, this.style)\n      });\n      this.element = shape;\n      return shape;\n    };\n\n    return Point;\n  }(GuideBase);\n\n  GuideBase.Point = Point$2;\n  var MARKER_RADIUS = 3;\n\n  var List = /*#__PURE__*/function () {\n    var _proto = List.prototype;\n\n    _proto.getDefaultCfg = function getDefaultCfg() {\n      return {\n        showTitle: false,\n\n        /**\n         * title string\n         * @type {?String}\n         */\n        title: null,\n\n        /**\n         * items array\n         * @type {?Array}\n         */\n        items: null,\n\n        /**\n         * offset between title and items\n         * @type {Number}\n         */\n        titleGap: 12,\n\n        /**\n         * offset between each item\n         * @type {Number}\n         */\n        itemGap: 10,\n\n        /**\n         * the offset between each item in vertical direaction\n         * @type {Number}\n         */\n        itemMarginBottom: 12,\n\n        /**\n         * the formatter for item text\n         * @type {[type]}\n         */\n        itemFormatter: null,\n        itemWidth: null,\n\n        /**\n         * offset between marker and text\n         * @type {Number}\n         */\n        wordSpace: 6,\n        x: 0,\n        y: 0,\n        layout: 'horizontal',\n\n        /**\n         * the join string of `name` and `value`\n         * @type {String}\n         */\n        joinString: ': '\n      };\n    };\n\n    function List(cfg) {\n      deepMix(this, this.getDefaultCfg(), cfg);\n\n      this._init();\n\n      this._renderTitle();\n\n      this._renderItems();\n    }\n\n    _proto._init = function _init() {\n      var parent = this.parent;\n      if (!parent) return;\n      var container = parent.addGroup({\n        zIndex: this.zIndex || 0\n      });\n      this.container = container;\n      var wrapper = container.addGroup();\n      this.wrapper = wrapper;\n      var itemsGroup = wrapper.addGroup({\n        className: 'itemsGroup'\n      });\n      this.itemsGroup = itemsGroup;\n    };\n\n    _proto._renderTitle = function _renderTitle(title) {\n      title = title || this.title;\n      var titleShape = this.titleShape;\n      var titleHeight = 0;\n\n      if (this.showTitle && title) {\n        if (titleShape && !titleShape.get('destroyed')) {\n          titleShape.attr('text', title);\n        } else {\n          var wrapper = this.wrapper,\n              titleStyle = this.titleStyle;\n          titleShape = wrapper.addShape('text', {\n            className: 'title',\n            attrs: mix({\n              x: 0,\n              y: 0,\n              text: title\n            }, titleStyle)\n          });\n          this.titleShape = titleShape;\n        }\n\n        titleHeight = titleShape.getBBox().height + this.titleGap;\n      }\n\n      this._titleHeight = titleHeight;\n    };\n\n    _proto._renderItems = function _renderItems(items) {\n      var self = this;\n      items = items || self.items;\n\n      if (!items) {\n        return;\n      }\n\n      if (self.reversed) {\n        items.reverse();\n      }\n\n      each(items, function (item, index) {\n        self._addItem(item, index);\n      });\n\n      if (items.length > 1) {\n        this._adjustItems();\n      }\n\n      this._renderBackground();\n    };\n\n    _proto._renderBackground = function _renderBackground() {\n      var background = this.background;\n\n      if (background) {\n        var container = this.container;\n        var wrapper = this.wrapper;\n\n        var _wrapper$getBBox = wrapper.getBBox(),\n            minX = _wrapper$getBBox.minX,\n            minY = _wrapper$getBBox.minY,\n            width = _wrapper$getBBox.width,\n            height = _wrapper$getBBox.height;\n\n        var padding = background.padding || [0, 0, 0, 0];\n        padding = parsePadding(padding);\n        var attrs = mix({\n          x: minX - padding[3],\n          y: minY - padding[0],\n          width: width + padding[1] + padding[3],\n          height: height + padding[0] + padding[2]\n        }, background);\n        var backShape = this.backShape;\n\n        if (backShape) {\n          backShape.attr(attrs);\n        } else {\n          backShape = container.addShape('Rect', {\n            zIndex: -1,\n            attrs: attrs\n          });\n        }\n\n        this.backShape = backShape;\n        container.sort();\n      }\n    };\n\n    _proto._addItem = function _addItem(item) {\n      var itemsGroup = this.itemsGroup;\n      var itemGroup = itemsGroup.addGroup({\n        name: item.name,\n        value: item.value,\n        dataValue: item.dataValue,\n        checked: item.checked\n      });\n      var unCheckStyle = this.unCheckStyle,\n          unCheckColor = this.unCheckColor,\n          nameStyle = this.nameStyle,\n          valueStyle = this.valueStyle,\n          wordSpace = this.wordSpace;\n      var marker = item.marker,\n          value = item.value;\n      var startX = 0;\n\n      if (unCheckColor) {\n        unCheckStyle.fill = unCheckColor;\n      }\n\n      if (marker) {\n        var radius = marker.radius || MARKER_RADIUS;\n        var markerAttrs = mix({\n          x: radius,\n          y: this._titleHeight\n        }, marker);\n\n        if (item.checked === false) {\n          mix(markerAttrs, unCheckStyle);\n        }\n\n        var markerShape = itemGroup.addShape('marker', {\n          className: 'item-marker',\n          attrs: markerAttrs\n        });\n        startX += markerShape.getBBox().width + wordSpace;\n      }\n\n      var nameText;\n      var name = item.name;\n\n      if (name) {\n        var joinString = this.joinString || '';\n        name = value ? name + joinString : name;\n        nameText = itemGroup.addShape('text', {\n          className: 'name',\n          attrs: mix({\n            x: startX,\n            y: this._titleHeight,\n            text: this._formatItemValue(name)\n          }, nameStyle, item.checked === false ? unCheckStyle : null)\n        });\n      }\n\n      if (value) {\n        var valueX = startX;\n\n        if (nameText) {\n          valueX += nameText.getBBox().width;\n        }\n\n        itemGroup.addShape('text', {\n          className: 'value',\n          attrs: mix({\n            x: valueX,\n            y: this._titleHeight,\n            text: value\n          }, valueStyle, item.checked === false ? unCheckStyle : null)\n        });\n      }\n\n      return itemGroup;\n    };\n\n    _proto._formatItemValue = function _formatItemValue(value) {\n      var formatter = this.itemFormatter;\n\n      if (formatter) {\n        value = formatter.call(this, value);\n      }\n\n      return value;\n    };\n\n    _proto._getMaxItemWidth = function _getMaxItemWidth() {\n      var width;\n      var itemWidth = this.itemWidth;\n\n      if (isNumber(itemWidth) || isNil(itemWidth)) {\n        return itemWidth;\n      }\n\n      if (itemWidth === 'auto') {\n        var itemsGroup = this.itemsGroup;\n        var children = itemsGroup.get('children');\n        var count = children.length;\n        var maxItemWidth = 0;\n\n        for (var i = 0; i < count; i++) {\n          var _children$i$getBBox = children[i].getBBox(),\n              _width = _children$i$getBBox.width;\n\n          maxItemWidth = Math.max(maxItemWidth, _width);\n        }\n\n        var maxLength = this.maxLength;\n        var itemGap = this.itemGap;\n        var twoAvgWidth = (maxLength - itemGap) / 2;\n        var threeAvgWidth = (maxLength - itemGap * 2) / 3;\n\n        if (count === 2) {\n          width = Math.max(maxItemWidth, twoAvgWidth);\n        } else {\n          // 1. max <= 3Avg, 3Avg\n          // 2. 3Avg < max && max < 2avg, 2avg\n          // 3. max > 2avg, max, one column\n          if (maxItemWidth <= threeAvgWidth) {\n            width = threeAvgWidth;\n          } else if (maxItemWidth <= twoAvgWidth) {\n            width = twoAvgWidth;\n          } else {\n            width = maxItemWidth;\n          }\n        }\n\n        return width;\n      }\n    };\n\n    _proto._adjustHorizontal = function _adjustHorizontal() {\n      var maxLength = this.maxLength,\n          itemsGroup = this.itemsGroup;\n      var children = itemsGroup.get('children');\n      var itemGap = this.itemGap,\n          itemMarginBottom = this.itemMarginBottom;\n      var titleHeight = this._titleHeight;\n      var row = 0;\n      var rowWidth = 0;\n      var width;\n      var height;\n\n      var itemWidth = this._getMaxItemWidth();\n\n      var legendHitBoxes = [];\n\n      for (var i = 0, len = children.length; i < len; i++) {\n        var child = children[i];\n        var box = child.getBBox();\n        var childHeight = box.height;\n        var childWidth = box.width;\n        width = itemWidth || childWidth;\n        height = childHeight + itemMarginBottom;\n\n        if (width - (maxLength - rowWidth) > 0.0001) {\n          row++;\n          rowWidth = 0;\n        }\n\n        child.moveTo(rowWidth, row * height);\n        legendHitBoxes.push({\n          x: rowWidth,\n          y: row * height + titleHeight - childHeight / 2,\n          width: childWidth * 1.375,\n          height: childHeight * 1.375\n        });\n        rowWidth += width + itemGap;\n      }\n\n      this.legendHitBoxes = legendHitBoxes;\n      return;\n    };\n\n    _proto._adjustVertical = function _adjustVertical() {\n      var maxLength = this.maxLength,\n          itemsGroup = this.itemsGroup;\n      var itemGap = this.itemGap,\n          itemMarginBottom = this.itemMarginBottom,\n          itemWidth = this.itemWidth;\n      var titleHeight = this._titleHeight;\n      var children = itemsGroup.get('children');\n      var colHeight = 0;\n      var width;\n      var height;\n      var maxItemWidth = 0;\n      var totalWidth = 0;\n      var legendHitBoxes = [];\n\n      for (var i = 0, length = children.length; i < length; i++) {\n        var child = children[i];\n        var bbox = child.getBBox();\n        width = bbox.width;\n        height = bbox.height;\n\n        if (isNumber(itemWidth)) {\n          maxItemWidth = itemWidth + itemGap;\n        } else if (width > maxItemWidth) {\n          maxItemWidth = width + itemGap;\n        }\n\n        if (maxLength - colHeight < height) {\n          colHeight = 0;\n          totalWidth += maxItemWidth;\n          child.moveTo(totalWidth, 0);\n          legendHitBoxes.push({\n            x: totalWidth,\n            y: titleHeight - height / 2,\n            width: width * 1.375,\n            height: height * 1.375\n          });\n        } else {\n          child.moveTo(totalWidth, colHeight);\n          legendHitBoxes.push({\n            x: totalWidth,\n            y: colHeight - height / 2 + titleHeight,\n            width: width * 1.375,\n            height: height * 1.375\n          });\n        }\n\n        colHeight += height + itemMarginBottom;\n      }\n\n      this.legendHitBoxes = legendHitBoxes;\n      return;\n    };\n\n    _proto._adjustItems = function _adjustItems() {\n      var layout = this.layout;\n\n      if (layout === 'horizontal') {\n        this._adjustHorizontal();\n      } else {\n        this._adjustVertical();\n      }\n    };\n\n    _proto.moveTo = function moveTo(x, y) {\n      this.x = x;\n      this.y = y;\n      var container = this.container;\n      container && container.moveTo(x, y);\n      return this;\n    };\n\n    _proto.setItems = function setItems(items) {\n      this.clearItems();\n\n      this._renderItems(items);\n    };\n\n    _proto.setTitle = function setTitle(title) {\n      this._renderTitle(title);\n    };\n\n    _proto.clearItems = function clearItems() {\n      var itemsGroup = this.itemsGroup;\n      itemsGroup.clear();\n    };\n\n    _proto.getWidth = function getWidth() {\n      var container = this.container;\n      var bbox = container.getBBox();\n      return bbox.width;\n    };\n\n    _proto.getHeight = function getHeight() {\n      var container = this.container;\n      var bbox = container.getBBox();\n      return bbox.height;\n    };\n\n    _proto.show = function show() {\n      var container = this.container;\n      container.show();\n    };\n\n    _proto.hide = function hide() {\n      var container = this.container;\n      container.hide();\n    };\n\n    _proto.clear = function clear() {\n      var container = this.container;\n      container.clear();\n      container.remove(true);\n    };\n\n    return List;\n  }();\n\n  var TextBox = /*#__PURE__*/function () {\n    var _proto = TextBox.prototype;\n\n    _proto.getDefaultCfg = function getDefaultCfg() {\n      return {\n        x: 0,\n        y: 0,\n        content: '',\n        textStyle: {\n          fontSize: 12,\n          fill: '#fff',\n          textAlign: 'center',\n          textBaseline: 'middle',\n          fontFamily: 'Arial'\n        },\n        background: {\n          radius: 1,\n          fill: 'rgba(0, 0, 0, 0.65)',\n          padding: [3, 5]\n        },\n        width: 0,\n        height: 0,\n        className: ''\n      };\n    };\n\n    function TextBox(cfg) {\n      deepMix(this, this.getDefaultCfg(), cfg);\n\n      this._init();\n\n      var content = this.content,\n          x = this.x,\n          y = this.y;\n\n      if (!isNil(content)) {\n        this.updateContent(content);\n      }\n\n      this.updatePosition(x, y);\n    }\n\n    _proto._init = function _init() {\n      var content = this.content,\n          textStyle = this.textStyle,\n          background = this.background,\n          className = this.className,\n          visible = this.visible,\n          context = this.context;\n      var container = new Group({\n        context: context,\n        className: className,\n        zIndex: 0,\n        visible: visible\n      });\n      var text = container.addShape('Text', {\n        className: className + '-text',\n        zIndex: 1,\n        attrs: mix({\n          text: content,\n          x: 0,\n          y: 0\n        }, textStyle)\n      });\n      var backgroundShape = container.addShape('Rect', {\n        className: className + '-bg',\n        zIndex: -1,\n        attrs: mix({\n          x: 0,\n          y: 0,\n          width: 0,\n          height: 0\n        }, background)\n      });\n      container.sort();\n      this.container = container;\n      this.textShape = text;\n      this.backgroundShape = backgroundShape;\n    };\n\n    _proto._getBBox = function _getBBox() {\n      var textShape = this.textShape;\n      var background = this.background;\n      var textBBox = textShape.getBBox();\n      var padding = parsePadding(background.padding);\n      var width = textBBox.width + padding[1] + padding[3];\n      var height = textBBox.height + padding[0] + padding[2];\n      var x = textBBox.minX - padding[3];\n      var y = textBBox.minY - padding[0];\n      return {\n        x: x,\n        y: y,\n        width: width,\n        height: height\n      };\n    };\n\n    _proto.updateContent = function updateContent(text) {\n      var textShape = this.textShape,\n          backgroundShape = this.backgroundShape;\n\n      if (!isNil(text)) {\n        if (!isObject(text)) {\n          text = {\n            text: text\n          };\n        }\n\n        textShape.attr(text); // update box shape\n\n        var _this$_getBBox = this._getBBox(),\n            x = _this$_getBBox.x,\n            y = _this$_getBBox.y,\n            tipWidth = _this$_getBBox.width,\n            tipHeight = _this$_getBBox.height;\n\n        var width = this.width || tipWidth;\n        var height = this.height || tipHeight;\n        backgroundShape.attr({\n          x: x,\n          y: y,\n          width: width,\n          height: height\n        });\n        this._width = width;\n        this._height = height;\n        this.content = text.text;\n      }\n    };\n\n    _proto.updatePosition = function updatePosition(x, y) {\n      var container = this.container;\n\n      var _this$_getBBox2 = this._getBBox(),\n          xMin = _this$_getBBox2.x,\n          yMin = _this$_getBBox2.y;\n\n      container.moveTo(x - xMin, y - yMin);\n      this.x = x - xMin;\n      this.y = y - yMin;\n    };\n\n    _proto.getWidth = function getWidth() {\n      return this._width;\n    };\n\n    _proto.getHeight = function getHeight() {\n      return this._height;\n    };\n\n    _proto.show = function show() {\n      this.container.show();\n    };\n\n    _proto.hide = function hide() {\n      this.container.hide();\n    };\n\n    _proto.clear = function clear() {\n      var container = this.container;\n      container.clear();\n      container.remove(true);\n      this.container = null;\n      this.textShape = null;\n      this.backgroundShape = null;\n    };\n\n    return TextBox;\n  }();\n\n  var GAP = 4;\n  /**\n   * TODOList：\n   * 1. 移除 fixed 参数\n   */\n\n  var Tooltip = /*#__PURE__*/function () {\n    var _proto = Tooltip.prototype;\n\n    _proto.getDefaultCfg = function getDefaultCfg() {\n      return {\n        /**\n         * wether show the crosshairs\n         * @type {Object}\n         */\n        showCrosshairs: false,\n\n        /**\n         * the style for crosshairs\n         * @type {Object}\n         */\n        crosshairsStyle: {\n          stroke: 'rgba(0, 0, 0, 0.25)',\n          lineWidth: 1\n        },\n\n        /**\n         * the type of crosshairs, optional value is 'x', 'y' or 'xy', default is 'y'\n         */\n        crosshairsType: 'y',\n\n        /**\n         * show or hide the x axis tip\n         */\n        showXTip: false,\n\n        /**\n         * show or hide the y axis tip\n         */\n        showYTip: false,\n        xTip: null,\n        xTipBackground: {\n          radius: 1,\n          fill: 'rgba(0, 0, 0, 0.65)',\n          padding: [3, 5]\n        },\n        xTipTextStyle: {\n          fontSize: 12,\n          fill: '#fff',\n          textAlign: 'center',\n          textBaseline: 'middle'\n        },\n        yTip: null,\n        yTipBackground: {\n          radius: 1,\n          fill: 'rgba(0, 0, 0, 0.65)',\n          padding: [3, 5]\n        },\n        yTipTextStyle: {\n          fontSize: 12,\n          fill: '#fff',\n          textAlign: 'center',\n          textBaseline: 'middle'\n        },\n\n        /**\n         * the style for tooltip container's background\n         * @type {Object}\n         */\n        background: null,\n\n        /**\n         * layout, can be horizontal or vertical\n         * @type {String}\n         */\n        layout: 'horizontal',\n        offsetX: 0,\n        offsetY: 0\n      };\n    };\n\n    function Tooltip(cfg) {\n      deepMix(this, this.getDefaultCfg(), cfg);\n      var frontPlot = this.frontPlot,\n          custom = this.custom;\n\n      if (!custom) {\n        // custom means user do customize\n        var container = new List(mix({\n          parent: frontPlot,\n          zIndex: 3\n        }, cfg));\n        this.container = container;\n        var fixed = this.fixed,\n            background = this.background;\n\n        if (!fixed) {\n          this.tooltipArrow = frontPlot.addShape('Polygon', {\n            className: 'tooltip-arrow',\n            visible: false,\n            zIndex: 2,\n            attrs: mix({\n              points: []\n            }, background)\n          });\n        }\n      }\n\n      if (this.showXTip) {\n        var xTipBackground = this.xTipBackground,\n            xTipTextStyle = this.xTipTextStyle;\n        var xTipBox = new TextBox({\n          context: frontPlot.get('context'),\n          className: 'xTip',\n          background: xTipBackground,\n          textStyle: xTipTextStyle,\n          visible: false\n        });\n        frontPlot.add(xTipBox.container);\n        this.xTipBox = xTipBox;\n      }\n\n      if (this.showYTip) {\n        var yTipBackground = this.yTipBackground,\n            yTipTextStyle = this.yTipTextStyle;\n        var yTipBox = new TextBox({\n          context: frontPlot.get('context'),\n          className: 'yTip',\n          background: yTipBackground,\n          textStyle: yTipTextStyle,\n          visible: false\n        });\n        frontPlot.add(yTipBox.container);\n        this.yTipBox = yTipBox;\n      }\n\n      if (this.showCrosshairs) {\n        this._renderCrosshairs();\n      }\n\n      frontPlot.sort();\n    }\n\n    _proto.setContent = function setContent(title, items) {\n      this.title = title;\n      this.items = items;\n\n      if (!this.custom) {\n        var container = this.container;\n        container.setTitle(title);\n        container.setItems(items);\n      }\n    };\n\n    _proto.setYTipContent = function setYTipContent(val) {\n      var yTip = this.yTip;\n\n      if (isFunction(yTip)) {\n        val = yTip(val);\n      } else {\n        val = mix({\n          text: val\n        }, yTip);\n      }\n\n      this.yTipBox && this.yTipBox.updateContent(val);\n    };\n\n    _proto.setYTipPosition = function setYTipPosition(pos) {\n      var plotRange = this.plotRange;\n      var crosshairsShapeX = this.crosshairsShapeX;\n\n      if (this.showYTip) {\n        var yTipBox = this.yTipBox;\n        var yTipHeight = yTipBox.getHeight();\n        var yTipWidth = yTipBox.getWidth();\n        var posX = plotRange.tl.x - yTipWidth;\n        var posY = pos - yTipHeight / 2;\n\n        if (posY <= plotRange.tl.y) {\n          posY = plotRange.tl.y;\n        }\n\n        if (posY + yTipHeight >= plotRange.br.y) {\n          posY = plotRange.br.y - yTipHeight;\n        }\n\n        if (posX < 0) {\n          posX = plotRange.tl.x;\n          crosshairsShapeX && crosshairsShapeX.attr('x1', plotRange.tl.x + yTipWidth);\n        }\n\n        yTipBox.updatePosition(posX, posY);\n      }\n    };\n\n    _proto.setXTipContent = function setXTipContent(val) {\n      var xTip = this.xTip;\n\n      if (isFunction(xTip)) {\n        val = xTip(val);\n      } else {\n        val = mix({\n          text: val\n        }, xTip);\n      }\n\n      this.xTipBox && this.xTipBox.updateContent(val);\n    };\n\n    _proto.setXTipPosition = function setXTipPosition(pos) {\n      var showXTip = this.showXTip,\n          canvas = this.canvas,\n          plotRange = this.plotRange,\n          xTipBox = this.xTipBox,\n          crosshairsShapeY = this.crosshairsShapeY;\n\n      if (showXTip) {\n        // const el = canvas.get('el');\n        // const canvasHeight = Util.getHeight(el);\n        var canvasHeight = canvas.get('height');\n        var xTipWidth = xTipBox.getWidth();\n        var xTipHeight = xTipBox.getHeight();\n        var posX = pos - xTipWidth / 2;\n        var posY = plotRange.br.y;\n\n        if (posX <= plotRange.tl.x) {\n          posX = plotRange.tl.x;\n        }\n\n        if (posX + xTipWidth >= plotRange.tr.x) {\n          posX = plotRange.tr.x - xTipWidth;\n        }\n\n        if (canvasHeight - posY < xTipHeight) {\n          posY -= xTipHeight;\n        }\n\n        xTipBox.updatePosition(posX, posY);\n        crosshairsShapeY && crosshairsShapeY.attr('y1', posY);\n      }\n    };\n\n    _proto.setXCrosshairPosition = function setXCrosshairPosition(pos) {\n      this.crosshairsShapeX && this.crosshairsShapeX.moveTo(0, pos);\n    };\n\n    _proto.setYCrosshairPosition = function setYCrosshairPosition(pos) {\n      this.crosshairsShapeY && this.crosshairsShapeY.moveTo(pos, 0);\n    };\n\n    _proto.setPosition = function setPosition(items) {\n      var container = this.container,\n          plotRange = this.plotRange,\n          offsetX = this.offsetX,\n          offsetY = this.offsetY,\n          fixed = this.fixed,\n          tooltipArrow = this.tooltipArrow;\n\n      if (!container) {\n        return;\n      }\n\n      var containerBBox = container.container.getBBox();\n      var minX = containerBBox.minX,\n          minY = containerBBox.minY,\n          width = containerBBox.width,\n          height = containerBBox.height;\n      var tl = plotRange.tl,\n          tr = plotRange.tr;\n      var posX = 0;\n      var posY = tl.y - height - GAP + offsetY;\n\n      if (posY < 0) {\n        posY = 0;\n      }\n\n      if (fixed) {\n        var x = (tl.x + tr.x) / 2;\n        posX = x - width / 2 + offsetX;\n      } else {\n        var _x;\n\n        if (items.length > 1) {\n          _x = (items[0].x + items[items.length - 1].x) / 2;\n        } else {\n          _x = items[0].x;\n        }\n\n        posX = _x - width / 2 + offsetX;\n\n        if (posX < tl.x) {\n          posX = tl.x;\n        }\n\n        if (posX + width > tr.x) {\n          posX = tr.x - width;\n        }\n\n        if (tooltipArrow) {\n          var arrowY = posY + height;\n          tooltipArrow.attr('points', [{\n            x: _x - 3,\n            y: arrowY\n          }, {\n            x: _x + 3,\n            y: arrowY\n          }, {\n            x: _x,\n            y: arrowY + GAP\n          }]);\n          var backShape = container.backShape;\n          var radius = parsePadding(backShape.attr('radius'));\n\n          if (_x === tl.x) {\n            radius[3] = 0;\n            tooltipArrow.attr('points', [{\n              x: tl.x,\n              y: arrowY\n            }, {\n              x: tl.x + GAP,\n              y: arrowY\n            }, {\n              x: tl.x,\n              y: arrowY + GAP\n            }]);\n          } else if (_x === tr.x) {\n            radius[2] = 0;\n            tooltipArrow.attr('points', [{\n              x: tr.x - GAP,\n              y: arrowY\n            }, {\n              x: tr.x,\n              y: arrowY\n            }, {\n              x: tr.x,\n              y: arrowY + GAP\n            }]);\n          }\n\n          backShape.attr('radius', radius);\n        }\n      }\n\n      container.moveTo(posX - minX, posY - minY);\n    };\n\n    _proto.setMarkers = function setMarkers(cfg) {\n      if (cfg === void 0) {\n        cfg = {};\n      }\n\n      var self = this;\n      var _cfg = cfg,\n          items = _cfg.items,\n          style = _cfg.style,\n          type = _cfg.type;\n\n      var markerGroup = self._getMarkerGroup(type);\n\n      if (type === 'circle') {\n        for (var i = 0, length = items.length; i < length; i++) {\n          var item = items[i];\n          markerGroup.addShape('marker', {\n            className: 'tooltip-circle-marker',\n            attrs: mix({\n              x: item.x,\n              y: item.y,\n              stroke: item.color\n            }, style)\n          });\n        }\n      } else {\n        markerGroup.addShape('rect', {\n          className: 'tooltip-rect-marker',\n          attrs: style\n        });\n      }\n    };\n\n    _proto.clearMarkers = function clearMarkers() {\n      var markerGroup = this.markerGroup;\n      markerGroup && markerGroup.clear();\n    };\n\n    _proto.show = function show() {\n      var crosshairsShapeX = this.crosshairsShapeX;\n      var crosshairsShapeY = this.crosshairsShapeY;\n      var markerGroup = this.markerGroup;\n      var container = this.container;\n      var tooltipArrow = this.tooltipArrow;\n      var xTipBox = this.xTipBox;\n      var yTipBox = this.yTipBox;\n      var canvas = this.canvas;\n      crosshairsShapeX && crosshairsShapeX.show();\n      crosshairsShapeY && crosshairsShapeY.show();\n      markerGroup && markerGroup.show();\n      container && container.show();\n      tooltipArrow && tooltipArrow.show();\n      xTipBox && xTipBox.show();\n      yTipBox && yTipBox.show();\n      canvas.draw();\n    };\n\n    _proto.hide = function hide() {\n      var crosshairsShapeX = this.crosshairsShapeX;\n      var crosshairsShapeY = this.crosshairsShapeY;\n      var markerGroup = this.markerGroup;\n      var container = this.container;\n      var tooltipArrow = this.tooltipArrow;\n      var xTipBox = this.xTipBox;\n      var yTipBox = this.yTipBox;\n      crosshairsShapeX && crosshairsShapeX.hide();\n      crosshairsShapeY && crosshairsShapeY.hide();\n      markerGroup && markerGroup.hide();\n      container && container.hide();\n      tooltipArrow && tooltipArrow.hide();\n      xTipBox && xTipBox.hide();\n      yTipBox && yTipBox.hide();\n    };\n\n    _proto.destroy = function destroy() {\n      var crosshairsShapeX = this.crosshairsShapeX;\n      var crosshairsShapeY = this.crosshairsShapeY;\n      var markerGroup = this.markerGroup;\n      var container = this.container;\n      var tooltipArrow = this.tooltipArrow;\n      var xTipBox = this.xTipBox;\n      var yTipBox = this.yTipBox;\n      crosshairsShapeX && crosshairsShapeX.remove(true);\n      crosshairsShapeY && crosshairsShapeY.remove(true);\n      markerGroup && markerGroup.remove(true);\n      tooltipArrow && tooltipArrow.remove(true);\n      container && container.clear();\n      xTipBox && xTipBox.clear();\n      yTipBox && yTipBox.clear();\n      this.destroyed = true;\n    };\n\n    _proto._getMarkerGroup = function _getMarkerGroup(type) {\n      var markerGroup = this.markerGroup;\n\n      if (!markerGroup) {\n        if (type === 'circle') {\n          markerGroup = this.frontPlot.addGroup({\n            zIndex: 1\n          });\n          this.frontPlot.sort();\n        } else {\n          markerGroup = this.backPlot.addGroup();\n        }\n\n        this.markerGroup = markerGroup;\n      } else {\n        markerGroup.clear();\n      }\n\n      return markerGroup;\n    };\n\n    _proto._renderCrosshairs = function _renderCrosshairs() {\n      var crosshairsType = this.crosshairsType,\n          crosshairsStyle = this.crosshairsStyle,\n          frontPlot = this.frontPlot,\n          plotRange = this.plotRange;\n      var tl = plotRange.tl,\n          br = plotRange.br;\n\n      if (directionEnabled(crosshairsType, 'x')) {\n        this.crosshairsShapeX = frontPlot.addShape('Line', {\n          className: 'tooltip-crosshairs-x',\n          zIndex: 0,\n          visible: false,\n          attrs: mix({\n            x1: tl.x,\n            y1: 0,\n            x2: br.x,\n            y2: 0\n          }, crosshairsStyle)\n        });\n      }\n\n      if (directionEnabled(crosshairsType, 'y')) {\n        this.crosshairsShapeY = frontPlot.addShape('Line', {\n          className: 'tooltip-crosshairs-y',\n          zIndex: 0,\n          visible: false,\n          attrs: mix({\n            x1: 0,\n            y1: br.y,\n            x2: 0,\n            y2: tl.y\n          }, crosshairsStyle)\n        });\n      }\n    };\n\n    return Tooltip;\n  }();\n\n  Global.tooltip = deepMix({\n    triggerOn: 'press',\n    triggerOff: 'pressend',\n    alwaysShow: false,\n    showTitle: false,\n    showCrosshairs: false,\n    crosshairsStyle: {\n      stroke: 'rgba(0, 0, 0, 0.25)',\n      lineWidth: 1\n    },\n    showTooltipMarker: true,\n    background: {\n      radius: 1,\n      fill: 'rgba(0, 0, 0, 0.65)',\n      padding: [3, 5]\n    },\n    titleStyle: {\n      fontSize: 12,\n      fill: '#fff',\n      textAlign: 'start',\n      textBaseline: 'top'\n    },\n    nameStyle: {\n      fontSize: 12,\n      fill: 'rgba(255, 255, 255, 0.65)',\n      textAlign: 'start',\n      textBaseline: 'middle'\n    },\n    valueStyle: {\n      fontSize: 12,\n      fill: '#fff',\n      textAlign: 'start',\n      textBaseline: 'middle'\n    },\n    showItemMarker: true,\n    itemMarkerStyle: {\n      radius: 3,\n      symbol: 'circle',\n      lineWidth: 1,\n      stroke: '#fff'\n    },\n    layout: 'horizontal',\n    snap: false\n  }, Global.tooltip || {});\n\n  function _getTooltipValueScale(geom) {\n    var colorAttr = geom.getAttr('color');\n\n    if (colorAttr) {\n      var colorScale = colorAttr.getScale(colorAttr.type);\n\n      if (colorScale.isLinear) {\n        return colorScale;\n      }\n    }\n\n    var xScale = geom.getXScale();\n    var yScale = geom.getYScale();\n\n    if (yScale) {\n      return yScale;\n    }\n\n    return xScale;\n  }\n\n  function getTooltipName(geom, origin) {\n    var name;\n    var nameScale;\n\n    var groupScales = geom._getGroupScales();\n\n    if (groupScales.length) {\n      each(groupScales, function (scale) {\n        nameScale = scale;\n        return false;\n      });\n    }\n\n    if (nameScale) {\n      var field = nameScale.field;\n      name = nameScale.getText(origin[field]);\n    } else {\n      var valueScale = _getTooltipValueScale(geom);\n\n      name = valueScale.alias || valueScale.field;\n    }\n\n    return name;\n  }\n\n  function getTooltipValue(geom, origin) {\n    var scale = _getTooltipValueScale(geom);\n\n    return scale.getText(origin[scale.field]);\n  }\n\n  function getTooltipTitle(geom, origin) {\n    var position = geom.getAttr('position');\n    var field = position.getFields()[0];\n    var scale = geom.get('scales')[field];\n    return scale.getText(origin[scale.field]);\n  }\n\n  function _indexOfArray(items, item) {\n    var rst = -1;\n    each(items, function (sub, index) {\n      if (sub.title === item.title && sub.name === item.name && sub.value === item.value && sub.color === item.color) {\n        rst = index;\n        return false;\n      }\n    });\n    return rst;\n  }\n\n  function _uniqItems(items) {\n    var tmp = [];\n    each(items, function (item) {\n      var index = _indexOfArray(tmp, item);\n\n      if (index === -1) {\n        tmp.push(item);\n      } else {\n        tmp[index] = item;\n      }\n    });\n    return tmp;\n  }\n\n  function isEqual$1(arr1, arr2) {\n    return JSON.stringify(arr1) === JSON.stringify(arr2);\n  }\n\n  var TooltipController = /*#__PURE__*/function () {\n    function TooltipController(cfg) {\n      var _this = this;\n\n      _defineProperty(this, \"handleShowEvent\", function (ev) {\n        var chart = _this.chart;\n        if (!_this.enable) return;\n        var plot = chart.get('plotRange');\n        var point = createEvent(ev, chart);\n\n        if (!isPointInPlot(point, plot) && !_this._tooltipCfg.alwaysShow) {\n          // not in chart plot\n          _this.hideTooltip();\n\n          return;\n        }\n\n        var lastTimeStamp = _this.timeStamp;\n        var timeStamp = +new Date();\n\n        if (timeStamp - lastTimeStamp > 16) {\n          _this.showTooltip(point);\n\n          _this.timeStamp = timeStamp;\n        }\n      });\n\n      _defineProperty(this, \"handleHideEvent\", function () {\n        if (!_this.enable) return;\n\n        _this.hideTooltip();\n      });\n\n      this.enable = true;\n      this.cfg = {};\n      this.tooltip = null;\n      this.chart = null;\n      this.timeStamp = 0;\n      mix(this, cfg);\n      var _chart = this.chart;\n\n      var canvas = _chart.get('canvas');\n\n      this.canvas = canvas;\n      this.canvasDom = canvas.get('el');\n    }\n\n    var _proto = TooltipController.prototype;\n\n    _proto._setCrosshairsCfg = function _setCrosshairsCfg() {\n      var self = this;\n      var chart = self.chart;\n      var defaultCfg = mix({}, Global.tooltip);\n      var geoms = chart.get('geoms');\n      var shapes = [];\n      each(geoms, function (geom) {\n        var type = geom.get('type');\n\n        if (shapes.indexOf(type) === -1) {\n          shapes.push(type);\n        }\n      });\n      var coordType = chart.get('coord').type;\n\n      if (geoms.length && (coordType === 'cartesian' || coordType === 'rect')) {\n        if (shapes.length === 1 && ['line', 'area', 'path', 'point'].indexOf(shapes[0]) !== -1) {\n          mix(defaultCfg, {\n            showCrosshairs: true\n          });\n        }\n      }\n\n      return defaultCfg;\n    };\n\n    _proto._getMaxLength = function _getMaxLength(cfg) {\n      if (cfg === void 0) {\n        cfg = {};\n      }\n\n      var _cfg = cfg,\n          layout = _cfg.layout,\n          plotRange = _cfg.plotRange;\n      return layout === 'horizontal' ? plotRange.br.x - plotRange.bl.x : plotRange.bl.y - plotRange.tr.y;\n    };\n\n    _proto.render = function render() {\n      var self = this;\n\n      if (self.tooltip) {\n        return;\n      }\n\n      var chart = self.chart;\n      var canvas = chart.get('canvas');\n      var frontPlot = chart.get('frontPlot').addGroup({\n        className: 'tooltipContainer',\n        zIndex: 10\n      });\n      var backPlot = chart.get('backPlot').addGroup({\n        className: 'tooltipContainer'\n      });\n      var plotRange = chart.get('plotRange');\n      var coord = chart.get('coord');\n\n      var defaultCfg = self._setCrosshairsCfg();\n\n      var cfg = self.cfg; // 通过 chart.tooltip() 接口传入的 tooltip 配置项\n\n      var tooltipCfg = deepMix({\n        plotRange: plotRange,\n        frontPlot: frontPlot,\n        backPlot: backPlot,\n        canvas: canvas,\n        fixed: coord.transposed || coord.isPolar\n      }, defaultCfg, cfg); // 创建 tooltip 实例需要的配置，不应该修改 this.cfg，即用户传入的配置\n\n      tooltipCfg.maxLength = self._getMaxLength(tooltipCfg);\n      this._tooltipCfg = tooltipCfg;\n      var tooltip = new Tooltip(tooltipCfg);\n      self.tooltip = tooltip; // 需要保持tooltip一直显示\n\n      if (tooltipCfg.alwaysShow && self.prePoint) {\n        this.showTooltip(self.prePoint);\n      }\n\n      self.bindEvents();\n    };\n\n    _proto.clear = function clear() {\n      var tooltip = this.tooltip;\n\n      if (tooltip) {\n        tooltip.destroy();\n        this.unBindEvents();\n      }\n\n      this.tooltip = null;\n      this._lastActive = null;\n    };\n\n    _proto._getTooltipMarkerStyle = function _getTooltipMarkerStyle(cfg) {\n      if (cfg === void 0) {\n        cfg = {};\n      }\n\n      var _cfg2 = cfg,\n          type = _cfg2.type,\n          items = _cfg2.items;\n      var tooltipCfg = this._tooltipCfg;\n\n      if (type === 'rect') {\n        var x;\n        var y;\n        var width;\n        var height;\n        var chart = this.chart;\n\n        var _chart$get = chart.get('plotRange'),\n            tl = _chart$get.tl,\n            br = _chart$get.br;\n\n        var coord = chart.get('coord');\n        var firstItem = items[0];\n        var lastItem = items[items.length - 1];\n        var intervalWidth = firstItem.width;\n\n        if (coord.transposed) {\n          x = tl.x;\n          y = lastItem.y - intervalWidth * 0.75;\n          width = br.x - tl.x;\n          height = firstItem.y - lastItem.y + 1.5 * intervalWidth;\n        } else {\n          x = firstItem.x - intervalWidth * 0.75;\n          y = tl.y;\n          width = lastItem.x - firstItem.x + 1.5 * intervalWidth;\n          height = br.y - tl.y;\n        }\n\n        cfg.style = mix({\n          x: x,\n          y: y,\n          width: width,\n          height: height,\n          fill: '#CCD6EC',\n          opacity: 0.3\n        }, tooltipCfg.tooltipMarkerStyle);\n      } else {\n        cfg.style = mix({\n          radius: 4,\n          fill: '#fff',\n          lineWidth: 2\n        }, tooltipCfg.tooltipMarkerStyle);\n      }\n\n      return cfg;\n    };\n\n    _proto._setTooltip = function _setTooltip(point, items, tooltipMarkerCfg) {\n      if (tooltipMarkerCfg === void 0) {\n        tooltipMarkerCfg = {};\n      }\n\n      this.prePoint = point;\n      var lastActive = this._lastActive;\n      var tooltip = this.tooltip;\n      var cfg = this._tooltipCfg;\n      items = _uniqItems(items);\n      var chart = this.chart;\n      var coord = chart.get('coord');\n      var yScale = chart.getYScales()[0];\n      var snap = cfg.snap;\n\n      if (snap === false && yScale.isLinear) {\n        var invertPoint = coord.invertPoint(point);\n        var plot = chart.get('plotRange');\n        var tip;\n        var pos;\n\n        if (isPointInPlot(point, plot)) {\n          if (coord.transposed) {\n            tip = yScale.invert(invertPoint.x);\n            pos = point.x;\n            tooltip.setXTipContent(tip);\n            tooltip.setXTipPosition(pos);\n            tooltip.setYCrosshairPosition(pos);\n          } else {\n            tip = yScale.invert(invertPoint.y);\n            pos = point.y;\n            tooltip.setYTipContent(tip);\n            tooltip.setYTipPosition(pos);\n            tooltip.setXCrosshairPosition(pos);\n          }\n        }\n      }\n\n      if (cfg.onShow) {\n        cfg.onShow({\n          x: point.x,\n          y: point.y,\n          tooltip: tooltip,\n          items: items,\n          tooltipMarkerCfg: tooltipMarkerCfg\n        });\n      }\n\n      if (isEqual$1(lastActive, items)) {\n        if (snap === false && (directionEnabled(cfg.crosshairsType, 'y') || cfg.showYTip)) {\n          var canvas = this.chart.get('canvas');\n          canvas.draw();\n        }\n\n        return;\n      }\n\n      this._lastActive = items;\n      var onChange = cfg.onChange;\n\n      if (onChange) {\n        onChange({\n          x: point.x,\n          y: point.y,\n          tooltip: tooltip,\n          items: items,\n          tooltipMarkerCfg: tooltipMarkerCfg\n        });\n      }\n\n      var first = items[0];\n      var title = first.title || first.name;\n      var xTipPosX = first.x;\n\n      if (items.length > 1) {\n        xTipPosX = (items[0].x + items[items.length - 1].x) / 2;\n      }\n\n      tooltip.setContent(title, items, coord.transposed);\n      tooltip.setPosition(items, point);\n\n      if (coord.transposed) {\n        var yTipPosY = first.y;\n\n        if (items.length > 1) {\n          yTipPosY = (items[0].y + items[items.length - 1].y) / 2;\n        }\n\n        tooltip.setYTipContent(title);\n        tooltip.setYTipPosition(yTipPosY);\n        tooltip.setXCrosshairPosition(yTipPosY);\n\n        if (snap) {\n          tooltip.setXTipContent(first.value);\n          tooltip.setXTipPosition(xTipPosX);\n          tooltip.setYCrosshairPosition(xTipPosX);\n        }\n      } else {\n        tooltip.setXTipContent(title);\n        tooltip.setXTipPosition(xTipPosX);\n        tooltip.setYCrosshairPosition(xTipPosX);\n\n        if (snap) {\n          tooltip.setYTipContent(first.value);\n          tooltip.setYTipPosition(first.y);\n          tooltip.setXCrosshairPosition(first.y);\n        }\n      }\n\n      var markerItems = tooltipMarkerCfg.items;\n\n      if (cfg.showTooltipMarker && markerItems.length) {\n        tooltipMarkerCfg = this._getTooltipMarkerStyle(tooltipMarkerCfg);\n        tooltip.setMarkers(tooltipMarkerCfg);\n      } else {\n        tooltip.clearMarkers();\n      }\n\n      tooltip.show();\n    };\n\n    _proto.showTooltip = function showTooltip(point) {\n      var self = this;\n      var chart = self.chart;\n      var tooltipMarkerType;\n      var tooltipMarkerItems = [];\n      var items = [];\n      var cfg = self._tooltipCfg;\n      var showItemMarker = cfg.showItemMarker,\n          itemMarkerStyle = cfg.itemMarkerStyle,\n          alwaysShow = cfg.alwaysShow;\n      var marker;\n\n      if (showItemMarker) {\n        marker = itemMarkerStyle;\n      }\n\n      var geoms = chart.get('geoms');\n      var coord = chart.get('coord');\n      each(geoms, function (geom) {\n        if (geom.get('visible')) {\n          var type = geom.get('type');\n          var records = geom.getSnapRecords(point);\n          var adjust = geom.get('adjust'); // 漏斗图和金子塔图tooltip位置有问题，暂时不开放显示\n\n          if (type === 'interval' && adjust && adjust.type === 'symmetric') {\n            return;\n          }\n\n          each(records, function (record) {\n            var x = record.x,\n                y = record.y,\n                _origin = record._origin,\n                color = record.color;\n\n            if ((x || !isNaN(x)) && (y || !isNaN(y))) {\n              var tooltipItem = {\n                x: x,\n                y: isArray(y) ? y[1] : y,\n                color: color || Global.defaultColor,\n                origin: _origin,\n                name: getTooltipName(geom, _origin),\n                value: getTooltipValue(geom, _origin),\n                title: getTooltipTitle(geom, _origin)\n              };\n\n              if (marker) {\n                tooltipItem.marker = mix({\n                  fill: color || Global.defaultColor\n                }, marker);\n              }\n\n              items.push(tooltipItem);\n\n              if (['line', 'area', 'path'].indexOf(type) !== -1) {\n                tooltipMarkerType = 'circle';\n                tooltipMarkerItems.push(tooltipItem);\n              } else if (type === 'interval' && (coord.type === 'cartesian' || coord.type === 'rect')) {\n                tooltipMarkerType = 'rect';\n                tooltipItem.width = geom.getSize(record._origin);\n                tooltipMarkerItems.push(tooltipItem);\n              }\n            }\n          });\n        }\n      });\n\n      if (items.length) {\n        var tooltipMarkerCfg = {\n          items: tooltipMarkerItems,\n          type: tooltipMarkerType\n        };\n\n        self._setTooltip(point, items, tooltipMarkerCfg);\n\n        return;\n      }\n\n      if (!alwaysShow) {\n        self.hideTooltip();\n      }\n    };\n\n    _proto.hideTooltip = function hideTooltip() {\n      var cfg = this._tooltipCfg;\n      this._lastActive = null;\n      var tooltip = this.tooltip;\n\n      if (tooltip) {\n        tooltip.hide();\n\n        if (cfg.onHide) {\n          cfg.onHide({\n            tooltip: tooltip\n          });\n        }\n\n        var canvas = this.chart.get('canvas');\n        canvas.draw();\n      }\n    };\n\n    _proto._handleEvent = function _handleEvent(methodName, method, action) {\n      var canvas = this.canvas;\n      each([].concat(methodName), function (aMethod) {\n        if (action === 'bind') {\n          canvas.on(aMethod, method);\n        } else {\n          canvas.off(aMethod, method);\n        }\n      });\n    };\n\n    _proto.bindEvents = function bindEvents() {\n      var cfg = this._tooltipCfg;\n      var triggerOn = cfg.triggerOn,\n          triggerOff = cfg.triggerOff,\n          alwaysShow = cfg.alwaysShow;\n      triggerOn && this._handleEvent(triggerOn, this.handleShowEvent, 'bind'); // 如果 !alwaysShow, 则在手势离开后就隐藏\n\n      if (!alwaysShow) {\n        this._handleEvent(triggerOff, this.handleHideEvent, 'bind');\n      }\n    };\n\n    _proto.unBindEvents = function unBindEvents() {\n      var cfg = this._tooltipCfg;\n      var triggerOn = cfg.triggerOn,\n          triggerOff = cfg.triggerOff,\n          alwaysShow = cfg.alwaysShow;\n      triggerOn && this._handleEvent(triggerOn, this.handleShowEvent, 'unBind');\n\n      if (!alwaysShow) {\n        this._handleEvent(triggerOff, this.handleHideEvent, 'unBind');\n      }\n    };\n\n    return TooltipController;\n  }();\n\n  function init(chart) {\n    var tooltipController = new TooltipController({\n      chart: chart\n    });\n    chart.set('tooltipController', tooltipController);\n\n    chart.tooltip = function (enable, cfg) {\n      if (isObject(enable)) {\n        cfg = enable;\n        enable = true;\n      }\n\n      tooltipController.enable = enable;\n\n      if (cfg) {\n        tooltipController.cfg = cfg;\n      }\n\n      return this;\n    };\n  }\n\n  function afterGeomDraw(chart) {\n    var tooltipController = chart.get('tooltipController');\n    tooltipController.render();\n\n    chart.showTooltip = function (point) {\n      tooltipController.showTooltip(point);\n      return this;\n    };\n\n    chart.hideTooltip = function () {\n      tooltipController.hideTooltip();\n      return this;\n    };\n  }\n\n  function clearInner(chart) {\n    var tooltipController = chart.get('tooltipController');\n    tooltipController.clear();\n  }\n\n  var tooltip = {\n    init: init,\n    afterGeomDraw: afterGeomDraw,\n    clearInner: clearInner\n  };\n  var Tooltip$1 = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    init: init,\n    afterGeomDraw: afterGeomDraw,\n    clearInner: clearInner,\n    'default': tooltip\n  });\n  Global.guide = deepMix({\n    line: {\n      style: {\n        stroke: '#a3a3a3',\n        lineWidth: 1\n      },\n      top: true\n    },\n    text: {\n      style: {\n        fill: '#787878',\n        textAlign: 'center',\n        textBaseline: 'middle'\n      },\n      offsetX: 0,\n      offsetY: 0,\n      top: true\n    },\n    rect: {\n      style: {\n        fill: '#fafafa'\n      },\n      top: false\n    },\n    arc: {\n      style: {\n        stroke: '#a3a3a3'\n      },\n      top: true\n    },\n    html: {\n      offsetX: 0,\n      offsetY: 0,\n      alignX: 'center',\n      alignY: 'middle'\n    },\n    tag: {\n      top: true,\n      offsetX: 0,\n      offsetY: 0,\n      side: 4,\n      background: {\n        padding: 5,\n        radius: 2,\n        fill: '#1890FF'\n      },\n      textStyle: {\n        fontSize: 12,\n        fill: '#fff',\n        textAlign: 'center',\n        textBaseline: 'middle'\n      }\n    },\n    point: {\n      top: true,\n      offsetX: 0,\n      offsetY: 0,\n      style: {\n        fill: '#fff',\n        r: 3,\n        lineWidth: 2,\n        stroke: '#1890ff'\n      }\n    }\n  }, Global.guide || {});\n\n  var GuideController = /*#__PURE__*/function () {\n    function GuideController(cfg) {\n      this.guides = [];\n      this.xScale = null;\n      this.yScales = null;\n      this.guideShapes = [];\n      mix(this, cfg);\n    }\n\n    var _proto = GuideController.prototype;\n\n    _proto._toString = function _toString(position) {\n      if (isFunction(position)) {\n        position = position(this.xScale, this.yScales);\n      }\n\n      position = position.toString();\n      return position;\n    };\n\n    _proto._getId = function _getId(shape, guide) {\n      var id = guide.id;\n\n      if (!id) {\n        var type = guide.type;\n\n        if (type === 'arc' || type === 'line' || type === 'rect') {\n          id = this._toString(guide.start) + '-' + this._toString(guide.end);\n        } else {\n          id = this._toString(guide.position);\n        }\n      }\n\n      return id;\n    };\n\n    _proto.paint = function paint(coord) {\n      var self = this;\n      var chart = self.chart,\n          guides = self.guides,\n          xScale = self.xScale,\n          yScales = self.yScales;\n      var guideShapes = [];\n      each(guides, function (guide, idx) {\n        guide.xScale = xScale;\n        guide.yScales = yScales;\n        var container;\n\n        if (guide.type === 'regionFilter') {\n          // TODO: RegionFilter support animation\n          guide.chart = chart;\n        } else {\n          container = guide.top ? self.frontPlot : self.backPlot;\n        }\n\n        guide.coord = coord;\n        guide.container = container;\n        guide.canvas = chart.get('canvas');\n        var shape = guide.render(coord, container);\n\n        if (shape) {\n          var id = self._getId(shape, guide);\n\n          [].concat(shape).forEach(function (s) {\n            s._id = s.get('className') + '-' + id;\n            s.set('index', idx);\n            guideShapes.push(s);\n          });\n        }\n      });\n      self.guideShapes = guideShapes;\n    };\n\n    _proto.clear = function clear() {\n      this.reset();\n      this.guides = [];\n      return this;\n    };\n\n    _proto.reset = function reset() {\n      var guides = this.guides;\n      each(guides, function (guide) {\n        guide.remove();\n      });\n    };\n\n    _proto._createGuide = function _createGuide(type, cfg) {\n      var ClassName = upperFirst(type);\n      var guide = new GuideBase[ClassName](deepMix({}, Global.guide[type], cfg));\n      this.guides.push(guide);\n      return guide;\n    };\n\n    _proto.line = function line(cfg) {\n      if (cfg === void 0) {\n        cfg = {};\n      }\n\n      return this._createGuide('line', cfg);\n    };\n\n    _proto.text = function text(cfg) {\n      if (cfg === void 0) {\n        cfg = {};\n      }\n\n      return this._createGuide('text', cfg);\n    };\n\n    _proto.arc = function arc(cfg) {\n      if (cfg === void 0) {\n        cfg = {};\n      }\n\n      return this._createGuide('arc', cfg);\n    };\n\n    _proto.html = function html(cfg) {\n      if (cfg === void 0) {\n        cfg = {};\n      }\n\n      return this._createGuide('html', cfg);\n    };\n\n    _proto.rect = function rect(cfg) {\n      if (cfg === void 0) {\n        cfg = {};\n      }\n\n      return this._createGuide('rect', cfg);\n    };\n\n    _proto.tag = function tag(cfg) {\n      if (cfg === void 0) {\n        cfg = {};\n      }\n\n      return this._createGuide('tag', cfg);\n    };\n\n    _proto.point = function point(cfg) {\n      if (cfg === void 0) {\n        cfg = {};\n      }\n\n      return this._createGuide('point', cfg);\n    };\n\n    _proto.regionFilter = function regionFilter(cfg) {\n      if (cfg === void 0) {\n        cfg = {};\n      }\n\n      return this._createGuide('regionFilter', cfg);\n    };\n\n    return GuideController;\n  }();\n\n  function init$1(chart) {\n    var guideController = new GuideController({\n      frontPlot: chart.get('frontPlot').addGroup({\n        zIndex: 20,\n        className: 'guideContainer'\n      }),\n      backPlot: chart.get('backPlot').addGroup({\n        className: 'guideContainer'\n      })\n    });\n    chart.set('guideController', guideController);\n    /**\n     * 为图表添加 guide\n     * @return {GuideController} 返回 guide 控制器\n     */\n\n    chart.guide = function () {\n      return guideController;\n    };\n  }\n\n  function afterGeomDraw$1(chart) {\n    var guideController = chart.get('guideController');\n\n    if (!guideController.guides.length) {\n      return;\n    }\n\n    var xScale = chart.getXScale();\n    var yScales = chart.getYScales();\n    var coord = chart.get('coord');\n    guideController.xScale = xScale;\n    guideController.yScales = yScales;\n    guideController.chart = chart; // for regionFilter\n\n    guideController.paint(coord);\n  }\n\n  function clear(chart) {\n    chart.get('guideController').clear();\n  }\n\n  function repaint(chart) {\n    chart.get('guideController').reset();\n  }\n\n  var guide = {\n    init: init$1,\n    afterGeomDraw: afterGeomDraw$1,\n    clear: clear,\n    repaint: repaint\n  };\n  var Guide = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    init: init$1,\n    afterGeomDraw: afterGeomDraw$1,\n    clear: clear,\n    repaint: repaint,\n    'default': guide\n  });\n  var LEGEND_GAP = 12;\n  var MARKER_SIZE = 3;\n  var DEFAULT_CFG = {\n    itemMarginBottom: 12,\n    itemGap: 10,\n    showTitle: false,\n    titleStyle: {\n      fontSize: 12,\n      fill: '#808080',\n      textAlign: 'start',\n      textBaseline: 'top'\n    },\n    nameStyle: {\n      fill: '#808080',\n      fontSize: 12,\n      textAlign: 'start',\n      textBaseline: 'middle'\n    },\n    valueStyle: {\n      fill: '#000000',\n      fontSize: 12,\n      textAlign: 'start',\n      textBaseline: 'middle'\n    },\n    unCheckStyle: {\n      fill: '#bfbfbf'\n    },\n    itemWidth: 'auto',\n    wordSpace: 6,\n    selectedMode: 'multiple' // 'multiple' or 'single'\n\n  }; // Register the default configuration for Legend\n\n  Global.legend = deepMix({\n    common: DEFAULT_CFG,\n    // common legend configuration\n    right: mix({\n      position: 'right',\n      layout: 'vertical'\n    }, DEFAULT_CFG),\n    left: mix({\n      position: 'left',\n      layout: 'vertical'\n    }, DEFAULT_CFG),\n    top: mix({\n      position: 'top',\n      layout: 'horizontal'\n    }, DEFAULT_CFG),\n    bottom: mix({\n      position: 'bottom',\n      layout: 'horizontal'\n    }, DEFAULT_CFG)\n  }, Global.legend || {});\n\n  function getPaddingByPos(pos, appendPadding) {\n    var padding = 0;\n    appendPadding = parsePadding(appendPadding);\n\n    switch (pos) {\n      case 'top':\n        padding = appendPadding[0];\n        break;\n\n      case 'right':\n        padding = appendPadding[1];\n        break;\n\n      case 'bottom':\n        padding = appendPadding[2];\n        break;\n\n      case 'left':\n        padding = appendPadding[3];\n        break;\n    }\n\n    return padding;\n  }\n\n  var LegendController = /*#__PURE__*/function () {\n    function LegendController(cfg) {\n      var _this = this;\n\n      _defineProperty(this, \"handleEvent\", function (ev) {\n        var self = _this;\n\n        function findItem(x, y) {\n          var result = null;\n          var legends = self.legends;\n          each(legends, function (legendItems) {\n            each(legendItems, function (legend) {\n              var itemsGroup = legend.itemsGroup,\n                  legendHitBoxes = legend.legendHitBoxes;\n              var children = itemsGroup.get('children');\n\n              if (children.length) {\n                var legendPosX = legend.x;\n                var legendPosY = legend.y;\n                each(legendHitBoxes, function (box, index) {\n                  if (x >= box.x + legendPosX && x <= box.x + box.width + legendPosX && y >= box.y + legendPosY && y <= box.height + box.y + legendPosY) {\n                    // inbox\n                    result = {\n                      clickedItem: children[index],\n                      clickedLegend: legend\n                    };\n                    return false;\n                  }\n                });\n              }\n            });\n          });\n          return result;\n        }\n\n        var chart = self.chart;\n\n        var _createEvent = createEvent(ev, chart),\n            x = _createEvent.x,\n            y = _createEvent.y;\n\n        var clicked = findItem(x, y);\n\n        if (clicked && clicked.clickedLegend.clickable !== false) {\n          var clickedItem = clicked.clickedItem,\n              clickedLegend = clicked.clickedLegend;\n\n          if (clickedLegend.onClick) {\n            ev.clickedItem = clickedItem;\n            clickedLegend.onClick(ev);\n          } else if (!clickedLegend.custom) {\n            var checked = clickedItem.get('checked');\n            var value = clickedItem.get('dataValue');\n            var filteredVals = clickedLegend.filteredVals,\n                field = clickedLegend.field,\n                selectedMode = clickedLegend.selectedMode;\n            var isSingeSelected = selectedMode === 'single';\n\n            if (isSingeSelected) {\n              chart.filter(field, function (val) {\n                return val === value;\n              });\n            } else {\n              if (checked) {\n                filteredVals.push(value);\n              } else {\n                remove(filteredVals, value);\n              }\n\n              chart.filter(field, function (val) {\n                return filteredVals.indexOf(val) === -1;\n              });\n            }\n\n            chart.repaint();\n          }\n        }\n      });\n\n      this.legendCfg = {};\n      this.enable = true;\n      this.position = 'top';\n      mix(this, cfg);\n      var _chart = this.chart;\n      this.canvasDom = _chart.get('canvas').get('el');\n      this.clear();\n    }\n\n    var _proto = LegendController.prototype;\n\n    _proto.addLegend = function addLegend(scale, items, filteredVals) {\n      var self = this;\n      var legendCfg = self.legendCfg;\n      var field = scale.field;\n      var fieldCfg = legendCfg[field];\n\n      if (fieldCfg === false) {\n        return null;\n      }\n\n      if (fieldCfg && fieldCfg.custom) {\n        self.addCustomLegend(field);\n      } else {\n        var position = legendCfg.position || self.position;\n\n        if (fieldCfg && fieldCfg.position) {\n          position = fieldCfg.position;\n        }\n\n        if (scale.isCategory) {\n          self._addCategoryLegend(scale, items, position, filteredVals);\n        }\n      }\n    };\n\n    _proto.addCustomLegend = function addCustomLegend(field) {\n      var self = this;\n      var legendCfg = self.legendCfg;\n\n      if (field && legendCfg[field]) {\n        legendCfg = legendCfg[field];\n      }\n\n      var position = legendCfg.position || self.position;\n      var legends = self.legends;\n      legends[position] = legends[position] || [];\n      var items = legendCfg.items;\n\n      if (!items) {\n        return null;\n      }\n\n      var container = self.container;\n      each(items, function (item) {\n        if (!isPlainObject(item.marker)) {\n          item.marker = {\n            symbol: item.marker || 'circle',\n            fill: item.fill,\n            radius: MARKER_SIZE\n          };\n        } else {\n          item.marker.radius = item.marker.radius || MARKER_SIZE;\n        }\n\n        item.checked = isNil(item.checked) ? true : item.checked;\n        item.name = item.name || item.value;\n      });\n      var legend = new List(deepMix({}, Global.legend[position], legendCfg, {\n        maxLength: self._getMaxLength(position),\n        items: items,\n        parent: container\n      }));\n      legends[position].push(legend);\n    };\n\n    _proto.clear = function clear() {\n      var legends = this.legends;\n      each(legends, function (legendItems) {\n        each(legendItems, function (legend) {\n          legend.clear();\n        });\n      });\n      this.legends = {};\n      this.unBindEvents();\n    };\n\n    _proto._isFiltered = function _isFiltered(scale, values, value) {\n      var rst = false;\n      each(values, function (val) {\n        rst = rst || scale.getText(val) === scale.getText(value);\n\n        if (rst) {\n          return false;\n        }\n      });\n      return rst;\n    };\n\n    _proto._getMaxLength = function _getMaxLength(position) {\n      var chart = this.chart;\n      var appendPadding = parsePadding(chart.get('appendPadding'));\n      return position === 'right' || position === 'left' ? chart.get('height') - (appendPadding[0] + appendPadding[2]) : chart.get('width') - (appendPadding[1] + appendPadding[3]);\n    };\n\n    _proto._addCategoryLegend = function _addCategoryLegend(scale, items, position, filteredVals) {\n      var self = this;\n      var legendCfg = self.legendCfg,\n          legends = self.legends,\n          container = self.container,\n          chart = self.chart;\n      var field = scale.field;\n      legends[position] = legends[position] || [];\n      var symbol = 'circle';\n\n      if (legendCfg[field] && legendCfg[field].marker) {\n        symbol = legendCfg[field].marker;\n      } else if (legendCfg.marker) {\n        symbol = legendCfg.marker;\n      }\n\n      each(items, function (item) {\n        if (isPlainObject(symbol)) {\n          mix(item.marker, symbol);\n        } else {\n          item.marker.symbol = symbol;\n        }\n\n        if (filteredVals) {\n          item.checked = !self._isFiltered(scale, filteredVals, item.dataValue);\n        }\n      });\n      var legendItems = chart.get('legendItems');\n      legendItems[field] = items;\n      var lastCfg = deepMix({}, Global.legend[position], legendCfg[field] || legendCfg, {\n        maxLength: self._getMaxLength(position),\n        items: items,\n        field: field,\n        filteredVals: filteredVals,\n        parent: container\n      });\n\n      if (lastCfg.showTitle) {\n        deepMix(lastCfg, {\n          title: scale.alias || scale.field\n        });\n      }\n\n      var legend = new List(lastCfg);\n      legends[position].push(legend);\n      return legend;\n    };\n\n    _proto._alignLegend = function _alignLegend(legend, pre, position) {\n      var self = this;\n      var _self$plotRange = self.plotRange,\n          tl = _self$plotRange.tl,\n          bl = _self$plotRange.bl;\n      var chart = self.chart;\n      var offsetX = legend.offsetX || 0;\n      var offsetY = legend.offsetY || 0;\n      var chartWidth = chart.get('width');\n      var chartHeight = chart.get('height');\n      var appendPadding = parsePadding(chart.get('appendPadding'));\n      var legendHeight = legend.getHeight();\n      var legendWidth = legend.getWidth();\n      var x = 0;\n      var y = 0;\n\n      if (position === 'left' || position === 'right') {\n        var verticalAlign = legend.verticalAlign || 'middle';\n        var height = Math.abs(tl.y - bl.y);\n        x = position === 'left' ? appendPadding[3] : chartWidth - legendWidth - appendPadding[1];\n        y = (height - legendHeight) / 2 + tl.y;\n\n        if (verticalAlign === 'top') {\n          y = tl.y;\n        } else if (verticalAlign === 'bottom') {\n          y = bl.y - legendHeight;\n        }\n\n        if (pre) {\n          y = pre.get('y') - legendHeight - LEGEND_GAP;\n        }\n      } else {\n        var align = legend.align || 'left';\n        x = appendPadding[3];\n\n        if (align === 'center') {\n          x = chartWidth / 2 - legendWidth / 2;\n        } else if (align === 'right') {\n          x = chartWidth - (legendWidth + appendPadding[1]);\n        }\n\n        y = position === 'top' ? appendPadding[0] + Math.abs(legend.container.getBBox().minY) : chartHeight - legendHeight;\n\n        if (pre) {\n          var preWidth = pre.getWidth();\n          x = pre.x + preWidth + LEGEND_GAP;\n        }\n      }\n\n      if (position === 'bottom' && offsetY > 0) {\n        offsetY = 0;\n      }\n\n      if (position === 'right' && offsetX > 0) {\n        offsetX = 0;\n      }\n\n      legend.moveTo(x + offsetX, y + offsetY);\n    };\n\n    _proto.alignLegends = function alignLegends() {\n      var self = this;\n      var legends = self.legends;\n      each(legends, function (legendItems, position) {\n        each(legendItems, function (legend, index) {\n          var pre = legendItems[index - 1];\n\n          self._alignLegend(legend, pre, position);\n        });\n      });\n      return self;\n    };\n\n    _proto.bindEvents = function bindEvents() {\n      var legendCfg = this.legendCfg;\n      var triggerOn = legendCfg.triggerOn || 'touchstart';\n      addEventListener(this.canvasDom, triggerOn, this.handleEvent);\n    };\n\n    _proto.unBindEvents = function unBindEvents() {\n      var legendCfg = this.legendCfg;\n      var triggerOn = legendCfg.triggerOn || 'touchstart';\n      removeEventListener(this.canvasDom, triggerOn, this.handleEvent);\n    };\n\n    return LegendController;\n  }();\n\n  function init$2(chart) {\n    var legendController = new LegendController({\n      container: chart.get('backPlot').addGroup(),\n      plotRange: chart.get('plotRange'),\n      chart: chart\n    });\n    chart.set('legendController', legendController);\n\n    chart.legend = function (field, cfg) {\n      var legendCfg = legendController.legendCfg;\n      legendController.enable = true;\n\n      if (isBoolean(field)) {\n        legendController.enable = field;\n        legendCfg = cfg || {};\n      } else if (isObject(field)) {\n        legendCfg = field;\n      } else {\n        legendCfg[field] = cfg;\n      }\n\n      legendController.legendCfg = legendCfg;\n      return this;\n    };\n  }\n\n  function beforeGeomDraw(chart) {\n    var legendController = chart.get('legendController');\n    if (!legendController.enable) return null; // legend is not displayed\n\n    var legendCfg = legendController.legendCfg,\n        container = legendController.container;\n\n    if (legendCfg && legendCfg.custom) {\n      legendController.addCustomLegend();\n    } else {\n      var legendItems = chart.getLegendItems();\n      var scales = chart.get('scales');\n      var filters = chart.get('filters');\n      each(legendItems, function (items, field) {\n        var scale = scales[field];\n        var values = scale.values;\n        var filteredVals;\n\n        if (filters && filters[field]) {\n          filteredVals = values.filter(function (v) {\n            return !filters[field](v);\n          });\n        } else {\n          filteredVals = [];\n        }\n\n        legendController.addLegend(scale, items, filteredVals);\n      });\n    }\n\n    if (legendCfg && legendCfg.clickable !== false) {\n      legendController.bindEvents();\n    }\n\n    var legends = legendController.legends;\n    var legendRange = {\n      top: 0,\n      right: 0,\n      bottom: 0,\n      left: 0\n    };\n    each(legends, function (legendItems, position) {\n      var padding = 0;\n      each(legendItems, function (legend) {\n        var width = legend.getWidth();\n        var height = legend.getHeight();\n\n        if (position === 'top' || position === 'bottom') {\n          padding = Math.max(padding, height);\n\n          if (legend.offsetY > 0) {\n            padding += legend.offsetY;\n          }\n        } else {\n          padding = Math.max(padding, width);\n\n          if (legend.offsetX > 0) {\n            padding += legend.offsetX;\n          }\n        }\n      });\n      legendRange[position] = padding + getPaddingByPos(position, chart.get('appendPadding'));\n    });\n    chart.set('legendRange', legendRange);\n\n    if (Object.keys(legends).length) {\n      container.set('ariaLabel', lang.legend.prefix);\n    } else {\n      container.set('ariaLabel', null);\n    }\n  }\n\n  function afterGeomDraw$2(chart) {\n    var legendController = chart.get('legendController');\n    legendController.alignLegends();\n  }\n\n  function clearInner$1(chart) {\n    var legendController = chart.get('legendController');\n    legendController.clear();\n    chart.set('legendRange', null);\n  }\n\n  var legend = {\n    init: init$2,\n    beforeGeomDraw: beforeGeomDraw,\n    afterGeomDraw: afterGeomDraw$2,\n    clearInner: clearInner$1\n  };\n  var Legend = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    init: init$2,\n    beforeGeomDraw: beforeGeomDraw,\n    afterGeomDraw: afterGeomDraw$2,\n    clearInner: clearInner$1,\n    'default': legend\n  });\n  var clock = typeof performance === 'object' && performance.now ? performance : Date;\n\n  var Timeline = /*#__PURE__*/function () {\n    function Timeline() {\n      this.anims = [];\n      this.time = null;\n      this.playing = false;\n      this.canvas = [];\n    }\n\n    var _proto = Timeline.prototype;\n\n    _proto.play = function play() {\n      var self = this;\n      self.time = clock.now();\n      self.playing = true;\n\n      function step() {\n        if (self.playing) {\n          requestAnimationFrame(step);\n          self.update();\n        }\n      }\n\n      requestAnimationFrame(step);\n    };\n\n    _proto.stop = function stop() {\n      this.playing = false;\n      this.time = null;\n      this.canvas = [];\n    };\n\n    _proto.pushAnim = function pushAnim(animInfo) {\n      // 先启动动画\n      if (!this.playing) {\n        this.play();\n      }\n\n      var delay = animInfo.delay,\n          duration = animInfo.duration;\n      var startTime = this.time + delay;\n      var endTime = startTime + duration;\n      animInfo.startTime = startTime;\n      animInfo.endTime = endTime;\n      this.anims.push(animInfo);\n    };\n\n    _proto.update = function update() {\n      var currentTime = clock.now();\n      this.canvas = [];\n\n      if (!this.anims.length) {\n        this.stop();\n        return;\n      }\n\n      for (var i = 0; i < this.anims.length; i++) {\n        var propertyAnim = this.anims[i];\n\n        if (currentTime < propertyAnim.startTime || propertyAnim.hasEnded) {\n          continue;\n        }\n\n        var shape = propertyAnim.shape; // shape\n\n        if (shape.get('destroyed')) {\n          this.anims.splice(i, 1);\n          i--;\n          continue;\n        }\n\n        var startState = propertyAnim.startState,\n            endState = propertyAnim.endState,\n            interpolate = propertyAnim.interpolate,\n            duration = propertyAnim.duration;\n\n        if (currentTime >= propertyAnim.startTime && !propertyAnim.hasStarted) {\n          propertyAnim.hasStarted = true;\n\n          if (propertyAnim.onStart) {\n            propertyAnim.onStart();\n          }\n        }\n\n        var t = (currentTime - propertyAnim.startTime) / duration;\n        t = Math.max(0, Math.min(t, 1));\n        t = propertyAnim.easing(t);\n\n        if (propertyAnim.onFrame) {\n          propertyAnim.onFrame(t);\n        } else {\n          for (var key in interpolate) {\n            var diff = interpolate[key];\n            var value = diff(t);\n            var newValue = void 0;\n\n            if (key === 'points') {\n              newValue = [];\n              var aLen = Math.max(startState.points.length, endState.points.length);\n\n              for (var j = 0; j < aLen; j += 2) {\n                newValue.push({\n                  x: value[j],\n                  y: value[j + 1]\n                });\n              }\n            } else {\n              newValue = value;\n            }\n\n            shape._attrs.attrs[key] = newValue;\n            shape._attrs.bbox = null; // should clear calculated bbox\n          }\n        }\n\n        var canvas = shape.get('canvas');\n\n        if (this.canvas.indexOf(canvas) === -1) {\n          this.canvas.push(canvas);\n        }\n\n        if (propertyAnim.onUpdate) {\n          propertyAnim.onUpdate(t);\n        }\n\n        if (currentTime >= propertyAnim.endTime && !propertyAnim.hasEnded) {\n          propertyAnim.hasEnded = true;\n\n          if (propertyAnim.onEnd) {\n            propertyAnim.onEnd();\n          }\n        }\n\n        if (t === 1) {\n          // end\n          this.anims.splice(i, 1);\n          i--;\n        }\n      }\n\n      this.canvas.map(function (c) {\n        c.draw();\n        return c;\n      });\n      this.time = clock.now();\n    };\n\n    return Timeline;\n  }();\n\n  function linear$1(k) {\n    return k;\n  }\n\n  function quadraticIn(k) {\n    return k * k;\n  }\n\n  function quadraticOut(k) {\n    return k * (2 - k);\n  }\n\n  function quadraticInOut(k) {\n    if ((k *= 2) < 1) {\n      return 0.5 * k * k;\n    }\n\n    return -0.5 * (--k * (k - 2) - 1);\n  }\n\n  function cubicIn(k) {\n    return k * k * k;\n  }\n\n  function cubicOut(k) {\n    return --k * k * k + 1;\n  }\n\n  function cubicInOut(k) {\n    if ((k *= 2) < 1) {\n      return 0.5 * k * k * k;\n    }\n\n    return 0.5 * ((k -= 2) * k * k + 2);\n  }\n\n  function elasticIn(k) {\n    var s;\n    var a = 0.1;\n    var p = 0.4;\n    if (k === 0) return 0;\n    if (k === 1) return 1;\n\n    if (!a || a < 1) {\n      a = 1;\n      s = p / 4;\n    } else {\n      s = p / (2 * Math.PI) * Math.asin(1 / a);\n    }\n\n    return -(a * Math.pow(2, 10 * (k -= 1)) * Math.sin((k - s) * (2 * Math.PI) / p));\n  }\n\n  function elasticOut(k) {\n    var s;\n    var a = 0.1;\n    var p = 0.4;\n    if (k === 0) return 0;\n    if (k === 1) return 1;\n\n    if (!a || a < 1) {\n      a = 1;\n      s = p / 4;\n    } else {\n      s = p / (2 * Math.PI) * Math.asin(1 / a);\n    }\n\n    return a * Math.pow(2, -10 * k) * Math.sin((k - s) * (2 * Math.PI) / p) + 1;\n  }\n\n  function elasticInOut(k) {\n    var s;\n    var a = 0.1;\n    var p = 0.4;\n    if (k === 0) return 0;\n    if (k === 1) return 1;\n\n    if (!a || a < 1) {\n      a = 1;\n      s = p / 4;\n    } else {\n      s = p / (2 * Math.PI) * Math.asin(1 / a);\n    }\n\n    if ((k *= 2) < 1) {\n      return -0.5 * (a * Math.pow(2, 10 * (k -= 1)) * Math.sin((k - s) * (2 * Math.PI) / p));\n    }\n\n    return a * Math.pow(2, -10 * (k -= 1)) * Math.sin((k - s) * (2 * Math.PI) / p) * 0.5 + 1;\n  }\n\n  function backIn(k) {\n    var s = 1.70158;\n    return k * k * ((s + 1) * k - s);\n  }\n\n  function backOut(k) {\n    var s = 1.70158;\n    return (k = k - 1) * k * ((s + 1) * k + s) + 1;\n  }\n\n  function backInOut(k) {\n    var s = 1.70158 * 1.525;\n\n    if ((k *= 2) < 1) {\n      return 0.5 * (k * k * ((s + 1) * k - s));\n    }\n\n    return 0.5 * ((k -= 2) * k * ((s + 1) * k + s) + 2);\n  }\n\n  function bounceIn(k) {\n    return 1 - bounceOut(1 - k);\n  }\n\n  function bounceOut(k) {\n    if ((k /= 1) < 1 / 2.75) {\n      return 7.5625 * k * k;\n    } else if (k < 2 / 2.75) {\n      return 7.5625 * (k -= 1.5 / 2.75) * k + 0.75;\n    } else if (k < 2.5 / 2.75) {\n      return 7.5625 * (k -= 2.25 / 2.75) * k + 0.9375;\n    }\n\n    return 7.5625 * (k -= 2.625 / 2.75) * k + 0.984375;\n  }\n\n  function bounceInOut(k) {\n    if (k < 0.5) {\n      return bounceIn(k * 2) * 0.5;\n    }\n\n    return bounceOut(k * 2 - 1) * 0.5 + 0.5;\n  }\n\n  var Easing = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    linear: linear$1,\n    quadraticIn: quadraticIn,\n    quadraticOut: quadraticOut,\n    quadraticInOut: quadraticInOut,\n    cubicIn: cubicIn,\n    cubicOut: cubicOut,\n    cubicInOut: cubicInOut,\n    elasticIn: elasticIn,\n    elasticOut: elasticOut,\n    elasticInOut: elasticInOut,\n    backIn: backIn,\n    backOut: backOut,\n    backInOut: backInOut,\n    bounceIn: bounceIn,\n    bounceOut: bounceOut,\n    bounceInOut: bounceInOut\n  });\n\n  function plainArray(arr) {\n    var result = [];\n\n    for (var i = 0, len = arr.length; i < len; i++) {\n      if (arr[i]) {\n        result.push(arr[i].x);\n        result.push(arr[i].y);\n      }\n    }\n\n    return result;\n  }\n\n  function interpolateNumber(a, b) {\n    a = +a;\n    b -= a;\n    return function (t) {\n      return a + b * t;\n    };\n  }\n\n  function interpolateArray(a, b) {\n    var nb = b ? b.length : 0;\n    var na = a ? Math.min(nb, a.length) : 0;\n    var x = new Array(na);\n    var c = new Array(nb);\n    var i;\n\n    for (i = 0; i < na; ++i) {\n      x[i] = interpolateNumber(a[i], b[i]);\n    }\n\n    for (; i < nb; ++i) {\n      c[i] = b[i];\n    }\n\n    return function (t) {\n      for (i = 0; i < na; ++i) {\n        c[i] = x[i](t);\n      }\n\n      return c;\n    };\n  }\n\n  var Animator = /*#__PURE__*/function () {\n    function Animator(shape, source, timeline) {\n      this.hasStarted = false;\n      this.hasEnded = false;\n      this.shape = shape;\n      this.source = source;\n      this.timeline = timeline;\n      this.animate = null;\n    } // delay, attrs, duration, easing\n\n\n    var _proto = Animator.prototype;\n\n    _proto.to = function to(cfg) {\n      if (cfg === void 0) {\n        cfg = {};\n      }\n\n      var delay = cfg.delay || 0;\n      var attrs = cfg.attrs || {};\n      var duration = cfg.duration || 1000;\n      var easing; // 缓动函数\n\n      if (typeof cfg.easing === 'function') {\n        easing = cfg.easing;\n      } else {\n        easing = Easing[cfg.easing] || linear$1;\n      }\n\n      var animInfo = {\n        shape: this.shape,\n        delay: delay,\n        duration: duration,\n        easing: easing\n      };\n      var interpolate = {}; // 差值函数\n\n      for (var attrName in attrs) {\n        var startValue = this.source[attrName];\n        var endValue = attrs[attrName];\n\n        if (attrName === 'points') {\n          startValue = plainArray(startValue);\n          endValue = plainArray(endValue);\n          interpolate.points = interpolateArray(startValue, endValue);\n          this.source.points = startValue;\n          attrs.points = endValue;\n        } else if (attrName === 'matrix') {\n          interpolate.matrix = interpolateArray(startValue, endValue);\n        } else {\n          interpolate[attrName] = interpolateNumber(startValue, endValue);\n        }\n      }\n\n      animInfo.interpolate = interpolate;\n      animInfo.startState = this.source;\n      animInfo.endState = attrs;\n      this.timeline.pushAnim(animInfo);\n      this.animate = animInfo;\n      return this;\n    };\n\n    _proto.onFrame = function onFrame(callback) {\n      // 自定义每一帧动画的动作\n      if (this.animate) {\n        this.animate.onFrame = function (frame) {\n          callback(frame);\n        };\n      }\n\n      return this;\n    };\n\n    _proto.onStart = function onStart(callback) {\n      if (this.animate) {\n        this.animate.onStart = function () {\n          callback();\n        };\n      }\n\n      return this;\n    };\n\n    _proto.onUpdate = function onUpdate(callback) {\n      if (this.animate) {\n        this.animate.onUpdate = function (frame) {\n          callback(frame);\n        };\n      }\n\n      return this;\n    };\n\n    _proto.onEnd = function onEnd(callback) {\n      if (this.animate) {\n        this.animate.onEnd = function () {\n          callback();\n        };\n      }\n\n      return this;\n    };\n\n    return Animator;\n  }();\n\n  var defaultAnimationCfg = {\n    appear: {\n      duration: 450,\n      easing: 'quadraticOut'\n    },\n    // 'appear' animation options\n    update: {\n      duration: 300,\n      easing: 'quadraticOut'\n    },\n    // 'update' animation options\n    enter: {\n      duration: 300,\n      easing: 'quadraticOut'\n    },\n    // 'enter' animation options\n    leave: {\n      duration: 350,\n      easing: 'quadraticIn'\n    } // 'leave' animation options\n\n  };\n  var Animate = {\n    defaultCfg: {},\n    Action: {},\n    getAnimation: function getAnimation(geomType, coord, animationType) {\n      var geomAnimateCfg = this.defaultCfg[geomType];\n\n      if (geomAnimateCfg) {\n        var animation = geomAnimateCfg[animationType];\n\n        if (isFunction(animation)) {\n          return animation(coord);\n        }\n      }\n\n      return false;\n    },\n    getAnimateCfg: function getAnimateCfg(geomType, animationType) {\n      var defaultCfg = defaultAnimationCfg[animationType];\n      var geomConfig = this.defaultCfg[geomType];\n\n      if (geomConfig && geomConfig.cfg && geomConfig.cfg[animationType]) {\n        return deepMix({}, defaultCfg, geomConfig.cfg[animationType]);\n      }\n\n      return defaultCfg;\n    },\n    registerAnimation: function registerAnimation(animationName, animationFun) {\n      var _extends2;\n\n      if (!this.Action) {\n        this.Action = {};\n      }\n\n      this.Action = _extends({}, this.Action, (_extends2 = {}, _extends2[animationName] = animationFun, _extends2));\n    }\n  };\n  /**\n   * Utility\n   * @author sima.zhang1990@gmail.com\n   */\n\n  function getCoordInfo(coord) {\n    var start = coord.start;\n    var end = coord.end;\n    return {\n      start: start,\n      end: end,\n      width: end.x - start.x,\n      height: Math.abs(end.y - start.y)\n    };\n  }\n\n  function getScaledMatrix(shape, v, direct) {\n    var scaledMatrix;\n    shape.apply(v);\n    var x = v[0];\n    var y = v[1];\n\n    if (direct === 'x') {\n      shape.transform([['t', x, y], ['s', 0.01, 1], ['t', -x, -y]]);\n      var matrix = shape.getMatrix();\n      scaledMatrix = Matrix.transform(matrix, [['t', x, y], ['s', 100, 1], ['t', -x, -y]]);\n    } else if (direct === 'y') {\n      shape.transform([['t', x, y], ['s', 1, 0.01], ['t', -x, -y]]);\n\n      var _matrix = shape.getMatrix();\n\n      scaledMatrix = Matrix.transform(_matrix, [['t', x, y], ['s', 1, 100], ['t', -x, -y]]);\n    } else if (direct === 'xy') {\n      shape.transform([['t', x, y], ['s', 0.01, 0.01], ['t', -x, -y]]);\n\n      var _matrix2 = shape.getMatrix();\n\n      scaledMatrix = Matrix.transform(_matrix2, [['t', x, y], ['s', 100, 100], ['t', -x, -y]]);\n    }\n\n    return scaledMatrix;\n  }\n\n  function getAnimateParam(animateCfg, index, id) {\n    var result = {};\n\n    if (animateCfg.delay) {\n      result.delay = isFunction(animateCfg.delay) ? animateCfg.delay(index, id) : animateCfg.delay;\n    }\n\n    result.easing = animateCfg.easing;\n    result.duration = animateCfg.duration;\n    result.delay = animateCfg.delay;\n    return result;\n  }\n\n  function doAnimation(shape, endState, animateCfg, callback) {\n    var id = shape._id;\n    var index = shape.get('index');\n\n    var _getAnimateParam = getAnimateParam(animateCfg, index, id),\n        easing = _getAnimateParam.easing,\n        delay = _getAnimateParam.delay,\n        duration = _getAnimateParam.duration;\n\n    var anim = shape.animate().to({\n      attrs: endState,\n      duration: duration,\n      delay: delay,\n      easing: easing\n    });\n\n    if (callback) {\n      anim.onEnd(function () {\n        callback();\n      });\n    }\n  }\n  /**\n   * Animation functions for shape\n   * @author sima.zhang1990@gmail.com\n   */\n\n  /*\n  function waveIn(shape, animateCfg, coord) {\n    const clip = Helpers.getClip(coord);\n    clip.set('canvas', shape.get('canvas'));\n    shape.attr('clip', clip);\n    const onEnd = function() {\n      shape.attr('clip', null);\n      clip.remove(true);\n    };\n    Helpers.doAnimation(clip, clip.endState, animateCfg, onEnd);\n  }\n   function scaleInX(shape, animateCfg) {\n    const box = shape.getBBox();\n    const points = shape.get('origin').points;\n    let x;\n    const y = (box.minY + box.maxY) / 2;\n     if (points[0].y - points[1].y > 0) { // 当顶点在零点之下\n      x = box.maxX;\n    } else {\n      x = box.minX;\n    }\n    const scaledMatrix = Helpers.getScaledMatrix(shape, [ x, y ], 'x');\n    Helpers.doAnimation(shape, { matrix: scaledMatrix }, animateCfg);\n  }\n   function scaleInY(shape, animateCfg) {\n    const box = shape.getBBox();\n    const points = shape.get('origin').points;\n    const x = (box.minX + box.maxX) / 2;\n    let y;\n     if (points[0].y - points[1].y <= 0) { // 当顶点在零点之下\n      y = box.maxY;\n    } else {\n      y = box.minY;\n    }\n    const scaledMatrix = Helpers.getScaledMatrix(shape, [ x, y ], 'x');\n    Helpers.doAnimation(shape, { matrix: scaledMatrix }, animateCfg);\n  }\n  */\n\n\n  function fadeIn(shape, animateCfg) {\n    var fillOpacity = isNil(shape.attr('fillOpacity')) ? 1 : shape.attr('fillOpacity');\n    var strokeOpacity = isNil(shape.attr('strokeOpacity')) ? 1 : shape.attr('strokeOpacity');\n    shape.attr('fillOpacity', 0);\n    shape.attr('strokeOpacity', 0);\n    var endState = {\n      fillOpacity: fillOpacity,\n      strokeOpacity: strokeOpacity\n    };\n    doAnimation(shape, endState, animateCfg);\n  }\n\n  var ShapeAction = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    fadeIn: fadeIn\n  });\n  /**\n   * Group animate functions\n   * @author sima.zhang1990@gmail.com\n   */\n\n  function _groupScaleIn(container, animateCfg, coord, zeroY, type) {\n    var _getCoordInfo = getCoordInfo(coord),\n        start = _getCoordInfo.start,\n        end = _getCoordInfo.end,\n        width = _getCoordInfo.width,\n        height = _getCoordInfo.height;\n\n    var x;\n    var y;\n    var clip = new Shape$2.Rect({\n      attrs: {\n        x: start.x,\n        y: end.y,\n        width: width,\n        height: height\n      }\n    });\n\n    if (type === 'y') {\n      x = start.x + width / 2;\n      y = zeroY.y < start.y ? zeroY.y : start.y;\n    } else if (type === 'x') {\n      x = zeroY.x > start.x ? zeroY.x : start.x;\n      y = start.y + height / 2;\n    } else if (type === 'xy') {\n      if (coord.isPolar) {\n        x = coord.center.x;\n        y = coord.center.y;\n      } else {\n        x = (start.x + end.x) / 2;\n        y = (start.y + end.y) / 2;\n      }\n    }\n\n    var endMatrix = getScaledMatrix(clip, [x, y], type);\n    clip.isClip = true;\n    clip.endState = {\n      matrix: endMatrix\n    };\n    clip.set('canvas', container.get('canvas'));\n    container.attr('clip', clip);\n\n    var onEnd = function onEnd() {\n      container.attr('clip', null);\n      clip.remove(true);\n    };\n\n    doAnimation(clip, clip.endState, animateCfg, onEnd);\n  }\n\n  function _shapeScale(container, animateCfg, type) {\n    var shapes = container.get('children');\n    var x;\n    var y;\n    var endMatrix;\n\n    for (var i = 0, len = shapes.length; i < len; i++) {\n      var shape = shapes[i];\n      var box = shape.getBBox();\n      x = (box.minX + box.maxX) / 2;\n      y = (box.minY + box.maxY) / 2;\n      endMatrix = getScaledMatrix(shape, [x, y], type);\n      doAnimation(shape, {\n        matrix: endMatrix\n      }, animateCfg);\n    }\n  }\n\n  function groupScaleInX(container, animateCfg, coord, zeroY) {\n    _groupScaleIn(container, animateCfg, coord, zeroY, 'x');\n  }\n\n  function groupScaleInY(container, animateCfg, coord, zeroY) {\n    _groupScaleIn(container, animateCfg, coord, zeroY, 'y');\n  }\n\n  function groupScaleInXY(container, animateCfg, coord, zeroY) {\n    _groupScaleIn(container, animateCfg, coord, zeroY, 'xy');\n  }\n\n  function shapesScaleInX(container, animateCfg) {\n    _shapeScale(container, animateCfg, 'x');\n  }\n\n  function shapesScaleInY(container, animateCfg) {\n    _shapeScale(container, animateCfg, 'y');\n  }\n\n  function shapesScaleInXY(container, animateCfg) {\n    _shapeScale(container, animateCfg, 'xy');\n  }\n\n  function groupWaveIn(container, animateCfg, coord) {\n    var clip = getClip(coord);\n    clip.set('canvas', container.get('canvas'));\n    container.attr('clip', clip);\n\n    var onEnd = function onEnd() {\n      container.attr('clip', null);\n      clip.remove(true);\n    };\n\n    var endState = {};\n\n    if (coord.isPolar) {\n      var startAngle = coord.startAngle,\n          endAngle = coord.endAngle;\n      endState.endAngle = endAngle;\n      clip.attr('endAngle', startAngle);\n    } else {\n      var start = coord.start,\n          end = coord.end;\n      var width = Math.abs(start.x - end.x);\n      var height = Math.abs(start.y - end.y);\n\n      if (coord.isTransposed) {\n        clip.attr('height', 0);\n        endState.height = height;\n      } else {\n        clip.attr('width', 0);\n        endState.width = width;\n      }\n    }\n\n    doAnimation(clip, endState, animateCfg, onEnd);\n  }\n\n  var GroupAction = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    groupWaveIn: groupWaveIn,\n    groupScaleInX: groupScaleInX,\n    groupScaleInY: groupScaleInY,\n    groupScaleInXY: groupScaleInXY,\n    shapesScaleInX: shapesScaleInX,\n    shapesScaleInY: shapesScaleInY,\n    shapesScaleInXY: shapesScaleInXY\n  });\n  /**\n   * Handle the detail animations\n   * @author sima.zhang1990@gmail.com\n   */\n\n  var timeline;\n\n  Element.prototype.animate = function () {\n    var attrs = mix({}, this.get('attrs'));\n    return new Animator(this, attrs, timeline);\n  };\n\n  Chart.prototype.animate = function (cfg) {\n    this.set('animate', cfg);\n    return this;\n  };\n\n  Animate.Action = ShapeAction;\n  Animate.defaultCfg = {\n    interval: {\n      enter: function enter(coord) {\n        if (coord.isPolar && coord.transposed) {\n          // for pie chart\n          return function (shape) {\n            shape.set('zIndex', -1);\n            var container = shape.get('parent');\n            container.sort();\n          };\n        }\n\n        return fadeIn;\n      }\n    },\n    area: {\n      enter: function enter(coord) {\n        if (coord.isPolar) return null;\n        return fadeIn;\n      }\n    },\n    line: {\n      enter: function enter(coord) {\n        if (coord.isPolar) return null;\n        return fadeIn;\n      }\n    },\n    path: {\n      enter: function enter(coord) {\n        if (coord.isPolar) return null;\n        return fadeIn;\n      }\n    }\n  };\n  var GROUP_ANIMATION = {\n    line: function line(coord) {\n      if (coord.isPolar) {\n        return groupScaleInXY;\n      }\n\n      return groupWaveIn;\n    },\n    area: function area(coord) {\n      if (coord.isPolar) {\n        return groupScaleInXY;\n      }\n\n      return groupWaveIn;\n    },\n    path: function path(coord) {\n      if (coord.isPolar) {\n        return groupScaleInXY;\n      }\n\n      return groupWaveIn;\n    },\n    point: function point() {\n      return shapesScaleInXY;\n    },\n    interval: function interval(coord) {\n      var result;\n\n      if (coord.isPolar) {\n        // polar coodinate\n        result = groupScaleInXY;\n\n        if (coord.transposed) {\n          // pie chart\n          result = groupWaveIn;\n        }\n      } else {\n        result = coord.transposed ? groupScaleInX : groupScaleInY;\n      }\n\n      return result;\n    },\n    schema: function schema() {\n      return groupWaveIn;\n    }\n  };\n\n  function diff(fromAttrs, toAttrs) {\n    var endState = {};\n\n    for (var k in toAttrs) {\n      if (isNumber(fromAttrs[k]) && fromAttrs[k] !== toAttrs[k]) {\n        endState[k] = toAttrs[k];\n      } else if (isArray(fromAttrs[k]) && JSON.stringify(fromAttrs[k]) !== JSON.stringify(toAttrs[k])) {\n        endState[k] = toAttrs[k];\n      }\n    }\n\n    return endState;\n  } // Add a unique id identifier to each shape\n\n\n  function _getShapeId(geom, dataObj, geomIdx) {\n    var type = geom.get('type');\n    var id = 'geom' + geomIdx + '-' + type;\n    var xScale = geom.getXScale();\n    var yScale = geom.getYScale();\n    var xField = xScale.field || 'x';\n    var yField = yScale.field || 'y';\n    var yVal = dataObj[yField];\n    var xVal;\n\n    if (xScale.isIdentity) {\n      xVal = xScale.value;\n    } else {\n      xVal = dataObj[xField];\n    }\n\n    if (type === 'interval' || type === 'schema') {\n      id += '-' + xVal;\n    } else if (type === 'line' || type === 'area' || type === 'path') {\n      id += '-' + type;\n    } else {\n      id += xScale.isCategory ? '-' + xVal : '-' + xVal + '-' + yVal;\n    }\n\n    var groupScales = geom._getGroupScales();\n\n    each(groupScales, function (groupScale) {\n      var field = groupScale.field;\n\n      if (groupScale.type !== 'identity') {\n        id += '-' + dataObj[field];\n      }\n    });\n    return id;\n  } // get geometry's shapes\n\n\n  function getShapes(geoms, chart, coord) {\n    var shapes = [];\n    each(geoms, function (geom, geomIdx) {\n      var geomContainer = geom.get('container');\n      var geomShapes = geomContainer.get('children');\n      var type = geom.get('type');\n      var animateCfg = isNil(geom.get('animateCfg')) ? _getAnimateCfgByShapeType(type, chart) : geom.get('animateCfg');\n\n      if (animateCfg !== false) {\n        each(geomShapes, function (shape, index) {\n          if (shape.get('className') === type) {\n            shape._id = _getShapeId(geom, shape.get('origin')._origin, geomIdx);\n            shape.set('coord', coord);\n            shape.set('animateCfg', animateCfg);\n            shape.set('index', index);\n            shapes.push(shape);\n          }\n        });\n      }\n\n      geom.set('shapes', geomShapes);\n    });\n    return shapes;\n  }\n\n  function cache(shapes) {\n    var rst = {};\n\n    for (var i = 0, len = shapes.length; i < len; i++) {\n      var shape = shapes[i];\n      if (!shape._id || shape.isClip) continue;\n      var id = shape._id;\n      rst[id] = {\n        _id: id,\n        type: shape.get('type'),\n        // the type of shape\n        attrs: mix({}, shape._attrs.attrs),\n        // the graphics attributes of shape\n        className: shape.get('className'),\n        geomType: shape.get('className'),\n        index: shape.get('index'),\n        coord: shape.get('coord'),\n        animateCfg: shape.get('animateCfg')\n      };\n    }\n\n    return rst;\n  }\n\n  function getAnimate(geomType, coord, animationType, animationName) {\n    var result;\n\n    if (isFunction(animationName)) {\n      result = animationName;\n    } else if (isString(animationName)) {\n      result = Animate.Action[animationName];\n    } else {\n      result = Animate.getAnimation(geomType, coord, animationType);\n    }\n\n    return result;\n  }\n\n  function getAnimateCfg(geomType, animationType, animateCfg) {\n    if (animateCfg === false || isObject(animateCfg) && animateCfg[animationType] === false) {\n      return false;\n    }\n\n    var defaultCfg = Animate.getAnimateCfg(geomType, animationType);\n\n    if (animateCfg && animateCfg[animationType]) {\n      return deepMix({}, defaultCfg, animateCfg[animationType]);\n    }\n\n    return defaultCfg;\n  }\n\n  function addAnimate(cache, shapes, canvas) {\n    var animate;\n    var animateCfg; // the order of animation: leave -> update -> enter\n\n    var updateShapes = [];\n    var newShapes = [];\n    each(shapes, function (shape) {\n      var result = cache[shape._id];\n\n      if (!result) {\n        newShapes.push(shape);\n      } else {\n        shape.set('cacheShape', result);\n        updateShapes.push(shape);\n        delete cache[shape._id];\n      }\n    }); // first do the leave animation\n\n    each(cache, function (deletedShape) {\n      var className = deletedShape.className,\n          coord = deletedShape.coord,\n          _id = deletedShape._id,\n          attrs = deletedShape.attrs,\n          index = deletedShape.index,\n          type = deletedShape.type;\n      animateCfg = getAnimateCfg(className, 'leave', deletedShape.animateCfg);\n      if (animateCfg === false) return true;\n      animate = getAnimate(className, coord, 'leave', animateCfg.animation);\n\n      if (isFunction(animate)) {\n        var tempShape = canvas.addShape(type, {\n          attrs: attrs,\n          index: index,\n          canvas: canvas,\n          className: className\n        });\n        tempShape._id = _id;\n        animate(tempShape, animateCfg, coord);\n      }\n    }); // then do the update animation\n\n    each(updateShapes, function (updateShape) {\n      var className = updateShape.get('className');\n      animateCfg = getAnimateCfg(className, 'update', updateShape.get('animateCfg'));\n      if (animateCfg === false) return true;\n      var coord = updateShape.get('coord');\n      var cacheAttrs = updateShape.get('cacheShape').attrs;\n      var endState = diff(cacheAttrs, updateShape._attrs.attrs); // 判断如果属性相同的话就不进行变换\n\n      if (Object.keys(endState).length) {\n        animate = getAnimate(className, coord, 'update', animateCfg.animation);\n\n        if (isFunction(animate)) {\n          animate(updateShape, animateCfg, coord);\n        } else {\n          var startState = {};\n          each(endState, function (value, key) {\n            startState[key] = cacheAttrs[key];\n          });\n          updateShape.attr(startState);\n          updateShape.animate().to({\n            attrs: endState,\n            duration: animateCfg.duration,\n            easing: animateCfg.easing,\n            delay: animateCfg.delay\n          }).onEnd(function () {\n            updateShape.set('cacheShape', null);\n          });\n        }\n      }\n    }); // last, enter animation\n\n    each(newShapes, function (newShape) {\n      // 新图形元素的进场元素\n      var className = newShape.get('className');\n      var coord = newShape.get('coord');\n      animateCfg = getAnimateCfg(className, 'enter', newShape.get('animateCfg'));\n      if (animateCfg === false) return true;\n      animate = getAnimate(className, coord, 'enter', animateCfg.animation);\n\n      if (isFunction(animate)) {\n        if (className === 'interval' && coord.isPolar && coord.transposed) {\n          var index = newShape.get('index');\n          var lastShape = updateShapes[index - 1];\n          animate(newShape, animateCfg, lastShape);\n        } else {\n          animate(newShape, animateCfg, coord);\n        }\n      }\n    });\n  }\n\n  function _getAnimateCfgByShapeType(type, chart) {\n    if (!type) {\n      return null;\n    }\n\n    var animateCfg = chart.get('animate');\n\n    if (type.indexOf('guide-tag') > -1) {\n      type = 'guide-tag';\n    }\n\n    if (isObject(animateCfg)) {\n      return animateCfg[type];\n    }\n\n    if (animateCfg === false) {\n      return false;\n    }\n\n    return null;\n  }\n\n  function afterCanvasInit()\n  /* chart */\n  {\n    timeline = new Timeline();\n    timeline.play();\n  }\n\n  function beforeCanvasDraw(chart) {\n    if (chart.get('animate') === false) {\n      return;\n    }\n\n    var isUpdate = chart.get('isUpdate');\n    var canvas = chart.get('canvas');\n    var coord = chart.get('coord');\n    var geoms = chart.get('geoms');\n    var caches = canvas.get('caches') || [];\n\n    if (caches.length === 0) {\n      isUpdate = false;\n    }\n\n    var cacheShapes = getShapes(geoms, chart, coord);\n\n    var _chart$get = chart.get('axisController'),\n        frontPlot = _chart$get.frontPlot,\n        backPlot = _chart$get.backPlot;\n\n    var axisShapes = frontPlot.get('children').concat(backPlot.get('children'));\n    var guideShapes = [];\n\n    if (chart.get('guideController')) {\n      guideShapes = chart.get('guideController').guideShapes;\n    }\n\n    var componentShapes = [];\n    axisShapes.concat(guideShapes).forEach(function (s) {\n      var className = s.get('className');\n\n      var animateCfg = _getAnimateCfgByShapeType(className, chart);\n\n      s.set('coord', coord);\n      s.set('animateCfg', animateCfg);\n      componentShapes.push(s);\n      cacheShapes.push(s);\n    });\n    canvas.set('caches', cache(cacheShapes));\n\n    if (isUpdate) {\n      addAnimate(caches, cacheShapes, canvas);\n    } else {\n      // do the appear animation\n      var animateCfg;\n      var animate;\n      each(geoms, function (geom) {\n        var type = geom.get('type');\n        var geomCfg = isNil(geom.get('animateCfg')) ? _getAnimateCfgByShapeType(type, chart) : geom.get('animateCfg');\n\n        if (geomCfg !== false) {\n          animateCfg = getAnimateCfg(type, 'appear', geomCfg);\n          animate = getAnimate(type, coord, 'appear', animateCfg.animation);\n\n          if (isFunction(animate)) {\n            var shapes = geom.get('shapes');\n            each(shapes, function (shape) {\n              animate(shape, animateCfg, coord);\n            });\n          } else if (GROUP_ANIMATION[type]) {\n            // do the default animation\n            animate = GroupAction[animateCfg.animation] || GROUP_ANIMATION[type](coord);\n            var yScale = geom.getYScale();\n            var zeroY = coord.convertPoint({\n              x: 0,\n              y: yScale.scale(geom.getYMinValue())\n            });\n            var container = geom.get('container');\n            animate && animate(container, animateCfg, coord, zeroY);\n          }\n        }\n      }); // do the animation of components\n\n      each(componentShapes, function (shape) {\n        var animateCfg = shape.get('animateCfg');\n        var className = shape.get('className');\n\n        if (animateCfg && animateCfg.appear) {\n          // if user configure\n          var defaultCfg = Animate.getAnimateCfg(className, 'appear');\n          var appearCfg = deepMix({}, defaultCfg, animateCfg.appear);\n\n          var _animate = getAnimate(className, coord, 'appear', appearCfg.animation);\n\n          if (isFunction(_animate)) {\n            _animate(shape, appearCfg, coord);\n          }\n        }\n      });\n    }\n  }\n\n  function afterCanvasDestroyed()\n  /* chart */\n  {\n    timeline.stop();\n  }\n\n  var detail = {\n    afterCanvasInit: afterCanvasInit,\n    beforeCanvasDraw: beforeCanvasDraw,\n    afterCanvasDestroyed: afterCanvasDestroyed\n  };\n  var Animation = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    afterCanvasInit: afterCanvasInit,\n    beforeCanvasDraw: beforeCanvasDraw,\n    afterCanvasDestroyed: afterCanvasDestroyed,\n    'default': detail\n  });\n  Chart._Interactions = {};\n\n  Chart.registerInteraction = function (type, constructor) {\n    Chart._Interactions[type] = constructor;\n  };\n\n  Chart.getInteraction = function (type) {\n    return Chart._Interactions[type];\n  };\n\n  Chart.prototype.interaction = function (type, cfg) {\n    var interactions = this._interactions || {};\n\n    if (interactions[type]) {\n      // if reprated, destroy last\n      interactions[type].destroy();\n    }\n\n    var Ctor = Chart.getInteraction(type);\n    var interact = new Ctor(cfg, this);\n    interactions[type] = interact;\n    this._interactions = interactions;\n    return this;\n  };\n\n  Chart.prototype.clearInteraction = function (type) {\n    var interactions = this._interactions;\n    if (!interactions) return;\n\n    if (type) {\n      interactions[type] && interactions[type].destroy();\n      delete interactions[type];\n    } else {\n      each(interactions, function (interaction, key) {\n        interaction.destroy();\n        delete interactions[key];\n      });\n    }\n\n    return this;\n  };\n\n  function isValuesEqual(values, newValues) {\n    if (values.length !== newValues.length) {\n      return false;\n    }\n\n    var lastIndex = values.length - 1;\n    return values[0] === newValues[0] && values[lastIndex] === newValues[lastIndex];\n  } // 不同交互之间共享的上下文\n\n\n  var defaultRange = [0, 1];\n\n  var Context = /*#__PURE__*/function () {\n    // 最开始的原始值\n    // 当前显示的范围\n    // 缩放最小的点数\n    // 最小的缩放比例, 默认通过minCount计算\n    // minScale = 0.01;\n    // 交互开始时，ticks个数，主要为了每次缩放后，更新ticks个数\n    // lastTickCount;\n    function Context(chart) {\n      var _this = this;\n\n      _defineProperty(this, \"chart\", null);\n\n      _defineProperty(this, \"values\", null);\n\n      _defineProperty(this, \"range\", defaultRange);\n\n      _defineProperty(this, \"startRange\", defaultRange);\n\n      _defineProperty(this, \"minCount\", 10);\n\n      _defineProperty(this, \"_afterinit\", function () {\n        // 初始化value值\n        var scale = _this.getPinchScale(); // 记录原始全量数据\n\n\n        var values = [].concat(scale.values);\n        _this.values = values; // 最小的缩放比例\n\n        if (!_this.minScale) {\n          _this.minScale = _this.minCount / values.length;\n        } // 初始化的时候有设置range，则初始化成默认比例\n\n\n        if (_this.range !== defaultRange) {\n          _this.updateRange(_this.range);\n\n          _this.updateTicks();\n        }\n      });\n\n      _defineProperty(this, \"_afterdatachange\", function () {\n        _this.updateRange(_this.range);\n      });\n\n      this.chart = chart;\n\n      this._initEvent(chart);\n    }\n\n    var _proto = Context.prototype;\n\n    _proto._initEvent = function _initEvent(chart) {\n      // 在整体初始化后还需要设置一些初始状态\n      chart.on(EVENT_AFTER_INIT, this._afterinit);\n      chart.on(EVENT_AFTER_DATA_CHANGE, this._afterdatachange);\n    } // 缩放的主轴scale\n    ;\n\n    _proto.getPinchScale = function getPinchScale() {\n      var chart = this.chart; // 默认缩放x轴\n\n      var scale = chart.getXScale();\n      return scale;\n    } // 跟随轴的scale\n    ;\n\n    _proto.getFollowScale = function getFollowScale() {\n      var chart = this.chart; // 默认缩放x轴\n\n      var scales = chart.getYScales() || [];\n      return scales[0];\n    };\n\n    _proto.start = function start() {\n      var range = this.range;\n      var scale = this.getPinchScale();\n      var start = range[0],\n          end = range[1]; // 记录交互起始的范围\n\n      this.startRange = [start, end]; // 记录开始时的ticks个数\n\n      this.lastTickCount = scale.tickCount;\n    };\n\n    _proto.doZoom = function doZoom(leftScale, rightScale, zoom) {\n      var range = this.startRange,\n          minScale = this.minScale;\n      var start = range[0],\n          end = range[1];\n      var zoomOffset = 1 - zoom;\n      var rangeLen = end - start;\n      var rangeOffset = rangeLen * zoomOffset;\n      var leftOffset = rangeOffset * leftScale;\n      var rightOffset = rangeOffset * rightScale;\n      var newStart = Math.max(0, start - leftOffset);\n      var newEnd = Math.min(1, end + rightOffset);\n      var newRange = [newStart, newEnd]; // 如果已经到了最小比例，则不能再继续再放大\n\n      if (newEnd - newStart < minScale) {\n        return;\n      }\n\n      this.updateRange(newRange);\n    };\n\n    _proto.doMove = function doMove(ratio) {\n      // 不管是0， 还是其他，都不用处理\n      if (!ratio) return;\n      var range = this.startRange;\n      var start = range[0],\n          end = range[1];\n      var rangeLen = end - start;\n      var rangeOffset = rangeLen * ratio;\n      var newStart = start - rangeOffset;\n      var newEnd = end - rangeOffset; // 处理边界值\n\n      var newRange;\n\n      if (newStart < 0) {\n        newRange = [0, rangeLen];\n      } else if (newEnd > 1) {\n        newRange = [1 - rangeLen, 1];\n      } else {\n        newRange = [newStart, newEnd];\n      }\n\n      this.updateRange(newRange);\n    };\n\n    _proto.updateRange = function updateRange(range) {\n      var values = this.values; // 0， 1 的范围之间\n\n      var start = range[0],\n          end = range[1]; // start 不能小于0\n\n      start = Math.max(0, start); // end 不能大于1\n\n      end = Math.min(1, end); // 设置当前的范围\n\n      this.range = [start, end];\n      var len = values.length;\n      var valueStart = start * len;\n      var valueEnd = end * len; // 从原始数据里截取需要显示的数据\n\n      var newValues = values.slice(valueStart, valueEnd);\n      this.repaint(newValues);\n    };\n\n    _proto.repaint = function repaint(newValues) {\n      var chart = this.chart;\n      var scale = this.getPinchScale();\n      var currentValues = scale.values,\n          ticks = scale.ticks; // 如果新数组和当前显示的数组相同，则不更新\n\n      if (isValuesEqual(currentValues, newValues)) {\n        return;\n      } // 更新主轴values\n\n\n      this.updateScale(scale, {\n        ticks: ticks,\n        values: newValues\n      });\n      this.updateFollowScale(scale, newValues);\n      chart.repaint();\n    };\n\n    _proto.updateFollowScale = function updateFollowScale(pinchScale, pinchValues) {\n      var chart = this.chart;\n      var followScale = this.getFollowScale();\n      var pinchField = pinchScale.field,\n          pinchScaleType = pinchScale.type;\n      var followField = followScale.field; // 根据主轴的value值，找到所有从轴的value值\n\n      var values = []; // 转成map，让查找性能更高\n\n      var pinchValueMap = {};\n      pinchValues.forEach(function (item) {\n        pinchValueMap[item] = true;\n      });\n      var data = chart.get('data');\n      data.forEach(function (item) {\n        if (pinchScaleType === 'timeCat') {\n          var value = toTimeStamp(item[pinchField]);\n\n          if (pinchValueMap[value]) {\n            values.push(item[followField]);\n          }\n        }\n      });\n\n      var _getRange = getRange$1(values),\n          min = _getRange.min,\n          max = _getRange.max;\n\n      this.updateScale(followScale, {\n        min: min,\n        max: max,\n        nice: true\n      });\n    };\n\n    _proto.updateScale = function updateScale(scale, cfg) {\n      if (!scale) {\n        return;\n      }\n\n      scale.change(cfg);\n    } // 上一次的tick个数\n    ;\n\n    _proto.updateTicks = function updateTicks() {\n      var chart = this.chart,\n          values = this.values;\n      var scale = this.getPinchScale();\n      var currentValues = scale.values,\n          tickCount = scale.tickCount; // 根据当前数据的比例，和定义的tickCount计算应该需要多少个ticks\n\n      var newTickCount = Math.round(tickCount * values.length / currentValues.length);\n      var catTicks = getTickMethod('cat');\n      var ticks = catTicks({\n        tickCount: newTickCount,\n        values: values\n      });\n      this.updateScale(scale, {\n        ticks: ticks,\n        values: currentValues\n      }); // 更新完后，需要重新绘制一次\n\n      chart.repaint();\n    };\n\n    _proto.destroy = function destroy() {\n      var chart = this.chart;\n      chart.off(EVENT_AFTER_INIT, this._afterinit);\n      chart.off(EVENT_AFTER_DATA_CHANGE, this._afterdatachange);\n    };\n\n    return Context;\n  }();\n\n  var Base$2 = /*#__PURE__*/function () {\n    var _proto = Base.prototype; // 交互的上下文\n\n    _proto.getDefaultCfg = function getDefaultCfg() {\n      return {};\n    };\n\n    _proto.getInteractionContext = function getInteractionContext(chart) {\n      var interactionContext = chart.get('interactionContext');\n\n      if (interactionContext) {\n        return interactionContext;\n      }\n\n      interactionContext = new Context(chart);\n      chart.set('interactionContext', interactionContext);\n      return interactionContext;\n    };\n\n    function Base(cfg, chart) {\n      var _this = this;\n\n      _defineProperty(this, \"type\", '');\n\n      _defineProperty(this, \"startEvent\", 'touchstart');\n\n      _defineProperty(this, \"processEvent\", 'touchmove');\n\n      _defineProperty(this, \"endEvent\", 'touchend');\n\n      _defineProperty(this, \"resetEvent\", null);\n\n      _defineProperty(this, \"context\", null);\n\n      _defineProperty(this, \"_start\", function (ev) {\n        _this.preStart && _this.preStart(ev);\n\n        _this.start(ev);\n\n        _this.onStart && _this.onStart(ev);\n      });\n\n      _defineProperty(this, \"_process\", function (ev) {\n        _this.preProcess && _this.preProcess(ev);\n\n        _this.process(ev);\n\n        _this.onProcess && _this.onProcess(ev);\n      });\n\n      _defineProperty(this, \"_end\", function (ev) {\n        _this.preEnd && _this.preEnd(ev);\n\n        _this.end(ev);\n\n        _this.onEnd && _this.onEnd(ev);\n      });\n\n      _defineProperty(this, \"_reset\", function (ev) {\n        _this.preReset && _this.preReset(ev);\n\n        _this.reset(ev);\n\n        _this.onReset && _this.onReset(ev);\n      });\n\n      mix(this, this.getDefaultCfg(), cfg);\n      this.context = this.getInteractionContext(chart);\n      this.chart = chart; // 只处理range, 暂时先这么处理后面再看情况调整\n\n      var range = this.range;\n\n      if (range) {\n        this.context.range = range;\n      }\n\n      this._bindEvents(chart);\n    }\n\n    _proto._bindEvents = function _bindEvents(chart) {\n      var startEvent = this.startEvent,\n          processEvent = this.processEvent,\n          endEvent = this.endEvent,\n          resetEvent = this.resetEvent;\n      var canvas = chart.get('canvas'); // 统一绑定事件\n\n      canvas.on(startEvent, this._start);\n      canvas.on(processEvent, this._process);\n      canvas.on(endEvent, this._end);\n      canvas.on(resetEvent, this._reset);\n    };\n\n    _proto._clearEvents = function _clearEvents() {\n      var chart = this.chart,\n          startEvent = this.startEvent,\n          processEvent = this.processEvent,\n          endEvent = this.endEvent,\n          resetEvent = this.resetEvent;\n      var canvas = chart.get('canvas'); // 统一绑定事件\n\n      canvas.off(startEvent, this._start);\n      canvas.off(processEvent, this._process);\n      canvas.off(endEvent, this._end);\n      canvas.off(resetEvent, this._start);\n    }; // override\n\n\n    _proto.start = function start() {} // override\n    ;\n\n    _proto.process = function process() {} // override\n    ;\n\n    _proto.end = function end() {} // override\n    ;\n\n    _proto.reset = function reset() {};\n\n    _proto.destroy = function destroy() {\n      this.context.destroy();\n\n      this._clearEvents();\n    };\n\n    return Base;\n  }();\n\n  var Pan = /*#__PURE__*/function (_Base) {\n    _inheritsLoose(Pan, _Base);\n\n    function Pan() {\n      return _Base.apply(this, arguments) || this;\n    }\n\n    var _proto = Pan.prototype;\n\n    _proto.getDefaultCfg = function getDefaultCfg() {\n      return {\n        type: 'pan',\n        startEvent: 'panstart',\n        processEvent: 'pan',\n        endEvent: 'panend'\n      };\n    };\n\n    _proto.start = function start() {\n      var context = this.context;\n      context.start();\n    };\n\n    _proto.process = function process(e) {\n      var direction = e.direction,\n          deltaX = e.deltaX;\n\n      if (direction === 'up' || direction === 'down') {\n        return;\n      }\n\n      e.preventDefault && e.preventDefault();\n      var context = this.context;\n      var chart = context.chart;\n      var coord = chart.get('coord');\n      var start = coord.start,\n          end = coord.end;\n      var coordWidth = end.x - start.x;\n      var ratio = deltaX / coordWidth;\n      context.doMove(ratio);\n    };\n\n    return Pan;\n  }(Base$2);\n\n  var Pinch = /*#__PURE__*/function (_Base) {\n    _inheritsLoose(Pinch, _Base);\n\n    var _proto = Pinch.prototype;\n\n    _proto.getDefaultCfg = function getDefaultCfg() {\n      return {\n        type: 'pinch',\n        startEvent: 'pinchstart',\n        processEvent: 'pinch',\n        endEvent: 'pinchend'\n      };\n    };\n\n    function Pinch(cfg, chart) {\n      var _this;\n\n      _this = _Base.call(this, cfg, chart) || this;\n\n      var _assertThisInitialize = _assertThisInitialized(_this),\n          context = _assertThisInitialize.context;\n\n      mix(context, cfg);\n      return _this;\n    }\n\n    _proto.start = function start() {\n      var context = this.context;\n      context.start();\n    };\n\n    _proto.process = function process(e) {\n      e.preventDefault && e.preventDefault();\n      var zoom = e.zoom,\n          center = e.center;\n      var context = this.context;\n      var chart = context.chart;\n      var coord = chart.get('coord');\n      var start = coord.start,\n          end = coord.end;\n      var coordWidth = end.x - start.x;\n      var leftLen = Math.abs(center.x - start.x);\n      var rightLen = Math.abs(end.x - center.x); // 计算左右缩放的比例\n\n      var leftScale = leftLen / coordWidth;\n      var rightScale = rightLen / coordWidth;\n      context.doZoom(leftScale, rightScale, zoom);\n    };\n\n    _proto.end = function end() {\n      // 缩放完成后再更新ticks\n      var context = this.context;\n      context.updateTicks();\n    };\n\n    return Pinch;\n  }(Base$2);\n\n  Chart.registerInteraction('pan', Pan);\n  Chart.registerInteraction('pinch', Pinch);\n  /**\n   * Default, without interactins\n   */\n\n  var Component = {\n    // 为了兼容之前版本\n    Marker: Shape$2.Marker,\n    Tooltip: Tooltip\n  }; // register plugins\n\n  Chart.plugins.register([Tooltip$1, Legend, Guide, Animation]); // 默认添加交互\n\n  var index = {\n    Component: Component,\n    Global: Global,\n    Chart: Chart,\n    Shape: Shape$1,\n    G: G,\n    Util: Util,\n    Helper: Helper,\n    track: track,\n    Animate: Animate\n  };\n  exports.Animate = Animate;\n  exports.Chart = Chart;\n  exports.Component = Component;\n  exports.G = G;\n  exports.Global = Global;\n  exports.Helper = Helper;\n  exports.Shape = Shape$1;\n  exports.Util = Util;\n  exports.default = index;\n  exports.track = track;\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n});","map":{"version":3,"sources":["/home/zhiguangda/ITS/deckgl/node_modules/@antv/f2/dist/f2.js"],"names":["global","factory","exports","module","define","amd","globalThis","self","F2","isArrayLike","value","isFinite","length","contains","arr","indexOf","filter","func","result","index","push","toString","isType","type","call","isFunction","isNil","undefined","isArray","Array","isObject","each","elements","rst","i","len","k","hasOwnProperty","keys","Object","obj","key","isMatch","attrs","_keys","isObjectLike","isPlainObject","getPrototypeOf","proto","find","predicate","_predicate","a","getRange","values","filterValues","v","isNaN","min","max","tmp","concat","Math","apply","isString","str","uniq","resultArr","item","head","o","last","fixedBase","base","round","substr","parseFloat","toFixed","isNumber","toString$1","lowerFirst","charAt","toLowerCase","substring","substitute","replace","match","name","slice","upperFirst","toUpperCase","toString$2","getType","isBoolean","isDate","objectProto","prototype","isPrototype","Ctor","constructor","_mix","dist","mix","src1","src2","src3","MAX_MIX_LEVEL","_deepMix","src","level","maxLevel","deepMix","args","_i","arguments","m","isEmpty","size","isEqual","other","valueKeys","otherKeys","map","merge","dataArray","data","tmpMap","val","firstValue","groupToMap","fields","callback","row","unique","l","groups","group","appendConditions","array","_values","remove","splice","getRange$1","freeze","__proto__","supportsEventListenerOptions","supports","options","defineProperty","get","window","addEventListener","e","eventListenerOptions","passive","isWx","wx","getSystemInfoSync","isMy","my","isNode","isBrowser","document","sessionStorage","isCanvasElement","el","nodeType","nodeName","getPixelRatio","devicePixelRatio","getStyle","property","currentStyle","defaultView","getComputedStyle","getPropertyValue","getWidth","width","offsetWidth","getHeight","height","offsetHeight","getDomById","id","getElementById","getRelativePosition","point","canvas","canvasDom","_canvasDom$getBoundin","getBoundingClientRect","top","left","paddingLeft","paddingTop","mouseX","x","mouseY","y","source","listener","removeEventListener","landscapePoint","landscape","convertPoints","ev","touches","clientX","clientY","changedTouches","points","touch","_point","createEvent","event","chart","measureText","text","font","ctx","createElement","getContext","isObjectValueEqual","b","assign","aProps","getOwnPropertyNames","bProps","propName","parsePadding","padding","right","bottom","directionEnabled","mode","dir","toTimeStamp","Date","getTime","Util","color1","color2","defaultAxis","label","fill","fontSize","line","stroke","lineWidth","grid","lineDash","tickLine","labelOffset","Theme","fontFamily","defaultColor","pixelRatio","appendPadding","colors","shapes","sizes","axis","common","circle","radius","shape","lineJoin","lineCap","area","fillOpacity","_defaultAxis","lang","general","title","withTitle","coord","cartesian","scale","linear","cat","timeCat","geometry","prefix","oneData","partData","allData","legend","Global","version","scales","widthRatio","column","rose","multiplePie","setTheme","theme","_defineProperty","enumerable","configurable","writable","_extends","target","_inheritsLoose","subClass","superClass","create","_assertThisInitialized","ReferenceError","EVENT_AFTER_INIT","EVENT_BEFORE_RENDER","EVENT_AFTER_RENDER","EVENT_BEFORE_DATA_CHANGE","EVENT_AFTER_DATA_CHANGE","EVENT_AFTER_SIZE_CHANGE","EVENT_AFTER_GEOM_INIT","EVENT_BEFORE_GEOM_DRAW","EVENT_AFTER_GEOM_DRAW","EVENT_CLEAR","EVENT_CLEAR_INNER","EVENT_REPAINT","EventEmit","__events","_proto","on","events","emit","_this","forEach","off","Base","_Emit","getDefaultCfg","cfg","defaultCfg","_attrs","set","destroy","destroyed","Plot","_init","start","end","xMin","xMax","yMin","yMax","tl","tr","bl","br","reset","isInRange","Matrix","generateDefault","isChanged","multiply","m1","m2","m11","m12","m21","m22","dx","dy","out","rotate","radian","c","cos","s","sin","translate","transform","actions","action","Vector2","sqrt","normalize","add","v1","v2","sub","dot","direction","angle","theta","acos","angleTo","angleLargeThanPI","PI","zero","distance","clone","transformMat2d","defaultMatrix","Base$1","_initDefaultCfg","plot","init","_scale","s1","s2","matrix","center","convertPoint","_this$_convertPoint","_convertPoint","vector","invertPoint","_invertPoint","Cartesian","_Base","transposed","isRect","xDim","yDim","Rect","toScaleString","invert","AttributeBase","method","mixedCallback","defaultCallback","userCallback","_len","params","_key","ret","_getAttrValue","isCategory","percent","getLinearValue","steps","step","floor","leftPercent","rstValue","getNames","names","getFields","field","getScale","mapping","_len2","_key2","_toOriginParam","param","isLinear","Position","scaleX","scaleY","rstX","rstY","j","xLen","yLen","yVal","xVal","Shape","gradient","Size","getValue","arr2hex","toRGBValue","calColor","rgb","hex2arr","parseInt","colorCache","black","blue","grey","green","orange","pink","purple","red","white","yellow","toHex","color","hex","r","g","shift","split","Color","gradient$1","Attr","Shape$1","ShapeBase","_coord","draw","container","drawShape","setCoord","parsePoint","isPolar","parsePoints","ShapeFactoryBase","defaultShapeType","getShape","getShapePoints","fn","getPoints","getDefaultPoints","registerFactory","factoryName","className","geomObj","registerShape","shapeType","shapeObj","registShape","getShapeFactory","_mix$1","mix$1","mix_1","Adjust","adjustNames","processAdjust","generateScaleAria","join","getText","generateCoordAria","xScale","yScale","xLabel","yLabel","GROUP_ATTRS","FIELD_ORIGIN","FIELD_ORIGIN_Y","parseFields","Geom","styleOptions","generatePoints","attrOptions","sortable","startOnZero","visible","connectNulls","ignoreEmptyGroup","isInit","_initAttrs","_processData","_getGroupScales","attrName","attr","getAttr","attrScales","_groupData","colDefs","groupScales","_setAttrOptions","attrCfg","_createAttr","_createAttrOption","defaultValues","option","_createScale","hasAdjust","change","nice","createScale","groupedArray","getYScale","some","subData","tempData","_saveOrigin","_numberic","_adjustData","_sort","origin","positionAttr","count","adjust","adjustType","Error","getXScale","xField","yField","adjustObject","_updateStackRange","mergeArray","tmpMin","tmpMax","mappedArray","itemArr","sort","obj1","obj2","paint","shapeFactory","_beforeMapping","mappedData","_mapping","generateAria","mappedCache","record","mappedRecord","_getAttrValues","_name","getAttrValue","_generatePoints","isInCircle","getCallbackCfg","tmpCfg","getDrawCfg","opacity","style","nextPoints","_origin","shapeData","gShape","shapeAttr","createShapePointsCfg","nextData","aria","ariaLables","coordAriaLabel","_lang$geometry","groupScale","prefixLabel","firstObj","template","xValue","yValue","part","_normalizeValues","y0","getYMinValue","_getSnap","getSnapRecords","xfield","invertPointX","rangeMax","rangeMin","originValue","_isEqual","getRecords","position","animate","changeData","clearInner","clear","_display","show","hide","methodCache","getTickMethod","registerTickMethod","Scale","isContinuous","isIdentity","range","ticks","__cfg__","initCfg","getTicks","tick","idx","tickValue","formatter","res","getConfig","setDomain","calculateTicks","tickMethod","calcPercent","NaN","calcValue","extendStatics","d","setPrototypeOf","p","__extends","__","__spreadArrays","il","jl","Category","_super","order","scaledValue","domainRange","includes","token","twoDigitsOptional","twoDigits","threeDigits","fourDigits","word","literal","shorten","sLen","newArr","monthUpdate","arrName","i18n","lowerCaseArr","origObj","_a","args_1","dayNames","monthNames","monthNamesShort","dayNamesShort","defaultI18n","amPm","DoFn","dayOfMonth","globalI18n","setGlobalDateI18n","regexEscape","pad","String","formatFlags","D","dateObj","getDate","DD","Do","getDay","dd","ddd","dddd","M","getMonth","MM","MMM","MMMM","YY","getFullYear","YYYY","h","getHours","hh","H","HH","getMinutes","mm","getSeconds","ss","S","getMilliseconds","SS","SSS","A","ZZ","offset","getTimezoneOffset","abs","Z","monthParse","emptyDigits","emptyWord","timezoneOffset","parts","minutes","parseFlags","now","cent","globalMasks","default","shortDate","mediumDate","longDate","fullDate","isoDate","isoDateTime","shortTime","mediumTime","longTime","setGlobalDateMasks","masks","format","mask","literals","$0","$1","combinedI18nSettings","parse","dateStr","today","dateInfo","year","month","day","hour","minute","second","millisecond","isPm","parseInfo","newFormat","specifiedFields","requiredFields","info","regex","requiredField","matches","RegExp","parser","dateWithoutTZ","validateFields","UTC","fecha","fecha1","bisector","getter","_lo","_hi","lo","hi","mid","FORMAT_METHOD","timeFormat","time","toTimeStamp$1","SECOND","MINUTE","HOUR","DAY","MONTH","YEAR","intervals","getTickInterval","tickCount","interval","TimeCat","tickIndex","Continuous","getScalePercent","firstTick","lastTick","minLimit","maxLimit","getInvertPercent","Linear","calBase","E","pow","log","getLogPositiveMin","positiveMin","Log","appendPercent","Pow","exponent","factor","Time","numberValue","minConfig","maxConfig","timeStamps_1","min_1","Infinity","secondMin_1","max_1","timeStamp","TypeError","minTickInterval","Quantize","minIndex","minTick","nextTick","minIndexPercent","maxIndexPercent","unshift","Quantile","map$1","getClass","registerClass","cls","Identity","DEFAULT_Q","eps","Number","EPSILON","mod","n","simplicity","q","Q","lmin","lmax","lstep","simplicityMax","density","dmin","dmax","rt","densityMax","coverage","coverageMax","span","half","legibility","extended","onlyLoose","w","best","score","Q_1","sm","dm","delta","z","ceil","log10","cm","minStart","maxStart","isInteger","calculateCatTicks","tickInterval","ticks_1","valid","d3Linear","D3Linear","domain","DEFAULT_COUNT","e10","e5","e2","_domain","from","_b","i0","i1","stop","tickIncrement","d3ArrayTicks","reverse","power","LN10","error","snapMultiple","snapType","div","intervalTicks","maxTick","strictLimit","defaultMin","defaultMax","tickMin","tickMax","d3LinearTickMethod","calculateLogTicks","avg","pretty","h5","unit","nu","ns","calculatePowTicks","quantileSorted","sorted","linearPretty","calculateTimeTicks","ratio","calculateTimeCatTicks","lastValue","getYear","date","createYear","diffMonth","minYear","maxYear","minMonth","maxMonth","creatMonth","diffDay","diffHour","diffMinus","timePretty","yearInterval","monthInterval","mmMoth","dMonths","mday","ddays","hours","dHours","dMinus","minSecond","dSeconds","seconds","console","warn","CatTick","SNAP_COUNT_ARRAY","DEFAULT_COUNT$1","LinearTick","_ref","_ref2","getBestInterval","intervalCount","tickLength","fixedLength","getFixedLength","DECIMAL_LENGTH","getFactor","number","_ref3","avgInterval","calInterval","calMax","calMin","similarityIndex","similarityInterval","getInterval","startIndex","verify","intervalIsVerify","_ref4","num","indexOfExp","Linear$1","Identity$1","Category$1","TimeCat$1","Cat","isFullCircle","startAngle","endAngle","clearObj","ScaleController","defs","setFieldDef","updateScales","_getDef","def","_getDefaultType","_getScaleDef","values$1","_Array$getRange","isRounding","_adjustRange","_getScaleCfg","firstValue$1","_this$_getScaleCfg","newScale","_updateScale","_getScaleData","_this$_getScaleCfg2","adjustStartZero","Abastract","offsetFactor","frontContainer","backContainer","gridPoints","drawGrid","drawTicks","drawLine","drawLabels","tickCfg","getContainer","getOffsetPoint","getSidePoint","addShape","x1","y1","x2","y2","_id","labels","labelShape","_self$getSidePoint","getTextAlignInfo","gridCfg","subPoints","executedGrid","getAxisVector","getOffsetVector","axisVector","normal","verticalVector","offsetVector","align","baseLine","textAlign","textBaseline","isTop","Line","_Abstract","lineCfg","formatTicks","first","AxisController","axisCfg","frontPlot","backPlot","axes","_isHide","_getLinePosition","dimType","_getLineCfg","_getCircleCfg","circleRadius","_getRadiusCfg","_getAxisCfg","verticalScale","maxWidth","maxHeight","labelCfg","executedLabel","textStyle","axisLabel","context","_axisLabel$getBBox","getBBox","_createAxis","coordType","createAxis","yScales","_isAutoPadding","userPadding","legendRange","circleAxis","_axes$right","_maxWidth","_labelOffset","_axes$left","_maxWidth2","_labelOffset2","_axes$bottom","_maxHeight","_labelOffset3","_updateLayout","appendCfg","verticalTicks","verticalTick","calcDirection","xDistance","yDistance","calcDistance","point1","point2","getCenter","PRESS_DELAY","EventController","emitEvent","startTime","startPoints","startDistance","pressTimeout","setTimeout","eventType","emitStart","clearPressTimeout","currentDistance","zoom","deltaX","deltaY","getEventType","prevMoveTime","lastMoveTime","prevMovePoints","lastMovePoints","emitEnd","intervalTime","velocity","_start","delegateEvent","processEvent","canvasEl","_click","_move","_end","_cancel","panEventListeners","pan","enable","isProcess","_this2","clearTimeout","pinch","CanvasElement","_EventEmit","setAttribute","dispatchEvent","supportEventListener","support","Event","CanvasElement$1","_mod","_addStop","addColorStop","_parseLineGradient","_shape$getBBox","minX","minY","maxX","maxY","tanTheta","tan","tanTheta2","createLinearGradient","_parseRadialGradient","circleCfg","fx","fy","fr","_color","_shape$getBBox2","createRadialGradient","parseStyle","firstCode","ALIAS_ATTRS_MAP","SHAPE_ATTRS","CLIP_SHAPES","Element","_initProperties","zIndex","initAttrs","initTransform","isGroup","isShape","getDefaultAttrs","_setAttr","_setAttrClip","alias","_getAttr","clip","argumentsLen","bbox","_afterAttrsSet","getParent","setContext","drawInner","restoreContext","save","resetTransform","createPath","resetContext","restore","elAttrs","setLineDash","hasFill","fillStyle","hasStroke","strokeStyle","isVisible","getAriaLabel","_this$_attrs","_getAriaLabel","ariaLabel","_removeFromParent","parent","children","getMatrix","setMatrix","setTransform","rad","sx","sy","moveTo","cx","cy","mo","isDestroyed","Shape$2","_Element","originOpacity","globalAlpha","strokeOpacity","calculateBox","parseRadius","minWidth","minHeight","_Shape","canFill","canStroke","createRadiusPath","lineTo","arc","closePath","beginPath","rect","ImageShape","_Rect","loading","image","drawImage","Image","_image","crossOrigin","onload","swidth","sheight","Circle","extremity","getCubicBezierXYatT","startPt","controlPt1","controlPt2","endPt","T","CubicN","t2","t3","cubicBezierBounds","c1","c2","t","pt","getBBoxFromPoints","getBBoxFromLine","x0","getBBoxFromArc","anticlockwise","diff","getBBoxFromBezierGroup","Line$1","Polygon","getPoint","smoothBezier","smooth","isLoop","constraint","cps","prevPoint","nextPoint","hasConstraint","d0","d1","sum","cp0","cp1","catmullRom2bezier","pointList","controlPointList","cp2","_filterPoints","filteredPoints","Polyline","constaint","sps","sp","bezierCurveTo","newPoints","lastPoint","Arc","Sector","r0","unitX","unitY","outerBBox","innerBBox","Rect$1","calcRotatedBox","absRotate","textWidthCacheCounter","textWidthCache","TEXT_CACHE_MAX","Text","lineCount","fontStyle","fontWeight","fontVariant","lineHeight","textArr","_getFontStyle","_getTextHeight","spaceingY","_getSpaceingY","subY","subText","fillText","_subText","strokeText","_getTextWidth","rotatedBox","Custom","SYMBOLS","square","Marker","symbol","SHAPE_MAP","INDEX","getComparer","compare","Container","getGroupClass","getChildren","addGroup","groupClass","contain","child","drawChildren","items","descendants","_setEvn","_self$_attrs","_item$_attrs","childAriaLabels","_childAriaLabel","childAriaLabel","Group","box","leftTop","leftBottom","rightTop","rightBottom","requestAnimationFrame","Canvas","_initPixelRatio","_initCanvas","beforeDraw","clearRect","changeSize","eventController","canvasDOM","getPointByClient","_beginDraw","toDraw","_endDraw","setAriaLabel","engines","registerEngine","engine","getEngine","G","createCanvas","renderer","getClip","margin","isClip","isPointInPlot","Helper","_isScaleExist","compareScale","flag","scaleValues","compareScaleValues","Chart","initPlugins","_plugins","_cacheId","register","plugins","plugin","unregister","getAll","notify","hook","descriptors","ilen","descriptor","cache","rendered","geoms","filters","_syncYScales","syncY","syncScales","geom","_getFieldsForLegend","filteredData","legendFields","_adjustScale","scaleController","_removeGeoms","_clearGeoms","_clearInner","_initFilteredData","_changeGeomsData","_initGeom","middlePlot","_initGeoms","_initCoord","coordCfg","C","_initLayout","newPlot","_initLayers","_initEvents","_initScaleController","_clearScaleController","geomConstructor","methodName","addGeom","axisController","condition","render","_renderAxis","repaint","_interactions","interaction","getPosition","getYScales","getRecord","getLegendItems","legendItems","colorAttr","scaleValue","marker","dataValue","checked","registerPlugins","chartPlugins","_landscape","track","splitPoints","yItem","splitArray","SHAPES","Point","pointInfo","getPointsCfg","pointCfg","Point$1","_Geom","hasStack","Line$2","getStyle$1","drawLines","topPoints","bottomPoints","isStack","topShape","bottomShape","SHAPES$1","Path","splitArrayObj","splitedIndex","Line$3","_Path","equals","notEmpty","filterPoints","equalsCenter","eqls","drawRectShape","isSmooth","pointsLen","topSps","bottomSps","_n","_sp","drawShape$1","Area","SHAPES$2","Area$1","splitArrayfn","SizeMixin","initEvent","getDefaultSize","defaultSize","normalizeSize","getDimWidth","dimName","_getWidth","_toNormalizedSize","_toCoordSize","getNormalizedSize","getSize","getRectPoints","ymin","ymax","xmin","xmax","getRectRange","xValues","yValues","getMiddlePoint","Interval","_cfg$center","v0","rectCfg","polygonPoints","Interval$1","Polygon$1","Polygon$2","temp","xCount","yCount","xOffset","yOffset","_sortValue","getCandlePoints","Schema","Schema$1","toString$3","isType$1","isType_1","isArray$1","isArray_1","isNil$1","isNil_1","_inheritsLoose$1","Stack","_Adjust","processStack","stackCache","positive","negative","reverseOrder","xkey","_typeof","Symbol","iterator","isObject$1","isObject_1","each$1","each_1","_inheritsLoose$2","MARGIN_RATIO","DODGE_RATIO","Dodge","marginRatio","dodgeRatio","getDodgeOffset","pre","next","dodgeValue","isFunction$1","isFunction_1","maxBy","maxData","maxBy_1","merge$1","merge_1","_inheritsLoose$3","ArrayUtil","Symmetric","cacheMax","groupFields","_getMax","dim","mergeData","maxRecord","maxValue","_getXValuesMax","_processSymmetric","valueMax","subVal","Polar","inner","innerRadius","maxRadius","startV","pointV","percentX","percentY","Circle$1","_getCirclePoint","KEYWORDS_PERCENT","median","GuideBase","_getNormalizedValue","parsePercentPoint","xPercent","yPercent","limitInPlot","element","changeVisible","display","Arc$1","_GuideBase","coordCenter","atan2","getOffsetFromAlign","alignX","alignY","modifyCSS","DOM","CSS","createDom","innerHTML","childNodes","Html","offsetX","offsetY","html","myNode","visibility","parentNode","wrapperNode","appendChild","canvasOffsetTop","offsetTop","canvasOffsetLeft","offsetLeft","newOffset","removeChild","Line$4","Rect$2","Text$1","content","Tag","direct","autoAdjust","side","background","withPoint","pointStyle","_getDirect","tagWidth","tagHeight","clientWidth","clientHeight","vertical","horizontal","wrapperContainer","pointShape","tagContainer","tagText","textBBox","tagBg","arrowPoints","sideShape","Point$2","MARKER_RADIUS","List","showTitle","titleGap","itemGap","itemMarginBottom","itemFormatter","itemWidth","wordSpace","layout","joinString","_renderTitle","_renderItems","wrapper","itemsGroup","titleShape","titleHeight","titleStyle","_titleHeight","reversed","_addItem","_adjustItems","_renderBackground","_wrapper$getBBox","backShape","itemGroup","unCheckStyle","unCheckColor","nameStyle","valueStyle","startX","markerAttrs","markerShape","nameText","_formatItemValue","valueX","_getMaxItemWidth","maxItemWidth","_children$i$getBBox","_width","maxLength","twoAvgWidth","threeAvgWidth","_adjustHorizontal","rowWidth","legendHitBoxes","childHeight","childWidth","_adjustVertical","colHeight","totalWidth","setItems","clearItems","setTitle","TextBox","updateContent","updatePosition","backgroundShape","textShape","_getBBox","_this$_getBBox","tipWidth","tipHeight","_height","_this$_getBBox2","GAP","Tooltip","showCrosshairs","crosshairsStyle","crosshairsType","showXTip","showYTip","xTip","xTipBackground","xTipTextStyle","yTip","yTipBackground","yTipTextStyle","custom","fixed","tooltipArrow","xTipBox","yTipBox","_renderCrosshairs","setContent","setYTipContent","setYTipPosition","pos","plotRange","crosshairsShapeX","yTipHeight","yTipWidth","posX","posY","setXTipContent","setXTipPosition","crosshairsShapeY","canvasHeight","xTipWidth","xTipHeight","setXCrosshairPosition","setYCrosshairPosition","setPosition","containerBBox","_x","arrowY","setMarkers","_cfg","markerGroup","_getMarkerGroup","clearMarkers","tooltip","triggerOn","triggerOff","alwaysShow","showTooltipMarker","showItemMarker","itemMarkerStyle","snap","_getTooltipValueScale","colorScale","getTooltipName","nameScale","valueScale","getTooltipValue","getTooltipTitle","_indexOfArray","_uniqItems","isEqual$1","arr1","arr2","JSON","stringify","TooltipController","_tooltipCfg","hideTooltip","lastTimeStamp","showTooltip","_chart","_setCrosshairsCfg","_getMaxLength","tooltipCfg","prePoint","bindEvents","unBindEvents","_lastActive","_getTooltipMarkerStyle","_cfg2","_chart$get","firstItem","lastItem","intervalWidth","tooltipMarkerStyle","_setTooltip","tooltipMarkerCfg","lastActive","tip","onShow","onChange","xTipPosX","yTipPosY","markerItems","tooltipMarkerType","tooltipMarkerItems","records","tooltipItem","onHide","_handleEvent","aMethod","handleShowEvent","handleHideEvent","tooltipController","afterGeomDraw","Tooltip$1","guide","tag","GuideController","guides","guideShapes","_toString","_getId","_createGuide","ClassName","regionFilter","init$1","guideController","afterGeomDraw$1","Guide","LEGEND_GAP","MARKER_SIZE","DEFAULT_CFG","selectedMode","getPaddingByPos","LegendController","findItem","legends","legendPosX","legendPosY","clickedItem","clickedLegend","_createEvent","clicked","clickable","onClick","filteredVals","isSingeSelected","legendCfg","addLegend","fieldCfg","addCustomLegend","_addCategoryLegend","_isFiltered","lastCfg","_alignLegend","_self$plotRange","chartWidth","chartHeight","legendHeight","legendWidth","verticalAlign","preWidth","alignLegends","handleEvent","init$2","legendController","beforeGeomDraw","afterGeomDraw$2","clearInner$1","Legend","clock","performance","Timeline","anims","playing","play","update","pushAnim","animInfo","delay","duration","endTime","currentTime","propertyAnim","hasEnded","startState","endState","interpolate","hasStarted","onStart","easing","onFrame","newValue","aLen","onUpdate","onEnd","linear$1","quadraticIn","quadraticOut","quadraticInOut","cubicIn","cubicOut","cubicInOut","elasticIn","asin","elasticOut","elasticInOut","backIn","backOut","backInOut","bounceIn","bounceOut","bounceInOut","Easing","plainArray","interpolateNumber","interpolateArray","nb","na","Animator","timeline","to","startValue","endValue","frame","defaultAnimationCfg","appear","enter","leave","Animate","Action","getAnimation","geomType","animationType","geomAnimateCfg","animation","getAnimateCfg","geomConfig","registerAnimation","animationName","animationFun","_extends2","getCoordInfo","getScaledMatrix","scaledMatrix","_matrix","_matrix2","getAnimateParam","animateCfg","doAnimation","_getAnimateParam","anim","fadeIn","ShapeAction","_groupScaleIn","zeroY","_getCoordInfo","endMatrix","_shapeScale","groupScaleInX","groupScaleInY","groupScaleInXY","shapesScaleInX","shapesScaleInY","shapesScaleInXY","groupWaveIn","isTransposed","GroupAction","path","GROUP_ANIMATION","schema","fromAttrs","toAttrs","_getShapeId","dataObj","geomIdx","getShapes","geomContainer","geomShapes","_getAnimateCfgByShapeType","getAnimate","addAnimate","updateShapes","newShapes","deletedShape","tempShape","updateShape","cacheAttrs","newShape","lastShape","afterCanvasInit","beforeCanvasDraw","isUpdate","caches","cacheShapes","axisShapes","componentShapes","geomCfg","appearCfg","_animate","afterCanvasDestroyed","detail","Animation","_Interactions","registerInteraction","getInteraction","interactions","interact","clearInteraction","isValuesEqual","newValues","lastIndex","defaultRange","Context","getPinchScale","minScale","minCount","updateRange","updateTicks","_initEvent","_afterinit","_afterdatachange","getFollowScale","startRange","lastTickCount","doZoom","leftScale","rightScale","zoomOffset","rangeLen","rangeOffset","leftOffset","rightOffset","newStart","newEnd","newRange","doMove","valueStart","valueEnd","currentValues","updateScale","updateFollowScale","pinchScale","pinchValues","followScale","pinchField","pinchScaleType","followField","pinchValueMap","_getRange","newTickCount","catTicks","Base$2","getInteractionContext","interactionContext","preStart","preProcess","process","onProcess","preEnd","preReset","onReset","_bindEvents","startEvent","endEvent","resetEvent","_process","_reset","_clearEvents","Pan","preventDefault","coordWidth","Pinch","_assertThisInitialize","leftLen","rightLen","Component"],"mappings":"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","sourcesContent":["(function (global, factory) {\n    typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports) :\n    typeof define === 'function' && define.amd ? define(['exports'], factory) :\n    (global = typeof globalThis !== 'undefined' ? globalThis : global || self, factory(global.F2 = {}));\n}(this, (function (exports) { 'use strict';\n\n    var isArrayLike = function (value) {\n      /**\n       * isArrayLike([1, 2, 3]) => true\n       * isArrayLike(document.body.children) => true\n       * isArrayLike('abc') => true\n       * isArrayLike(Function) => false\n       */\n      return value !== null && typeof value !== 'function' && isFinite(value.length);\n    };\n\n    var contains = function (arr, value) {\n      if (!isArrayLike(arr)) {\n        return false;\n      }\n\n      return arr.indexOf(value) > -1;\n    };\n\n    var filter = function (arr, func) {\n      if (!isArrayLike(arr)) {\n        return arr;\n      }\n\n      var result = [];\n\n      for (var index = 0; index < arr.length; index++) {\n        var value = arr[index];\n\n        if (func(value, index)) {\n          result.push(value);\n        }\n      }\n\n      return result;\n    };\n\n    var toString = {}.toString;\n\n    var isType = function (value, type) {\n      return toString.call(value) === '[object ' + type + ']';\n    };\n\n    /**\n     * 是否为函数\n     * @param  {*} fn 对象\n     * @return {Boolean}  是否函数\n     */\n    var isFunction = (function (value) {\n      return isType(value, 'Function');\n    });\n\n    // isFinite,\n    var isNil = function (value) {\n      /**\n       * isNil(null) => true\n       * isNil() => true\n       */\n      return value === null || value === undefined;\n    };\n\n    var isArray = (function (value) {\n      return Array.isArray ? Array.isArray(value) : isType(value, 'Array');\n    });\n\n    var isObject = (function (value) {\n      /**\n       * isObject({}) => true\n       * isObject([1, 2, 3]) => true\n       * isObject(Function) => true\n       * isObject(null) => false\n       */\n      var type = typeof value;\n      return value !== null && type === 'object' || type === 'function';\n    });\n\n    function each(elements, func) {\n      if (!elements) {\n        return;\n      }\n\n      var rst;\n\n      if (isArray(elements)) {\n        for (var i = 0, len = elements.length; i < len; i++) {\n          rst = func(elements[i], i);\n\n          if (rst === false) {\n            break;\n          }\n        }\n      } else if (isObject(elements)) {\n        for (var k in elements) {\n          if (elements.hasOwnProperty(k)) {\n            rst = func(elements[k], k);\n\n            if (rst === false) {\n              break;\n            }\n          }\n        }\n      }\n    }\n\n    var keys = Object.keys ? function (obj) {\n      return Object.keys(obj);\n    } : function (obj) {\n      var result = [];\n      each(obj, function (value, key) {\n        if (!(isFunction(obj) && key === 'prototype')) {\n          result.push(key);\n        }\n      });\n      return result;\n    };\n\n    function isMatch(obj, attrs) {\n      var _keys = keys(attrs);\n\n      var length = _keys.length;\n      if (isNil(obj)) return !length;\n\n      for (var i = 0; i < length; i += 1) {\n        var key = _keys[i];\n\n        if (attrs[key] !== obj[key] || !(key in obj)) {\n          return false;\n        }\n      }\n\n      return true;\n    }\n\n    var isObjectLike = function (value) {\n      /**\n       * isObjectLike({}) => true\n       * isObjectLike([1, 2, 3]) => true\n       * isObjectLike(Function) => false\n       * isObjectLike(null) => false\n       */\n      return typeof value === 'object' && value !== null;\n    };\n\n    var isPlainObject = function (value) {\n      /**\n       * isObjectLike(new Foo) => false\n       * isObjectLike([1, 2, 3]) => false\n       * isObjectLike({ x: 0, y: 0 }) => true\n       * isObjectLike(Object.create(null)) => true\n       */\n      if (!isObjectLike(value) || !isType(value, 'Object')) {\n        return false;\n      }\n\n      if (Object.getPrototypeOf(value) === null) {\n        return true;\n      }\n\n      var proto = value;\n\n      while (Object.getPrototypeOf(proto) !== null) {\n        proto = Object.getPrototypeOf(proto);\n      }\n\n      return Object.getPrototypeOf(value) === proto;\n    };\n\n    function find(arr, predicate) {\n      if (!isArray(arr)) return null;\n\n      var _predicate;\n\n      if (isFunction(predicate)) {\n        _predicate = predicate;\n      }\n\n      if (isPlainObject(predicate)) {\n        _predicate = function (a) {\n          return isMatch(a, predicate);\n        };\n      }\n\n      if (_predicate) {\n        for (var i = 0; i < arr.length; i += 1) {\n          if (_predicate(arr[i])) {\n            return arr[i];\n          }\n        }\n      }\n\n      return null;\n    }\n\n    var getRange = function (values) {\n      // 存在 NaN 时，min,max 判定会出问题\n      var filterValues = values.filter(function (v) {\n        return !isNaN(v);\n      });\n\n      if (!filterValues.length) {\n        // 如果没有数值则直接返回0\n        return {\n          min: 0,\n          max: 0\n        };\n      }\n\n      if (isArray(values[0])) {\n        var tmp = [];\n\n        for (var i = 0; i < values.length; i++) {\n          tmp = tmp.concat(values[i]);\n        }\n\n        filterValues = tmp;\n      }\n\n      var max = Math.max.apply(null, filterValues);\n      var min = Math.min.apply(null, filterValues);\n      return {\n        min: min,\n        max: max\n      };\n    };\n\n    var isString = (function (str) {\n      return isType(str, 'String');\n    });\n\n    var uniq = function (arr) {\n      var resultArr = [];\n      each(arr, function (item) {\n        if (!contains(resultArr, item)) {\n          resultArr.push(item);\n        }\n      });\n      return resultArr;\n    };\n\n    function head(o) {\n      if (isArrayLike(o)) {\n        return o[0];\n      }\n\n      return undefined;\n    }\n\n    function last(o) {\n      if (isArrayLike(o)) {\n        var arr = o;\n        return arr[arr.length - 1];\n      }\n\n      return undefined;\n    }\n\n    var fixedBase = function (v, base) {\n      var str = base.toString();\n      var index = str.indexOf('.');\n\n      if (index === -1) {\n        return Math.round(v);\n      }\n\n      var length = str.substr(index + 1).length;\n\n      if (length > 20) {\n        length = 20;\n      }\n\n      return parseFloat(v.toFixed(length));\n    };\n\n    /**\n     * 判断是否数字\n     * @return {Boolean} 是否数字\n     */\n\n    var isNumber = function (value) {\n      return isType(value, 'Number');\n    };\n\n    var toString$1 = (function (value) {\n      if (isNil(value)) return '';\n      return value.toString();\n    });\n\n    var lowerFirst = function (value) {\n      var str = toString$1(value);\n      return str.charAt(0).toLowerCase() + str.substring(1);\n    };\n\n    function substitute(str, o) {\n      if (!str || !o) {\n        return str;\n      }\n\n      return str.replace(/\\\\?\\{([^{}]+)\\}/g, function (match, name) {\n        if (match.charAt(0) === '\\\\') {\n          return match.slice(1);\n        }\n\n        return o[name] === undefined ? '' : o[name];\n      });\n    }\n\n    var upperFirst = function (value) {\n      var str = toString$1(value);\n      return str.charAt(0).toUpperCase() + str.substring(1);\n    };\n\n    var toString$2 = {}.toString;\n\n    var getType = function (value) {\n      return toString$2.call(value).replace(/^\\[object /, '').replace(/]$/, '');\n    };\n\n    /**\n     * 是否是布尔类型\n     *\n     * @param {Object} value 测试的值\n     * @return {Boolean}\n     */\n\n    var isBoolean = function (value) {\n      return isType(value, 'Boolean');\n    };\n\n    var isDate = function (value) {\n      return isType(value, 'Date');\n    };\n\n    var objectProto = Object.prototype;\n\n    var isPrototype = function (value) {\n      var Ctor = value && value.constructor;\n      var proto = typeof Ctor === 'function' && Ctor.prototype || objectProto;\n      return value === proto;\n    };\n\n    // FIXME: Mutable param should be forbidden in static lang.\n    function _mix(dist, obj) {\n      for (var key in obj) {\n        if (obj.hasOwnProperty(key) && key !== 'constructor' && obj[key] !== undefined) {\n          dist[key] = obj[key];\n        }\n      }\n    }\n\n    function mix(dist, src1, src2, src3) {\n      if (src1) _mix(dist, src1);\n      if (src2) _mix(dist, src2);\n      if (src3) _mix(dist, src3);\n      return dist;\n    }\n\n    var MAX_MIX_LEVEL = 5;\n\n    function _deepMix(dist, src, level, maxLevel) {\n      level = level || 0;\n      maxLevel = maxLevel || MAX_MIX_LEVEL;\n\n      for (var key in src) {\n        if (src.hasOwnProperty(key)) {\n          var value = src[key];\n\n          if (value !== null && isPlainObject(value)) {\n            if (!isPlainObject(dist[key])) {\n              dist[key] = {};\n            }\n\n            if (level < maxLevel) {\n              _deepMix(dist[key], value, level + 1, maxLevel);\n            } else {\n              dist[key] = src[key];\n            }\n          } else if (isArray(value)) {\n            dist[key] = [];\n            dist[key] = dist[key].concat(value);\n          } else if (value !== undefined) {\n            dist[key] = value;\n          }\n        }\n      }\n    } // todo 重写\n\n\n    var deepMix = function (rst) {\n      var args = [];\n\n      for (var _i = 1; _i < arguments.length; _i++) {\n        args[_i - 1] = arguments[_i];\n      }\n\n      for (var i = 0; i < args.length; i += 1) {\n        _deepMix(rst, args[i]);\n      }\n\n      return rst;\n    };\n\n    var indexOf = function (arr, obj) {\n      if (!isArrayLike(arr)) {\n        return -1;\n      }\n\n      var m = Array.prototype.indexOf;\n\n      if (m) {\n        return m.call(arr, obj);\n      }\n\n      var index = -1;\n\n      for (var i = 0; i < arr.length; i++) {\n        if (arr[i] === obj) {\n          index = i;\n          break;\n        }\n      }\n\n      return index;\n    };\n\n    var hasOwnProperty = Object.prototype.hasOwnProperty;\n\n    function isEmpty(value) {\n      /**\n       * isEmpty(null) => true\n       * isEmpty() => true\n       * isEmpty(true) => true\n       * isEmpty(1) => true\n       * isEmpty([1, 2, 3]) => false\n       * isEmpty('abc') => false\n       * isEmpty({ a: 1 }) => false\n       */\n      if (isNil(value)) {\n        return true;\n      }\n\n      if (isArrayLike(value)) {\n        return !value.length;\n      }\n\n      var type = getType(value);\n\n      if (type === 'Map' || type === 'Set') {\n        return !value.size;\n      }\n\n      if (isPrototype(value)) {\n        return !Object.keys(value).length;\n      }\n\n      for (var key in value) {\n        if (hasOwnProperty.call(value, key)) {\n          return false;\n        }\n      }\n\n      return true;\n    }\n\n    var isEqual = function (value, other) {\n      if (value === other) {\n        return true;\n      }\n\n      if (!value || !other) {\n        return false;\n      }\n\n      if (isString(value) || isString(other)) {\n        return false;\n      }\n\n      if (isArrayLike(value) || isArrayLike(other)) {\n        if (value.length !== other.length) {\n          return false;\n        }\n\n        var rst = true;\n\n        for (var i = 0; i < value.length; i++) {\n          rst = isEqual(value[i], other[i]);\n\n          if (!rst) {\n            break;\n          }\n        }\n\n        return rst;\n      }\n\n      if (isObjectLike(value) || isObjectLike(other)) {\n        var valueKeys = Object.keys(value);\n        var otherKeys = Object.keys(other);\n\n        if (valueKeys.length !== otherKeys.length) {\n          return false;\n        }\n\n        var rst = true;\n\n        for (var i = 0; i < valueKeys.length; i++) {\n          rst = isEqual(value[valueKeys[i]], other[valueKeys[i]]);\n\n          if (!rst) {\n            break;\n          }\n        }\n\n        return rst;\n      }\n\n      return false;\n    };\n\n    var map = function (arr, func) {\n      if (!isArrayLike(arr)) {\n        // @ts-ignore\n        return arr;\n      }\n\n      var result = [];\n\n      for (var index = 0; index < arr.length; index++) {\n        var value = arr[index];\n        result.push(func(value, index));\n      }\n\n      return result;\n    };\n\n    function size(o) {\n      if (isNil(o)) {\n        return 0;\n      }\n\n      if (isArrayLike(o)) {\n        return o.length;\n      }\n\n      return Object.keys(o).length;\n    }\n\n    function merge(dataArray) {\n      var rst = [];\n\n      for (var i = 0, len = dataArray.length; i < len; i++) {\n        rst = rst.concat(dataArray[i]);\n      }\n\n      return rst;\n    }\n\n    function values(data, name) {\n      var rst = [];\n      var tmpMap = {};\n\n      for (var i = 0, len = data.length; i < len; i++) {\n        var obj = data[i];\n        var value = obj[name];\n\n        if (!isNil(value)) {\n          if (!isArray(value)) {\n            if (!tmpMap[value]) {\n              rst.push(value);\n              tmpMap[value] = true;\n            }\n          } else {\n            each(value, function (val) {\n              if (!tmpMap[val]) {\n                rst.push(val);\n                tmpMap[val] = true;\n              }\n            });\n          }\n        }\n      }\n\n      return rst;\n    }\n\n    function firstValue(data, name) {\n      var rst = null;\n\n      for (var i = 0, len = data.length; i < len; i++) {\n        var obj = data[i];\n        var value = obj[name];\n\n        if (!isNil(value)) {\n          if (isArray(value)) {\n            rst = value[0];\n          } else {\n            rst = value;\n          }\n\n          break;\n        }\n      }\n\n      return rst;\n    }\n\n    function groupToMap(data, fields) {\n      if (!fields) {\n        return {\n          0: data\n        };\n      }\n\n      var callback = function callback(row) {\n        var unique = '_';\n\n        for (var i = 0, l = fields.length; i < l; i++) {\n          unique += row[fields[i]] && row[fields[i]].toString();\n        }\n\n        return unique;\n      };\n\n      var groups = {};\n\n      for (var i = 0, len = data.length; i < len; i++) {\n        var row = data[i];\n        var key = callback(row);\n\n        if (groups[key]) {\n          groups[key].push(row);\n        } else {\n          groups[key] = [row];\n        }\n      }\n\n      return groups;\n    }\n\n    function group(data, fields, appendConditions) {\n      if (appendConditions === void 0) {\n        appendConditions = {};\n      }\n\n      if (!fields) {\n        return [data];\n      }\n\n      var groups = groupToMap(data, fields);\n      var array = [];\n\n      if (fields.length === 1 && appendConditions[fields[0]]) {\n        var _values = appendConditions[fields[0]];\n        each(_values, function (value) {\n          value = '_' + value;\n          array.push(groups[value]);\n        });\n      } else {\n        for (var i in groups) {\n          array.push(groups[i]);\n        }\n      }\n\n      return array;\n    }\n\n    function remove(arr, obj) {\n      if (!arr) {\n        return;\n      }\n\n      var index = arr.indexOf(obj);\n\n      if (index !== -1) {\n        arr.splice(index, 1);\n      }\n    }\n\n    function getRange$1(values) {\n      if (!values.length) {\n        return {\n          min: 0,\n          max: 0\n        };\n      }\n\n      var max = Math.max.apply(null, values);\n      var min = Math.min.apply(null, values);\n      return {\n        min: min,\n        max: max\n      };\n    }\n\n    var array = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        merge: merge,\n        values: values,\n        firstValue: firstValue,\n        group: group,\n        groupToMap: groupToMap,\n        remove: remove,\n        getRange: getRange$1\n    });\n\n    /**\n     * Detects support for options object argument in addEventListener.\n     * https://developer.mozilla.org/en-US/docs/Web/API/EventTarget/addEventListener#Safely_detecting_option_support\n     * @private\n     */\n\n    var supportsEventListenerOptions = function () {\n      var supports = false;\n\n      try {\n        var options = Object.defineProperty({}, 'passive', {\n          get: function get() {\n            supports = true;\n          }\n        });\n        window.addEventListener('e', null, options);\n      } catch (e) {// continue regardless of error\n      }\n\n      return supports;\n    }(); // Default passive to true as expected by Chrome for 'touchstart' and 'touchend' events.\n    // https://github.com/chartjs/Chart.js/issues/4287\n\n\n    var eventListenerOptions = supportsEventListenerOptions ? {\n      passive: true\n    } : false;\n    /* global wx, my */\n    // weixin miniprogram\n\n    var isWx = typeof wx === 'object' && typeof wx.getSystemInfoSync === 'function'; // ant miniprogram\n\n    var isMy = typeof my === 'object' && typeof my.getSystemInfoSync === 'function'; // in node\n\n    var isNode = typeof global && !typeof window; // in browser\n\n    var isBrowser = typeof window !== 'undefined' && typeof window.document !== 'undefined' && typeof window.sessionStorage !== 'undefined';\n\n    function isCanvasElement(el) {\n      if (!el || typeof el !== 'object') return false;\n\n      if (el.nodeType === 1 && el.nodeName) {\n        // HTMLCanvasElement\n        return true;\n      } // CanvasElement\n\n\n      return !!el.isCanvasElement;\n    }\n\n    function getPixelRatio() {\n      return window && window.devicePixelRatio || 1;\n    }\n\n    function getStyle(el, property) {\n      return el.currentStyle ? el.currentStyle[property] : document.defaultView.getComputedStyle(el, null).getPropertyValue(property);\n    }\n\n    function getWidth(el) {\n      var width = getStyle(el, 'width');\n\n      if (width === 'auto') {\n        width = el.offsetWidth;\n      }\n\n      return parseFloat(width);\n    }\n\n    function getHeight(el) {\n      var height = getStyle(el, 'height');\n\n      if (height === 'auto') {\n        height = el.offsetHeight;\n      }\n\n      return parseFloat(height);\n    }\n\n    function getDomById(id) {\n      if (!id) {\n        return null;\n      }\n\n      return document.getElementById(id);\n    }\n\n    function getRelativePosition(point, canvas) {\n      var canvasDom = canvas.get('el');\n      if (!canvasDom) return point;\n\n      var _canvasDom$getBoundin = canvasDom.getBoundingClientRect(),\n          top = _canvasDom$getBoundin.top,\n          left = _canvasDom$getBoundin.left;\n\n      var paddingLeft = parseFloat(getStyle(canvasDom, 'padding-left'));\n      var paddingTop = parseFloat(getStyle(canvasDom, 'padding-top'));\n      var mouseX = point.x - left - paddingLeft;\n      var mouseY = point.y - top - paddingTop;\n      return {\n        x: mouseX,\n        y: mouseY\n      };\n    }\n\n    function addEventListener(source, type, listener) {\n      source.addEventListener(type, listener, eventListenerOptions);\n    }\n\n    function removeEventListener(source, type, listener) {\n      source.removeEventListener(type, listener, eventListenerOptions);\n    }\n\n    function landscapePoint(point, canvas) {\n      var landscape = canvas.get('landscape');\n\n      if (!landscape) {\n        return point;\n      }\n\n      if (isFunction(landscape)) {\n        return landscape(point, canvas);\n      } // 默认顺时针旋转90度\n\n\n      var height = canvas.get('height');\n      var x = point.y;\n      var y = height - point.x;\n      return {\n        x: x,\n        y: y\n      };\n    }\n\n    function convertPoints(ev, canvas) {\n      var touches = ev.touches; // 认为是mouse事件\n\n      if (!touches) {\n        var point = getRelativePosition({\n          x: ev.clientX,\n          y: ev.clientY\n        }, canvas);\n        return [landscapePoint(point, canvas)];\n      } // 单指 touchend 后，touchs 会变空，最后的触点要从changedTouches里拿\n\n\n      if (!touches.length) {\n        // 为了防止万一，加个空逻辑\n        touches = ev.changedTouches || [];\n      }\n\n      var points = [];\n\n      for (var i = 0, len = touches.length; i < len; i++) {\n        var touch = touches[i]; // x, y: 相对canvas原点的位置，clientX, clientY 相对于可视窗口的位置\n\n        var x = touch.x,\n            y = touch.y,\n            clientX = touch.clientX,\n            clientY = touch.clientY;\n\n        var _point = void 0; // 小程序环境会有x,y\n\n\n        if (isNumber(x) || isNumber(y)) {\n          _point = {\n            x: x,\n            y: y\n          };\n        } else {\n          // 浏览器环境再计算下canvas的相对位置\n          _point = getRelativePosition({\n            x: clientX,\n            y: clientY\n          }, canvas);\n        }\n\n        points.push(landscapePoint(_point, canvas));\n      }\n\n      return points;\n    }\n\n    function createEvent(event, chart) {\n      var canvas = chart.get('canvas');\n      var points = convertPoints(event, canvas); // touchend会没有points\n\n      var point = points[0] || {};\n      return {\n        type: event.type,\n        chart: chart,\n        \"native\": event,\n        x: point.x,\n        y: point.y\n      };\n    }\n\n    function measureText(text, font, ctx) {\n      if (!ctx) {\n        ctx = document.createElement('canvas').getContext('2d');\n      }\n\n      ctx.font = font || '12px sans-serif';\n      return ctx.measureText(text);\n    }\n\n    /**\n     * @fileOverview Utility for F2\n     * @author dxq613 @gmail.com\n     * @author sima.zhang1990@gmail.com\n     */\n\n    function isObjectValueEqual(a, b) {\n      // for vue.js\n      a = Object.assign({}, a);\n      b = Object.assign({}, b);\n      var aProps = Object.getOwnPropertyNames(a);\n      var bProps = Object.getOwnPropertyNames(b);\n\n      if (aProps.length !== bProps.length) {\n        return false;\n      }\n\n      for (var i = 0, len = aProps.length; i < len; i++) {\n        var propName = aProps[i];\n\n        if (a[propName] !== b[propName]) {\n          return false;\n        }\n      }\n\n      return true;\n    }\n\n    function parsePadding(padding) {\n      var top;\n      var right;\n      var bottom;\n      var left;\n\n      if (isNumber(padding) || isString(padding)) {\n        top = bottom = left = right = padding;\n      } else if (isArray(padding)) {\n        top = padding[0];\n        right = !isNil(padding[1]) ? padding[1] : padding[0];\n        bottom = !isNil(padding[2]) ? padding[2] : padding[0];\n        left = !isNil(padding[3]) ? padding[3] : right;\n      }\n\n      return [top, right, bottom, left];\n    }\n\n    function directionEnabled(mode, dir) {\n      if (mode === undefined) {\n        return true;\n      } else if (typeof mode === 'string') {\n        return mode.indexOf(dir) !== -1;\n      }\n\n      return false;\n    }\n\n    function toTimeStamp(value) {\n      if (isString(value)) {\n        if (value.indexOf('T') > 0) {\n          value = new Date(value).getTime();\n        } else {\n          // new Date('2010/01/10') 和 new Date('2010-01-10') 的差别在于:\n          // 如果仅有年月日时，前者是带有时区的: Fri Jan 10 2020 02:40:13 GMT+0800 (中国标准时间)\n          // 后者会格式化成 Sun Jan 10 2010 08:00:00 GMT+0800 (中国标准时间)\n          value = new Date(value.replace(/-/gi, '/')).getTime();\n        }\n      }\n\n      if (isDate(value)) {\n        value = value.getTime();\n      }\n\n      return value;\n    }\n\n    var Util = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        Array: array,\n        upperFirst: upperFirst,\n        lowerFirst: lowerFirst,\n        isString: isString,\n        isNumber: isNumber,\n        isBoolean: isBoolean,\n        isFunction: isFunction,\n        isDate: isDate,\n        isArray: isArray,\n        isNil: isNil,\n        isObject: isObject,\n        isPlainObject: isPlainObject,\n        isEqual: isEqual,\n        deepMix: deepMix,\n        mix: mix,\n        each: each,\n        uniq: uniq,\n        find: find,\n        isObjectValueEqual: isObjectValueEqual,\n        parsePadding: parsePadding,\n        directionEnabled: directionEnabled,\n        toTimeStamp: toTimeStamp,\n        substitute: substitute,\n        isWx: isWx,\n        isMy: isMy,\n        isNode: isNode,\n        isBrowser: isBrowser,\n        isCanvasElement: isCanvasElement,\n        getPixelRatio: getPixelRatio,\n        getStyle: getStyle,\n        getWidth: getWidth,\n        getHeight: getHeight,\n        getDomById: getDomById,\n        getRelativePosition: getRelativePosition,\n        addEventListener: addEventListener,\n        removeEventListener: removeEventListener,\n        createEvent: createEvent,\n        convertPoints: convertPoints,\n        measureText: measureText\n    });\n\n    /**\n     * @fileOverview default theme\n     * @author dxq613@gail.com\n     */\n    var color1 = '#E8E8E8'; // color of axis-line and axis-grid\n\n    var color2 = '#808080'; // color of axis label\n\n    var defaultAxis = {\n      label: {\n        fill: color2,\n        fontSize: 10\n      },\n      line: {\n        stroke: color1,\n        lineWidth: 1\n      },\n      grid: {\n        type: 'line',\n        stroke: color1,\n        lineWidth: 1,\n        lineDash: [2]\n      },\n      tickLine: null,\n      labelOffset: 7.5\n    };\n    var Theme = {\n      fontFamily: '\"Helvetica Neue\", \"San Francisco\", Helvetica, Tahoma, Arial, \"PingFang SC\", \"Hiragino Sans GB\", \"Heiti SC\", \"Microsoft YaHei\", sans-serif',\n      defaultColor: '#1890FF',\n      pixelRatio: 1,\n      padding: 'auto',\n      appendPadding: 15,\n      colors: ['#1890FF', '#2FC25B', '#FACC14', '#223273', '#8543E0', '#13C2C2', '#3436C7', '#F04864'],\n      shapes: {\n        line: ['line', 'dash'],\n        point: ['circle', 'hollowCircle']\n      },\n      sizes: [4, 10],\n      axis: {\n        common: defaultAxis,\n        // common axis configuration\n        bottom: mix({}, defaultAxis, {\n          grid: null\n        }),\n        left: mix({}, defaultAxis, {\n          line: null\n        }),\n        right: mix({}, defaultAxis, {\n          line: null\n        }),\n        circle: mix({}, defaultAxis, {\n          line: null\n        }),\n        radius: mix({}, defaultAxis, {\n          labelOffset: 4\n        })\n      },\n      shape: {\n        line: {\n          lineWidth: 2,\n          lineJoin: 'round',\n          lineCap: 'round'\n        },\n        point: {\n          lineWidth: 0,\n          size: 3\n        },\n        area: {\n          fillOpacity: 0.1\n        }\n      },\n      _defaultAxis: defaultAxis\n    };\n\n    var lang = {\n      general: {\n        title: '这是一个图表，',\n        withTitle: '这是一个关于“{title}”的图表。'\n      },\n      coord: {\n        cartesian: 'X轴是{xLabel}Y轴是{yLabel}' // polar: '弧度是{xLabel}半径是{yLabel}'\n\n      },\n      scale: {\n        linear: '数值型，数据最小值为{min}，最大值为{max}；',\n        cat: '分类型, 分类类型有：{values}；',\n        timeCat: '时间型，时间范围从{start}到{end}；'\n      },\n      geometry: {\n        prefix: '共有{count}种分类组成，',\n        oneData: '第{index}类是{name}，数据是{values};',\n        partData: '第{index}类是{name}，共有{count}项数据，前{part}项是{values};',\n        allData: '第{index}类是{name}，有{count}项数据，分别是{values};'\n      },\n      legend: {\n        prefix: '图例分类有：'\n      }\n    };\n\n    var Global = {\n      version: '3.8.2',\n      scales: {},\n      widthRatio: {\n        column: 1 / 2,\n        rose: 0.999999,\n        multiplePie: 3 / 4\n      },\n      lineDash: [4, 4],\n      lang: lang\n    };\n\n    Global.setTheme = function (theme) {\n      deepMix(Global, theme);\n    };\n\n    Global.setTheme(Theme);\n\n    function _defineProperty(obj, key, value) {\n      if (key in obj) {\n        Object.defineProperty(obj, key, {\n          value: value,\n          enumerable: true,\n          configurable: true,\n          writable: true\n        });\n      } else {\n        obj[key] = value;\n      }\n\n      return obj;\n    }\n\n    function _extends() {\n      _extends = Object.assign || function (target) {\n        for (var i = 1; i < arguments.length; i++) {\n          var source = arguments[i];\n\n          for (var key in source) {\n            if (Object.prototype.hasOwnProperty.call(source, key)) {\n              target[key] = source[key];\n            }\n          }\n        }\n\n        return target;\n      };\n\n      return _extends.apply(this, arguments);\n    }\n\n    function _inheritsLoose(subClass, superClass) {\n      subClass.prototype = Object.create(superClass.prototype);\n      subClass.prototype.constructor = subClass;\n      subClass.__proto__ = superClass;\n    }\n\n    function _assertThisInitialized(self) {\n      if (self === void 0) {\n        throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n      }\n\n      return self;\n    }\n\n    var EVENT_AFTER_INIT = 'afterinit';\n    var EVENT_BEFORE_RENDER = 'beforerender';\n    var EVENT_AFTER_RENDER = 'afterrender';\n    var EVENT_BEFORE_DATA_CHANGE = 'beforedatachange';\n    var EVENT_AFTER_DATA_CHANGE = 'afterdatachange';\n    var EVENT_AFTER_SIZE_CHANGE = '_aftersizechange';\n    var EVENT_AFTER_GEOM_INIT = '_aftergeominit';\n    var EVENT_BEFORE_GEOM_DRAW = 'beforegeomdraw';\n    var EVENT_AFTER_GEOM_DRAW = 'aftergeomdraw';\n    var EVENT_CLEAR = 'clear';\n    var EVENT_CLEAR_INNER = 'clearinner';\n    var EVENT_REPAINT = 'repaint';\n\n    // 实现简单的事件机制\n\n    var EventEmit = /*#__PURE__*/function () {\n      function EventEmit() {\n        this.__events = {};\n      }\n\n      var _proto = EventEmit.prototype;\n\n      _proto.on = function on(type, listener) {\n        if (!type || !listener) {\n          return;\n        }\n\n        var events = this.__events[type] || [];\n        events.push(listener);\n        this.__events[type] = events;\n      };\n\n      _proto.emit = function emit(type, e) {\n        var _this = this;\n\n        if (isObject(type)) {\n          e = type;\n          type = e && e.type;\n        }\n\n        if (!type) {\n          return;\n        }\n\n        var events = this.__events[type];\n\n        if (!events || !events.length) {\n          return;\n        }\n\n        events.forEach(function (listener) {\n          listener.call(_this, e);\n        });\n      };\n\n      _proto.off = function off(type, listener) {\n        var __events = this.__events;\n        var events = __events[type];\n\n        if (!events || !events.length) {\n          return;\n        } // 如果没有指定方法，则删除所有项\n\n\n        if (!listener) {\n          delete __events[type];\n          return;\n        } // 删除指定的 listener\n\n\n        for (var i = 0, len = events.length; i < len; i++) {\n          if (events[i] === listener) {\n            events.splice(i, 1);\n            i--;\n          }\n        }\n      };\n\n      return EventEmit;\n    }();\n\n    var Base = /*#__PURE__*/function (_Emit) {\n      _inheritsLoose(Base, _Emit);\n\n      var _proto = Base.prototype;\n\n      _proto.getDefaultCfg = function getDefaultCfg() {\n        return {};\n      };\n\n      function Base(cfg) {\n        var _this;\n\n        _this = _Emit.call(this) || this;\n        var attrs = {};\n\n        var defaultCfg = _this.getDefaultCfg();\n\n        _this._attrs = attrs;\n        mix(attrs, defaultCfg, cfg);\n        return _this;\n      }\n\n      _proto.get = function get(name) {\n        return this._attrs[name];\n      };\n\n      _proto.set = function set(name, value) {\n        this._attrs[name] = value;\n      };\n\n      _proto.destroy = function destroy() {\n        this._attrs = {};\n        this.destroyed = true;\n      };\n\n      return Base;\n    }(EventEmit);\n\n    var Plot = /*#__PURE__*/function () {\n      function Plot(cfg) {\n        mix(this, cfg);\n\n        this._init();\n      }\n\n      var _proto = Plot.prototype;\n\n      _proto._init = function _init() {\n        var self = this;\n        var start = self.start;\n        var end = self.end;\n        var xMin = Math.min(start.x, end.x);\n        var xMax = Math.max(start.x, end.x);\n        var yMin = Math.min(start.y, end.y);\n        var yMax = Math.max(start.y, end.y);\n        this.tl = {\n          x: xMin,\n          y: yMin\n        };\n        this.tr = {\n          x: xMax,\n          y: yMin\n        };\n        this.bl = {\n          x: xMin,\n          y: yMax\n        };\n        this.br = {\n          x: xMax,\n          y: yMax\n        };\n        this.width = xMax - xMin;\n        this.height = yMax - yMin;\n      }\n      /**\n       * reset\n       * @param  {Object} start start point\n       * @param  {Object} end end point\n       */\n      ;\n\n      _proto.reset = function reset(start, end) {\n        this.start = start;\n        this.end = end;\n\n        this._init();\n      }\n      /**\n       * check the point is in the range of plot\n       * @param  {Number}  x x value\n       * @param  {[type]}  y y value\n       * @return {Boolean} return the result\n       */\n      ;\n\n      _proto.isInRange = function isInRange(x, y) {\n        if (isObject(x)) {\n          y = x.y;\n          x = x.x;\n        }\n\n        var tl = this.tl;\n        var br = this.br;\n        return tl.x <= x && x <= br.x && tl.y <= y && y <= br.y;\n      };\n\n      return Plot;\n    }();\n\n    var Matrix = {\n      generateDefault: function generateDefault() {\n        return [1, 0, 0, 1, 0, 0];\n      },\n      isChanged: function isChanged(m) {\n        return m[0] !== 1 || m[1] !== 0 || m[2] !== 0 || m[3] !== 1 || m[4] !== 0 || m[5] !== 0;\n      },\n      multiply: function multiply(m1, m2) {\n        var m11 = m1[0] * m2[0] + m1[2] * m2[1];\n        var m12 = m1[1] * m2[0] + m1[3] * m2[1];\n        var m21 = m1[0] * m2[2] + m1[2] * m2[3];\n        var m22 = m1[1] * m2[2] + m1[3] * m2[3];\n        var dx = m1[0] * m2[4] + m1[2] * m2[5] + m1[4];\n        var dy = m1[1] * m2[4] + m1[3] * m2[5] + m1[5];\n        return [m11, m12, m21, m22, dx, dy];\n      },\n      scale: function scale(out, m, v) {\n        out[0] = m[0] * v[0];\n        out[1] = m[1] * v[0];\n        out[2] = m[2] * v[1];\n        out[3] = m[3] * v[1];\n        out[4] = m[4];\n        out[5] = m[5];\n        return out;\n      },\n      rotate: function rotate(out, m, radian) {\n        var c = Math.cos(radian);\n        var s = Math.sin(radian);\n        var m11 = m[0] * c + m[2] * s;\n        var m12 = m[1] * c + m[3] * s;\n        var m21 = m[0] * -s + m[2] * c;\n        var m22 = m[1] * -s + m[3] * c;\n        out[0] = m11;\n        out[1] = m12;\n        out[2] = m21;\n        out[3] = m22;\n        out[4] = m[4];\n        out[5] = m[5];\n        return out;\n      },\n      translate: function translate(out, m, v) {\n        out[0] = m[0];\n        out[1] = m[1];\n        out[2] = m[2];\n        out[3] = m[3];\n        out[4] = m[4] + m[0] * v[0] + m[2] * v[1];\n        out[5] = m[5] + m[1] * v[0] + m[3] * v[1];\n        return out;\n      },\n      transform: function transform(m, actions) {\n        var out = [].concat(m);\n\n        for (var i = 0, len = actions.length; i < len; i++) {\n          var action = actions[i];\n\n          switch (action[0]) {\n            case 't':\n              Matrix.translate(out, out, [action[1], action[2]]);\n              break;\n\n            case 's':\n              Matrix.scale(out, out, [action[1], action[2]]);\n              break;\n\n            case 'r':\n              Matrix.rotate(out, out, action[1]);\n              break;\n          }\n        }\n\n        return out;\n      }\n    };\n\n    /**\n     * 2 Dimensional Vector\n     * @module vector2\n     */\n    var Vector2 = {\n      /**\n       * Creates a new, empty vector2\n       *\n       * @return {vector2} a new 2D vector\n       */\n      create: function create() {\n        return [0, 0];\n      },\n\n      /**\n       * Calculates the length of a vector2\n       *\n       * @param {vector2} v vector to calculate length of\n       * @return {Number} length of v\n       */\n      length: function length(v) {\n        var x = v[0];\n        var y = v[1];\n        return Math.sqrt(x * x + y * y);\n      },\n\n      /**\n       * Normalize a vector2\n       *\n       * @param {vector2} out the receiving vector\n       * @param {vector2} v vector to normalize\n       * @return {vector2} out\n       */\n      normalize: function normalize(out, v) {\n        var len = this.length(v);\n\n        if (len === 0) {\n          out[0] = 0;\n          out[1] = 0;\n        } else {\n          out[0] = v[0] / len;\n          out[1] = v[1] / len;\n        }\n\n        return out;\n      },\n\n      /**\n       * Adds two vector2's\n       *\n       * @param {vector2} out the receiving vector\n       * @param {vector2} v1 the first operand\n       * @param {vector2} v2 the second operand\n       * @return {vector2} out\n       */\n      add: function add(out, v1, v2) {\n        out[0] = v1[0] + v2[0];\n        out[1] = v1[1] + v2[1];\n        return out;\n      },\n\n      /**\n       * Subtracts vector v2 from vector v1\n       *\n       * @param {vector2} out the receiving vector\n       * @param {vector2} v1 the first operand\n       * @param {vector2} v2 the second operand\n       * @return {vector2} out\n       */\n      sub: function sub(out, v1, v2) {\n        out[0] = v1[0] - v2[0];\n        out[1] = v1[1] - v2[1];\n        return out;\n      },\n\n      /**\n       * Scales a vector2 by a scalar number\n       *\n       * @param {vector2} out the receiving vector\n       * @param {vector2} v the vector to scale\n       * @param {Number} s amount to scale the vector by\n       * @return {vector2} out\n       */\n      scale: function scale(out, v, s) {\n        out[0] = v[0] * s;\n        out[1] = v[1] * s;\n        return out;\n      },\n\n      /**\n       * Calculates the dot product of two vector2's\n       *\n       * @param {vector2} v1 the first operand\n       * @param {vector2} v2 the second operand\n       * @return {Number} dot product of v1 and v2\n       */\n      dot: function dot(v1, v2) {\n        return v1[0] * v2[0] + v1[1] * v2[1];\n      },\n\n      /**\n       * Calculates the direction of two vector2's\n       *\n       * @param {vector2} v1 the first operand\n       * @param {vector2} v2 the second operand\n       * @return {Boolean} the direction of v1 and v2\n       */\n      direction: function direction(v1, v2) {\n        return v1[0] * v2[1] - v2[0] * v1[1];\n      },\n\n      /**\n       * Calculates the angle of two vector2's\n       *\n       * @param {vector2} v1 the first operand\n       * @param {vector2} v2 the second operand\n       * @return {Number} angle of v1 and v2\n       */\n      angle: function angle(v1, v2) {\n        var theta = this.dot(v1, v2) / (this.length(v1) * this.length(v2));\n        return Math.acos(theta);\n      },\n\n      /**\n       * Calculates the angle of two vector2's with direction\n       *\n       * @param {vector2} v1 the first operand\n       * @param {vector2} v2 the second operand\n       * @param {Boolean} direction the direction of two vector2's\n       * @return {Number} angle of v1 and v2\n       */\n      angleTo: function angleTo(v1, v2, direction) {\n        var angle = this.angle(v1, v2);\n        var angleLargeThanPI = this.direction(v1, v2) >= 0;\n\n        if (direction) {\n          if (angleLargeThanPI) {\n            return Math.PI * 2 - angle;\n          }\n\n          return angle;\n        }\n\n        if (angleLargeThanPI) {\n          return angle;\n        }\n\n        return Math.PI * 2 - angle;\n      },\n\n      /**\n       * whether a vector2 is zero vector\n       *\n       * @param  {vector2} v vector to calculate\n       * @return {Boolean}   is or not a zero vector\n       */\n      zero: function zero(v) {\n        return v[0] === 0 && v[1] === 0;\n      },\n\n      /**\n       * Calculates the euclidian distance between two vector2's\n       *\n       * @param {vector2} v1 the first operand\n       * @param {vector2} v2 the second operand\n       * @return {Number} distance between a and b\n       */\n      distance: function distance(v1, v2) {\n        var x = v2[0] - v1[0];\n        var y = v2[1] - v1[1];\n        return Math.sqrt(x * x + y * y);\n      },\n\n      /**\n       * Creates a new vector2 initialized with values from an existing vector\n       *\n       * @param {vector2} v vector to clone\n       * @return {Array} a new 2D vector\n       */\n      clone: function clone(v) {\n        return [v[0], v[1]];\n      },\n\n      /**\n       * Return the minimum of two vector2's\n       *\n       * @param {vector2} out the receiving vector\n       * @param {vector2} v1 the first operand\n       * @param {vector2} v2 the second operand\n       * @return {vector2} out\n       */\n      min: function min(out, v1, v2) {\n        out[0] = Math.min(v1[0], v2[0]);\n        out[1] = Math.min(v1[1], v2[1]);\n        return out;\n      },\n\n      /**\n       * Return the maximum of two vector2's\n       *\n       * @param {vector2} out the receiving vector\n       * @param {vector2} v1 the first operand\n       * @param {vector2} v2 the second operand\n       * @return {vector2} out\n       */\n      max: function max(out, v1, v2) {\n        out[0] = Math.max(v1[0], v2[0]);\n        out[1] = Math.max(v1[1], v2[1]);\n        return out;\n      },\n\n      /**\n       * Transforms the vector2 with a mat2d\n       *\n       * @param {vector2} out the receiving vector\n       * @param {vector2} v the vector to transform\n       * @param {mat2d} m matrix to transform with\n       * @return {vector2} out\n       */\n      transformMat2d: function transformMat2d(out, v, m) {\n        var x = v[0];\n        var y = v[1];\n        out[0] = m[0] * x + m[2] * y + m[4];\n        out[1] = m[1] * x + m[3] * y + m[5];\n        return out;\n      }\n    };\n\n    var defaultMatrix = [1, 0, 0, 1, 0, 0];\n\n    var Base$1 = /*#__PURE__*/function () {\n      var _proto = Base.prototype;\n\n      _proto._initDefaultCfg = function _initDefaultCfg() {};\n\n      function Base(cfg) {\n        this._initDefaultCfg();\n\n        mix(this, cfg);\n        var start;\n        var end;\n\n        if (this.plot) {\n          start = this.plot.bl;\n          end = this.plot.tr;\n          this.start = start;\n          this.end = end;\n        } else {\n          start = this.start;\n          end = this.end;\n        }\n\n        this.init(start, end);\n      }\n\n      _proto._scale = function _scale(s1, s2) {\n        var matrix = this.matrix;\n        var center = this.center;\n        Matrix.translate(matrix, matrix, [center.x, center.y]);\n        Matrix.scale(matrix, matrix, [s1, s2]);\n        Matrix.translate(matrix, matrix, [-center.x, -center.y]);\n      };\n\n      _proto.init = function init(start, end) {\n        this.matrix = [].concat(defaultMatrix); // 设置中心点\n\n        this.center = {\n          x: (end.x - start.x) / 2 + start.x,\n          y: (end.y - start.y) / 2 + start.y\n        };\n\n        if (this.scale) {\n          this._scale(this.scale[0], this.scale[1]);\n        }\n      };\n\n      _proto.convertPoint = function convertPoint(point) {\n        var _this$_convertPoint = this._convertPoint(point),\n            x = _this$_convertPoint.x,\n            y = _this$_convertPoint.y;\n\n        if (!Matrix.isChanged(this.matrix)) {\n          return {\n            x: x,\n            y: y\n          };\n        }\n\n        var vector = [x, y];\n        Vector2.transformMat2d(vector, vector, this.matrix);\n        return {\n          x: vector[0],\n          y: vector[1]\n        };\n      };\n\n      _proto.invertPoint = function invertPoint(point) {\n        return this._invertPoint(point);\n      };\n\n      _proto._convertPoint = function _convertPoint(point) {\n        return point;\n      };\n\n      _proto._invertPoint = function _invertPoint(point) {\n        return point;\n      };\n\n      _proto.reset = function reset(plot) {\n        this.plot = plot;\n        var bl = plot.bl,\n            tr = plot.tr;\n        this.start = bl;\n        this.end = tr;\n        this.init(bl, tr);\n      };\n\n      return Base;\n    }();\n\n    var Cartesian = /*#__PURE__*/function (_Base) {\n      _inheritsLoose(Cartesian, _Base);\n\n      function Cartesian() {\n        return _Base.apply(this, arguments) || this;\n      }\n\n      var _proto = Cartesian.prototype;\n\n      _proto._initDefaultCfg = function _initDefaultCfg() {\n        this.type = 'cartesian';\n        this.transposed = false;\n        this.isRect = true;\n      };\n\n      _proto.init = function init(start, end) {\n        _Base.prototype.init.call(this, start, end);\n\n        this.x = {\n          start: start.x,\n          end: end.x\n        };\n        this.y = {\n          start: start.y,\n          end: end.y\n        };\n      };\n\n      _proto._convertPoint = function _convertPoint(point) {\n        var self = this;\n        var transposed = self.transposed;\n        var xDim = transposed ? 'y' : 'x';\n        var yDim = transposed ? 'x' : 'y';\n        var x = self.x;\n        var y = self.y;\n        return {\n          x: x.start + (x.end - x.start) * point[xDim],\n          y: y.start + (y.end - y.start) * point[yDim]\n        };\n      };\n\n      _proto._invertPoint = function _invertPoint(point) {\n        var self = this;\n        var transposed = self.transposed;\n        var xDim = transposed ? 'y' : 'x';\n        var yDim = transposed ? 'x' : 'y';\n        var x = self.x;\n        var y = self.y;\n        var rst = {};\n        rst[xDim] = (point.x - x.start) / (x.end - x.start);\n        rst[yDim] = (point.y - y.start) / (y.end - y.start);\n        return rst;\n      };\n\n      return Cartesian;\n    }(Base$1);\n\n    Base$1.Cartesian = Cartesian;\n    Base$1.Rect = Cartesian;\n\n    /**\n     * @fileOverview the Attribute base class\n     */\n\n    function toScaleString(scale, value) {\n      if (isString(value)) {\n        return value;\n      }\n\n      return scale.invert(scale.scale(value));\n    }\n    /**\n     * 所有视觉通道属性的基类\n     * @class Attr\n     */\n\n\n    var AttributeBase = /*#__PURE__*/function () {\n      function AttributeBase(cfg) {\n        var _this = this;\n\n        /**\n         * 属性的类型\n         * @type {String}\n         */\n        this.type = 'base';\n        /**\n         * 属性的名称\n         * @type {String}\n         */\n\n        this.name = null;\n        /**\n         * 回调函数\n         * @type {Function}\n         */\n\n        this.method = null;\n        /**\n         * 备选的值数组\n         * @type {Array}\n         */\n\n        this.values = [];\n        /**\n         * 属性内部的度量\n         * @type {Array}\n         */\n\n        this.scales = [];\n        /**\n         * 是否通过线性取值, 如果未指定，则根据数值的类型判定\n         * @type {Boolean}\n         */\n\n        this.linear = null;\n        /**\n         * 当用户设置的 callback 返回 null 时, 应该返回默认 callback 中的值\n         */\n\n        var mixedCallback = null;\n        var defaultCallback = this.callback;\n\n        if (cfg.callback) {\n          var userCallback = cfg.callback;\n\n          mixedCallback = function mixedCallback() {\n            for (var _len = arguments.length, params = new Array(_len), _key = 0; _key < _len; _key++) {\n              params[_key] = arguments[_key];\n            }\n\n            var ret = userCallback.apply(void 0, params);\n\n            if (isNil(ret)) {\n              ret = defaultCallback.apply(_this, params);\n            }\n\n            return ret;\n          };\n        }\n\n        mix(this, cfg);\n\n        if (mixedCallback) {\n          mix(this, {\n            callback: mixedCallback\n          });\n        }\n      } // 获取属性值，将值映射到视觉通道\n\n\n      var _proto = AttributeBase.prototype;\n\n      _proto._getAttrValue = function _getAttrValue(scale, value) {\n        var values = this.values;\n\n        if (scale.isCategory && !this.linear) {\n          var index = scale.translate(value);\n          return values[index % values.length];\n        }\n\n        var percent = scale.scale(value);\n        return this.getLinearValue(percent);\n      }\n      /**\n       * 如果进行线性映射，返回对应的映射值\n       * @protected\n       * @param  {Number} percent 百分比\n       * @return {*}  颜色值、形状、大小等\n       */\n      ;\n\n      _proto.getLinearValue = function getLinearValue(percent) {\n        var values = this.values;\n        var steps = values.length - 1;\n        var step = Math.floor(steps * percent);\n        var leftPercent = steps * percent - step;\n        var start = values[step];\n        var end = step === steps ? start : values[step + 1];\n        var rstValue = start + (end - start) * leftPercent;\n        return rstValue;\n      }\n      /**\n       * 默认的回调函数\n       * @param {*} value 回调函数的值\n       * @type {Function}\n       * @return {Array} 返回映射后的值\n       */\n      ;\n\n      _proto.callback = function callback(value) {\n        var self = this;\n        var scale = self.scales[0];\n        var rstValue = null;\n\n        if (scale.type === 'identity') {\n          rstValue = scale.value;\n        } else {\n          rstValue = self._getAttrValue(scale, value);\n        }\n\n        return rstValue;\n      }\n      /**\n       * 根据度量获取属性名\n       * @return {Array} dims of this Attribute\n       */\n      ;\n\n      _proto.getNames = function getNames() {\n        var scales = this.scales;\n        var names = this.names;\n        var length = Math.min(scales.length, names.length);\n        var rst = [];\n\n        for (var i = 0; i < length; i++) {\n          rst.push(names[i]);\n        }\n\n        return rst;\n      }\n      /**\n       * 根据度量获取维度名\n       * @return {Array} dims of this Attribute\n       */\n      ;\n\n      _proto.getFields = function getFields() {\n        var scales = this.scales;\n        var rst = [];\n        each(scales, function (scale) {\n          rst.push(scale.field);\n        });\n        return rst;\n      }\n      /**\n       * 根据名称获取度量\n       * @param  {String} name the name of scale\n       * @return {Scale} scale\n       */\n      ;\n\n      _proto.getScale = function getScale(name) {\n        var scales = this.scales;\n        var names = this.names;\n        var index = names.indexOf(name);\n        return scales[index];\n      }\n      /**\n       * 映射数据\n       * @param {*} param1...paramn 多个数值\n       * @return {Array} 映射的值组成的数组\n       */\n      ;\n\n      _proto.mapping = function mapping() {\n        var scales = this.scales;\n        var callback = this.callback;\n\n        for (var _len2 = arguments.length, params = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n          params[_key2] = arguments[_key2];\n        }\n\n        var values = params;\n\n        if (callback) {\n          for (var i = 0, len = params.length; i < len; i++) {\n            params[i] = this._toOriginParam(params[i], scales[i]);\n          }\n\n          values = callback.apply(this, params);\n        }\n\n        values = [].concat(values);\n        return values;\n      } // 原始的参数\n      ;\n\n      _proto._toOriginParam = function _toOriginParam(param, scale) {\n        var rst = param;\n\n        if (!scale.isLinear) {\n          if (isArray(param)) {\n            rst = [];\n\n            for (var i = 0, len = param.length; i < len; i++) {\n              rst.push(toScaleString(scale, param[i]));\n            }\n          } else {\n            rst = toScaleString(scale, param);\n          }\n        }\n\n        return rst;\n      };\n\n      return AttributeBase;\n    }();\n\n    var Position = /*#__PURE__*/function (_Base) {\n      _inheritsLoose(Position, _Base);\n\n      function Position(cfg) {\n        var _this;\n\n        _this = _Base.call(this, cfg) || this;\n        _this.names = ['x', 'y'];\n        _this.type = 'position';\n        return _this;\n      }\n\n      var _proto = Position.prototype;\n\n      _proto.mapping = function mapping(x, y) {\n        var scales = this.scales;\n        var coord = this.coord;\n        var scaleX = scales[0];\n        var scaleY = scales[1];\n        var rstX;\n        var rstY;\n        var obj;\n\n        if (isNil(x) || isNil(y)) {\n          return [];\n        }\n\n        if (isArray(y) && isArray(x)) {\n          rstX = [];\n          rstY = [];\n\n          for (var i = 0, j = 0, xLen = x.length, yLen = y.length; i < xLen && j < yLen; i++, j++) {\n            obj = coord.convertPoint({\n              x: scaleX.scale(x[i]),\n              y: scaleY.scale(y[j])\n            });\n            rstX.push(obj.x);\n            rstY.push(obj.y);\n          }\n        } else if (isArray(y)) {\n          x = scaleX.scale(x);\n          rstY = [];\n          each(y, function (yVal) {\n            yVal = scaleY.scale(yVal);\n            obj = coord.convertPoint({\n              x: x,\n              y: yVal\n            });\n\n            if (rstX && rstX !== obj.x) {\n              if (!isArray(rstX)) {\n                rstX = [rstX];\n              }\n\n              rstX.push(obj.x);\n            } else {\n              rstX = obj.x;\n            }\n\n            rstY.push(obj.y);\n          });\n        } else if (isArray(x)) {\n          y = scaleY.scale(y);\n          rstX = [];\n          each(x, function (xVal) {\n            xVal = scaleX.scale(xVal);\n            obj = coord.convertPoint({\n              x: xVal,\n              y: y\n            });\n\n            if (rstY && rstY !== obj.y) {\n              if (!isArray(rstY)) {\n                rstY = [rstY];\n              }\n\n              rstY.push(obj.y);\n            } else {\n              rstY = obj.y;\n            }\n\n            rstX.push(obj.x);\n          });\n        } else {\n          x = scaleX.scale(x);\n          y = scaleY.scale(y);\n          var point = coord.convertPoint({\n            x: x,\n            y: y\n          });\n          rstX = point.x;\n          rstY = point.y;\n        }\n\n        return [rstX, rstY];\n      };\n\n      return Position;\n    }(AttributeBase);\n\n    var Shape = /*#__PURE__*/function (_Base) {\n      _inheritsLoose(Shape, _Base);\n\n      function Shape(cfg) {\n        var _this;\n\n        _this = _Base.call(this, cfg) || this;\n        _this.names = ['shape'];\n        _this.type = 'shape';\n        _this.gradient = null;\n        return _this;\n      }\n      /**\n       * @override\n       */\n\n\n      var _proto = Shape.prototype;\n\n      _proto.getLinearValue = function getLinearValue(percent) {\n        var values = this.values;\n        var index = Math.round((values.length - 1) * percent);\n        return values[index];\n      };\n\n      return Shape;\n    }(AttributeBase);\n\n    var Size = /*#__PURE__*/function (_Base) {\n      _inheritsLoose(Size, _Base);\n\n      function Size(cfg) {\n        var _this;\n\n        _this = _Base.call(this, cfg) || this;\n        _this.names = ['size'];\n        _this.type = 'size';\n        _this.gradient = null;\n        return _this;\n      }\n\n      return Size;\n    }(AttributeBase);\n\n    function getValue(start, end, percent, index) {\n      var value = start[index] + (end[index] - start[index]) * percent;\n      return value;\n    } // convert to hex\n\n\n    function arr2hex(arr) {\n      return '#' + toRGBValue(arr[0]) + toRGBValue(arr[1]) + toRGBValue(arr[2]);\n    }\n\n    function toRGBValue(value) {\n      value = Math.round(value);\n      value = value.toString(16);\n\n      if (value.length === 1) {\n        value = '0' + value;\n      }\n\n      return value;\n    }\n\n    function calColor(colors, percent) {\n      var steps = colors.length - 1;\n      var step = Math.floor(steps * percent);\n      var left = steps * percent - step;\n      var start = colors[step];\n      var end = step === steps ? start : colors[step + 1];\n      var rgb = arr2hex([getValue(start, end, left, 0), getValue(start, end, left, 1), getValue(start, end, left, 2)]);\n      return rgb;\n    }\n\n    function hex2arr(str) {\n      var arr = [];\n      arr.push(parseInt(str.substr(1, 2), 16));\n      arr.push(parseInt(str.substr(3, 2), 16));\n      arr.push(parseInt(str.substr(5, 2), 16));\n      return arr;\n    }\n\n    var colorCache = {\n      black: '#000000',\n      blue: '#0000ff',\n      grey: '#808080',\n      green: '#008000',\n      orange: '#ffa500',\n      pink: '#ffc0cb',\n      purple: '#800080',\n      red: '#ff0000',\n      white: '#ffffff',\n      yellow: '#ffff00'\n    };\n    /**\n     * Returns a hexadecimal string representing this color in RGB space, such as #f7eaba.\n     * @param  {String} color color value\n     * @return {String} Returns a hexadecimal string\n     */\n\n    function toHex(color) {\n      if (colorCache[color]) {\n        return colorCache[color];\n      }\n\n      if (color[0] === '#') {\n        if (color.length === 7) {\n          return color;\n        }\n\n        var hex = color.replace(/^#?([a-f\\d])([a-f\\d])([a-f\\d])$/i, function (m, r, g, b) {\n          return '#' + r + r + g + g + b + b;\n        }); // hex3 to hex6\n\n        colorCache[color] = hex;\n        return hex;\n      } // rgb/rgba to hex\n\n\n      var rst = color.match(/^rgba?[\\s+]?\\([\\s+]?(\\d+)[\\s+]?,[\\s+]?(\\d+)[\\s+]?,[\\s+]?(\\d+)[\\s+]?/i);\n      rst.shift();\n      rst = arr2hex(rst);\n      colorCache[color] = rst;\n      return rst;\n    }\n    /**\n     * handle the gradient color\n     * @param  {Array} colors the colors\n     * @return {String} return the color value\n     */\n\n\n    function gradient(colors) {\n      var points = [];\n\n      if (isString(colors)) {\n        colors = colors.split('-');\n      }\n\n      each(colors, function (color) {\n        if (color.indexOf('#') === -1) {\n          color = toHex(color);\n        }\n\n        points.push(hex2arr(color));\n      });\n      return function (percent) {\n        return calColor(points, percent);\n      };\n    }\n\n    var Color = /*#__PURE__*/function (_Base) {\n      _inheritsLoose(Color, _Base);\n\n      function Color(cfg) {\n        var _this;\n\n        _this = _Base.call(this, cfg) || this;\n        _this.names = ['color'];\n        _this.type = 'color';\n        _this.gradient = null;\n\n        if (isString(_this.values)) {\n          _this.linear = true;\n        }\n\n        return _this;\n      }\n      /**\n       * @override\n       */\n\n\n      var _proto = Color.prototype;\n\n      _proto.getLinearValue = function getLinearValue(percent) {\n        var gradient$1 = this.gradient;\n\n        if (!gradient$1) {\n          var values = this.values;\n          gradient$1 = gradient(values);\n          this.gradient = gradient$1;\n        }\n\n        return gradient$1(percent);\n      };\n\n      return Color;\n    }(AttributeBase);\n\n    var Attr = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        Position: Position,\n        Shape: Shape,\n        Size: Size,\n        Color: Color\n    });\n\n    var Shape$1 = {};\n    var ShapeBase = {\n      _coord: null,\n\n      /**\n       * draw the shape\n       * @param {Object} cfg options\n       * @param {Object} container container to store the shapes\n       */\n      draw: function draw(cfg, container) {\n        if (this.drawShape) {\n          this.drawShape(cfg, container);\n        }\n      },\n\n      /**\n       * set the coordinate instance\n       * @param {Coord} coord coordinate instance\n       */\n      setCoord: function setCoord(coord) {\n        this._coord = coord;\n      },\n\n      /**\n       * convert the normalized value to the canvas position\n       * @param  {point} point the point to convert\n       * @return {point} point return the result\n       */\n      parsePoint: function parsePoint(point) {\n        var coord = this._coord;\n\n        if (coord.isPolar) {\n          if (point.x === 1) point.x = 0.9999999;\n          if (point.y === 1) point.y = 0.9999999;\n        }\n\n        return coord.convertPoint(point);\n      },\n\n      /**\n       * convert the normalized value to the canvas position\n       * @param  {points} points the array that store the points\n       * @return {points} points return the result\n       */\n      parsePoints: function parsePoints(points) {\n        if (!points) return false;\n        var self = this;\n        var rst = [];\n        points.forEach(function (point) {\n          rst.push(self.parsePoint(point));\n        });\n        return rst;\n      }\n    };\n    var ShapeFactoryBase = {\n      defaultShapeType: null,\n      setCoord: function setCoord(coord) {\n        this._coord = coord;\n      },\n      getShape: function getShape(type) {\n        var self = this;\n\n        if (isArray(type)) {\n          type = type[0];\n        }\n\n        var shape = self[type] || self[self.defaultShapeType];\n        shape._coord = self._coord;\n        return shape;\n      },\n      getShapePoints: function getShapePoints(type, cfg) {\n        var shape = this.getShape(type);\n        var fn = shape.getPoints || shape.getShapePoints || this.getDefaultPoints;\n        var points = fn(cfg);\n        return points;\n      },\n      getDefaultPoints: function getDefaultPoints()\n      /* cfg */\n      {\n        return [];\n      },\n      drawShape: function drawShape(type, cfg, container) {\n        var shape = this.getShape(type);\n\n        if (!cfg.color) {\n          cfg.color = Global.colors[0];\n        }\n\n        return shape.draw(cfg, container);\n      }\n    };\n\n    Shape$1.registerFactory = function (factoryName, cfg) {\n      var className = upperFirst(factoryName);\n      var geomObj = mix({}, ShapeFactoryBase, cfg);\n      Shape$1[className] = geomObj;\n      geomObj.name = factoryName;\n      return geomObj;\n    };\n\n    Shape$1.registerShape = function (factoryName, shapeType, cfg) {\n      var className = upperFirst(factoryName);\n      var factory = Shape$1[className];\n      var shapeObj = mix({}, ShapeBase, cfg);\n      factory[shapeType] = shapeObj;\n      return shapeObj;\n    };\n\n    Shape$1.registShape = Shape$1.registerShape;\n\n    Shape$1.getShapeFactory = function (factoryName) {\n      var self = this;\n      factoryName = factoryName || 'point';\n      var className = upperFirst(factoryName);\n      return self[className];\n    };\n\n    function _mix$1(dist, obj) {\n      for (var key in obj) {\n        if (obj.hasOwnProperty(key) && key !== 'constructor' && obj[key] !== undefined) {\n          dist[key] = obj[key];\n        }\n      }\n    }\n\n    var mix$1 = function mix(dist, src1, src2, src3) {\n      if (src1) _mix$1(dist, src1);\n      if (src2) _mix$1(dist, src2);\n      if (src3) _mix$1(dist, src3);\n      return dist;\n    };\n\n    var mix_1 = mix$1;\n\n    var Adjust = /*#__PURE__*/function () {\n      var _proto = Adjust.prototype;\n\n      _proto._initDefaultCfg = function _initDefaultCfg() {\n        this.adjustNames = ['x', 'y']; // 调整的维度，默认,x,y都做调整\n      };\n\n      function Adjust(cfg) {\n        this._initDefaultCfg();\n\n        mix_1(this, cfg);\n      }\n      /**\n       * @override\n       */\n\n\n      _proto.processAdjust = function processAdjust()\n      /* dataArray */\n      {};\n\n      return Adjust;\n    }();\n\n    var base = Adjust;\n\n    function generateScaleAria(scale) {\n      var type = scale.type,\n          values = scale.values;\n\n      if (type === 'linear') {\n        return substitute(lang.scale.linear, scale);\n      }\n\n      if (type === 'cat') {\n        return substitute(lang.scale.cat, {\n          values: values.slice(0, 10).join(' ')\n        });\n      }\n\n      if (type === 'timeCat') {\n        var start = scale.getText(values[0]);\n        var end = scale.getText(values[values.length - 1]);\n        return substitute(lang.scale.timeCat, {\n          start: start,\n          end: end\n        });\n      }\n\n      return '';\n    }\n    function generateCoordAria(coord, xScale, yScale) {\n      var type = coord.type;\n\n      if (!lang.coord[type]) {\n        return '';\n      }\n\n      return substitute(lang.coord[type], {\n        xLabel: generateScaleAria(xScale),\n        yLabel: generateScaleAria(yScale)\n      });\n    }\n\n    var GROUP_ATTRS = ['color', 'size', 'shape'];\n    var FIELD_ORIGIN = '_origin';\n    var FIELD_ORIGIN_Y = '_originY';\n\n    function parseFields(field) {\n      if (isArray(field)) {\n        return field;\n      }\n\n      if (isString(field)) {\n        return field.split('*');\n      }\n\n      return [field];\n    }\n    /**\n     * The parent class for Geometry\n     * @class Geom\n     */\n\n\n    var Geom = /*#__PURE__*/function (_Base) {\n      _inheritsLoose(Geom, _Base);\n\n      function Geom() {\n        return _Base.apply(this, arguments) || this;\n      }\n\n      var _proto = Geom.prototype;\n\n      _proto.getDefaultCfg = function getDefaultCfg() {\n        return {\n          /**\n           * geometry type\n           * @type {String}\n           */\n          type: null,\n\n          /**\n           * the data of geometry\n           * @type {Array}\n           */\n          data: null,\n\n          /**\n           * the attrs of geo,etry\n           * @type {Object}\n           */\n          attrs: {},\n          scales: {},\n\n          /**\n           * group for storing the shapes\n           * @type {Canvas}\n           */\n          container: null,\n\n          /**\n           * style options\n           * @type {Object}\n           */\n          styleOptions: null,\n          chart: null,\n          shapeType: '',\n\n          /**\n           * wether to generate key points for each shape\n           * @protected\n           * @type {Boolean}\n           */\n          generatePoints: false,\n          attrOptions: {},\n          sortable: false,\n          startOnZero: true,\n          visible: true,\n          connectNulls: false,\n          // 是否丢弃没有值的分组。\n          ignoreEmptyGroup: false,\n          // 是否已经初始化\n          isInit: false\n        };\n      };\n\n      _proto.init = function init() {\n        var self = this;\n        var isInit = self.get('isInit');\n\n        if (isInit) {\n          return;\n        }\n\n        self._initAttrs();\n\n        self._processData();\n\n        self.set('isInit', true);\n      };\n\n      _proto._getGroupScales = function _getGroupScales() {\n        var self = this;\n        var scales = [];\n        each(GROUP_ATTRS, function (attrName) {\n          var attr = self.getAttr(attrName);\n\n          if (attr) {\n            var attrScales = attr.scales;\n            each(attrScales, function (scale) {\n              if (scale && scale.isCategory && scales.indexOf(scale) === -1) {\n                scales.push(scale);\n              }\n            });\n          }\n        });\n        return scales;\n      };\n\n      _proto._groupData = function _groupData(data) {\n        var self = this;\n        var colDefs = self.get('colDefs');\n\n        var groupScales = self._getGroupScales();\n\n        if (groupScales.length) {\n          var appendConditions = {};\n          var names = [];\n          each(groupScales, function (scale) {\n            var field = scale.field;\n            names.push(field);\n\n            if (colDefs && colDefs[field] && colDefs[field].values) {\n              // users have defined\n              appendConditions[scale.field] = colDefs[field].values;\n            }\n          });\n          return group(data, names, appendConditions);\n        }\n\n        return [data];\n      };\n\n      _proto._setAttrOptions = function _setAttrOptions(attrName, attrCfg) {\n        var options = this.get('attrOptions');\n        options[attrName] = attrCfg;\n        var attrs = this.get('attrs'); // 说明已经初始化过了\n\n        if (Object.keys(attrs).length) {\n          this._createAttr(attrName, attrCfg);\n        }\n      };\n\n      _proto._createAttrOption = function _createAttrOption(attrName, field, cfg, defaultValues) {\n        var attrCfg = {};\n        attrCfg.field = field;\n\n        if (cfg) {\n          if (isFunction(cfg)) {\n            attrCfg.callback = cfg;\n          } else {\n            attrCfg.values = cfg;\n          }\n        } else {\n          attrCfg.values = defaultValues;\n        }\n\n        this._setAttrOptions(attrName, attrCfg);\n      };\n\n      _proto._createAttr = function _createAttr(type, option) {\n        var self = this;\n        var attrs = self.get('attrs');\n        var coord = self.get('coord');\n        var className = upperFirst(type);\n        var fields = parseFields(option.field);\n\n        if (type === 'position') {\n          option.coord = coord;\n        }\n\n        var scales = [];\n\n        for (var i = 0, len = fields.length; i < len; i++) {\n          var field = fields[i];\n\n          var scale = self._createScale(field);\n\n          scales.push(scale);\n        }\n\n        if (type === 'position') {\n          var yScale = scales[1]; // 饼图的处理，但是还不知道为啥\n\n          if (coord.type === 'polar' && coord.transposed && self.hasAdjust('stack')) {\n            if (yScale.values.length) {\n              yScale.change({\n                nice: false,\n                min: 0,\n                max: Math.max.apply(null, yScale.values)\n              });\n            }\n          }\n        }\n\n        option.scales = scales;\n        var attr = new Attr[className](option);\n        attrs[type] = attr;\n        return attr;\n      };\n\n      _proto._initAttrs = function _initAttrs() {\n        var self = this;\n        var attrOptions = self.get('attrOptions');\n\n        for (var type in attrOptions) {\n          if (attrOptions.hasOwnProperty(type)) {\n            this._createAttr(type, attrOptions[type]);\n          }\n        }\n      };\n\n      _proto._createScale = function _createScale(field) {\n        var scales = this.get('scales');\n        var scale = scales[field];\n\n        if (!scale) {\n          scale = this.get('chart').createScale(field);\n          scales[field] = scale;\n        }\n\n        return scale;\n      };\n\n      _proto._processData = function _processData() {\n        var self = this;\n        var data = this.get('data');\n        var dataArray = [];\n\n        var groupedArray = this._groupData(data);\n\n        if (this.get('ignoreEmptyGroup')) {\n          var yScale = this.getYScale();\n          groupedArray = groupedArray.filter(function (group) {\n            return group.some(function (item) {\n              return typeof item[yScale.field] !== 'undefined';\n            });\n          });\n        }\n\n        for (var i = 0, len = groupedArray.length; i < len; i++) {\n          var subData = groupedArray[i];\n\n          var tempData = self._saveOrigin(subData);\n\n          if (this.hasAdjust('dodge')) {\n            self._numberic(tempData);\n          }\n\n          dataArray.push(tempData);\n        }\n\n        if (self.get('adjust')) {\n          self._adjustData(dataArray);\n        }\n\n        if (self.get('sortable')) {\n          self._sort(dataArray);\n        }\n\n        self.emit('afterprocessdata', {\n          dataArray: dataArray\n        });\n        self.set('mappingData', dataArray);\n        self.set('dataArray', dataArray);\n        return dataArray;\n      };\n\n      _proto._saveOrigin = function _saveOrigin(data) {\n        var rst = [];\n\n        for (var i = 0, len = data.length; i < len; i++) {\n          var origin = data[i];\n          var obj = {};\n\n          for (var k in origin) {\n            obj[k] = origin[k];\n          }\n\n          obj[FIELD_ORIGIN] = origin;\n          rst.push(obj);\n        }\n\n        return rst;\n      };\n\n      _proto._numberic = function _numberic(data) {\n        var positionAttr = this.getAttr('position');\n        var scales = positionAttr.scales;\n\n        for (var j = 0, len = data.length; j < len; j++) {\n          var obj = data[j];\n          var count = Math.min(2, scales.length);\n\n          for (var i = 0; i < count; i++) {\n            var scale = scales[i];\n\n            if (scale.isCategory) {\n              var field = scale.field;\n              obj[field] = scale.translate(obj[field]);\n            }\n          }\n        }\n      };\n\n      _proto._adjustData = function _adjustData(dataArray) {\n        var self = this;\n        var adjust = self.get('adjust');\n\n        if (adjust) {\n          var adjustType = upperFirst(adjust.type);\n\n          if (!base[adjustType]) {\n            throw new Error('not support such adjust : ' + adjust);\n          }\n\n          var xScale = self.getXScale();\n          var yScale = self.getYScale();\n          var cfg = mix({\n            xField: xScale.field,\n            yField: yScale.field\n          }, adjust);\n          var adjustObject = new base[adjustType](cfg);\n          adjustObject.processAdjust(dataArray);\n\n          if (adjustType === 'Stack') {\n            self._updateStackRange(yScale.field, yScale, dataArray);\n          }\n        }\n      };\n\n      _proto._updateStackRange = function _updateStackRange(field, scale, dataArray) {\n        var mergeArray = merge(dataArray);\n        var min = scale.min;\n        var max = scale.max;\n\n        for (var i = 0, len = mergeArray.length; i < len; i++) {\n          var obj = mergeArray[i];\n          var tmpMin = Math.min.apply(null, obj[field]);\n          var tmpMax = Math.max.apply(null, obj[field]);\n\n          if (tmpMin < min) {\n            min = tmpMin;\n          }\n\n          if (tmpMax > max) {\n            max = tmpMax;\n          }\n        }\n\n        if (min < scale.min || max > scale.max) {\n          scale.change({\n            min: min,\n            max: max\n          });\n        }\n      };\n\n      _proto._sort = function _sort(mappedArray) {\n        var self = this;\n        var xScale = self.getXScale();\n        var field = xScale.field,\n            type = xScale.type;\n\n        if (type !== 'identity' && xScale.values.length > 1) {\n          each(mappedArray, function (itemArr) {\n            itemArr.sort(function (obj1, obj2) {\n              if (type === 'timeCat') {\n                return toTimeStamp(obj1[FIELD_ORIGIN][field]) - toTimeStamp(obj2[FIELD_ORIGIN][field]);\n              }\n\n              return xScale.translate(obj1[FIELD_ORIGIN][field]) - xScale.translate(obj2[FIELD_ORIGIN][field]);\n            });\n          });\n        }\n\n        self.set('hasSorted', true);\n        self.set('dataArray', mappedArray);\n      };\n\n      _proto.paint = function paint() {\n        var self = this;\n        var dataArray = self.get('mappingData');\n        var mappedArray = [];\n        var shapeFactory = self.getShapeFactory();\n        shapeFactory.setCoord(self.get('coord'));\n\n        self._beforeMapping(dataArray);\n\n        for (var i = 0, len = dataArray.length; i < len; i++) {\n          var data = dataArray[i];\n\n          if (data.length) {\n            var mappedData = self._mapping(data);\n\n            mappedArray.push(mappedData);\n            self.draw(mappedData, shapeFactory);\n          }\n        }\n\n        self.set('dataArray', mappedArray);\n        this.generateAria();\n      };\n\n      _proto.getShapeFactory = function getShapeFactory() {\n        var shapeFactory = this.get('shapeFactory');\n\n        if (!shapeFactory) {\n          var shapeType = this.get('shapeType');\n          shapeFactory = Shape$1.getShapeFactory(shapeType);\n          this.set('shapeFactory', shapeFactory);\n        }\n\n        return shapeFactory;\n      };\n\n      _proto._mapping = function _mapping(data) {\n        var self = this;\n        var attrs = self.get('attrs');\n        var yField = self.getYScale().field; // 用来缓存转换的值，减少mapping耗时\n\n        var mappedCache = {};\n        var mappedData = new Array(data.length);\n\n        for (var k in attrs) {\n          if (attrs.hasOwnProperty(k)) {\n            var attr = attrs[k];\n            var names = attr.names;\n            var scales = attr.scales;\n\n            for (var i = 0, len = data.length; i < len; i++) {\n              var record = data[i];\n\n              var mappedRecord = _extends({}, record, mappedData[i]);\n\n              mappedRecord[FIELD_ORIGIN_Y] = record[yField]; // 获取视觉属性对应的value值\n              // 位置的缓存命中率低，还是每次单独计算\n\n              if (attr.type === 'position') {\n                var values = self._getAttrValues(attr, record);\n\n                for (var j = 0, _len = values.length; j < _len; j++) {\n                  var val = values[j];\n                  var name = names[j];\n                  mappedRecord[name] = isArray(val) && val.length === 1 ? val[0] : val;\n                }\n              } else {\n                // 除了position其他都只有一项\n                var _name = names[0];\n                var field = scales[0].field;\n                var value = record[field];\n                var key = \"\" + _name + value;\n                var _values = mappedCache[key];\n\n                if (!_values) {\n                  _values = self._getAttrValues(attr, record);\n                  mappedCache[key] = _values;\n                }\n\n                mappedRecord[_name] = _values[0];\n              } // 设置新数组\n\n\n              mappedData[i] = mappedRecord;\n            }\n          }\n        }\n\n        return mappedData;\n      };\n\n      _proto._getAttrValues = function _getAttrValues(attr, record) {\n        var scales = attr.scales;\n        var params = [];\n\n        for (var i = 0, len = scales.length; i < len; i++) {\n          var scale = scales[i];\n          var field = scale.field;\n\n          if (scale.type === 'identity') {\n            params.push(scale.value);\n          } else {\n            params.push(record[field]);\n          }\n        }\n\n        var values = attr.mapping.apply(attr, params);\n        return values;\n      };\n\n      _proto.getAttrValue = function getAttrValue(attrName, record) {\n        var attr = this.getAttr(attrName);\n        var rst = null;\n\n        if (attr) {\n          var values = this._getAttrValues(attr, record);\n\n          rst = values[0];\n        }\n\n        return rst;\n      };\n\n      _proto._beforeMapping = function _beforeMapping(dataArray) {\n        var self = this;\n\n        if (self.get('generatePoints')) {\n          self._generatePoints(dataArray);\n        }\n      };\n\n      _proto.isInCircle = function isInCircle() {\n        var coord = this.get('coord');\n        return coord && coord.isPolar;\n      };\n\n      _proto.getCallbackCfg = function getCallbackCfg(fields, cfg, origin) {\n        if (!fields) {\n          return cfg;\n        }\n\n        var tmpCfg = {};\n        var params = fields.map(function (field) {\n          return origin[field];\n        });\n        each(cfg, function (v, k) {\n          if (isFunction(v)) {\n            tmpCfg[k] = v.apply(null, params);\n          } else {\n            tmpCfg[k] = v;\n          }\n        });\n        return tmpCfg;\n      };\n\n      _proto.getDrawCfg = function getDrawCfg(obj) {\n        var self = this;\n        var isInCircle = self.isInCircle();\n        var cfg = {\n          origin: obj,\n          x: obj.x,\n          y: obj.y,\n          color: obj.color,\n          size: obj.size,\n          shape: obj.shape,\n          isInCircle: isInCircle,\n          opacity: obj.opacity\n        };\n        var styleOptions = self.get('styleOptions');\n\n        if (styleOptions && styleOptions.style) {\n          cfg.style = self.getCallbackCfg(styleOptions.fields, styleOptions.style, obj[FIELD_ORIGIN]);\n        }\n\n        if (self.get('generatePoints')) {\n          cfg.points = obj.points;\n          cfg.nextPoints = obj.nextPoints;\n        }\n\n        if (isInCircle) {\n          cfg.center = self.get('coord').center;\n        }\n\n        return cfg;\n      };\n\n      _proto.draw = function draw(data, shapeFactory) {\n        var self = this;\n        var container = self.get('container');\n        var yScale = self.getYScale();\n        each(data, function (obj, index) {\n          if (yScale && isNil(obj._origin[yScale.field])) {\n            return;\n          }\n\n          obj.index = index;\n          var cfg = self.getDrawCfg(obj);\n          var shape = obj.shape;\n          self.drawShape(shape, obj, cfg, container, shapeFactory);\n        });\n      };\n\n      _proto.drawShape = function drawShape(shape, shapeData, cfg, container, shapeFactory) {\n        var gShape = shapeFactory.drawShape(shape, cfg, container);\n\n        if (gShape) {\n          each([].concat(gShape), function (s) {\n            s.set('origin', shapeData);\n          });\n        }\n      };\n\n      _proto._generatePoints = function _generatePoints(dataArray) {\n        var self = this;\n        var shapeFactory = self.getShapeFactory();\n        var shapeAttr = self.getAttr('shape');\n        each(dataArray, function (data) {\n          for (var i = 0, len = data.length; i < len; i++) {\n            var obj = data[i];\n            var cfg = self.createShapePointsCfg(obj);\n            var shape = shapeAttr ? self._getAttrValues(shapeAttr, obj) : null;\n            var points = shapeFactory.getShapePoints(shape, cfg);\n            obj.points = points;\n          }\n        }); // 添加nextPoints\n\n        each(dataArray, function (data, index) {\n          var nextData = dataArray[index + 1];\n\n          if (nextData) {\n            data[0].nextPoints = nextData[0].points;\n          }\n        });\n      } // 生成无障碍文本\n      ;\n\n      _proto.generateAria = function generateAria() {\n        var container = this.get('container');\n        var aria = container.get('aria');\n\n        if (!aria) {\n          return;\n        }\n\n        var ariaLables = [];\n        var coord = this.get('coord');\n        var xScale = this.getXScale();\n        var yScale = this.getYScale();\n        var coordAriaLabel = generateCoordAria(coord, xScale, yScale);\n        ariaLables.push(coordAriaLabel);\n        var _lang$geometry = lang.geometry,\n            prefix = _lang$geometry.prefix,\n            oneData = _lang$geometry.oneData,\n            partData = _lang$geometry.partData,\n            allData = _lang$geometry.allData;\n        var dataArray = this.get('dataArray');\n        var count = dataArray.length; // 只处理一个，不然太复杂\n\n        var groupScale = this._getGroupScales()[0];\n\n        if (groupScale) {\n          var prefixLabel = substitute(prefix, {\n            count: count\n          });\n          ariaLables.push(prefixLabel);\n          each(dataArray, function (data, index) {\n            var len = data.length;\n            if (!len) return;\n            var firstObj = data[0]._origin;\n\n            if (len === 1) {\n              ariaLables.push(substitute(oneData, {\n                index: index + 1,\n                count: len,\n                name: firstObj[groupScale.field],\n                values: firstObj[yScale.field]\n              }));\n            } else {\n              var template = len > 5 ? partData : allData;\n              var values = data.slice(0, 5).map(function (record) {\n                var _origin = record._origin;\n                var xValue = xScale.getText(_origin[xScale.field]);\n                var yValue = yScale.getText(_origin[yScale.field]);\n                return xValue + \":\" + yValue;\n              });\n              ariaLables.push(substitute(template, {\n                index: index + 1,\n                count: len,\n                part: 3,\n                name: firstObj[groupScale.field],\n                values: values.join(' ')\n              }));\n            }\n          });\n        }\n\n        container.set('ariaLabel', ariaLables.join(''));\n      }\n      /**\n       * get the info of each shape\n       * @protected\n       * @param  {Object} obj the data item\n       * @return {Object} cfg return the result\n       */\n      ;\n\n      _proto.createShapePointsCfg = function createShapePointsCfg(obj) {\n        var xScale = this.getXScale();\n        var yScale = this.getYScale();\n\n        var x = this._normalizeValues(obj[xScale.field], xScale);\n\n        var y;\n\n        if (yScale) {\n          y = this._normalizeValues(obj[yScale.field], yScale);\n        } else {\n          y = obj.y ? obj.y : 0.1;\n        }\n\n        return {\n          x: x,\n          y: y,\n          y0: yScale ? yScale.scale(this.getYMinValue()) : undefined\n        };\n      };\n\n      _proto.getYMinValue = function getYMinValue() {\n        var yScale = this.getYScale();\n        var min = yScale.min,\n            max = yScale.max;\n        var value;\n\n        if (this.get('startOnZero')) {\n          if (max <= 0 && min <= 0) {\n            value = max;\n          } else {\n            value = min >= 0 ? min : 0;\n          }\n        } else {\n          value = min;\n        }\n\n        return value;\n      };\n\n      _proto._normalizeValues = function _normalizeValues(values, scale) {\n        var rst = [];\n\n        if (isArray(values)) {\n          for (var i = 0, len = values.length; i < len; i++) {\n            var v = values[i];\n            rst.push(scale.scale(v));\n          }\n        } else {\n          rst = scale.scale(values);\n        }\n\n        return rst;\n      };\n\n      _proto.getAttr = function getAttr(name) {\n        return this.get('attrs')[name];\n      };\n\n      _proto.getXScale = function getXScale() {\n        return this.getAttr('position').scales[0];\n      };\n\n      _proto.getYScale = function getYScale() {\n        return this.getAttr('position').scales[1];\n      };\n\n      _proto.hasAdjust = function hasAdjust(adjust) {\n        return this.get('adjust') && this.get('adjust').type === adjust;\n      };\n\n      _proto._getSnap = function _getSnap(scale, item, arr) {\n        var i = 0;\n        var values;\n        var yField = this.getYScale().field; // 叠加的维度\n\n        if (this.hasAdjust('stack') && scale.field === yField) {\n          values = [];\n          arr.forEach(function (obj) {\n            values.push(obj[FIELD_ORIGIN_Y]);\n          });\n\n          for (var len = values.length; i < len; i++) {\n            if (values[0][0] > item) {\n              break;\n            }\n\n            if (values[values.length - 1][1] <= item) {\n              i = values.length - 1;\n              break;\n            }\n\n            if (values[i][0] <= item && values[i][1] > item) {\n              break;\n            }\n          }\n        } else {\n          values = scale.values;\n          values.sort(function (a, b) {\n            return a - b;\n          });\n\n          for (var _len2 = values.length; i < _len2; i++) {\n            // 如果只有1个点直接返回第1个点\n            if (_len2 <= 1) {\n              break;\n            } // 第1个点和第2个点之间\n\n\n            if ((values[0] + values[1]) / 2 > item) {\n              break;\n            } // 中间的点\n\n\n            if ((values[i - 1] + values[i]) / 2 <= item && (values[i + 1] + values[i]) / 2 > item) {\n              break;\n            } // 最后2个点\n\n\n            if ((values[values.length - 2] + values[values.length - 1]) / 2 <= item) {\n              i = values.length - 1;\n              break;\n            }\n          }\n        }\n\n        var result = values[i];\n        return result;\n      };\n\n      _proto.getSnapRecords = function getSnapRecords(point) {\n        var self = this;\n        var coord = self.get('coord');\n        var xScale = self.getXScale();\n        var yScale = self.getYScale();\n        var xfield = xScale.field;\n        var dataArray = self.get('dataArray');\n\n        if (!this.get('hasSorted')) {\n          this._sort(dataArray);\n        }\n\n        var rst = [];\n        var invertPoint = coord.invertPoint(point);\n        var invertPointX = invertPoint.x;\n\n        if (self.isInCircle() && !coord.transposed && invertPointX > (1 + xScale.rangeMax()) / 2) {\n          invertPointX = xScale.rangeMin();\n        }\n\n        var xValue = xScale.invert(invertPointX);\n\n        if (!xScale.isCategory) {\n          xValue = self._getSnap(xScale, xValue);\n        }\n\n        var tmp = [];\n        dataArray.forEach(function (data) {\n          data.forEach(function (obj) {\n            var originValue = isNil(obj[FIELD_ORIGIN]) ? obj[xfield] : obj[FIELD_ORIGIN][xfield];\n\n            if (self._isEqual(originValue, xValue, xScale)) {\n              tmp.push(obj);\n            }\n          });\n        }); // special for pie chart\n\n        if (this.hasAdjust('stack') && coord.isPolar && coord.transposed) {\n          if (invertPointX >= 0 && invertPointX <= 1) {\n            var yValue = yScale.invert(invertPoint.y);\n            yValue = self._getSnap(yScale, yValue, tmp);\n            tmp.forEach(function (obj) {\n              if (isArray(yValue) ? obj[FIELD_ORIGIN_Y].toString() === yValue.toString() : obj[FIELD_ORIGIN_Y] === yValue) {\n                rst.push(obj);\n              }\n            });\n          }\n        } else {\n          rst = tmp;\n        }\n\n        return rst;\n      };\n\n      _proto.getRecords = function getRecords(value) {\n        var _this = this;\n\n        var xScale = this.getXScale();\n        var dataArray = this.get('dataArray');\n        var xfield = xScale.field;\n        return dataArray.map(function (data) {\n          for (var len = data.length, i = len - 1; i >= 0; i--) {\n            var obj = data[i];\n            var originValue = isNil(obj[FIELD_ORIGIN]) ? obj[xfield] : obj[FIELD_ORIGIN][xfield];\n\n            if (_this._isEqual(originValue, value, xScale)) {\n              return obj;\n            }\n          }\n\n          return null;\n        });\n      };\n\n      _proto._isEqual = function _isEqual(originValue, value, scale) {\n        if (scale.type === 'timeCat') {\n          return toTimeStamp(originValue) === value;\n        }\n\n        return value === originValue;\n      };\n\n      _proto.position = function position(field) {\n        this._setAttrOptions('position', {\n          field: field\n        });\n\n        return this;\n      };\n\n      _proto.color = function color(field, values) {\n        this._createAttrOption('color', field, values, Global.colors);\n\n        return this;\n      };\n\n      _proto.size = function size(field, values) {\n        this._createAttrOption('size', field, values, Global.sizes);\n\n        return this;\n      };\n\n      _proto.shape = function shape(field, values) {\n        var type = this.get('type');\n        var shapes = Global.shapes[type] || [];\n\n        this._createAttrOption('shape', field, values, shapes);\n\n        return this;\n      };\n\n      _proto.style = function style(field, cfg) {\n        var styleOptions = this.get('styleOptions');\n\n        if (!styleOptions) {\n          styleOptions = {};\n          this.set('styleOptions', styleOptions);\n        }\n\n        if (isObject(field)) {\n          cfg = field;\n          field = null;\n        }\n\n        var fields;\n\n        if (field) {\n          fields = parseFields(field);\n        }\n\n        styleOptions.fields = fields;\n        styleOptions.style = cfg;\n        return this;\n      };\n\n      _proto.adjust = function adjust(type) {\n        if (isString(type)) {\n          type = {\n            type: type\n          };\n        }\n\n        this.set('adjust', type);\n        return this;\n      };\n\n      _proto.animate = function animate(cfg) {\n        this.set('animateCfg', cfg);\n        return this;\n      };\n\n      _proto.changeData = function changeData(data) {\n        this.set('data', data); // 改变数据后，情况度量，因为需要重新实例化\n\n        this.set('scales', {});\n        if (!this.get('isInit')) return;\n        this.set('isInit', false);\n        this.init();\n      };\n\n      _proto.clearInner = function clearInner() {\n        var container = this.get('container');\n\n        if (container) {\n          container.clear(); // container.setMatrix([ 1, 0, 0, 1, 0, 0 ]);\n        }\n      };\n\n      _proto.reset = function reset() {\n        this.set('isInit', false);\n        this.set('attrs', {});\n        this.set('attrOptions', {});\n        this.set('adjust', null);\n        this.clearInner();\n      };\n\n      _proto.clear = function clear() {\n        this.clearInner();\n      };\n\n      _proto.destroy = function destroy() {\n        this.set('isInit', false);\n        this.clear();\n\n        _Base.prototype.destroy.call(this);\n      };\n\n      _proto._display = function _display(visible) {\n        this.set('visible', visible);\n        var container = this.get('container');\n        var canvas = container.get('canvas');\n        container.set('visible', visible);\n        canvas.draw();\n      };\n\n      _proto.show = function show() {\n        this._display(true);\n      };\n\n      _proto.hide = function hide() {\n        this._display(false);\n      };\n\n      return Geom;\n    }(Base);\n\n    var methodCache = {};\n    /**\n     * 获取计算 ticks 的方法\n     * @param key 键值\n     * @returns 计算 ticks 的方法\n     */\n\n    function getTickMethod(key) {\n      return methodCache[key];\n    }\n    /**\n     * 注册计算 ticks 的方法\n     * @param key 键值\n     * @param method 方法\n     */\n\n    function registerTickMethod(key, method) {\n      methodCache[key] = method;\n    }\n\n    var Scale =\n    /** @class */\n    function () {\n      function Scale(cfg) {\n        /**\n         * 度量的类型\n         */\n        this.type = 'base';\n        /**\n         * 是否分类类型的度量\n         */\n\n        this.isCategory = false;\n        /**\n         * 是否线性度量，有linear, time 度量\n         */\n\n        this.isLinear = false;\n        /**\n         * 是否连续类型的度量，linear,time,log, pow, quantile, quantize 都支持\n         */\n\n        this.isContinuous = false;\n        /**\n         * 是否是常量的度量，传入和传出一致\n         */\n\n        this.isIdentity = false;\n        this.values = [];\n        this.range = [0, 1];\n        this.ticks = [];\n        this.__cfg__ = cfg;\n        this.initCfg();\n        this.init();\n      } // 对于原始值的必要转换，如分类、时间字段需转换成数值，用transform/map命名可能更好\n\n\n      Scale.prototype.translate = function (v) {\n        return v;\n      };\n      /** 重新初始化 */\n\n\n      Scale.prototype.change = function (cfg) {\n        // 覆盖配置项，而不替代\n        mix(this.__cfg__, cfg);\n        this.init();\n      };\n\n      Scale.prototype.clone = function () {\n        return this.constructor(this.__cfg__);\n      };\n      /** 获取坐标轴需要的ticks */\n\n\n      Scale.prototype.getTicks = function () {\n        var _this = this;\n\n        return map(this.ticks, function (tick, idx) {\n          if (isObject(tick)) {\n            // 仅当符合Tick类型时才有意义\n            return tick;\n          }\n\n          return {\n            text: _this.getText(tick, idx),\n            tickValue: tick,\n            value: _this.scale(tick)\n          };\n        });\n      };\n      /** 获取Tick的格式化结果 */\n\n\n      Scale.prototype.getText = function (value, key) {\n        var formatter = this.formatter;\n        var res = formatter ? formatter(value, key) : value;\n\n        if (isNil(res) || !isFunction(res.toString)) {\n          return '';\n        }\n\n        return res.toString();\n      }; // 获取配置项中的值，当前 scale 上的值可能会被修改\n\n\n      Scale.prototype.getConfig = function (key) {\n        return this.__cfg__[key];\n      }; // scale初始化\n\n\n      Scale.prototype.init = function () {\n        mix(this, this.__cfg__);\n        this.setDomain();\n\n        if (isEmpty(this.getConfig('ticks'))) {\n          this.ticks = this.calculateTicks();\n        }\n      }; // 子类上覆盖某些属性，不能直接在类上声明，否则会被覆盖\n\n\n      Scale.prototype.initCfg = function () {};\n\n      Scale.prototype.setDomain = function () {};\n\n      Scale.prototype.calculateTicks = function () {\n        var tickMethod = this.tickMethod;\n        var ticks = [];\n\n        if (isString(tickMethod)) {\n          var method = getTickMethod(tickMethod);\n\n          if (!method) {\n            throw new Error('There is no method to to calculate ticks!');\n          }\n\n          ticks = method(this);\n        } else if (isFunction(tickMethod)) {\n          ticks = tickMethod(this);\n        }\n\n        return ticks;\n      }; // range 的最小值\n\n\n      Scale.prototype.rangeMin = function () {\n        return head(this.range);\n      }; // range 的最大值\n\n\n      Scale.prototype.rangeMax = function () {\n        return last(this.range);\n      };\n      /** 定义域转 0~1 */\n\n\n      Scale.prototype.calcPercent = function (value, min, max) {\n        if (isNumber(value)) {\n          return (value - min) / (max - min);\n        }\n\n        return NaN;\n      };\n      /** 0~1转定义域 */\n\n\n      Scale.prototype.calcValue = function (percent, min, max) {\n        return min + percent * (max - min);\n      };\n\n      return Scale;\n    }();\n\n    /*! *****************************************************************************\r\n    Copyright (c) Microsoft Corporation.\r\n\r\n    Permission to use, copy, modify, and/or distribute this software for any\r\n    purpose with or without fee is hereby granted.\r\n\r\n    THE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\n    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\n    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\n    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\n    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\n    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\n    PERFORMANCE OF THIS SOFTWARE.\r\n    ***************************************************************************** */\n\n    /* global Reflect, Promise */\n    var extendStatics = function (d, b) {\n      extendStatics = Object.setPrototypeOf || {\n        __proto__: []\n      } instanceof Array && function (d, b) {\n        d.__proto__ = b;\n      } || function (d, b) {\n        for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n      };\n\n      return extendStatics(d, b);\n    };\n\n    function __extends(d, b) {\n      extendStatics(d, b);\n\n      function __() {\n        this.constructor = d;\n      }\n\n      d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    }\n    function __spreadArrays() {\n      for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\n\n      for (var r = Array(s), k = 0, i = 0; i < il; i++) for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++) r[k] = a[j];\n\n      return r;\n    }\n\n    /**\n     * 分类度量\n     * @class\n     */\n\n    var Category =\n    /** @class */\n    function (_super) {\n      __extends(Category, _super);\n\n      function Category() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n\n        _this.type = 'cat';\n        _this.isCategory = true;\n        return _this;\n      }\n\n      Category.prototype.translate = function (value) {\n        var index = indexOf(this.values, value);\n\n        if (index === -1) {\n          return isNumber(value) ? value : NaN;\n        }\n\n        return index;\n      };\n\n      Category.prototype.scale = function (value) {\n        var order = this.translate(value); // 分类数据允许 0.5 范围内调整\n        // if (order < this.min - 0.5 || order > this.max + 0.5) {\n        //   return NaN;\n        // }\n\n        var percent = this.calcPercent(order, this.min, this.max);\n        return this.calcValue(percent, this.rangeMin(), this.rangeMax());\n      };\n\n      Category.prototype.invert = function (scaledValue) {\n        var domainRange = this.max - this.min;\n        var percent = this.calcPercent(scaledValue, this.rangeMin(), this.rangeMax());\n        var idx = Math.round(domainRange * percent) + this.min;\n\n        if (idx < this.min || idx > this.max) {\n          return NaN;\n        }\n\n        return this.values[idx];\n      };\n\n      Category.prototype.getText = function (value) {\n        var args = [];\n\n        for (var _i = 1; _i < arguments.length; _i++) {\n          args[_i - 1] = arguments[_i];\n        }\n\n        var v = value; // value为index\n\n        if (isNumber(value) && !this.values.includes(value)) {\n          v = this.values[v];\n        }\n\n        return _super.prototype.getText.apply(this, __spreadArrays([v], args));\n      }; // 复写属性\n\n\n      Category.prototype.initCfg = function () {\n        this.tickMethod = 'cat';\n      }; // 设置 min, max\n\n\n      Category.prototype.setDomain = function () {\n        // 用户有可能设置 min\n        if (isNil(this.getConfig('min'))) {\n          this.min = 0;\n        }\n\n        if (isNil(this.getConfig('max'))) {\n          var size = this.values.length;\n          this.max = size > 1 ? size - 1 : size;\n        }\n      };\n\n      return Category;\n    }(Scale);\n\n    var token = /d{1,4}|M{1,4}|YY(?:YY)?|S{1,3}|Do|ZZ|Z|([HhMsDm])\\1?|[aA]|\"[^\"]*\"|'[^']*'/g;\n    var twoDigitsOptional = \"[1-9]\\\\d?\";\n    var twoDigits = \"\\\\d\\\\d\";\n    var threeDigits = \"\\\\d{3}\";\n    var fourDigits = \"\\\\d{4}\";\n    var word = \"[^\\\\s]+\";\n    var literal = /\\[([^]*?)\\]/gm;\n\n    function shorten(arr, sLen) {\n      var newArr = [];\n\n      for (var i = 0, len = arr.length; i < len; i++) {\n        newArr.push(arr[i].substr(0, sLen));\n      }\n\n      return newArr;\n    }\n\n    var monthUpdate = function (arrName) {\n      return function (v, i18n) {\n        var lowerCaseArr = i18n[arrName].map(function (v) {\n          return v.toLowerCase();\n        });\n        var index = lowerCaseArr.indexOf(v.toLowerCase());\n\n        if (index > -1) {\n          return index;\n        }\n\n        return null;\n      };\n    };\n\n    function assign(origObj) {\n      var args = [];\n\n      for (var _i = 1; _i < arguments.length; _i++) {\n        args[_i - 1] = arguments[_i];\n      }\n\n      for (var _a = 0, args_1 = args; _a < args_1.length; _a++) {\n        var obj = args_1[_a];\n\n        for (var key in obj) {\n          // @ts-ignore ex\n          origObj[key] = obj[key];\n        }\n      }\n\n      return origObj;\n    }\n\n    var dayNames = [\"Sunday\", \"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\", \"Friday\", \"Saturday\"];\n    var monthNames = [\"January\", \"February\", \"March\", \"April\", \"May\", \"June\", \"July\", \"August\", \"September\", \"October\", \"November\", \"December\"];\n    var monthNamesShort = shorten(monthNames, 3);\n    var dayNamesShort = shorten(dayNames, 3);\n    var defaultI18n = {\n      dayNamesShort: dayNamesShort,\n      dayNames: dayNames,\n      monthNamesShort: monthNamesShort,\n      monthNames: monthNames,\n      amPm: [\"am\", \"pm\"],\n      DoFn: function (dayOfMonth) {\n        return dayOfMonth + [\"th\", \"st\", \"nd\", \"rd\"][dayOfMonth % 10 > 3 ? 0 : (dayOfMonth - dayOfMonth % 10 !== 10 ? 1 : 0) * dayOfMonth % 10];\n      }\n    };\n    var globalI18n = assign({}, defaultI18n);\n\n    var setGlobalDateI18n = function (i18n) {\n      return globalI18n = assign(globalI18n, i18n);\n    };\n\n    var regexEscape = function (str) {\n      return str.replace(/[|\\\\{()[^$+*?.-]/g, \"\\\\$&\");\n    };\n\n    var pad = function (val, len) {\n      if (len === void 0) {\n        len = 2;\n      }\n\n      val = String(val);\n\n      while (val.length < len) {\n        val = \"0\" + val;\n      }\n\n      return val;\n    };\n\n    var formatFlags = {\n      D: function (dateObj) {\n        return String(dateObj.getDate());\n      },\n      DD: function (dateObj) {\n        return pad(dateObj.getDate());\n      },\n      Do: function (dateObj, i18n) {\n        return i18n.DoFn(dateObj.getDate());\n      },\n      d: function (dateObj) {\n        return String(dateObj.getDay());\n      },\n      dd: function (dateObj) {\n        return pad(dateObj.getDay());\n      },\n      ddd: function (dateObj, i18n) {\n        return i18n.dayNamesShort[dateObj.getDay()];\n      },\n      dddd: function (dateObj, i18n) {\n        return i18n.dayNames[dateObj.getDay()];\n      },\n      M: function (dateObj) {\n        return String(dateObj.getMonth() + 1);\n      },\n      MM: function (dateObj) {\n        return pad(dateObj.getMonth() + 1);\n      },\n      MMM: function (dateObj, i18n) {\n        return i18n.monthNamesShort[dateObj.getMonth()];\n      },\n      MMMM: function (dateObj, i18n) {\n        return i18n.monthNames[dateObj.getMonth()];\n      },\n      YY: function (dateObj) {\n        return pad(String(dateObj.getFullYear()), 4).substr(2);\n      },\n      YYYY: function (dateObj) {\n        return pad(dateObj.getFullYear(), 4);\n      },\n      h: function (dateObj) {\n        return String(dateObj.getHours() % 12 || 12);\n      },\n      hh: function (dateObj) {\n        return pad(dateObj.getHours() % 12 || 12);\n      },\n      H: function (dateObj) {\n        return String(dateObj.getHours());\n      },\n      HH: function (dateObj) {\n        return pad(dateObj.getHours());\n      },\n      m: function (dateObj) {\n        return String(dateObj.getMinutes());\n      },\n      mm: function (dateObj) {\n        return pad(dateObj.getMinutes());\n      },\n      s: function (dateObj) {\n        return String(dateObj.getSeconds());\n      },\n      ss: function (dateObj) {\n        return pad(dateObj.getSeconds());\n      },\n      S: function (dateObj) {\n        return String(Math.round(dateObj.getMilliseconds() / 100));\n      },\n      SS: function (dateObj) {\n        return pad(Math.round(dateObj.getMilliseconds() / 10), 2);\n      },\n      SSS: function (dateObj) {\n        return pad(dateObj.getMilliseconds(), 3);\n      },\n      a: function (dateObj, i18n) {\n        return dateObj.getHours() < 12 ? i18n.amPm[0] : i18n.amPm[1];\n      },\n      A: function (dateObj, i18n) {\n        return dateObj.getHours() < 12 ? i18n.amPm[0].toUpperCase() : i18n.amPm[1].toUpperCase();\n      },\n      ZZ: function (dateObj) {\n        var offset = dateObj.getTimezoneOffset();\n        return (offset > 0 ? \"-\" : \"+\") + pad(Math.floor(Math.abs(offset) / 60) * 100 + Math.abs(offset) % 60, 4);\n      },\n      Z: function (dateObj) {\n        var offset = dateObj.getTimezoneOffset();\n        return (offset > 0 ? \"-\" : \"+\") + pad(Math.floor(Math.abs(offset) / 60), 2) + \":\" + pad(Math.abs(offset) % 60, 2);\n      }\n    };\n\n    var monthParse = function (v) {\n      return +v - 1;\n    };\n\n    var emptyDigits = [null, twoDigitsOptional];\n    var emptyWord = [null, word];\n    var amPm = [\"isPm\", word, function (v, i18n) {\n      var val = v.toLowerCase();\n\n      if (val === i18n.amPm[0]) {\n        return 0;\n      } else if (val === i18n.amPm[1]) {\n        return 1;\n      }\n\n      return null;\n    }];\n    var timezoneOffset = [\"timezoneOffset\", \"[^\\\\s]*?[\\\\+\\\\-]\\\\d\\\\d:?\\\\d\\\\d|[^\\\\s]*?Z?\", function (v) {\n      var parts = (v + \"\").match(/([+-]|\\d\\d)/gi);\n\n      if (parts) {\n        var minutes = +parts[1] * 60 + parseInt(parts[2], 10);\n        return parts[0] === \"+\" ? minutes : -minutes;\n      }\n\n      return 0;\n    }];\n    var parseFlags = {\n      D: [\"day\", twoDigitsOptional],\n      DD: [\"day\", twoDigits],\n      Do: [\"day\", twoDigitsOptional + word, function (v) {\n        return parseInt(v, 10);\n      }],\n      M: [\"month\", twoDigitsOptional, monthParse],\n      MM: [\"month\", twoDigits, monthParse],\n      YY: [\"year\", twoDigits, function (v) {\n        var now = new Date();\n        var cent = +(\"\" + now.getFullYear()).substr(0, 2);\n        return +(\"\" + (+v > 68 ? cent - 1 : cent) + v);\n      }],\n      h: [\"hour\", twoDigitsOptional, undefined, \"isPm\"],\n      hh: [\"hour\", twoDigits, undefined, \"isPm\"],\n      H: [\"hour\", twoDigitsOptional],\n      HH: [\"hour\", twoDigits],\n      m: [\"minute\", twoDigitsOptional],\n      mm: [\"minute\", twoDigits],\n      s: [\"second\", twoDigitsOptional],\n      ss: [\"second\", twoDigits],\n      YYYY: [\"year\", fourDigits],\n      S: [\"millisecond\", \"\\\\d\", function (v) {\n        return +v * 100;\n      }],\n      SS: [\"millisecond\", twoDigits, function (v) {\n        return +v * 10;\n      }],\n      SSS: [\"millisecond\", threeDigits],\n      d: emptyDigits,\n      dd: emptyDigits,\n      ddd: emptyWord,\n      dddd: emptyWord,\n      MMM: [\"month\", word, monthUpdate(\"monthNamesShort\")],\n      MMMM: [\"month\", word, monthUpdate(\"monthNames\")],\n      a: amPm,\n      A: amPm,\n      ZZ: timezoneOffset,\n      Z: timezoneOffset\n    }; // Some common format strings\n\n    var globalMasks = {\n      default: \"ddd MMM DD YYYY HH:mm:ss\",\n      shortDate: \"M/D/YY\",\n      mediumDate: \"MMM D, YYYY\",\n      longDate: \"MMMM D, YYYY\",\n      fullDate: \"dddd, MMMM D, YYYY\",\n      isoDate: \"YYYY-MM-DD\",\n      isoDateTime: \"YYYY-MM-DDTHH:mm:ssZ\",\n      shortTime: \"HH:mm\",\n      mediumTime: \"HH:mm:ss\",\n      longTime: \"HH:mm:ss.SSS\"\n    };\n\n    var setGlobalDateMasks = function (masks) {\n      return assign(globalMasks, masks);\n    };\n    /***\n     * Format a date\n     * @method format\n     * @param {Date|number} dateObj\n     * @param {string} mask Format of the date, i.e. 'mm-dd-yy' or 'shortDate'\n     * @returns {string} Formatted date string\n     */\n\n\n    var format = function (dateObj, mask, i18n) {\n      if (mask === void 0) {\n        mask = globalMasks[\"default\"];\n      }\n\n      if (i18n === void 0) {\n        i18n = {};\n      }\n\n      if (typeof dateObj === \"number\") {\n        dateObj = new Date(dateObj);\n      }\n\n      if (Object.prototype.toString.call(dateObj) !== \"[object Date]\" || isNaN(dateObj.getTime())) {\n        throw new Error(\"Invalid Date pass to format\");\n      }\n\n      mask = globalMasks[mask] || mask;\n      var literals = []; // Make literals inactive by replacing them with @@@\n\n      mask = mask.replace(literal, function ($0, $1) {\n        literals.push($1);\n        return \"@@@\";\n      });\n      var combinedI18nSettings = assign(assign({}, globalI18n), i18n); // Apply formatting rules\n\n      mask = mask.replace(token, function ($0) {\n        return formatFlags[$0](dateObj, combinedI18nSettings);\n      }); // Inline literal values back into the formatted value\n\n      return mask.replace(/@@@/g, function () {\n        return literals.shift();\n      });\n    };\n    /**\n     * Parse a date string into a Javascript Date object /\n     * @method parse\n     * @param {string} dateStr Date string\n     * @param {string} format Date parse format\n     * @param {i18n} I18nSettingsOptional Full or subset of I18N settings\n     * @returns {Date|null} Returns Date object. Returns null what date string is invalid or doesn't match format\n     */\n\n\n    function parse(dateStr, format, i18n) {\n      if (i18n === void 0) {\n        i18n = {};\n      }\n\n      if (typeof format !== \"string\") {\n        throw new Error(\"Invalid format in fecha parse\");\n      } // Check to see if the format is actually a mask\n\n\n      format = globalMasks[format] || format; // Avoid regular expression denial of service, fail early for really long strings\n      // https://www.owasp.org/index.php/Regular_expression_Denial_of_Service_-_ReDoS\n\n      if (dateStr.length > 1000) {\n        return null;\n      } // Default to the beginning of the year.\n\n\n      var today = new Date();\n      var dateInfo = {\n        year: today.getFullYear(),\n        month: 0,\n        day: 1,\n        hour: 0,\n        minute: 0,\n        second: 0,\n        millisecond: 0,\n        isPm: null,\n        timezoneOffset: null\n      };\n      var parseInfo = [];\n      var literals = []; // Replace all the literals with @@@. Hopefully a string that won't exist in the format\n\n      var newFormat = format.replace(literal, function ($0, $1) {\n        literals.push(regexEscape($1));\n        return \"@@@\";\n      });\n      var specifiedFields = {};\n      var requiredFields = {}; // Change every token that we find into the correct regex\n\n      newFormat = regexEscape(newFormat).replace(token, function ($0) {\n        var info = parseFlags[$0];\n        var field = info[0],\n            regex = info[1],\n            requiredField = info[3]; // Check if the person has specified the same field twice. This will lead to confusing results.\n\n        if (specifiedFields[field]) {\n          throw new Error(\"Invalid format. \" + field + \" specified twice in format\");\n        }\n\n        specifiedFields[field] = true; // Check if there are any required fields. For instance, 12 hour time requires AM/PM specified\n\n        if (requiredField) {\n          requiredFields[requiredField] = true;\n        }\n\n        parseInfo.push(info);\n        return \"(\" + regex + \")\";\n      }); // Check all the required fields are present\n\n      Object.keys(requiredFields).forEach(function (field) {\n        if (!specifiedFields[field]) {\n          throw new Error(\"Invalid format. \" + field + \" is required in specified format\");\n        }\n      }); // Add back all the literals after\n\n      newFormat = newFormat.replace(/@@@/g, function () {\n        return literals.shift();\n      }); // Check if the date string matches the format. If it doesn't return null\n\n      var matches = dateStr.match(new RegExp(newFormat, \"i\"));\n\n      if (!matches) {\n        return null;\n      }\n\n      var combinedI18nSettings = assign(assign({}, globalI18n), i18n); // For each match, call the parser function for that date part\n\n      for (var i = 1; i < matches.length; i++) {\n        var _a = parseInfo[i - 1],\n            field = _a[0],\n            parser = _a[2];\n        var value = parser ? parser(matches[i], combinedI18nSettings) : +matches[i]; // If the parser can't make sense of the value, return null\n\n        if (value == null) {\n          return null;\n        }\n\n        dateInfo[field] = value;\n      }\n\n      if (dateInfo.isPm === 1 && dateInfo.hour != null && +dateInfo.hour !== 12) {\n        dateInfo.hour = +dateInfo.hour + 12;\n      } else if (dateInfo.isPm === 0 && +dateInfo.hour === 12) {\n        dateInfo.hour = 0;\n      }\n\n      var dateWithoutTZ = new Date(dateInfo.year, dateInfo.month, dateInfo.day, dateInfo.hour, dateInfo.minute, dateInfo.second, dateInfo.millisecond);\n      var validateFields = [[\"month\", \"getMonth\"], [\"day\", \"getDate\"], [\"hour\", \"getHours\"], [\"minute\", \"getMinutes\"], [\"second\", \"getSeconds\"]];\n\n      for (var i = 0, len = validateFields.length; i < len; i++) {\n        // Check to make sure the date field is within the allowed range. Javascript dates allows values\n        // outside the allowed range. If the values don't match the value was invalid\n        if (specifiedFields[validateFields[i][0]] && dateInfo[validateFields[i][0]] !== dateWithoutTZ[validateFields[i][1]]()) {\n          return null;\n        }\n      }\n\n      if (dateInfo.timezoneOffset == null) {\n        return dateWithoutTZ;\n      }\n\n      return new Date(Date.UTC(dateInfo.year, dateInfo.month, dateInfo.day, dateInfo.hour, dateInfo.minute - dateInfo.timezoneOffset, dateInfo.second, dateInfo.millisecond));\n    }\n\n    var fecha = {\n      format: format,\n      parse: parse,\n      defaultI18n: defaultI18n,\n      setGlobalDateI18n: setGlobalDateI18n,\n      setGlobalDateMasks: setGlobalDateMasks\n    };\n\n    var fecha1 = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        'default': fecha,\n        assign: assign,\n        format: format,\n        parse: parse,\n        defaultI18n: defaultI18n,\n        setGlobalDateI18n: setGlobalDateI18n,\n        setGlobalDateMasks: setGlobalDateMasks\n    });\n\n    /**\n     * 二分右侧查找\n     * https://github.com/d3/d3-array/blob/master/src/bisector.js\n     */\n\n    function bisector (getter) {\n      /**\n       * x: 目标值\n       * lo: 起始位置\n       * hi: 结束位置\n       */\n      return function (a, x, _lo, _hi) {\n        var lo = isNil(_lo) ? 0 : _lo;\n        var hi = isNil(_hi) ? a.length : _hi;\n\n        while (lo < hi) {\n          var mid = lo + hi >>> 1;\n\n          if (getter(a[mid]) > x) {\n            hi = mid;\n          } else {\n            lo = mid + 1;\n          }\n        }\n\n        return lo;\n      };\n    }\n\n    var FORMAT_METHOD = 'format';\n    function timeFormat(time, mask) {\n      var method = fecha1[FORMAT_METHOD] || fecha[FORMAT_METHOD];\n      return method(time, mask);\n    }\n    /**\n     * 转换成时间戳\n     * @param value 时间值\n     */\n\n    function toTimeStamp$1(value) {\n      if (isString(value)) {\n        if (value.indexOf('T') > 0) {\n          value = new Date(value).getTime();\n        } else {\n          // new Date('2010/01/10') 和 new Date('2010-01-10') 的差别在于:\n          // 如果仅有年月日时，前者是带有时区的: Fri Jan 10 2020 02:40:13 GMT+0800 (中国标准时间)\n          // 后者会格式化成 Sun Jan 10 2010 08:00:00 GMT+0800 (中国标准时间)\n          value = new Date(value.replace(/-/gi, '/')).getTime();\n        }\n      }\n\n      if (isDate(value)) {\n        value = value.getTime();\n      }\n\n      return value;\n    }\n    var SECOND = 1000;\n    var MINUTE = 60 * SECOND;\n    var HOUR = 60 * MINUTE;\n    var DAY = 24 * HOUR;\n    var MONTH = DAY * 31;\n    var YEAR = DAY * 365;\n    var intervals = [['HH:mm:ss', SECOND], ['HH:mm:ss', SECOND * 10], ['HH:mm:ss', SECOND * 30], ['HH:mm', MINUTE], ['HH:mm', MINUTE * 10], ['HH:mm', MINUTE * 30], ['HH', HOUR], ['HH', HOUR * 6], ['HH', HOUR * 12], ['YYYY-MM-DD', DAY], ['YYYY-MM-DD', DAY * 4], ['YYYY-WW', DAY * 7], ['YYYY-MM', MONTH], ['YYYY-MM', MONTH * 4], ['YYYY-MM', MONTH * 6], ['YYYY', DAY * 380]];\n    function getTickInterval(min, max, tickCount) {\n      var target = (max - min) / tickCount;\n      var idx = bisector(function (o) {\n        return o[1];\n      })(intervals, target) - 1;\n      var interval = intervals[idx];\n\n      if (idx < 0) {\n        interval = intervals[0];\n      } else if (idx >= intervals.length) {\n        interval = last(intervals);\n      }\n\n      return interval;\n    }\n\n    /**\n     * 时间分类度量\n     * @class\n     */\n\n    var TimeCat =\n    /** @class */\n    function (_super) {\n      __extends(TimeCat, _super);\n\n      function TimeCat() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n\n        _this.type = 'timeCat';\n        return _this;\n      }\n      /**\n       * @override\n       */\n\n\n      TimeCat.prototype.translate = function (value) {\n        value = toTimeStamp$1(value);\n        var index = this.values.indexOf(value);\n\n        if (index === -1) {\n          if (isNumber(value) && value < this.values.length) {\n            index = value;\n          } else {\n            index = NaN;\n          }\n        }\n\n        return index;\n      };\n      /**\n       * 由于时间类型数据需要转换一下，所以复写 getText\n       * @override\n       */\n\n\n      TimeCat.prototype.getText = function (value, tickIndex) {\n        var index = this.translate(value);\n\n        if (index > -1) {\n          var result = this.values[index];\n          var formatter = this.formatter;\n          result = formatter ? formatter(result, tickIndex) : timeFormat(result, this.mask);\n          return result;\n        }\n\n        return value;\n      };\n\n      TimeCat.prototype.initCfg = function () {\n        this.tickMethod = 'time-cat';\n        this.mask = 'YYYY-MM-DD';\n        this.tickCount = 7; // 一般时间数据会显示 7， 14， 30 天的数字\n      };\n\n      TimeCat.prototype.setDomain = function () {\n        var values = this.values; // 针对时间分类类型，会将时间统一转换为时间戳\n\n        each(values, function (v, i) {\n          values[i] = toTimeStamp$1(v);\n        });\n        values.sort(function (v1, v2) {\n          return v1 - v2;\n        });\n\n        _super.prototype.setDomain.call(this);\n      };\n\n      return TimeCat;\n    }(Category);\n\n    /**\n     * 连续度量的基类\n     * @class\n     */\n\n    var Continuous =\n    /** @class */\n    function (_super) {\n      __extends(Continuous, _super);\n\n      function Continuous() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n\n        _this.isContinuous = true;\n        return _this;\n      }\n\n      Continuous.prototype.scale = function (value) {\n        if (isNil(value)) {\n          return NaN;\n        }\n\n        var rangeMin = this.rangeMin();\n        var rangeMax = this.rangeMax();\n        var max = this.max;\n        var min = this.min;\n\n        if (max === min) {\n          return rangeMin;\n        }\n\n        var percent = this.getScalePercent(value);\n        return rangeMin + percent * (rangeMax - rangeMin);\n      };\n\n      Continuous.prototype.init = function () {\n        _super.prototype.init.call(this); // init 完成后保证 min, max 包含 ticks 的范围\n\n\n        var ticks = this.ticks;\n        var firstTick = head(ticks);\n        var lastTick = last(ticks);\n\n        if (firstTick < this.min) {\n          this.min = firstTick;\n        }\n\n        if (lastTick > this.max) {\n          this.max = lastTick;\n        } // strict-limit 方式\n\n\n        if (!isNil(this.minLimit)) {\n          this.min = firstTick;\n        }\n\n        if (!isNil(this.maxLimit)) {\n          this.max = lastTick;\n        }\n      };\n\n      Continuous.prototype.setDomain = function () {\n        var _a = getRange(this.values),\n            min = _a.min,\n            max = _a.max;\n\n        if (isNil(this.min)) {\n          this.min = min;\n        }\n\n        if (isNil(this.max)) {\n          this.max = max;\n        }\n\n        if (this.min > this.max) {\n          this.min = min;\n          this.max = max;\n        }\n      };\n\n      Continuous.prototype.calculateTicks = function () {\n        var _this = this;\n\n        var ticks = _super.prototype.calculateTicks.call(this);\n\n        if (!this.nice) {\n          ticks = filter(ticks, function (tick) {\n            return tick >= _this.min && tick <= _this.max;\n          });\n        }\n\n        return ticks;\n      }; // 计算原始值值占的百分比\n\n\n      Continuous.prototype.getScalePercent = function (value) {\n        var max = this.max;\n        var min = this.min;\n        return (value - min) / (max - min);\n      };\n\n      Continuous.prototype.getInvertPercent = function (value) {\n        return (value - this.rangeMin()) / (this.rangeMax() - this.rangeMin());\n      };\n\n      return Continuous;\n    }(Scale);\n\n    /**\n     * 线性度量\n     * @class\n     */\n\n    var Linear =\n    /** @class */\n    function (_super) {\n      __extends(Linear, _super);\n\n      function Linear() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n\n        _this.type = 'linear';\n        _this.isLinear = true;\n        return _this;\n      }\n\n      Linear.prototype.invert = function (value) {\n        var percent = this.getInvertPercent(value);\n        return this.min + percent * (this.max - this.min);\n      };\n\n      Linear.prototype.initCfg = function () {\n        this.tickMethod = 'wilkinson-extended';\n        this.nice = false;\n      };\n\n      return Linear;\n    }(Continuous);\n\n    // 虽然数学上 b 不支持负数，但是这里需要支持 负数\n\n    function calBase(a, b) {\n      var e = Math.E;\n      var value;\n\n      if (b >= 0) {\n        value = Math.pow(e, Math.log(b) / a); // 使用换底公式求底\n      } else {\n        value = Math.pow(e, Math.log(-b) / a) * -1; // 使用换底公式求底\n      }\n\n      return value;\n    }\n    function log(a, b) {\n      if (a === 1) {\n        return 1;\n      }\n\n      return Math.log(b) / Math.log(a);\n    }\n    function getLogPositiveMin(values, base, max) {\n      if (isNil(max)) {\n        max = Math.max.apply(null, values);\n      }\n\n      var positiveMin = max;\n      each(values, function (value) {\n        if (value > 0 && value < positiveMin) {\n          positiveMin = value;\n        }\n      });\n\n      if (positiveMin === max) {\n        positiveMin = max / base;\n      }\n\n      if (positiveMin > 1) {\n        positiveMin = 1;\n      }\n\n      return positiveMin;\n    }\n\n    /**\n     * Log 度量，处理非均匀分布\n     */\n\n    var Log =\n    /** @class */\n    function (_super) {\n      __extends(Log, _super);\n\n      function Log() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n\n        _this.type = 'log';\n        return _this;\n      }\n      /**\n       * @override\n       */\n\n\n      Log.prototype.invert = function (value) {\n        var base = this.base;\n        var max = log(base, this.max);\n        var rangeMin = this.rangeMin();\n        var range = this.rangeMax() - rangeMin;\n        var min;\n        var positiveMin = this.positiveMin;\n\n        if (positiveMin) {\n          if (value === 0) {\n            return 0;\n          }\n\n          min = log(base, positiveMin / base);\n          var appendPercent = 1 / (max - min) * range; // 0 到 positiveMin的占比\n\n          if (value < appendPercent) {\n            // 落到 0 - positiveMin 之间\n            return value / appendPercent * positiveMin;\n          }\n        } else {\n          min = log(base, this.min);\n        }\n\n        var percent = (value - rangeMin) / range;\n        var tmp = percent * (max - min) + min;\n        return Math.pow(base, tmp);\n      };\n\n      Log.prototype.initCfg = function () {\n        this.tickMethod = 'log';\n        this.base = 10;\n        this.tickCount = 6;\n        this.nice = true;\n      }; // 设置\n\n\n      Log.prototype.setDomain = function () {\n        _super.prototype.setDomain.call(this);\n\n        var min = this.min;\n\n        if (min < 0) {\n          throw new Error('When you use log scale, the minimum value must be greater than zero!');\n        }\n\n        if (min === 0) {\n          this.positiveMin = getLogPositiveMin(this.values, this.base, this.max);\n        }\n      }; // 根据当前值获取占比\n\n\n      Log.prototype.getScalePercent = function (value) {\n        var max = this.max;\n        var min = this.min;\n\n        if (max === min) {\n          return 0;\n        } // 如果值小于等于0，则按照0处理\n\n\n        if (value <= 0) {\n          return 0;\n        }\n\n        var base = this.base;\n        var positiveMin = this.positiveMin; // 如果min == 0, 则根据比0大的最小值，计算比例关系。这个最小值作为坐标轴上的第二个tick，第一个是0但是不显示\n\n        if (positiveMin) {\n          min = positiveMin * 1 / base;\n        }\n\n        var percent; // 如果数值小于次小值，那么就计算 value / 次小值 占整体的比例\n\n        if (value < positiveMin) {\n          percent = value / positiveMin / (log(base, max) - log(base, min));\n        } else {\n          percent = (log(base, value) - log(base, min)) / (log(base, max) - log(base, min));\n        }\n\n        return percent;\n      };\n\n      return Log;\n    }(Continuous);\n\n    /**\n     * Pow 度量，处理非均匀分布\n     */\n\n    var Pow =\n    /** @class */\n    function (_super) {\n      __extends(Pow, _super);\n\n      function Pow() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n\n        _this.type = 'pow';\n        return _this;\n      }\n      /**\n       * @override\n       */\n\n\n      Pow.prototype.invert = function (value) {\n        var percent = this.getInvertPercent(value);\n        var exponent = this.exponent;\n        var max = calBase(exponent, this.max);\n        var min = calBase(exponent, this.min);\n        var tmp = percent * (max - min) + min;\n        var factor = tmp >= 0 ? 1 : -1;\n        return Math.pow(tmp, exponent) * factor;\n      };\n\n      Pow.prototype.initCfg = function () {\n        this.tickMethod = 'pow';\n        this.exponent = 2;\n        this.tickCount = 5;\n        this.nice = true;\n      }; // 获取度量计算时，value占的定义域百分比\n\n\n      Pow.prototype.getScalePercent = function (value) {\n        var max = this.max;\n        var min = this.min;\n\n        if (max === min) {\n          return 0;\n        }\n\n        var exponent = this.exponent;\n        var percent = (calBase(exponent, value) - calBase(exponent, min)) / (calBase(exponent, max) - calBase(exponent, min));\n        return percent;\n      };\n\n      return Pow;\n    }(Continuous);\n\n    /**\n     * 时间度量\n     * @class\n     */\n\n    var Time =\n    /** @class */\n    function (_super) {\n      __extends(Time, _super);\n\n      function Time() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n\n        _this.type = 'time';\n        return _this;\n      }\n      /**\n       * @override\n       */\n\n\n      Time.prototype.getText = function (value, index) {\n        var numberValue = this.translate(value);\n        var formatter = this.formatter;\n        return formatter ? formatter(numberValue, index) : timeFormat(numberValue, this.mask);\n      };\n      /**\n       * @override\n       */\n\n\n      Time.prototype.scale = function (value) {\n        var v = value;\n\n        if (isString(v) || isDate(v)) {\n          v = this.translate(v);\n        }\n\n        return _super.prototype.scale.call(this, v);\n      };\n      /**\n       * 将时间转换成数字\n       * @override\n       */\n\n\n      Time.prototype.translate = function (v) {\n        return toTimeStamp$1(v);\n      };\n\n      Time.prototype.initCfg = function () {\n        this.tickMethod = 'time-pretty';\n        this.mask = 'YYYY-MM-DD';\n        this.tickCount = 7;\n        this.nice = false;\n      };\n\n      Time.prototype.setDomain = function () {\n        var values = this.values; // 是否设置了 min, max，而不是直接取 this.min, this.max\n\n        var minConfig = this.getConfig('min');\n        var maxConfig = this.getConfig('max'); // 如果设置了 min,max 则转换成时间戳\n\n        if (!isNil(minConfig) || !isNumber(minConfig)) {\n          this.min = this.translate(this.min);\n        }\n\n        if (!isNil(maxConfig) || !isNumber(maxConfig)) {\n          this.max = this.translate(this.max);\n        } // 没有设置 min, max 时\n\n\n        if (values && values.length) {\n          // 重新计算最大最小值\n          var timeStamps_1 = [];\n          var min_1 = Infinity; // 最小值\n\n          var secondMin_1 = min_1; // 次小值\n\n          var max_1 = 0; // 使用一个循环，计算min,max,secondMin\n\n          each(values, function (v) {\n            var timeStamp = toTimeStamp$1(v);\n\n            if (isNaN(timeStamp)) {\n              throw new TypeError(\"Invalid Time: \" + v + \" in time scale!\");\n            }\n\n            if (min_1 > timeStamp) {\n              secondMin_1 = min_1;\n              min_1 = timeStamp;\n            } else if (secondMin_1 > timeStamp) {\n              secondMin_1 = timeStamp;\n            }\n\n            if (max_1 < timeStamp) {\n              max_1 = timeStamp;\n            }\n\n            timeStamps_1.push(timeStamp);\n          }); // 存在多个值时，设置最小间距\n\n          if (values.length > 1) {\n            this.minTickInterval = secondMin_1 - min_1;\n          }\n\n          if (isNil(minConfig)) {\n            this.min = min_1;\n          }\n\n          if (isNil(maxConfig)) {\n            this.max = max_1;\n          }\n        }\n      };\n\n      return Time;\n    }(Linear);\n\n    /**\n     * 分段度量\n     */\n\n    var Quantize =\n    /** @class */\n    function (_super) {\n      __extends(Quantize, _super);\n\n      function Quantize() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n\n        _this.type = 'quantize';\n        return _this;\n      }\n\n      Quantize.prototype.invert = function (value) {\n        var ticks = this.ticks;\n        var length = ticks.length;\n        var percent = this.getInvertPercent(value);\n        var minIndex = Math.floor(percent * (length - 1)); // 最后一个\n\n        if (minIndex >= length - 1) {\n          return last(ticks);\n        } // 超出左边界， 则取第一个\n\n\n        if (minIndex < 0) {\n          return head(ticks);\n        }\n\n        var minTick = ticks[minIndex];\n        var nextTick = ticks[minIndex + 1]; // 比当前值小的 tick 在度量上的占比\n\n        var minIndexPercent = minIndex / (length - 1);\n        var maxIndexPercent = (minIndex + 1) / (length - 1);\n        return minTick + (percent - minIndexPercent) / (maxIndexPercent - minIndexPercent) * (nextTick - minTick);\n      };\n\n      Quantize.prototype.initCfg = function () {\n        this.tickMethod = 'r-pretty';\n        this.tickCount = 5;\n        this.nice = true;\n      };\n\n      Quantize.prototype.calculateTicks = function () {\n        var ticks = _super.prototype.calculateTicks.call(this);\n\n        if (!this.nice) {\n          // 如果 nice = false ,补充 min, max\n          if (last(ticks) !== this.max) {\n            ticks.push(this.max);\n          }\n\n          if (head(ticks) !== this.min) {\n            ticks.unshift(this.min);\n          }\n        }\n\n        return ticks;\n      }; // 计算当前值在刻度中的占比\n\n\n      Quantize.prototype.getScalePercent = function (value) {\n        var ticks = this.ticks; // 超出左边界\n\n        if (value < head(ticks)) {\n          return 0;\n        } // 超出右边界\n\n\n        if (value > last(ticks)) {\n          return 1;\n        }\n\n        var minIndex = 0;\n        each(ticks, function (tick, index) {\n          if (value >= tick) {\n            minIndex = index;\n          } else {\n            return false;\n          }\n        });\n        return minIndex / (ticks.length - 1);\n      };\n\n      return Quantize;\n    }(Continuous);\n\n    var Quantile =\n    /** @class */\n    function (_super) {\n      __extends(Quantile, _super);\n\n      function Quantile() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n\n        _this.type = 'quantile';\n        return _this;\n      }\n\n      Quantile.prototype.initCfg = function () {\n        this.tickMethod = 'quantile';\n        this.tickCount = 5;\n        this.nice = true;\n      };\n\n      return Quantile;\n    }(Quantize);\n\n    var map$1 = {};\n\n    function getClass(key) {\n      return map$1[key];\n    }\n\n    function registerClass(key, cls) {\n      if (getClass(key)) {\n        throw new Error(\"type '\" + key + \"' existed.\");\n      }\n\n      map$1[key] = cls;\n    }\n\n    /**\n     * identity scale原则上是定义域和值域一致，scale/invert方法也是一致的\n     * 参考R的实现：https://github.com/r-lib/scales/blob/master/R/pal-identity.r\n     * 参考d3的实现（做了下转型）：https://github.com/d3/d3-scale/blob/master/src/identity.js\n     */\n\n    var Identity =\n    /** @class */\n    function (_super) {\n      __extends(Identity, _super);\n\n      function Identity() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n\n        _this.type = 'identity';\n        _this.isIdentity = true;\n        return _this;\n      }\n\n      Identity.prototype.calculateTicks = function () {\n        return this.values;\n      };\n\n      Identity.prototype.scale = function (value) {\n        // 如果传入的值不等于 identity 的值，则直接返回，用于一维图时的 dodge\n        if (this.values[0] !== value && isNumber(value)) {\n          return value;\n        }\n\n        return this.range[0];\n      };\n\n      Identity.prototype.invert = function (value) {\n        var range = this.range;\n\n        if (value < range[0] || value > range[1]) {\n          return NaN;\n        }\n\n        return this.values[0];\n      };\n\n      return Identity;\n    }(Scale);\n\n    var DEFAULT_Q = [1, 5, 2, 2.5, 4, 3];\n    var eps = Number.EPSILON * 100; // https://stackoverflow.com/questions/4467539/javascript-modulo-gives-a-negative-result-for-negative-numbers\n\n    function mod(n, m) {\n      return (n % m + m) % m;\n    }\n\n    function simplicity(q, Q, j, lmin, lmax, lstep) {\n      var n = size(Q);\n      var i = indexOf(Q, q);\n      var v = 0;\n      var m = mod(lmin, lstep);\n\n      if ((m < eps || lstep - m < eps) && lmin <= 0 && lmax >= 0) {\n        v = 1;\n      }\n\n      return 1 - i / (n - 1) - j + v;\n    }\n\n    function simplicityMax(q, Q, j) {\n      var n = size(Q);\n      var i = indexOf(Q, q);\n      var v = 1;\n      return 1 - i / (n - 1) - j + v;\n    }\n\n    function density(k, m, dmin, dmax, lmin, lmax) {\n      var r = (k - 1) / (lmax - lmin);\n      var rt = (m - 1) / (Math.max(lmax, dmax) - Math.min(dmin, lmin));\n      return 2 - Math.max(r / rt, rt / r);\n    }\n\n    function densityMax(k, m) {\n      if (k >= m) {\n        return 2 - (k - 1) / (m - 1);\n      }\n\n      return 1;\n    }\n\n    function coverage(dmin, dmax, lmin, lmax) {\n      var range = dmax - dmin;\n      return 1 - 0.5 * (Math.pow(dmax - lmax, 2) + Math.pow(dmin - lmin, 2)) / Math.pow(0.1 * range, 2);\n    }\n\n    function coverageMax(dmin, dmax, span) {\n      var range = dmax - dmin;\n\n      if (span > range) {\n        var half = (span - range) / 2;\n        return 1 - Math.pow(half, 2) / Math.pow(0.1 * range, 2);\n      }\n\n      return 1;\n    }\n\n    function legibility() {\n      return 1;\n    }\n    /**\n     * An Extension of Wilkinson's Algorithm for Position Tick Labels on Axes\n     * https://www.yuque.com/preview/yuque/0/2019/pdf/185317/1546999150858-45c3b9c2-4e86-4223-bf1a-8a732e8195ed.pdf\n     * @param dmin 最小值\n     * @param dmax 最大值\n     * @param m tick个数\n     * @param onlyLoose 是否允许扩展min、max，不绝对强制，例如[3, 97]\n     * @param Q nice numbers集合\n     * @param w 四个优化组件的权重\n     */\n\n\n    function extended(dmin, dmax, m, onlyLoose, Q, w) {\n      if (m === void 0) {\n        m = 5;\n      }\n\n      if (onlyLoose === void 0) {\n        onlyLoose = true;\n      }\n\n      if (Q === void 0) {\n        Q = DEFAULT_Q;\n      }\n\n      if (w === void 0) {\n        w = [0.25, 0.2, 0.5, 0.05];\n      } // 异常数据情况下，直接返回，防止 oom\n\n\n      if (typeof dmin !== 'number' || typeof dmax !== 'number') {\n        return {\n          min: 0,\n          max: 0,\n          ticks: []\n        };\n      }\n\n      if (dmin === dmax || m === 1) {\n        return {\n          min: dmin,\n          max: dmax,\n          ticks: [dmin]\n        };\n      }\n\n      var best = {\n        score: -2,\n        lmin: 0,\n        lmax: 0,\n        lstep: 0\n      };\n      var j = 1;\n\n      while (j < Infinity) {\n        for (var _i = 0, Q_1 = Q; _i < Q_1.length; _i++) {\n          var q = Q_1[_i];\n          var sm = simplicityMax(q, Q, j);\n\n          if (Number.isNaN(sm)) {\n            throw new Error('NaN');\n          }\n\n          if (w[0] * sm + w[1] + w[2] + w[3] < best.score) {\n            j = Infinity;\n            break;\n          }\n\n          var k = 2;\n\n          while (k < Infinity) {\n            var dm = densityMax(k, m);\n\n            if (w[0] * sm + w[1] + w[2] * dm + w[3] < best.score) {\n              break;\n            }\n\n            var delta = (dmax - dmin) / (k + 1) / j / q;\n            var z = Math.ceil(Math.log10(delta));\n\n            while (z < Infinity) {\n              var step = j * q * Math.pow(10, z);\n              var cm = coverageMax(dmin, dmax, step * (k - 1));\n\n              if (w[0] * sm + w[1] * cm + w[2] * dm + w[3] < best.score) {\n                break;\n              }\n\n              var minStart = Math.floor(dmax / step) * j - (k - 1) * j;\n              var maxStart = Math.ceil(dmin / step) * j;\n\n              if (minStart > maxStart) {\n                z = z + 1;\n                continue;\n              }\n\n              for (var start = minStart; start <= maxStart; start = start + 1) {\n                var lmin = start * (step / j);\n                var lmax = lmin + step * (k - 1);\n                var lstep = step;\n                var s = simplicity(q, Q, j, lmin, lmax, lstep);\n                var c = coverage(dmin, dmax, lmin, lmax);\n                var g = density(k, m, dmin, dmax, lmin, lmax);\n                var l = legibility();\n                var score = w[0] * s + w[1] * c + w[2] * g + w[3] * l;\n\n                if (score > best.score && (!onlyLoose || lmin <= dmin && lmax >= dmax)) {\n                  best.lmin = lmin;\n                  best.lmax = lmax;\n                  best.lstep = lstep;\n                  best.score = score;\n                }\n              }\n\n              z = z + 1;\n            }\n\n            k = k + 1;\n          }\n        }\n\n        j = j + 1;\n      } // 步长为浮点数时处理精度\n\n\n      var toFixed = Number.isInteger(best.lstep) ? 0 : Math.ceil(Math.abs(Math.log10(best.lstep)));\n      var range = [];\n\n      for (var tick = best.lmin; tick <= best.lmax; tick += best.lstep) {\n        range.push(tick);\n      }\n\n      var ticks = toFixed ? map(range, function (x) {\n        return Number.parseFloat(x.toFixed(toFixed));\n      }) : range;\n      return {\n        min: Math.min(dmin, head(ticks)),\n        max: Math.max(dmax, last(ticks)),\n        ticks: ticks\n      };\n    }\n\n    /**\n     * 计算分类 ticks\n     * @param cfg 度量的配置项\n     * @returns 计算后的 ticks\n     */\n\n    function calculateCatTicks(cfg) {\n      var values = cfg.values,\n          tickInterval = cfg.tickInterval,\n          tickCount = cfg.tickCount;\n      var ticks = values;\n\n      if (isNumber(tickInterval)) {\n        return filter(ticks, function (__, i) {\n          return i % tickInterval === 0;\n        });\n      }\n\n      var min = cfg.min,\n          max = cfg.max;\n\n      if (isNil(min)) {\n        min = 0;\n      }\n\n      if (isNil(max)) {\n        max = values.length - 1;\n      }\n\n      if (isNumber(tickCount) && tickCount < max - min) {\n        // 简单过滤，部分情况下小数的倍数也可以是整数\n        // tslint:disable-next-line: no-shadowed-variable\n        var ticks_1 = extended(min, max, tickCount, false, [1, 2, 5, 3, 4, 7, 6, 8, 9]).ticks;\n        var valid = filter(ticks_1, function (tick) {\n          return tick >= min && tick <= max;\n        });\n        return valid.map(function (index) {\n          return values[index];\n        });\n      }\n\n      return values.slice(min, max + 1);\n    }\n\n    function d3Linear(cfg) {\n      var min = cfg.min,\n          max = cfg.max,\n          nice = cfg.nice,\n          tickCount = cfg.tickCount;\n      var linear = new D3Linear();\n      linear.domain([min, max]);\n\n      if (nice) {\n        linear.nice(tickCount);\n      }\n\n      return linear.ticks(tickCount);\n    }\n    var DEFAULT_COUNT = 5;\n    var e10 = Math.sqrt(50);\n    var e5 = Math.sqrt(10);\n    var e2 = Math.sqrt(2); // https://github.com/d3/d3-scale\n\n    var D3Linear =\n    /** @class */\n    function () {\n      function D3Linear() {\n        this._domain = [0, 1];\n      }\n\n      D3Linear.prototype.domain = function (domain) {\n        if (domain) {\n          this._domain = Array.from(domain, Number);\n          return this;\n        }\n\n        return this._domain.slice();\n      };\n\n      D3Linear.prototype.nice = function (count) {\n        var _a, _b;\n\n        if (count === void 0) {\n          count = DEFAULT_COUNT;\n        }\n\n        var d = this._domain.slice();\n\n        var i0 = 0;\n        var i1 = this._domain.length - 1;\n        var start = this._domain[i0];\n        var stop = this._domain[i1];\n        var step;\n\n        if (stop < start) {\n          _a = [stop, start], start = _a[0], stop = _a[1];\n          _b = [i1, i0], i0 = _b[0], i1 = _b[1];\n        }\n\n        step = tickIncrement(start, stop, count);\n\n        if (step > 0) {\n          start = Math.floor(start / step) * step;\n          stop = Math.ceil(stop / step) * step;\n          step = tickIncrement(start, stop, count);\n        } else if (step < 0) {\n          start = Math.ceil(start * step) / step;\n          stop = Math.floor(stop * step) / step;\n          step = tickIncrement(start, stop, count);\n        }\n\n        if (step > 0) {\n          d[i0] = Math.floor(start / step) * step;\n          d[i1] = Math.ceil(stop / step) * step;\n          this.domain(d);\n        } else if (step < 0) {\n          d[i0] = Math.ceil(start * step) / step;\n          d[i1] = Math.floor(stop * step) / step;\n          this.domain(d);\n        }\n\n        return this;\n      };\n\n      D3Linear.prototype.ticks = function (count) {\n        if (count === void 0) {\n          count = DEFAULT_COUNT;\n        }\n\n        return d3ArrayTicks(this._domain[0], this._domain[this._domain.length - 1], count || DEFAULT_COUNT);\n      };\n\n      return D3Linear;\n    }();\n\n    function d3ArrayTicks(start, stop, count) {\n      var reverse;\n      var i = -1;\n      var n;\n      var ticks;\n      var step;\n      stop = +stop, start = +start, count = +count;\n\n      if (start === stop && count > 0) {\n        return [start];\n      } // tslint:disable-next-line\n\n\n      if (reverse = stop < start) {\n        n = start, start = stop, stop = n;\n      } // tslint:disable-next-line\n\n\n      if ((step = tickIncrement(start, stop, count)) === 0 || !isFinite(step)) {\n        return [];\n      }\n\n      if (step > 0) {\n        start = Math.ceil(start / step);\n        stop = Math.floor(stop / step);\n        ticks = new Array(n = Math.ceil(stop - start + 1));\n\n        while (++i < n) {\n          ticks[i] = (start + i) * step;\n        }\n      } else {\n        start = Math.floor(start * step);\n        stop = Math.ceil(stop * step);\n        ticks = new Array(n = Math.ceil(start - stop + 1));\n\n        while (++i < n) {\n          ticks[i] = (start - i) / step;\n        }\n      }\n\n      if (reverse) {\n        ticks.reverse();\n      }\n\n      return ticks;\n    }\n\n    function tickIncrement(start, stop, count) {\n      var step = (stop - start) / Math.max(0, count);\n      var power = Math.floor(Math.log(step) / Math.LN10);\n      var error = step / Math.pow(10, power);\n      return power >= 0 ? (error >= e10 ? 10 : error >= e5 ? 5 : error >= e2 ? 2 : 1) * Math.pow(10, power) : -Math.pow(10, -power) / (error >= e10 ? 10 : error >= e5 ? 5 : error >= e2 ? 2 : 1);\n    }\n\n    function snapMultiple(v, base, snapType) {\n      var div;\n\n      if (snapType === 'ceil') {\n        div = Math.ceil(v / base);\n      } else if (snapType === 'floor') {\n        div = Math.floor(v / base);\n      } else {\n        div = Math.round(v / base);\n      }\n\n      return div * base;\n    }\n\n    function intervalTicks(min, max, interval) {\n      // 变成 interval 的倍数\n      var minTick = snapMultiple(min, interval, 'floor');\n      var maxTick = snapMultiple(max, interval, 'ceil'); // 统一小数位数\n\n      minTick = fixedBase(minTick, interval);\n      maxTick = fixedBase(maxTick, interval);\n      var ticks = [];\n\n      for (var i = minTick; i <= maxTick; i = i + interval) {\n        var tickValue = fixedBase(i, interval); // 防止浮点数加法出现问题\n\n        ticks.push(tickValue);\n      }\n\n      return {\n        min: minTick,\n        max: maxTick,\n        ticks: ticks\n      };\n    }\n\n    /**\n     * 按照给定的 minLimit/maxLimit/tickCount 均匀计算出刻度 ticks\n     *\n     * @param cfg Scale 配置项\n     * @return ticks\n     */\n\n    function strictLimit(cfg, defaultMin, defaultMax) {\n      var _a;\n\n      var minLimit = cfg.minLimit,\n          maxLimit = cfg.maxLimit,\n          min = cfg.min,\n          max = cfg.max,\n          _b = cfg.tickCount,\n          tickCount = _b === void 0 ? 5 : _b;\n      var tickMin = isNil(minLimit) ? isNil(defaultMin) ? min : defaultMin : minLimit;\n      var tickMax = isNil(maxLimit) ? isNil(defaultMax) ? max : defaultMax : maxLimit;\n\n      if (tickMin > tickMax) {\n        _a = [tickMin, tickMax], tickMax = _a[0], tickMin = _a[1];\n      }\n\n      if (tickCount <= 2) {\n        return [tickMin, tickMax];\n      }\n\n      var step = (tickMax - tickMin) / (tickCount - 1);\n      var ticks = [];\n\n      for (var i = 0; i < tickCount; i++) {\n        ticks.push(tickMin + step * i);\n      }\n\n      return ticks;\n    }\n\n    function d3LinearTickMethod(cfg) {\n      var min = cfg.min,\n          max = cfg.max,\n          tickInterval = cfg.tickInterval,\n          minLimit = cfg.minLimit,\n          maxLimit = cfg.maxLimit;\n      var ticks = d3Linear(cfg);\n\n      if (!isNil(minLimit) || !isNil(maxLimit)) {\n        return strictLimit(cfg, head(ticks), last(ticks));\n      }\n\n      if (tickInterval) {\n        return intervalTicks(min, max, tickInterval).ticks;\n      }\n\n      return ticks;\n    }\n\n    /**\n     * 计算线性的 ticks，使用 wilkinson extended 方法\n     * @param cfg 度量的配置项\n     * @returns 计算后的 ticks\n     */\n\n    function linear(cfg) {\n      var min = cfg.min,\n          max = cfg.max,\n          tickCount = cfg.tickCount,\n          nice = cfg.nice,\n          tickInterval = cfg.tickInterval,\n          minLimit = cfg.minLimit,\n          maxLimit = cfg.maxLimit;\n      var ticks = extended(min, max, tickCount, nice).ticks;\n\n      if (!isNil(minLimit) || !isNil(maxLimit)) {\n        return strictLimit(cfg, head(ticks), last(ticks));\n      }\n\n      if (tickInterval) {\n        return intervalTicks(min, max, tickInterval).ticks;\n      }\n\n      return ticks;\n    }\n\n    /**\n     * 计算 log 的 ticks，考虑 min = 0 的场景\n     * @param cfg 度量的配置项\n     * @returns 计算后的 ticks\n     */\n\n    function calculateLogTicks(cfg) {\n      var base = cfg.base,\n          tickCount = cfg.tickCount,\n          min = cfg.min,\n          max = cfg.max,\n          values = cfg.values;\n      var minTick;\n      var maxTick = log(base, max);\n\n      if (min > 0) {\n        minTick = Math.floor(log(base, min));\n      } else {\n        var positiveMin = getLogPositiveMin(values, base, max);\n        minTick = Math.floor(log(base, positiveMin));\n      }\n\n      var count = maxTick - minTick;\n      var avg = Math.ceil(count / tickCount);\n      var ticks = [];\n\n      for (var i = minTick; i < maxTick + avg; i = i + avg) {\n        ticks.push(Math.pow(base, i));\n      }\n\n      if (min <= 0) {\n        // 最小值 <= 0 时显示 0\n        ticks.unshift(0);\n      }\n\n      return ticks;\n    }\n\n    function pretty(min, max, n) {\n      if (n === void 0) {\n        n = 5;\n      }\n\n      var res = {\n        max: 0,\n        min: 0,\n        ticks: []\n      };\n\n      if (min === max) {\n        return {\n          max: max,\n          min: min,\n          ticks: [min]\n        };\n      }\n      /*\n        R pretty:\n        https://svn.r-project.org/R/trunk/src/appl/pretty.c\n        https://www.rdocumentation.org/packages/base/versions/3.5.2/topics/pretty\n        */\n\n\n      var h = 1.5; // high.u.bias\n\n      var h5 = 0.5 + 1.5 * h; // u5.bias\n      // 反正我也不会调参，跳过所有判断步骤\n\n      var d = max - min;\n      var c = d / n; // 当d非常小的时候触发，但似乎没什么用\n      // const min_n = Math.floor(n / 3);\n      // const shrink_sml = Math.pow(2, 5);\n      // if (Math.log10(d) < -2) {\n      //   c = (_.max([ Math.abs(max), Math.abs(min) ]) * shrink_sml) / min_n;\n      // }\n\n      var base = Math.pow(10, Math.floor(Math.log10(c)));\n      var toFixed = base < 1 ? Math.ceil(Math.abs(Math.log10(base))) : 0;\n      var unit = base;\n\n      if (2 * base - c < h * (c - unit)) {\n        unit = 2 * base;\n\n        if (5 * base - c < h5 * (c - unit)) {\n          unit = 5 * base;\n\n          if (10 * base - c < h * (c - unit)) {\n            unit = 10 * base;\n          }\n        }\n      }\n\n      var nu = Math.ceil(max / unit);\n      var ns = Math.floor(min / unit);\n      res.max = Math.max(nu * unit, max);\n      res.min = Math.min(ns * unit, min);\n      var x = Number.parseFloat((ns * unit).toFixed(toFixed));\n\n      while (x < max) {\n        res.ticks.push(x);\n        x += unit;\n\n        if (toFixed) {\n          x = Number.parseFloat(x.toFixed(toFixed));\n        }\n      }\n\n      res.ticks.push(x);\n      return res;\n    }\n\n    /**\n     * 计算 Pow 的 ticks\n     * @param cfg 度量的配置项\n     * @returns 计算后的 ticks\n     */\n\n    function calculatePowTicks(cfg) {\n      var exponent = cfg.exponent,\n          tickCount = cfg.tickCount;\n      var max = Math.ceil(calBase(exponent, cfg.max));\n      var min = Math.floor(calBase(exponent, cfg.min));\n      var ticks = pretty(min, max, tickCount).ticks;\n      return ticks.map(function (tick) {\n        var factor = tick >= 0 ? 1 : -1;\n        return Math.pow(tick, exponent) * factor;\n      });\n    }\n\n    /**\n     * 计算几分位 https://github.com/simple-statistics/simple-statistics/blob/master/src/quantile_sorted.js\n     * @param x  数组\n     * @param p  百分比\n     */\n    function quantileSorted(x, p) {\n      var idx = x.length * p;\n      /*if (x.length === 0) { // 当前场景这些条件不可能命中\n        throw new Error('quantile requires at least one value.');\n      } else if (p < 0 || p > 1) {\n        throw new Error('quantiles must be between 0 and 1');\n      } else */\n\n      if (p === 1) {\n        // If p is 1, directly return the last element\n        return x[x.length - 1];\n      } else if (p === 0) {\n        // If p is 0, directly return the first element\n        return x[0];\n      } else if (idx % 1 !== 0) {\n        // If p is not integer, return the next element in array\n        return x[Math.ceil(idx) - 1];\n      } else if (x.length % 2 === 0) {\n        // If the list has even-length, we'll take the average of this number\n        // and the next value, if there is one\n        return (x[idx - 1] + x[idx]) / 2;\n      } else {\n        // Finally, in the simple case of an integer value\n        // with an odd-length list, return the x value at the index.\n        return x[idx];\n      }\n    }\n\n    function calculateTicks(cfg) {\n      var tickCount = cfg.tickCount,\n          values = cfg.values;\n\n      if (!values || !values.length) {\n        return [];\n      }\n\n      var sorted = values.slice().sort(function (a, b) {\n        return a - b;\n      });\n      var ticks = [];\n\n      for (var i = 0; i < tickCount; i++) {\n        var p = i / (tickCount - 1);\n        ticks.push(quantileSorted(sorted, p));\n      }\n\n      return ticks;\n    }\n\n    /**\n     * 计算线性的 ticks，使用 R's pretty 方法\n     * @param cfg 度量的配置项\n     * @returns 计算后的 ticks\n     */\n\n    function linearPretty(cfg) {\n      var min = cfg.min,\n          max = cfg.max,\n          tickCount = cfg.tickCount,\n          tickInterval = cfg.tickInterval,\n          minLimit = cfg.minLimit,\n          maxLimit = cfg.maxLimit;\n      var ticks = pretty(min, max, tickCount).ticks;\n\n      if (!isNil(minLimit) || !isNil(maxLimit)) {\n        return strictLimit(cfg, head(ticks), last(ticks));\n      }\n\n      if (tickInterval) {\n        return intervalTicks(min, max, tickInterval).ticks;\n      }\n\n      return ticks;\n    }\n\n    function calculateTimeTicks(cfg) {\n      var min = cfg.min,\n          max = cfg.max,\n          minTickInterval = cfg.minTickInterval;\n      var tickInterval = cfg.tickInterval;\n      var tickCount = cfg.tickCount; // 指定 tickInterval 后 tickCount 不生效，需要重新计算\n\n      if (tickInterval) {\n        tickCount = Math.ceil((max - min) / tickInterval);\n      } else {\n        tickInterval = getTickInterval(min, max, tickCount)[1];\n        var count = (max - min) / tickInterval;\n        var ratio = count / tickCount;\n\n        if (ratio > 1) {\n          tickInterval = tickInterval * Math.ceil(ratio);\n        } // 如果设置了最小间距，则使用最小间距\n\n\n        if (minTickInterval && tickInterval < minTickInterval) {\n          tickInterval = minTickInterval;\n        }\n      }\n\n      var ticks = [];\n\n      for (var i = min; i < max + tickInterval; i += tickInterval) {\n        ticks.push(i);\n      }\n\n      return ticks;\n    }\n\n    /**\n     * 计算时间分类的 ticks, 保头，保尾\n     * @param cfg 度量的配置项\n     * @returns 计算后的 ticks\n     */\n\n    function calculateTimeCatTicks(cfg) {\n      var ticks = calculateCatTicks(cfg);\n      var lastValue = last(cfg.values);\n\n      if (lastValue !== last(ticks)) {\n        ticks.push(lastValue);\n      }\n\n      return ticks;\n    }\n\n    function getYear(date) {\n      return new Date(date).getFullYear();\n    }\n\n    function createYear(year) {\n      return new Date(year, 0, 1).getTime();\n    }\n\n    function getMonth(date) {\n      return new Date(date).getMonth();\n    }\n\n    function diffMonth(min, max) {\n      var minYear = getYear(min);\n      var maxYear = getYear(max);\n      var minMonth = getMonth(min);\n      var maxMonth = getMonth(max);\n      return (maxYear - minYear) * 12 + (maxMonth - minMonth) % 12;\n    }\n\n    function creatMonth(year, month) {\n      return new Date(year, month, 1).getTime();\n    }\n\n    function diffDay(min, max) {\n      return Math.ceil((max - min) / DAY);\n    }\n\n    function diffHour(min, max) {\n      return Math.ceil((max - min) / HOUR);\n    }\n\n    function diffMinus(min, max) {\n      return Math.ceil((max - min) / (60 * 1000));\n    }\n    /**\n     * 计算 time 的 ticks，对 month, year 进行 pretty 处理\n     * @param cfg 度量的配置项\n     * @returns 计算后的 ticks\n     */\n\n\n    function timePretty(cfg) {\n      var min = cfg.min,\n          max = cfg.max,\n          minTickInterval = cfg.minTickInterval,\n          tickCount = cfg.tickCount;\n      var tickInterval = cfg.tickInterval;\n      var ticks = []; // 指定 tickInterval 后 tickCount 不生效，需要重新计算\n\n      if (!tickInterval) {\n        tickInterval = (max - min) / tickCount; // 如果设置了最小间距，则使用最小间距\n\n        if (minTickInterval && tickInterval < minTickInterval) {\n          tickInterval = minTickInterval;\n        }\n      }\n\n      var minYear = getYear(min); // 如果间距大于 1 年，则将开始日期从整年开始\n\n      if (tickInterval > YEAR) {\n        var maxYear = getYear(max);\n        var yearInterval = Math.ceil(tickInterval / YEAR);\n\n        for (var i = minYear; i <= maxYear + yearInterval; i = i + yearInterval) {\n          ticks.push(createYear(i));\n        }\n      } else if (tickInterval > MONTH) {\n        // 大于月时\n        var monthInterval = Math.ceil(tickInterval / MONTH);\n        var mmMoth = getMonth(min);\n        var dMonths = diffMonth(min, max);\n\n        for (var i = 0; i <= dMonths + monthInterval; i = i + monthInterval) {\n          ticks.push(creatMonth(minYear, i + mmMoth));\n        }\n      } else if (tickInterval > DAY) {\n        // 大于天\n        var date = new Date(min);\n        var year = date.getFullYear();\n        var month = date.getMonth();\n        var mday = date.getDate();\n        var day = Math.ceil(tickInterval / DAY);\n        var ddays = diffDay(min, max);\n\n        for (var i = 0; i < ddays + day; i = i + day) {\n          ticks.push(new Date(year, month, mday + i).getTime());\n        }\n      } else if (tickInterval > HOUR) {\n        // 大于小时\n        var date = new Date(min);\n        var year = date.getFullYear();\n        var month = date.getMonth();\n        var day = date.getDate();\n        var hour = date.getHours();\n        var hours = Math.ceil(tickInterval / HOUR);\n        var dHours = diffHour(min, max);\n\n        for (var i = 0; i <= dHours + hours; i = i + hours) {\n          ticks.push(new Date(year, month, day, hour + i).getTime());\n        }\n      } else if (tickInterval > MINUTE) {\n        // 大于分钟\n        var dMinus = diffMinus(min, max);\n        var minutes = Math.ceil(tickInterval / MINUTE);\n\n        for (var i = 0; i <= dMinus + minutes; i = i + minutes) {\n          ticks.push(min + i * MINUTE);\n        }\n      } else {\n        // 小于分钟\n        var interval = tickInterval;\n\n        if (interval < SECOND) {\n          interval = SECOND;\n        }\n\n        var minSecond = Math.floor(min / SECOND) * SECOND;\n        var dSeconds = Math.ceil((max - min) / SECOND);\n        var seconds = Math.ceil(interval / SECOND);\n\n        for (var i = 0; i < dSeconds + seconds; i = i + seconds) {\n          ticks.push(minSecond + i * SECOND);\n        }\n      } // 最好是能从算法能解决这个问题，但是如果指定了 tickInterval，计算 ticks，也只能这么算，所以\n      // 打印警告提示\n\n\n      if (ticks.length >= 512) {\n        console.warn(\"Notice: current ticks length(\" + ticks.length + \") >= 512, may cause performance issues, even out of memory. Because of the configure \\\"tickInterval\\\"(in milliseconds, current is \" + tickInterval + \") is too small, increase the value to solve the problem!\");\n      }\n\n      return ticks;\n    }\n\n    registerTickMethod('cat', calculateCatTicks);\n    registerTickMethod('time-cat', calculateTimeCatTicks);\n    registerTickMethod('wilkinson-extended', linear);\n    registerTickMethod('r-pretty', linearPretty);\n    registerTickMethod('time', calculateTimeTicks);\n    registerTickMethod('time-pretty', timePretty);\n    registerTickMethod('log', calculateLogTicks);\n    registerTickMethod('pow', calculatePowTicks);\n    registerTickMethod('quantile', calculateTicks);\n    registerTickMethod('d3-linear', d3LinearTickMethod);\n\n    registerClass('cat', Category);\n    registerClass('category', Category);\n    registerClass('identity', Identity);\n    registerClass('linear', Linear);\n    registerClass('log', Log);\n    registerClass('pow', Pow);\n    registerClass('time', Time);\n    registerClass('timeCat', TimeCat);\n    registerClass('quantize', Quantize);\n    registerClass('quantile', Quantile);\n\n    // cat平均算法，保头保尾\n    var CatTick = (function (cfg) {\n      var values = cfg.values,\n          tickCount = cfg.tickCount;\n\n      if (!tickCount) {\n        return values;\n      }\n\n      if (values.length <= 1) {\n        return values;\n      } // 获取间隔步长, 最小是1\n\n\n      var step = parseInt(values.length / (tickCount - 1)) || 1;\n      var ticks = []; // 按间隔数取对应节点\n\n      for (var index = 0; index < values.length; index = index + step) {\n        ticks.push(values[index]);\n      }\n\n      var last = values[values.length - 1]; // 如果最后一个tick不等于原数据的最后一个\n\n      if (ticks[ticks.length - 1] !== last) {\n        if (ticks.length >= tickCount) {\n          // 如果当前的tick个数满足要求\n          ticks[ticks.length - 1] = last;\n        } else {\n          // 不满足tickCount则直接加入最后一个\n          ticks.push(last);\n        }\n      }\n\n      return ticks;\n    });\n\n    // 认为是nice的刻度\n    var SNAP_COUNT_ARRAY = [1, 1.2, 1.5, 2, 2.2, 2.4, 2.5, 3, 4, 5, 6, 7.5, 8, 10];\n    var DEFAULT_COUNT$1 = 5; // 默认刻度值\n\n    var LinearTick = (function (cfg) {\n      var _ref = cfg || {},\n          tickCount = _ref.tickCount,\n          tickInterval = _ref.tickInterval;\n\n      var _ref2 = cfg || {},\n          min = _ref2.min,\n          max = _ref2.max;\n\n      min = isNaN(min) ? 0 : min;\n      max = isNaN(max) ? 0 : max;\n      var count = tickCount && tickCount >= 2 ? tickCount : DEFAULT_COUNT$1; // 计算interval， 优先取tickInterval\n\n      var interval = tickInterval || getBestInterval({\n        tickCount: count,\n        max: max,\n        min: min\n      }); // 通过interval计算最小tick\n\n      var minTick = Math.floor(min / interval) * interval; // 如果指定了tickInterval, count 需要根据指定的tickInterval来算计\n\n      if (tickInterval) {\n        var intervalCount = Math.abs(Math.ceil((max - minTick) / tickInterval)) + 1; // tickCount 作为最小 count 处理\n\n        count = Math.max(count, intervalCount);\n      }\n\n      var ticks = [];\n      var tickLength = 0;\n      var fixedLength = getFixedLength(interval);\n\n      while (tickLength < count) {\n        ticks.push(toFixed(minTick + tickLength * interval, fixedLength));\n        tickLength++;\n      }\n\n      return ticks;\n    });\n    var DECIMAL_LENGTH = 12;\n\n    function getFactor(number) {\n      // 取正数\n      number = Math.abs(number);\n      var factor = 1;\n\n      if (number === 0) {\n        return factor;\n      } // 小于1,逐渐放大\n\n\n      if (number < 1) {\n        var count = 0;\n\n        while (number < 1) {\n          factor = factor / 10;\n          number = number * 10;\n          count++;\n        } // 浮点数计算出现问题\n\n\n        if (factor.toString().length > DECIMAL_LENGTH) {\n          factor = parseFloat(factor.toFixed(count));\n        }\n\n        return factor;\n      } // 大于10逐渐缩小\n\n\n      while (number > 10) {\n        factor = factor * 10;\n        number = number / 10;\n      }\n\n      return factor;\n    } // 获取最佳匹配刻度\n\n\n    function getBestInterval(_ref3) {\n      var tickCount = _ref3.tickCount,\n          min = _ref3.min,\n          max = _ref3.max;\n\n      // 如果最大最小相等，则直接按1处理\n      if (min === max) {\n        return 1 * getFactor(max);\n      } // 1.计算平均刻度\b间隔\n\n\n      var avgInterval = (max - min) / (tickCount - 1); // 2.数据标准归一化 映射到[1-10]区间\n\n      var factor = getFactor(avgInterval);\n      var calInterval = avgInterval / factor;\n      var calMax = max / factor;\n      var calMin = min / factor; // 根据平均值推算最逼近刻度值\n\n      var similarityIndex = 0;\n\n      for (var index = 0; index < SNAP_COUNT_ARRAY.length; index++) {\n        var item = SNAP_COUNT_ARRAY[index];\n\n        if (calInterval <= item) {\n          similarityIndex = index;\n          break;\n        }\n      }\n\n      var similarityInterval = getInterval(similarityIndex, tickCount, calMin, calMax); // 小数点位数还原到数据的位数, 因为similarityIndex有可能是小数，所以需要保留similarityIndex自己的小数位数\n\n      var fixedLength = getFixedLength(similarityInterval) + getFixedLength(factor);\n      return toFixed(similarityInterval * factor, fixedLength);\n    }\n\n    function getInterval(startIndex, tickCount, min, max) {\n      var verify = false;\n      var interval = SNAP_COUNT_ARRAY[startIndex]; // 刻度值校验，如果不满足，循环下去\n\n      for (var i = startIndex; i < SNAP_COUNT_ARRAY.length; i++) {\n        if (intervalIsVerify({\n          interval: SNAP_COUNT_ARRAY[i],\n          tickCount: tickCount,\n          max: max,\n          min: min\n        })) {\n          // 有符合条件的interval\n          interval = SNAP_COUNT_ARRAY[i];\n          verify = true;\n          break;\n        }\n      } // 如果不满足, 依次缩小10倍，再计算\n\n\n      if (!verify) {\n        return 10 * getInterval(0, tickCount, min / 10, max / 10);\n      }\n\n      return interval;\n    } // 刻度是否满足展示需求\n\n\n    function intervalIsVerify(_ref4) {\n      var interval = _ref4.interval,\n          tickCount = _ref4.tickCount,\n          max = _ref4.max,\n          min = _ref4.min;\n      var minTick = Math.floor(min / interval) * interval;\n\n      if (minTick + (tickCount - 1) * interval >= max) {\n        return true;\n      }\n\n      return false;\n    } // 计算小数点应该保留的位数\n\n\n    function getFixedLength(num) {\n      var str = num.toString();\n      var index = str.indexOf('.');\n      var indexOfExp = str.indexOf('e-');\n      var length = indexOfExp >= 0 ? parseInt(str.substr(indexOfExp + 2), 10) : str.substr(index + 1).length;\n\n      if (length > 20) {\n        // 最多保留20位小数\n        length = 20;\n      }\n\n      return length;\n    } // @antv/util fixedbase不支持科学计数法的判断，需要提mr\n\n\n    function toFixed(v, length) {\n      return parseFloat(v.toFixed(length));\n    }\n\n    var Linear$1 = getClass('linear');\n    var Identity$1 = getClass('identity');\n    var Category$1 = getClass('category');\n    var TimeCat$1 = getClass('timeCat'); // 覆盖0.3.x的 cat 方法\n\n    registerTickMethod('cat', CatTick);\n    registerTickMethod('time-cat', CatTick); // 覆盖linear 度量的tick算法\n\n    registerTickMethod('wilkinson-extended', LinearTick);\n    Scale.Linear = Linear$1;\n    Scale.Identity = Identity$1;\n    Scale.Category = Category$1;\n    Scale.Cat = Category$1;\n    Scale.TimeCat = TimeCat$1;\n\n    function isFullCircle(coord) {\n      if (!coord.isPolar) {\n        return false;\n      }\n\n      var startAngle = coord.startAngle;\n      var endAngle = coord.endAngle;\n\n      if (!isNil(startAngle) && !isNil(endAngle) && endAngle - startAngle < Math.PI * 2) {\n        return false;\n      }\n\n      return true;\n    }\n\n    function clearObj(obj) {\n      Object.keys(obj).forEach(function (key) {\n        delete obj[key];\n      });\n    }\n\n    var ScaleController = /*#__PURE__*/function () {\n      function ScaleController(cfg) {\n        // defs 列定义\n        this.defs = {}; // 已经实例化的scale\n\n        this.scales = {};\n        mix(this, cfg);\n      }\n\n      var _proto = ScaleController.prototype;\n\n      _proto.setFieldDef = function setFieldDef(field, cfg) {\n        var defs = this.defs;\n\n        if (isObject(field)) {\n          mix(defs, field);\n        } else {\n          defs[field] = cfg;\n        } // 因为可能同时变更多个scale，所以要把所有已实例化的scale都更新下\n\n\n        this.updateScales();\n      };\n\n      _proto._getDef = function _getDef(field) {\n        var defs = this.defs;\n        var def = null;\n\n        if (Global.scales[field] || defs[field]) {\n          def = mix({}, Global.scales[field]);\n          each(defs[field], function (v, k) {\n            if (isNil(v)) {\n              delete def[k];\n            } else {\n              def[k] = v;\n            }\n          });\n        }\n\n        return def;\n      };\n\n      _proto._getDefaultType = function _getDefaultType(field, data, def) {\n        if (def && def.type) {\n          return def.type;\n        }\n\n        var type = 'linear';\n        var value = firstValue(data, field);\n\n        if (isArray(value)) {\n          value = value[0];\n        }\n\n        if (isString(value)) {\n          type = 'cat';\n        }\n\n        return type;\n      };\n\n      _proto._getScaleDef = function _getScaleDef(type, field, data, def) {\n        var values$1;\n\n        if (def && def.values) {\n          values$1 = def.values;\n        } else {\n          values$1 = values(data, field);\n        }\n\n        var cfg = {\n          field: field,\n          values: values$1\n        };\n\n        if (type !== 'cat' && type !== 'timeCat') {\n          if (!def || !(def.min && def.max)) {\n            var _Array$getRange = getRange$1(values$1),\n                min = _Array$getRange.min,\n                max = _Array$getRange.max;\n\n            cfg.min = min;\n            cfg.max = max;\n            cfg.nice = true;\n          }\n        } else {\n          cfg.isRounding = false; // used for tickCount calculation\n        }\n\n        return cfg;\n      } // 调整range，为了让图形居中\n      ;\n\n      _proto._adjustRange = function _adjustRange(type, cfg) {\n        var range = cfg.range,\n            values = cfg.values; // 如果是线性, 或者有自定义range都不处理\n\n        if (type === 'linear' || range || !values) {\n          return cfg;\n        }\n\n        var count = values.length; // 单只有一条数据时，在中间显示\n\n        if (count === 1) {\n          cfg.range = [0.5, 1];\n        } else {\n          var chart = this.chart;\n          var coord = chart.get('coord');\n          var widthRatio = Global.widthRatio.multiplePie;\n          var offset = 0;\n\n          if (isFullCircle(coord)) {\n            if (!coord.transposed) {\n              cfg.range = [0, 1 - 1 / count];\n            } else {\n              offset = 1 / count * widthRatio;\n              cfg.range = [offset / 2, 1 - offset / 2];\n            }\n          } else {\n            // 为了让图形居中，所以才设置range\n            offset = 1 / count * 0.5; // 这里可能用0.25会更合理\n\n            cfg.range = [offset, 1 - offset];\n          }\n        }\n\n        return cfg;\n      };\n\n      _proto._getScaleCfg = function _getScaleCfg(field, data) {\n        var self = this;\n\n        var def = self._getDef(field);\n\n        if (!data || !data.length) {\n          if (def && def.type) {\n            def.field = field;\n            return {\n              type: def.type,\n              cfg: def\n            };\n          }\n\n          return {\n            type: 'identity',\n            cfg: {\n              value: field,\n              field: field.toString(),\n              values: [field]\n            }\n          };\n        }\n\n        var firstObj = data[0];\n        var firstValue$1 = firstObj[field];\n\n        if (firstValue$1 === null) {\n          firstValue$1 = firstValue(data, field);\n        }\n\n        if (isNumber(field) || isNil(firstValue$1) && !def) {\n          return {\n            type: 'identity',\n            cfg: {\n              value: field,\n              field: field.toString(),\n              values: [field]\n            }\n          };\n        }\n\n        var type = self._getDefaultType(field, data, def);\n\n        var cfg = self._getScaleDef(type, field, data, def);\n\n        def && mix(cfg, def);\n        cfg = this._adjustRange(type, cfg);\n        return {\n          type: type,\n          cfg: cfg\n        };\n      };\n\n      _proto.createScale = function createScale(field, data) {\n        var scales = this.scales;\n\n        var _this$_getScaleCfg = this._getScaleCfg(field, data),\n            type = _this$_getScaleCfg.type,\n            cfg = _this$_getScaleCfg.cfg;\n\n        var scale = scales[field]; // 如果已经存在，且类型相等时直接返回\n\n        if (scale && scale.type === type) {\n          scale.change(cfg);\n          return scale;\n        }\n\n        var Scale = getClass(type);\n        var newScale = new Scale(cfg);\n        scales[field] = newScale;\n        return newScale;\n      };\n\n      _proto._updateScale = function _updateScale(scale) {\n        var field = scale.field; // 因为每个field的数据都会不同\n\n        var data = this.chart._getScaleData(field);\n\n        var _this$_getScaleCfg2 = this._getScaleCfg(field, data),\n            cfg = _this$_getScaleCfg2.cfg;\n\n        scale.change(cfg);\n      };\n\n      _proto.updateScales = function updateScales() {\n        var _this = this;\n\n        var scales = this.scales; // 修改完列定义后，需要更新已经实例化的scale\n        // 如果是还没有实例化的，在geom初始化的时候会被实例化，所以这里可以不用更新\n\n        each(scales, function (scale) {\n          _this._updateScale(scale);\n        });\n      } // 调整scale从0开始\n      ;\n\n      _proto.adjustStartZero = function adjustStartZero(scale) {\n        var defs = this.defs;\n        var field = scale.field,\n            min = scale.min,\n            max = scale.max; // 如果有定义，则不处理\n\n        if (defs[field] && defs[field].min) {\n          return;\n        }\n\n        if (min > 0) {\n          scale.change({\n            min: 0\n          });\n        } else if (max < 0) {\n          scale.change({\n            max: 0\n          });\n        }\n      };\n\n      _proto.clear = function clear() {\n        // this.defs = {};\n        // this.scales = {};\n        clearObj(this.defs);\n        clearObj(this.scales);\n        this.data = null;\n      };\n\n      return ScaleController;\n    }();\n\n    var Abastract = /*#__PURE__*/function () {\n      var _proto = Abastract.prototype;\n\n      _proto._initDefaultCfg = function _initDefaultCfg() {\n        /**\n         * ticks\n         * @type {Array}\n         */\n        this.ticks = [];\n        /**\n         * the configuration for tickLine\n         * @type {Object}\n         */\n\n        this.tickLine = {};\n        /**\n         * the direction of ticks, 1 means clockwise\n         * @type {Number}\n         */\n\n        this.offsetFactor = 1;\n        /**\n         * the top container\n         * @type {container}\n         */\n\n        this.frontContainer = null;\n        /**\n         * the back container\n         * @type {[type]}\n         */\n\n        this.backContainer = null;\n        /**\n         * points for draw grid line\n         * @type {Array}\n         */\n\n        this.gridPoints = [];\n      };\n\n      function Abastract(cfg) {\n        this._initDefaultCfg();\n\n        mix(this, cfg);\n        this.draw();\n      }\n\n      _proto.draw = function draw() {\n        var line = this.line,\n            tickLine = this.tickLine,\n            label = this.label,\n            grid = this.grid;\n        grid && this.drawGrid(grid); // draw the grid lines\n\n        tickLine && this.drawTicks(tickLine); // draw the tickLine\n\n        line && this.drawLine(line); // draw axis line\n\n        label && this.drawLabels(); // draw ticks\n      };\n\n      _proto.drawTicks = function drawTicks(tickCfg) {\n        var self = this;\n        var ticks = self.ticks;\n        var length = tickCfg.length;\n        var container = self.getContainer(tickCfg.top);\n        each(ticks, function (tick) {\n          var start = self.getOffsetPoint(tick.value);\n          var end = self.getSidePoint(start, length);\n          var shape = container.addShape('line', {\n            className: 'axis-tick',\n            attrs: mix({\n              x1: start.x,\n              y1: start.y,\n              x2: end.x,\n              y2: end.y\n            }, tickCfg)\n          });\n          shape._id = self._id + '-ticks';\n        });\n      };\n\n      _proto.drawLabels = function drawLabels() {\n        var self = this;\n        var labelOffset = self.labelOffset;\n        var labels = self.labels;\n        each(labels, function (labelShape) {\n          var container = self.getContainer(labelShape.get('top'));\n          var start = self.getOffsetPoint(labelShape.get('value'));\n\n          var _self$getSidePoint = self.getSidePoint(start, labelOffset),\n              x = _self$getSidePoint.x,\n              y = _self$getSidePoint.y;\n\n          labelShape.attr(mix({\n            x: x,\n            y: y\n          }, self.getTextAlignInfo(start, labelOffset), labelShape.get('textStyle')));\n          labelShape._id = self._id + '-' + labelShape.attr('text');\n          container.add(labelShape);\n        });\n      };\n\n      _proto.drawLine = function drawLine() {};\n\n      _proto.drawGrid = function drawGrid(grid) {\n        var self = this;\n        var gridPoints = self.gridPoints,\n            ticks = self.ticks;\n        var gridCfg = grid;\n        var count = gridPoints.length;\n        each(gridPoints, function (subPoints, index) {\n          if (isFunction(grid)) {\n            var tick = ticks[index] || {};\n            var executedGrid = grid(tick.text, index, count);\n            gridCfg = executedGrid ? mix({}, Global._defaultAxis.grid, executedGrid) : null;\n          }\n\n          if (gridCfg) {\n            var type = gridCfg.type; // has two types: 'line' and 'arc'\n\n            var points = subPoints.points;\n            var container = self.getContainer(gridCfg.top);\n            var shape;\n\n            if (type === 'arc') {\n              var center = self.center,\n                  startAngle = self.startAngle,\n                  endAngle = self.endAngle;\n              var radius = Vector2.length([points[0].x - center.x, points[0].y - center.y]);\n              shape = container.addShape('Arc', {\n                className: 'axis-grid',\n                attrs: mix({\n                  x: center.x,\n                  y: center.y,\n                  startAngle: startAngle,\n                  endAngle: endAngle,\n                  r: radius\n                }, gridCfg)\n              });\n            } else {\n              shape = container.addShape('Polyline', {\n                className: 'axis-grid',\n                attrs: mix({\n                  points: points\n                }, gridCfg)\n              });\n            }\n\n            shape._id = subPoints._id;\n          }\n        });\n      };\n\n      _proto.getOffsetPoint = function getOffsetPoint() {};\n\n      _proto.getAxisVector = function getAxisVector() {};\n\n      _proto.getOffsetVector = function getOffsetVector(point, offset) {\n        var self = this;\n        var axisVector = self.getAxisVector(point);\n        var normal = Vector2.normalize([], axisVector);\n        var factor = self.offsetFactor;\n        var verticalVector = [normal[1] * -1 * factor, normal[0] * factor];\n        return Vector2.scale([], verticalVector, offset);\n      };\n\n      _proto.getSidePoint = function getSidePoint(point, offset) {\n        var self = this;\n        var offsetVector = self.getOffsetVector(point, offset);\n        return {\n          x: point.x + offsetVector[0],\n          y: point.y + offsetVector[1]\n        };\n      };\n\n      _proto.getTextAlignInfo = function getTextAlignInfo(point, offset) {\n        var self = this;\n        var offsetVector = self.getOffsetVector(point, offset);\n        var align;\n        var baseLine;\n\n        if (offsetVector[0] > 0) {\n          align = 'left';\n        } else if (offsetVector[0] < 0) {\n          align = 'right';\n        } else {\n          align = 'center';\n        }\n\n        if (offsetVector[1] > 0) {\n          baseLine = 'top';\n        } else if (offsetVector[1] < 0) {\n          baseLine = 'bottom';\n        } else {\n          baseLine = 'middle';\n        }\n\n        return {\n          textAlign: align,\n          textBaseline: baseLine\n        };\n      };\n\n      _proto.getContainer = function getContainer(isTop) {\n        var frontContainer = this.frontContainer,\n            backContainer = this.backContainer;\n        return isTop ? frontContainer : backContainer;\n      };\n\n      return Abastract;\n    }();\n\n    var Line = /*#__PURE__*/function (_Abstract) {\n      _inheritsLoose(Line, _Abstract);\n\n      function Line() {\n        return _Abstract.apply(this, arguments) || this;\n      }\n\n      var _proto = Line.prototype;\n\n      _proto._initDefaultCfg = function _initDefaultCfg() {\n        _Abstract.prototype._initDefaultCfg.call(this);\n\n        this.start = null;\n        this.end = null;\n      };\n\n      _proto.getOffsetPoint = function getOffsetPoint(value) {\n        var start = this.start,\n            end = this.end;\n        return {\n          x: start.x + (end.x - start.x) * value,\n          y: start.y + (end.y - start.y) * value\n        };\n      };\n\n      _proto.getAxisVector = function getAxisVector() {\n        var start = this.start,\n            end = this.end;\n        return [end.x - start.x, end.y - start.y];\n      };\n\n      _proto.drawLine = function drawLine(lineCfg) {\n        var container = this.getContainer(lineCfg.top);\n        var start = this.start,\n            end = this.end;\n        container.addShape('line', {\n          className: 'axis-line',\n          attrs: mix({\n            x1: start.x,\n            y1: start.y,\n            x2: end.x,\n            y2: end.y\n          }, lineCfg)\n        });\n      };\n\n      return Line;\n    }(Abastract);\n\n    Abastract.Line = Line;\n\n    function formatTicks(ticks) {\n      var tmp = ticks.slice(0);\n\n      if (tmp.length > 0) {\n        var first = tmp[0];\n        var last = tmp[tmp.length - 1];\n\n        if (first.value !== 0) {\n          tmp.unshift({\n            value: 0\n          });\n        }\n\n        if (last.value !== 1) {\n          tmp.push({\n            value: 1\n          });\n        }\n      }\n\n      return tmp;\n    }\n\n    var AxisController = /*#__PURE__*/function () {\n      function AxisController(cfg) {\n        this.axisCfg = {};\n        this.frontPlot = null;\n        this.backPlot = null;\n        this.axes = {}; // store the axes's options\n\n        mix(this, cfg);\n      }\n\n      var _proto = AxisController.prototype;\n\n      _proto._isHide = function _isHide(field) {\n        var axisCfg = this.axisCfg;\n        return !axisCfg || axisCfg[field] === false;\n      };\n\n      _proto._getLinePosition = function _getLinePosition(scale, dimType, index, transposed) {\n        var position = '';\n        var field = scale.field;\n        var axisCfg = this.axisCfg;\n\n        if (axisCfg[field] && axisCfg[field].position) {\n          position = axisCfg[field].position;\n        } else if (dimType === 'x') {\n          position = transposed ? 'left' : 'bottom';\n        } else if (dimType === 'y') {\n          position = index ? 'right' : 'left';\n\n          if (transposed) {\n            position = 'bottom';\n          }\n        }\n\n        return position;\n      };\n\n      _proto._getLineCfg = function _getLineCfg(coord, dimType, position) {\n        var start;\n        var end;\n        var factor = 1; // Mark clockwise or counterclockwise\n\n        if (dimType === 'x') {\n          start = {\n            x: 0,\n            y: 0\n          };\n          end = {\n            x: 1,\n            y: 0\n          };\n        } else {\n          if (position === 'right') {\n            // there will be several y axes\n            start = {\n              x: 1,\n              y: 0\n            };\n            end = {\n              x: 1,\n              y: 1\n            };\n          } else {\n            start = {\n              x: 0,\n              y: 0\n            };\n            end = {\n              x: 0,\n              y: 1\n            };\n            factor = -1;\n          }\n        }\n\n        if (coord.transposed) {\n          factor *= -1;\n        }\n\n        return {\n          offsetFactor: factor,\n          start: coord.convertPoint(start),\n          end: coord.convertPoint(end)\n        };\n      };\n\n      _proto._getCircleCfg = function _getCircleCfg(coord) {\n        return {\n          startAngle: coord.startAngle,\n          endAngle: coord.endAngle,\n          center: coord.center,\n          radius: coord.circleRadius\n        };\n      };\n\n      _proto._getRadiusCfg = function _getRadiusCfg(coord) {\n        var transposed = coord.transposed;\n        var start;\n        var end;\n\n        if (transposed) {\n          start = {\n            x: 0,\n            y: 0\n          };\n          end = {\n            x: 1,\n            y: 0\n          };\n        } else {\n          start = {\n            x: 0,\n            y: 0\n          };\n          end = {\n            x: 0,\n            y: 1\n          };\n        }\n\n        return {\n          offsetFactor: -1,\n          start: coord.convertPoint(start),\n          end: coord.convertPoint(end)\n        };\n      };\n\n      _proto._getAxisCfg = function _getAxisCfg(coord, scale, verticalScale, dimType, defaultCfg) {\n        var _this = this;\n\n        var self = this;\n        var axisCfg = this.axisCfg;\n        var ticks = scale.getTicks();\n        var cfg = deepMix({\n          ticks: ticks,\n          frontContainer: this.frontPlot,\n          backContainer: this.backPlot\n        }, defaultCfg, axisCfg[scale.field]);\n        var labels = [];\n        var label = cfg.label;\n        var count = ticks.length;\n        var maxWidth = 0;\n        var maxHeight = 0;\n        var labelCfg = label;\n        each(ticks, function (tick, index) {\n          if (isFunction(label)) {\n            var executedLabel = label(tick.text, index, count);\n            labelCfg = executedLabel ? mix({}, Global._defaultAxis.label, executedLabel) : null;\n          }\n\n          if (labelCfg) {\n            var textStyle = {};\n\n            if (labelCfg.textAlign) {\n              textStyle.textAlign = labelCfg.textAlign;\n            }\n\n            if (labelCfg.textBaseline) {\n              textStyle.textBaseline = labelCfg.textBaseline;\n            }\n\n            var container = labelCfg.top ? _this.frontPlot : _this.backPlot;\n            var axisLabel = container.addShape('text', {\n              className: 'axis-label',\n              aria: false,\n              attrs: mix({\n                x: 0,\n                y: 0,\n                text: tick.text,\n                fontFamily: self.chart.get('canvas').get('fontFamily')\n              }, labelCfg),\n              value: tick.value,\n              textStyle: textStyle,\n              top: labelCfg.top,\n              context: self.chart.get('canvas').get('context')\n            });\n            labels.push(axisLabel);\n\n            var _axisLabel$getBBox = axisLabel.getBBox(),\n                width = _axisLabel$getBBox.width,\n                height = _axisLabel$getBBox.height;\n\n            maxWidth = Math.max(maxWidth, width);\n            maxHeight = Math.max(maxHeight, height);\n          }\n        });\n        cfg.labels = labels;\n        cfg.maxWidth = maxWidth;\n        cfg.maxHeight = maxHeight;\n        return cfg;\n      };\n\n      _proto._createAxis = function _createAxis(coord, scale, verticalScale, dimType, index) {\n        if (index === void 0) {\n          index = '';\n        }\n\n        var self = this;\n        var coordType = coord.type;\n        var transposed = coord.transposed;\n        var type;\n        var key;\n        var defaultCfg;\n\n        if (coordType === 'cartesian' || coordType === 'rect') {\n          var position = self._getLinePosition(scale, dimType, index, transposed);\n\n          defaultCfg = Global.axis[position];\n          defaultCfg.position = position;\n          type = 'Line';\n          key = position;\n        } else {\n          if (dimType === 'x' && !transposed || dimType === 'y' && transposed) {\n            defaultCfg = Global.axis.circle;\n            type = 'Circle';\n            key = 'circle';\n          } else {\n            defaultCfg = Global.axis.radius;\n            type = 'Line';\n            key = 'radius';\n          }\n        }\n\n        var cfg = self._getAxisCfg(coord, scale, verticalScale, dimType, defaultCfg);\n\n        cfg.type = type;\n        cfg.dimType = dimType;\n        cfg.verticalScale = verticalScale;\n        cfg.index = index;\n        this.axes[key] = cfg;\n      };\n\n      _proto.createAxis = function createAxis(coord, xScale, yScales) {\n        var self = this;\n\n        if (xScale && !self._isHide(xScale.field)) {\n          self._createAxis(coord, xScale, yScales[0], 'x');\n        }\n\n        each(yScales, function (yScale, index) {\n          if (!self._isHide(yScale.field)) {\n            self._createAxis(coord, yScale, xScale, 'y', index);\n          }\n        });\n        var axes = this.axes;\n        var chart = self.chart;\n\n        if (chart._isAutoPadding()) {\n          var userPadding = parsePadding(chart.get('padding'));\n          var appendPadding = parsePadding(chart.get('appendPadding'));\n          var legendRange = chart.get('legendRange') || {\n            top: 0,\n            right: 0,\n            bottom: 0,\n            left: 0\n          };\n          var padding = [userPadding[0] === 'auto' ? legendRange.top + appendPadding[0] * 2 : userPadding[0], userPadding[1] === 'auto' ? legendRange.right + appendPadding[1] : userPadding[1], userPadding[2] === 'auto' ? legendRange.bottom + appendPadding[2] : userPadding[2], userPadding[3] === 'auto' ? legendRange.left + appendPadding[3] : userPadding[3]];\n\n          if (coord.isPolar) {\n            var circleAxis = axes.circle;\n\n            if (circleAxis) {\n              var maxHeight = circleAxis.maxHeight,\n                  maxWidth = circleAxis.maxWidth,\n                  labelOffset = circleAxis.labelOffset;\n              padding[0] += maxHeight + labelOffset;\n              padding[1] += maxWidth + labelOffset;\n              padding[2] += maxHeight + labelOffset;\n              padding[3] += maxWidth + labelOffset;\n            }\n          } else {\n            if (axes.right && userPadding[1] === 'auto') {\n              var _axes$right = axes.right,\n                  _maxWidth = _axes$right.maxWidth,\n                  _labelOffset = _axes$right.labelOffset;\n              padding[1] += _maxWidth + _labelOffset;\n            }\n\n            if (axes.left && userPadding[3] === 'auto') {\n              var _axes$left = axes.left,\n                  _maxWidth2 = _axes$left.maxWidth,\n                  _labelOffset2 = _axes$left.labelOffset;\n              padding[3] += _maxWidth2 + _labelOffset2;\n            }\n\n            if (axes.bottom && userPadding[2] === 'auto') {\n              var _axes$bottom = axes.bottom,\n                  _maxHeight = _axes$bottom.maxHeight,\n                  _labelOffset3 = _axes$bottom.labelOffset;\n              padding[2] += _maxHeight + _labelOffset3;\n            }\n          }\n\n          chart.set('_padding', padding);\n\n          chart._updateLayout(padding);\n        }\n\n        each(axes, function (axis) {\n          var type = axis.type,\n              grid = axis.grid,\n              verticalScale = axis.verticalScale,\n              ticks = axis.ticks,\n              dimType = axis.dimType,\n              position = axis.position,\n              index = axis.index;\n          var appendCfg;\n\n          if (coord.isPolar) {\n            if (type === 'Line') {\n              appendCfg = self._getRadiusCfg(coord);\n            } else if (type === 'Circle') {\n              appendCfg = self._getCircleCfg(coord);\n            }\n          } else {\n            appendCfg = self._getLineCfg(coord, dimType, position);\n          }\n\n          if (grid && verticalScale) {\n            var gridPoints = [];\n            var verticalTicks = formatTicks(verticalScale.getTicks());\n            each(ticks, function (tick) {\n              var subPoints = [];\n              each(verticalTicks, function (verticalTick) {\n                var x = dimType === 'x' ? tick.value : verticalTick.value;\n                var y = dimType === 'x' ? verticalTick.value : tick.value;\n\n                if (x >= 0 && x <= 1 && y >= 0 && y <= 1) {\n                  var point = coord.convertPoint({\n                    x: x,\n                    y: y\n                  });\n                  subPoints.push(point);\n                }\n              });\n              gridPoints.push({\n                points: subPoints,\n                _id: 'axis-' + dimType + index + '-grid-' + tick.tickValue\n              });\n            });\n            axis.gridPoints = gridPoints;\n\n            if (coord.isPolar) {\n              axis.center = coord.center;\n              axis.startAngle = coord.startAngle;\n              axis.endAngle = coord.endAngle;\n            }\n          }\n\n          appendCfg._id = 'axis-' + dimType;\n\n          if (!isNil(index)) {\n            appendCfg._id = 'axis-' + dimType + index;\n          }\n\n          new Abastract[type](mix(axis, appendCfg));\n        });\n      };\n\n      _proto.clear = function clear() {\n        this.axes = {};\n        this.frontPlot.clear();\n        this.backPlot.clear();\n      };\n\n      return AxisController;\n    }();\n\n    var calcDirection = function calcDirection(start, end) {\n      var xDistance = end.x - start.x;\n      var yDistance = end.y - start.y; // x 的距离大于y 说明是横向，否则就是纵向\n\n      if (Math.abs(xDistance) > Math.abs(yDistance)) {\n        return xDistance > 0 ? 'right' : 'left';\n      }\n\n      return yDistance > 0 ? 'down' : 'up';\n    }; // 计算2点之间的距离\n\n\n    var calcDistance = function calcDistance(point1, point2) {\n      var xDistance = Math.abs(point2.x - point1.x);\n      var yDistance = Math.abs(point2.y - point1.y);\n      return Math.sqrt(xDistance * xDistance + yDistance * yDistance);\n    };\n\n    var getCenter = function getCenter(point1, point2) {\n      var x = point1.x + (point2.x - point1.x) / 2;\n      var y = point1.y + (point2.y - point1.y) / 2;\n      return {\n        x: x,\n        y: y\n      };\n    };\n\n    var PRESS_DELAY = 250;\n\n    var EventController = /*#__PURE__*/function () {\n      function EventController(_ref) {\n        var _this = this;\n\n        var canvas = _ref.canvas,\n            el = _ref.el;\n\n        _defineProperty(this, \"_click\", function (ev) {\n          var points = convertPoints(ev, _this.canvas);\n          ev.points = points;\n\n          _this.emitEvent('click', ev);\n        });\n\n        _defineProperty(this, \"_start\", function (ev) {\n          var points = convertPoints(ev, _this.canvas);\n\n          if (!points) {\n            return;\n          }\n\n          ev.points = points;\n\n          _this.emitEvent('touchstart', ev); // 防止上次的内容没有清理掉，重新reset下\n\n\n          _this.reset(); // 记录touch start 的时间\n\n\n          _this.startTime = Date.now(); // 记录touch start 的点\n\n          _this.startPoints = points;\n\n          if (points.length > 1) {\n            _this.startDistance = calcDistance(points[0], points[1]);\n            _this.center = getCenter(points[0], points[1]);\n          } else {\n            // 如果touchstart后停顿250ms, 则也触发press事件\n            _this.pressTimeout = setTimeout(function () {\n              // 这里固定触发press事件\n              var eventType = 'press';\n              var direction = 'none';\n              ev.direction = direction;\n\n              _this.emitStart(eventType, ev);\n\n              _this.emitEvent(eventType, ev);\n\n              _this.eventType = eventType;\n              _this.direction = direction;\n            }, PRESS_DELAY);\n          }\n        });\n\n        _defineProperty(this, \"_move\", function (ev) {\n          var points = convertPoints(ev, _this.canvas);\n          if (!points) return;\n\n          _this.clearPressTimeout();\n\n          ev.points = points;\n\n          _this.emitEvent('touchmove', ev);\n\n          var startPoints = _this.startPoints;\n          if (!startPoints) return; // 多指触控\n\n          if (points.length > 1) {\n            // touchstart的距离\n            var startDistance = _this.startDistance;\n            var currentDistance = calcDistance(points[0], points[1]);\n            ev.zoom = currentDistance / startDistance;\n            ev.center = _this.center; // 触发缩放事件\n\n            _this.emitStart('pinch', ev);\n\n            _this.emitEvent('pinch', ev);\n          } else {\n            var deltaX = points[0].x - startPoints[0].x;\n            var deltaY = points[0].y - startPoints[0].y;\n            var direction = _this.direction || calcDirection(startPoints[0], points[0]);\n            _this.direction = direction; // 获取press或者pan的事件类型\n            // press 按住滑动, pan表示平移\n            // 如果start后立刻move，则触发pan, 如果有停顿，则触发press\n\n            var eventType = _this.getEventType(points);\n\n            ev.direction = direction;\n            ev.deltaX = deltaX;\n            ev.deltaY = deltaY;\n\n            _this.emitStart(eventType, ev);\n\n            _this.emitEvent(eventType, ev); // 记录最后2次move的时间和坐标，为了给swipe事件用\n\n\n            var prevMoveTime = _this.lastMoveTime;\n            var now = Date.now(); // 最后2次的时间间隔一定要大于0，否则swipe没发计算\n\n            if (now - prevMoveTime > 0) {\n              _this.prevMoveTime = prevMoveTime;\n              _this.prevMovePoints = _this.lastMovePoints;\n              _this.lastMoveTime = now;\n              _this.lastMovePoints = points;\n            }\n          }\n        });\n\n        _defineProperty(this, \"_end\", function (ev) {\n          var points = convertPoints(ev, _this.canvas);\n          ev.points = points;\n\n          _this.emitEnd(ev);\n\n          _this.emitEvent('touchend', ev); // swipe事件处理, 在touchend之后触发\n\n\n          var lastMoveTime = _this.lastMoveTime;\n          var now = Date.now(); // 做这个判断是为了最后一次touchmove后到end前，还有一个停顿的过程\n          // 100 是拍的一个值，理论这个值会很短，一般不卡顿的话在10ms以内\n\n          if (now - lastMoveTime < 100) {\n            var prevMoveTime = _this.prevMoveTime || _this.startTime;\n            var intervalTime = lastMoveTime - prevMoveTime; // 时间间隔一定要大于0, 否则计算没意义\n\n            if (intervalTime > 0) {\n              var prevMovePoints = _this.prevMovePoints || _this.startPoints;\n              var lastMovePoints = _this.lastMovePoints; // move速率\n\n              var velocity = calcDistance(prevMovePoints[0], lastMovePoints[0]) / intervalTime; // 0.3 是参考hammerjs的设置\n\n              if (velocity > 0.3) {\n                ev.velocity = velocity;\n                ev.direction = calcDirection(prevMovePoints[0], lastMovePoints[0]);\n\n                _this.emitEvent('swipe', ev);\n              }\n            }\n          }\n\n          _this.reset();\n\n          var touches = ev.touches; // 当多指只释放了1指时也会触发end, 这时重新触发一次start\n\n          if (touches && touches.length > 0) {\n            _this._start(ev);\n          }\n        });\n\n        _defineProperty(this, \"_cancel\", function (ev) {\n          _this.emitEvent('touchcancel', ev);\n\n          _this.reset();\n        });\n\n        // canvasEl\n        this.canvas = canvas;\n        this.delegateEvent(el); // 用来记录当前触发的事件\n\n        this.processEvent = {};\n      }\n\n      var _proto = EventController.prototype;\n\n      _proto.delegateEvent = function delegateEvent(canvasEl) {\n        // 代理这几个事件\n        canvasEl.addEventListener('click', this._click);\n        canvasEl.addEventListener('touchstart', this._start);\n        canvasEl.addEventListener('touchmove', this._move);\n        canvasEl.addEventListener('touchend', this._end);\n        canvasEl.addEventListener('touchcancel', this._cancel);\n      };\n\n      _proto.emitEvent = function emitEvent(type, ev) {\n        var canvas = this.canvas;\n        canvas.emit(type, ev);\n      };\n\n      _proto.getEventType = function getEventType(points) {\n        var eventType = this.eventType,\n            canvas = this.canvas,\n            startTime = this.startTime,\n            startPoints = this.startPoints;\n\n        if (eventType) {\n          return eventType;\n        }\n\n        var type;\n        var panEventListeners = canvas.__events.pan; // 如果没有pan事件的监听，默认都是press\n\n        if (!panEventListeners || !panEventListeners.length) {\n          type = 'press';\n        } else {\n          // 如果有pan事件的处理，press则需要停顿250ms, 且移动距离小于10\n          var now = Date.now();\n\n          if (now - startTime > PRESS_DELAY && calcDistance(startPoints[0], points[0]) < 10) {\n            type = 'press';\n          } else {\n            type = 'pan';\n          }\n        }\n\n        this.eventType = type;\n        return type;\n      };\n\n      _proto.enable = function enable(eventType) {\n        this.processEvent[eventType] = true;\n      } // 是否进行中的事件\n      ;\n\n      _proto.isProcess = function isProcess(eventType) {\n        return this.processEvent[eventType];\n      } // 触发start事件\n      ;\n\n      _proto.emitStart = function emitStart(type, ev) {\n        if (this.isProcess(type)) {\n          return;\n        }\n\n        this.enable(type);\n        this.emitEvent(type + \"start\", ev);\n      } // 触发end事件\n      ;\n\n      _proto.emitEnd = function emitEnd(ev) {\n        var _this2 = this;\n\n        var processEvent = this.processEvent;\n        Object.keys(processEvent).forEach(function (type) {\n          _this2.emitEvent(type + \"end\", ev);\n\n          delete processEvent[type];\n        });\n      };\n\n      _proto.clearPressTimeout = function clearPressTimeout() {\n        if (this.pressTimeout) {\n          clearTimeout(this.pressTimeout);\n          this.pressTimeout = 0;\n        }\n      };\n\n      _proto.reset = function reset() {\n        this.clearPressTimeout();\n        this.startTime = 0;\n        this.startPoints = null;\n        this.startDistance = 0;\n        this.direction = null;\n        this.eventType = null;\n        this.pinch = false;\n        this.prevMoveTime = 0;\n        this.prevMovePoints = null;\n        this.lastMoveTime = 0;\n        this.lastMovePoints = null;\n      };\n\n      return EventController;\n    }();\n\n    var CanvasElement = /*#__PURE__*/function (_EventEmit) {\n      _inheritsLoose(CanvasElement, _EventEmit);\n\n      function CanvasElement(ctx) {\n        var _this;\n\n        _this = _EventEmit.call(this) || this;\n        _this.context = ctx; // canvas实际的宽高 (width/height) * pixelRatio\n\n        _this.width = 0;\n        _this.height = 0;\n        _this.style = {};\n        _this.currentStyle = {};\n        _this.attrs = {}; // 用来标识是CanvasElement实例\n\n        _this.isCanvasElement = true;\n        return _this;\n      }\n\n      var _proto = CanvasElement.prototype;\n\n      _proto.getContext = function getContext()\n      /* type */\n      {\n        return this.context;\n      };\n\n      _proto.getBoundingClientRect = function getBoundingClientRect() {\n        var width = this.width;\n        var height = this.height; // 默认都处理成可视窗口的顶部位置\n\n        return {\n          top: 0,\n          right: width,\n          bottom: height,\n          left: 0\n        };\n      };\n\n      _proto.setAttribute = function setAttribute(key, value) {\n        this.attrs[key] = value;\n      };\n\n      _proto.addEventListener = function addEventListener(type, listener) {\n        this.on(type, listener);\n      };\n\n      _proto.removeEventListener = function removeEventListener(type, listener) {\n        this.off(type, listener);\n      };\n\n      _proto.dispatchEvent = function dispatchEvent(type, e) {\n        this.emit(type, e);\n      };\n\n      return CanvasElement;\n    }(EventEmit);\n\n    function supportEventListener(canvas) {\n      if (!canvas) {\n        return false;\n      } // 非 HTMLCanvasElement\n\n\n      if (canvas.nodeType !== 1 || !canvas.nodeName || canvas.nodeName.toLowerCase() !== 'canvas') {\n        return false;\n      } // 微信小程序canvas.getContext('2d')时也是CanvasRenderingContext2D\n      // 也会有ctx.canvas, 而且nodeType也是1，所以还要在看下是否支持addEventListener\n\n\n      var support = false;\n\n      try {\n        canvas.addEventListener('eventTest', function () {\n          support = true;\n        });\n        canvas.dispatchEvent(new Event('eventTest'));\n      } catch (error) {\n        support = false;\n      }\n\n      return support;\n    }\n\n    var CanvasElement$1 = {\n      create: function create(ctx) {\n        if (!ctx) {\n          return null;\n        }\n\n        if (supportEventListener(ctx.canvas)) {\n          return ctx.canvas;\n        }\n\n        return new CanvasElement(ctx);\n      }\n    };\n\n    function _mod(n, m) {\n      return (n % m + m) % m;\n    }\n\n    function _addStop(steps, gradient) {\n      each(steps, function (item) {\n        item = item.split(':');\n        gradient.addColorStop(Number(item[0]), item[1]);\n      });\n    } // the string format: 'l(0) 0:#ffffff 0.5:#7ec2f3 1:#1890ff'\n\n\n    function _parseLineGradient(color, shape, context) {\n      var arr = color.split(' ');\n      var angle = arr[0].slice(2, arr[0].length - 1);\n      angle = _mod(parseFloat(angle) * Math.PI / 180, Math.PI * 2);\n      var steps = arr.slice(1);\n\n      var _shape$getBBox = shape.getBBox(),\n          minX = _shape$getBBox.minX,\n          minY = _shape$getBBox.minY,\n          maxX = _shape$getBBox.maxX,\n          maxY = _shape$getBBox.maxY;\n\n      var start;\n      var end;\n\n      if (angle >= 0 && angle < 0.5 * Math.PI) {\n        start = {\n          x: minX,\n          y: minY\n        };\n        end = {\n          x: maxX,\n          y: maxY\n        };\n      } else if (0.5 * Math.PI <= angle && angle < Math.PI) {\n        start = {\n          x: maxX,\n          y: minY\n        };\n        end = {\n          x: minX,\n          y: maxY\n        };\n      } else if (Math.PI <= angle && angle < 1.5 * Math.PI) {\n        start = {\n          x: maxX,\n          y: maxY\n        };\n        end = {\n          x: minX,\n          y: minY\n        };\n      } else {\n        start = {\n          x: minX,\n          y: maxY\n        };\n        end = {\n          x: maxX,\n          y: minY\n        };\n      }\n\n      var tanTheta = Math.tan(angle);\n      var tanTheta2 = tanTheta * tanTheta;\n      var x = (end.x - start.x + tanTheta * (end.y - start.y)) / (tanTheta2 + 1) + start.x;\n      var y = tanTheta * (end.x - start.x + tanTheta * (end.y - start.y)) / (tanTheta2 + 1) + start.y;\n      var gradient = context.createLinearGradient(start.x, start.y, x, y);\n\n      _addStop(steps, gradient);\n\n      return gradient;\n    } // the string format: 'r(0.5, 0.5, 0.1) 0:#ffffff 1:#1890ff'\n\n\n    function _parseRadialGradient(color, shape, context) {\n      var arr = color.split(' ');\n      var circleCfg = arr[0].slice(2, arr[0].length - 1);\n      circleCfg = circleCfg.split(',');\n      var fx = parseFloat(circleCfg[0]);\n      var fy = parseFloat(circleCfg[1]);\n      var fr = parseFloat(circleCfg[2]);\n      var steps = arr.slice(1); // if radius is 0, no gradient, stroke with the last color\n\n      if (fr === 0) {\n        var _color = steps[steps.length - 1];\n        return _color.split(':')[1];\n      }\n\n      var _shape$getBBox2 = shape.getBBox(),\n          width = _shape$getBBox2.width,\n          height = _shape$getBBox2.height,\n          minX = _shape$getBBox2.minX,\n          minY = _shape$getBBox2.minY;\n\n      var r = Math.sqrt(width * width + height * height) / 2;\n      var gradient = context.createRadialGradient(minX + width * fx, minY + height * fy, fr * r, minX + width / 2, minY + height / 2, r);\n\n      _addStop(steps, gradient);\n\n      return gradient;\n    }\n\n    function parseStyle(color, shape, context) {\n      if (color[1] === '(') {\n        try {\n          var firstCode = color[0];\n\n          if (firstCode === 'l') {\n            return _parseLineGradient(color, shape, context);\n          } else if (firstCode === 'r') {\n            return _parseRadialGradient(color, shape, context);\n          }\n        } catch (ev) {\n          console.error('error in parsing gradient string, please check if there are any extra whitespaces.');\n          console.error(ev);\n        }\n      }\n\n      return color;\n    }\n\n    var ALIAS_ATTRS_MAP = {\n      stroke: 'strokeStyle',\n      fill: 'fillStyle',\n      opacity: 'globalAlpha'\n    };\n    var SHAPE_ATTRS = ['fillStyle', 'font', 'globalAlpha', 'lineCap', 'lineWidth', 'lineJoin', 'miterLimit', 'shadowBlur', 'shadowColor', 'shadowOffsetX', 'shadowOffsetY', 'strokeStyle', 'textAlign', 'textBaseline', 'lineDash', 'shadow' // 兼容支付宝小程序\n    ];\n    var CLIP_SHAPES = ['circle', 'sector', 'polygon', 'rect', 'polyline'];\n\n    var Element = /*#__PURE__*/function () {\n      var _proto = Element.prototype;\n\n      _proto._initProperties = function _initProperties() {\n        this._attrs = {\n          zIndex: 0,\n          visible: true,\n          destroyed: false\n        };\n      };\n\n      function Element(cfg) {\n        this._initProperties();\n\n        mix(this._attrs, cfg);\n        var attrs = this._attrs.attrs;\n\n        if (attrs) {\n          this.initAttrs(attrs);\n        }\n\n        this.initTransform();\n      }\n\n      _proto.get = function get(name) {\n        return this._attrs[name];\n      };\n\n      _proto.set = function set(name, value) {\n        this._attrs[name] = value;\n      };\n\n      _proto.isGroup = function isGroup() {\n        return this.get('isGroup');\n      };\n\n      _proto.isShape = function isShape() {\n        return this.get('isShape');\n      };\n\n      _proto.initAttrs = function initAttrs(attrs) {\n        this.attr(mix(this.getDefaultAttrs(), attrs));\n      };\n\n      _proto.getDefaultAttrs = function getDefaultAttrs() {\n        return {};\n      };\n\n      _proto._setAttr = function _setAttr(name, value) {\n        var attrs = this._attrs.attrs;\n\n        if (name === 'clip') {\n          value = this._setAttrClip(value);\n        } else {\n          var alias = ALIAS_ATTRS_MAP[name];\n\n          if (alias) {\n            attrs[alias] = value;\n          }\n        }\n\n        attrs[name] = value;\n      };\n\n      _proto._getAttr = function _getAttr(name) {\n        return this._attrs.attrs[name];\n      } // _afterAttrsSet() {}\n      ;\n\n      _proto._setAttrClip = function _setAttrClip(clip) {\n        if (clip && CLIP_SHAPES.indexOf(clip._attrs.type) > -1) {\n          if (clip.get('canvas') === null) {\n            clip = Object.assign({}, clip);\n          }\n\n          clip.set('parent', this.get('parent'));\n          clip.set('context', this.get('context'));\n          return clip;\n        }\n\n        return null;\n      };\n\n      _proto.attr = function attr(name, value) {\n        var self = this;\n        if (self.get('destroyed')) return null;\n        var argumentsLen = arguments.length;\n\n        if (argumentsLen === 0) {\n          return self._attrs.attrs;\n        }\n\n        if (isObject(name)) {\n          this._attrs.bbox = null;\n\n          for (var k in name) {\n            self._setAttr(k, name[k]);\n          }\n\n          if (self._afterAttrsSet) {\n            self._afterAttrsSet();\n          }\n\n          return self;\n        }\n\n        if (argumentsLen === 2) {\n          this._attrs.bbox = null;\n\n          self._setAttr(name, value);\n\n          if (self._afterAttrsSet) {\n            self._afterAttrsSet();\n          }\n\n          return self;\n        }\n\n        return self._getAttr(name);\n      };\n\n      _proto.getParent = function getParent() {\n        return this.get('parent');\n      };\n\n      _proto.draw = function draw(context) {\n        if (this.get('destroyed')) {\n          return;\n        }\n\n        if (this.get('visible')) {\n          this.setContext(context);\n          this.drawInner(context);\n          this.restoreContext(context);\n        }\n      };\n\n      _proto.setContext = function setContext(context) {\n        var clip = this._attrs.attrs.clip;\n        context.save();\n\n        if (clip) {\n          clip.resetTransform(context);\n          clip.createPath(context);\n          context.clip();\n        }\n\n        this.resetContext(context);\n        this.resetTransform(context);\n      };\n\n      _proto.restoreContext = function restoreContext(context) {\n        context.restore();\n      };\n\n      _proto.resetContext = function resetContext(context) {\n        var elAttrs = this._attrs.attrs;\n\n        if (!this._attrs.isGroup) {\n          for (var k in elAttrs) {\n            if (SHAPE_ATTRS.indexOf(k) > -1) {\n              var v = elAttrs[k];\n\n              if ((k === 'fillStyle' || k === 'strokeStyle') && v) {\n                v = parseStyle(v, this, context);\n              }\n\n              if (k === 'lineDash' && context.setLineDash && isArray(v)) {\n                context.setLineDash(v);\n              } else {\n                context[k] = v;\n              }\n            }\n          }\n        }\n      };\n\n      _proto.hasFill = function hasFill() {\n        return this.get('canFill') && this._attrs.attrs.fillStyle;\n      };\n\n      _proto.hasStroke = function hasStroke() {\n        return this.get('canStroke') && this._attrs.attrs.strokeStyle;\n      };\n\n      _proto.drawInner = function drawInner()\n      /* context */\n      {};\n\n      _proto.show = function show() {\n        this.set('visible', true);\n        return this;\n      };\n\n      _proto.hide = function hide() {\n        this.set('visible', false);\n        return this;\n      };\n\n      _proto.isVisible = function isVisible() {\n        return this.get('visible');\n      };\n\n      _proto.getAriaLabel = function getAriaLabel() {\n        var _this$_attrs = this._attrs,\n            destroyed = _this$_attrs.destroyed,\n            visible = _this$_attrs.visible,\n            isShape = _this$_attrs.isShape,\n            aria = _this$_attrs.aria;\n\n        if (destroyed || !visible || isShape && !aria) {\n          return;\n        }\n\n        return this._getAriaLabel();\n      };\n\n      _proto._getAriaLabel = function _getAriaLabel() {\n        return this._attrs.ariaLabel;\n      };\n\n      _proto._removeFromParent = function _removeFromParent() {\n        var parent = this.get('parent');\n\n        if (parent) {\n          var children = parent.get('children');\n          remove(children, this);\n        }\n\n        return this;\n      };\n\n      _proto.remove = function remove(destroy) {\n        if (destroy) {\n          this.destroy();\n        } else {\n          this._removeFromParent();\n        }\n      };\n\n      _proto.destroy = function destroy() {\n        var destroyed = this.get('destroyed');\n\n        if (destroyed) {\n          return null;\n        }\n\n        this._removeFromParent();\n\n        this._attrs = {};\n        this.set('destroyed', true);\n      };\n\n      _proto.getBBox = function getBBox() {\n        return {\n          minX: 0,\n          maxX: 0,\n          minY: 0,\n          maxY: 0,\n          width: 0,\n          height: 0\n        };\n      };\n\n      _proto.initTransform = function initTransform() {\n        var attrs = this._attrs.attrs || {};\n\n        if (!attrs.matrix) {\n          attrs.matrix = [1, 0, 0, 1, 0, 0];\n        }\n\n        this._attrs.attrs = attrs;\n      };\n\n      _proto.getMatrix = function getMatrix() {\n        return this._attrs.attrs.matrix;\n      };\n\n      _proto.setMatrix = function setMatrix(m) {\n        this._attrs.attrs.matrix = [m[0], m[1], m[2], m[3], m[4], m[5]];\n      };\n\n      _proto.transform = function transform(actions) {\n        var matrix = this._attrs.attrs.matrix;\n        this._attrs.attrs.matrix = Matrix.transform(matrix, actions);\n        return this;\n      };\n\n      _proto.setTransform = function setTransform(actions) {\n        this._attrs.attrs.matrix = [1, 0, 0, 1, 0, 0];\n        return this.transform(actions);\n      };\n\n      _proto.translate = function translate(x, y) {\n        var matrix = this._attrs.attrs.matrix;\n        Matrix.translate(matrix, matrix, [x, y]);\n      };\n\n      _proto.rotate = function rotate(rad) {\n        var matrix = this._attrs.attrs.matrix;\n        Matrix.rotate(matrix, matrix, rad);\n      };\n\n      _proto.scale = function scale(sx, sy) {\n        var matrix = this._attrs.attrs.matrix;\n        Matrix.scale(matrix, matrix, [sx, sy]);\n      };\n\n      _proto.moveTo = function moveTo(x, y) {\n        var cx = this._attrs.x || 0;\n        var cy = this._attrs.y || 0;\n        this.translate(x - cx, y - cy);\n        this.set('x', x);\n        this.set('y', y);\n      };\n\n      _proto.apply = function apply(v) {\n        var m = this._attrs.attrs.matrix;\n        Vector2.transformMat2d(v, v, m);\n        return this;\n      };\n\n      _proto.resetTransform = function resetTransform(context) {\n        var mo = this._attrs.attrs.matrix;\n\n        if (Matrix.isChanged(mo)) {\n          context.transform(mo[0], mo[1], mo[2], mo[3], mo[4], mo[5]);\n        }\n      };\n\n      _proto.isDestroyed = function isDestroyed() {\n        return this.get('destroyed');\n      };\n\n      return Element;\n    }();\n\n    var Shape$2 = /*#__PURE__*/function (_Element) {\n      _inheritsLoose(Shape, _Element);\n\n      function Shape() {\n        return _Element.apply(this, arguments) || this;\n      }\n\n      var _proto = Shape.prototype;\n\n      _proto._initProperties = function _initProperties() {\n        this._attrs = {\n          zIndex: 0,\n          visible: true,\n          destroyed: false,\n          isShape: true,\n          attrs: {}\n        };\n      };\n\n      _proto.getType = function getType() {\n        return this._attrs.type;\n      };\n\n      _proto.drawInner = function drawInner(context) {\n        var self = this;\n        var attrs = self.get('attrs');\n        self.createPath(context);\n        var originOpacity = context.globalAlpha;\n\n        if (self.hasFill()) {\n          var fillOpacity = attrs.fillOpacity;\n\n          if (!isNil(fillOpacity) && fillOpacity !== 1) {\n            context.globalAlpha = fillOpacity;\n            context.fill();\n            context.globalAlpha = originOpacity;\n          } else {\n            context.fill();\n          }\n        }\n\n        if (self.hasStroke()) {\n          var lineWidth = attrs.lineWidth;\n\n          if (lineWidth > 0) {\n            var strokeOpacity = attrs.strokeOpacity;\n\n            if (!isNil(strokeOpacity) && strokeOpacity !== 1) {\n              context.globalAlpha = strokeOpacity;\n            }\n\n            context.stroke();\n          }\n        }\n      };\n\n      _proto.getBBox = function getBBox() {\n        var bbox = this._attrs.bbox;\n\n        if (!bbox) {\n          bbox = this.calculateBox();\n\n          if (bbox) {\n            bbox.x = bbox.minX;\n            bbox.y = bbox.minY;\n            bbox.width = bbox.maxX - bbox.minX;\n            bbox.height = bbox.maxY - bbox.minY;\n          }\n\n          this._attrs.bbox = bbox;\n        }\n\n        return bbox;\n      };\n\n      _proto.calculateBox = function calculateBox() {\n        return null;\n      };\n\n      _proto.createPath = function createPath() {};\n\n      return Shape;\n    }(Element);\n\n    function parseRadius(radius, width, height) {\n      radius = parsePadding(radius); // 都为0\n\n      if (!radius[0] && !radius[1] && !radius[2] && !radius[3]) {\n        return radius;\n      }\n\n      var minWidth = Math.max(radius[0] + radius[1], radius[2] + radius[3]);\n      var minHeight = Math.max(radius[0] + radius[3], radius[1] + radius[2]);\n      var scale = Math.min(width / minWidth, height / minHeight);\n\n      if (scale < 1) {\n        return radius.map(function (r) {\n          return r * scale;\n        });\n      }\n\n      return radius;\n    }\n\n    var Rect = /*#__PURE__*/function (_Shape) {\n      _inheritsLoose(Rect, _Shape);\n\n      function Rect() {\n        return _Shape.apply(this, arguments) || this;\n      }\n\n      var _proto = Rect.prototype;\n\n      _proto._initProperties = function _initProperties() {\n        _Shape.prototype._initProperties.call(this);\n\n        this._attrs.canFill = true;\n        this._attrs.canStroke = true;\n        this._attrs.type = 'rect';\n      };\n\n      _proto.getDefaultAttrs = function getDefaultAttrs() {\n        return {\n          x: 0,\n          y: 0,\n          width: 0,\n          height: 0,\n          radius: 0,\n          lineWidth: 0\n        };\n      };\n\n      _proto.createRadiusPath = function createRadiusPath(context, x, y, width, height, radius) {\n        radius = parseRadius(radius, width, height);\n        context.moveTo(x + radius[0], y);\n        context.lineTo(x + width - radius[1], y);\n        context.arc(x + width - radius[1], y + radius[1], radius[1], -Math.PI / 2, 0, false);\n        context.lineTo(x + width, y + height - radius[2]);\n        context.arc(x + width - radius[2], y + height - radius[2], radius[2], 0, Math.PI / 2, false);\n        context.lineTo(x + radius[3], y + height);\n        context.arc(x + radius[3], y + height - radius[3], radius[3], Math.PI / 2, Math.PI, false);\n        context.lineTo(x, y + radius[0]);\n        context.arc(x + radius[0], y + radius[0], radius[0], Math.PI, Math.PI * 3 / 2, false);\n        context.closePath();\n      };\n\n      _proto.createPath = function createPath(context) {\n        var self = this;\n        var attrs = self.get('attrs');\n        var x = attrs.x,\n            y = attrs.y,\n            width = attrs.width,\n            height = attrs.height,\n            radius = attrs.radius;\n        context.beginPath();\n\n        if (!radius || !(width * height)) {\n          context.rect(x, y, width, height);\n        } else {\n          this.createRadiusPath(context, x, y, width, height, radius);\n        }\n      };\n\n      _proto.calculateBox = function calculateBox() {\n        var attrs = this.get('attrs');\n        var x = attrs.x,\n            y = attrs.y,\n            width = attrs.width,\n            height = attrs.height;\n        return {\n          minX: x,\n          minY: y,\n          maxX: x + width,\n          maxY: y + height\n        };\n      };\n\n      return Rect;\n    }(Shape$2);\n\n    var ImageShape = /*#__PURE__*/function (_Rect) {\n      _inheritsLoose(ImageShape, _Rect);\n\n      function ImageShape() {\n        return _Rect.apply(this, arguments) || this;\n      }\n\n      var _proto = ImageShape.prototype;\n\n      _proto._initProperties = function _initProperties() {\n        _Rect.prototype._initProperties.call(this);\n\n        this._attrs.canFill = false;\n        this._attrs.canStroke = false;\n        this._attrs.loading = false;\n        this._attrs.image = null;\n        this._attrs.type = 'image';\n      };\n\n      _proto.createPath = function createPath(context) {\n        var _this = this;\n\n        var attrs = this.get('attrs');\n        var src = attrs.src;\n\n        if (this.get('loading')) {\n          return;\n        }\n\n        var image = this.get('image');\n\n        if (image) {\n          this.drawImage(context, image);\n        } else {\n          if (src && Image) {\n            this.set('loading', true);\n\n            var _image = new Image();\n\n            _image.src = src; // 设置跨域\n\n            _image.crossOrigin = 'Anonymous';\n\n            _image.onload = function () {\n              _this.set('loading', false);\n\n              _this.set('image', _image);\n\n              _this.drawImage(context, _image);\n            };\n          }\n        }\n      };\n\n      _proto.drawImage = function drawImage(context, image) {\n        var _this$_attrs = this._attrs,\n            attrs = _this$_attrs.attrs,\n            destroyed = _this$_attrs.destroyed;\n\n        if (destroyed) {\n          return;\n        }\n\n        var x = attrs.x,\n            y = attrs.y,\n            width = attrs.width,\n            height = attrs.height,\n            sx = attrs.sx,\n            sy = attrs.sy,\n            swidth = attrs.swidth,\n            sheight = attrs.sheight,\n            radius = attrs.radius;\n\n        if (radius) {\n          context.save();\n          this.createRadiusPath(context, x, y, width, height, radius);\n          context.clip();\n        }\n\n        if (!isNil(sx) && !isNil(sy) && !isNil(swidth) && !isNil(sheight)) {\n          context.drawImage(image, sx, sy, swidth, sheight, x, y, width, height);\n        } else {\n          context.drawImage(image, x, y, width, height);\n        }\n\n        if (radius) {\n          // 因为 save 和 restore 会一定程度上影响绘图性能，所以只在必要是调用\n          context.restore();\n        }\n      };\n\n      return ImageShape;\n    }(Rect);\n\n    var Circle = /*#__PURE__*/function (_Shape) {\n      _inheritsLoose(Circle, _Shape);\n\n      function Circle() {\n        return _Shape.apply(this, arguments) || this;\n      }\n\n      var _proto = Circle.prototype;\n\n      _proto._initProperties = function _initProperties() {\n        _Shape.prototype._initProperties.call(this);\n\n        this._attrs.canFill = true;\n        this._attrs.canStroke = true;\n        this._attrs.type = 'circle';\n      };\n\n      _proto.getDefaultAttrs = function getDefaultAttrs() {\n        return {\n          x: 0,\n          y: 0,\n          r: 0,\n          lineWidth: 0\n        };\n      };\n\n      _proto.createPath = function createPath(context) {\n        var attrs = this.get('attrs');\n        var x = attrs.x,\n            y = attrs.y,\n            r = attrs.r;\n        context.beginPath();\n        context.arc(x, y, r, 0, Math.PI * 2, false);\n        context.closePath();\n      };\n\n      _proto.calculateBox = function calculateBox() {\n        var attrs = this.get('attrs');\n        var x = attrs.x,\n            y = attrs.y,\n            r = attrs.r;\n        return {\n          minX: x - r,\n          maxX: x + r,\n          minY: y - r,\n          maxY: y + r\n        };\n      };\n\n      return Circle;\n    }(Shape$2);\n\n    var start = Vector2.create();\n    var end = Vector2.create();\n    var extremity = Vector2.create();\n\n    function getCubicBezierXYatT(startPt, controlPt1, controlPt2, endPt, T) {\n      var x = CubicN(T, startPt.x, controlPt1.x, controlPt2.x, endPt.x);\n      var y = CubicN(T, startPt.y, controlPt1.y, controlPt2.y, endPt.y);\n      return {\n        x: x,\n        y: y\n      };\n    } // cubic helper formula at T distance\n\n\n    function CubicN(T, a, b, c, d) {\n      var t2 = T * T;\n      var t3 = t2 * T;\n      return a + (-a * 3 + T * (3 * a - a * T)) * T + (3 * b + T * (-6 * b + b * 3 * T)) * T + (c * 3 - c * 3 * T) * t2 + d * t3;\n    }\n\n    function cubicBezierBounds(c) {\n      var minX = Infinity;\n      var maxX = -Infinity;\n      var minY = Infinity;\n      var maxY = -Infinity;\n      var s = {\n        x: c[0],\n        y: c[1]\n      };\n      var c1 = {\n        x: c[2],\n        y: c[3]\n      };\n      var c2 = {\n        x: c[4],\n        y: c[5]\n      };\n      var e = {\n        x: c[6],\n        y: c[7]\n      };\n\n      for (var t = 0; t < 100; t++) {\n        var pt = getCubicBezierXYatT(s, c1, c2, e, t / 100);\n\n        if (pt.x < minX) {\n          minX = pt.x;\n        }\n\n        if (pt.x > maxX) {\n          maxX = pt.x;\n        }\n\n        if (pt.y < minY) {\n          minY = pt.y;\n        }\n\n        if (pt.y > maxY) {\n          maxY = pt.y;\n        }\n      }\n\n      return {\n        minX: minX,\n        minY: minY,\n        maxX: maxX,\n        maxY: maxY\n      };\n    }\n\n    function getBBoxFromPoints(points, lineWidth) {\n      if (points.length === 0) {\n        return;\n      }\n\n      var p = points[0];\n      var left = p.x;\n      var right = p.x;\n      var top = p.y;\n      var bottom = p.y;\n      var len = points.length;\n\n      for (var i = 1; i < len; i++) {\n        p = points[i];\n        left = Math.min(left, p.x);\n        right = Math.max(right, p.x);\n        top = Math.min(top, p.y);\n        bottom = Math.max(bottom, p.y);\n      }\n\n      lineWidth = lineWidth / 2 || 0;\n      return {\n        minX: left - lineWidth,\n        minY: top - lineWidth,\n        maxX: right + lineWidth,\n        maxY: bottom + lineWidth\n      };\n    }\n\n    function getBBoxFromLine(x0, y0, x1, y1, lineWidth) {\n      lineWidth = lineWidth / 2 || 0;\n      return {\n        minX: Math.min(x0, x1) - lineWidth,\n        minY: Math.min(y0, y1) - lineWidth,\n        maxX: Math.max(x0, x1) + lineWidth,\n        maxY: Math.max(y0, y1) + lineWidth\n      };\n    }\n\n    function getBBoxFromArc(x, y, r, startAngle, endAngle, anticlockwise) {\n      var diff = Math.abs(startAngle - endAngle);\n\n      if (diff % (Math.PI * 2) < 1e-4 && diff > 1e-4) {\n        // Is a circle\n        return {\n          minX: x - r,\n          minY: y - r,\n          maxX: x + r,\n          maxY: y + r\n        };\n      }\n\n      start[0] = Math.cos(startAngle) * r + x;\n      start[1] = Math.sin(startAngle) * r + y;\n      end[0] = Math.cos(endAngle) * r + x;\n      end[1] = Math.sin(endAngle) * r + y;\n      var min = [0, 0];\n      var max = [0, 0];\n      Vector2.min(min, start, end);\n      Vector2.max(max, start, end); // Thresh to [0, Math.PI * 2]\n\n      startAngle = startAngle % (Math.PI * 2);\n\n      if (startAngle < 0) {\n        startAngle = startAngle + Math.PI * 2;\n      }\n\n      endAngle = endAngle % (Math.PI * 2);\n\n      if (endAngle < 0) {\n        endAngle = endAngle + Math.PI * 2;\n      }\n\n      if (startAngle > endAngle && !anticlockwise) {\n        endAngle += Math.PI * 2;\n      } else if (startAngle < endAngle && anticlockwise) {\n        startAngle += Math.PI * 2;\n      }\n\n      if (anticlockwise) {\n        var tmp = endAngle;\n        endAngle = startAngle;\n        startAngle = tmp;\n      }\n\n      for (var angle = 0; angle < endAngle; angle += Math.PI / 2) {\n        if (angle > startAngle) {\n          extremity[0] = Math.cos(angle) * r + x;\n          extremity[1] = Math.sin(angle) * r + y;\n          Vector2.min(min, extremity, min);\n          Vector2.max(max, extremity, max);\n        }\n      }\n\n      return {\n        minX: min[0],\n        minY: min[1],\n        maxX: max[0],\n        maxY: max[1]\n      };\n    }\n\n    function getBBoxFromBezierGroup(points, lineWidth) {\n      var minX = Infinity;\n      var maxX = -Infinity;\n      var minY = Infinity;\n      var maxY = -Infinity;\n\n      for (var i = 0, len = points.length; i < len; i++) {\n        var bbox = cubicBezierBounds(points[i]);\n\n        if (bbox.minX < minX) {\n          minX = bbox.minX;\n        }\n\n        if (bbox.maxX > maxX) {\n          maxX = bbox.maxX;\n        }\n\n        if (bbox.minY < minY) {\n          minY = bbox.minY;\n        }\n\n        if (bbox.maxY > maxY) {\n          maxY = bbox.maxY;\n        }\n      }\n\n      lineWidth = lineWidth / 2 || 0;\n      return {\n        minX: minX - lineWidth,\n        minY: minY - lineWidth,\n        maxX: maxX + lineWidth,\n        maxY: maxY + lineWidth\n      };\n    }\n\n    var Line$1 = /*#__PURE__*/function (_Shape) {\n      _inheritsLoose(Line, _Shape);\n\n      function Line() {\n        return _Shape.apply(this, arguments) || this;\n      }\n\n      var _proto = Line.prototype;\n\n      _proto._initProperties = function _initProperties() {\n        _Shape.prototype._initProperties.call(this);\n\n        this._attrs.canStroke = true;\n        this._attrs.type = 'line';\n      };\n\n      _proto.getDefaultAttrs = function getDefaultAttrs() {\n        return {\n          x1: 0,\n          y1: 0,\n          x2: 0,\n          y2: 0,\n          lineWidth: 1\n        };\n      };\n\n      _proto.createPath = function createPath(context) {\n        var attrs = this.get('attrs');\n        var x1 = attrs.x1,\n            y1 = attrs.y1,\n            x2 = attrs.x2,\n            y2 = attrs.y2;\n        context.beginPath();\n        context.moveTo(x1, y1);\n        context.lineTo(x2, y2);\n      };\n\n      _proto.calculateBox = function calculateBox() {\n        var attrs = this.get('attrs');\n        var x1 = attrs.x1,\n            y1 = attrs.y1,\n            x2 = attrs.x2,\n            y2 = attrs.y2,\n            lineWidth = attrs.lineWidth;\n        return getBBoxFromLine(x1, y1, x2, y2, lineWidth);\n      };\n\n      return Line;\n    }(Shape$2);\n\n    var Polygon = /*#__PURE__*/function (_Shape) {\n      _inheritsLoose(Polygon, _Shape);\n\n      function Polygon() {\n        return _Shape.apply(this, arguments) || this;\n      }\n\n      var _proto = Polygon.prototype;\n\n      _proto._initProperties = function _initProperties() {\n        _Shape.prototype._initProperties.call(this);\n\n        this._attrs.canFill = true;\n        this._attrs.canStroke = true;\n        this._attrs.type = 'polygon';\n      };\n\n      _proto.getDefaultAttrs = function getDefaultAttrs() {\n        return {\n          points: null,\n          lineWidth: 0\n        };\n      };\n\n      _proto.createPath = function createPath(context) {\n        var self = this;\n        var attrs = self.get('attrs');\n        var points = attrs.points;\n        context.beginPath();\n\n        for (var i = 0, len = points.length; i < len; i++) {\n          var point = points[i];\n\n          if (i === 0) {\n            context.moveTo(point.x, point.y);\n          } else {\n            context.lineTo(point.x, point.y);\n          }\n        }\n\n        context.closePath();\n      };\n\n      _proto.calculateBox = function calculateBox() {\n        var attrs = this.get('attrs');\n        var points = attrs.points;\n        return getBBoxFromPoints(points);\n      };\n\n      return Polygon;\n    }(Shape$2);\n\n    /**\n     * @fileOverview convert the line to curve\n     * @author dxq613@gmail.com\n     */\n\n    function getPoint(v) {\n      return [v.x, v.y];\n    }\n\n    function smoothBezier(points, smooth, isLoop, constraint) {\n      var cps = [];\n      var prevPoint;\n      var nextPoint;\n      var hasConstraint = !!constraint;\n      var min;\n      var max;\n      var point;\n      var len;\n      var l;\n      var i;\n\n      if (hasConstraint) {\n        min = [Infinity, Infinity];\n        max = [-Infinity, -Infinity];\n\n        for (i = 0, l = points.length; i < l; i++) {\n          point = getPoint(points[i]);\n          Vector2.min(min, min, point);\n          Vector2.max(max, max, point);\n        }\n\n        Vector2.min(min, min, constraint[0]);\n        Vector2.max(max, max, constraint[1]);\n      }\n\n      for (i = 0, len = points.length; i < len; i++) {\n        point = getPoint(points[i]);\n\n        if (isLoop) {\n          prevPoint = getPoint(points[i ? i - 1 : len - 1]);\n          nextPoint = getPoint(points[(i + 1) % len]);\n        } else {\n          if (i === 0 || i === len - 1) {\n            cps.push([point[0], point[1]]);\n            continue;\n          } else {\n            prevPoint = getPoint(points[i - 1]);\n            nextPoint = getPoint(points[i + 1]);\n          }\n        }\n\n        var v = Vector2.sub([], nextPoint, prevPoint);\n        Vector2.scale(v, v, smooth);\n        var d0 = Vector2.distance(point, prevPoint);\n        var d1 = Vector2.distance(point, nextPoint);\n        var sum = d0 + d1;\n\n        if (sum !== 0) {\n          d0 /= sum;\n          d1 /= sum;\n        }\n\n        var v1 = Vector2.scale([], v, -d0);\n        var v2 = Vector2.scale([], v, d1);\n        var cp0 = Vector2.add([], point, v1);\n        var cp1 = Vector2.add([], point, v2);\n\n        if (hasConstraint) {\n          Vector2.max(cp0, cp0, min);\n          Vector2.min(cp0, cp0, max);\n          Vector2.max(cp1, cp1, min);\n          Vector2.min(cp1, cp1, max);\n        }\n\n        cps.push([cp0[0], cp0[1]]);\n        cps.push([cp1[0], cp1[1]]);\n      }\n\n      if (isLoop) {\n        cps.push(cps.shift());\n      }\n\n      return cps;\n    }\n\n    function catmullRom2bezier(pointList, z, constraint) {\n      var isLoop = !!z;\n      var controlPointList = smoothBezier(pointList, 0.4, isLoop, constraint);\n      var len = pointList.length;\n      var d1 = [];\n      var cp1;\n      var cp2;\n      var p;\n\n      for (var i = 0; i < len - 1; i++) {\n        cp1 = controlPointList[i * 2];\n        cp2 = controlPointList[i * 2 + 1];\n        p = pointList[i + 1];\n        d1.push(['C', cp1[0], cp1[1], cp2[0], cp2[1], p.x, p.y]);\n      }\n\n      if (isLoop) {\n        cp1 = controlPointList[len];\n        cp2 = controlPointList[len + 1];\n        p = pointList[0];\n        d1.push(['C', cp1[0], cp1[1], cp2[0], cp2[1], p.x, p.y]);\n      }\n\n      return d1;\n    }\n\n    function _filterPoints(points) {\n      var filteredPoints = [];\n\n      for (var i = 0, len = points.length; i < len; i++) {\n        var point = points[i];\n\n        if (!isNaN(point.x) && !isNaN(point.y)) {\n          filteredPoints.push(point);\n        }\n      }\n\n      return filteredPoints;\n    }\n\n    var Polyline = /*#__PURE__*/function (_Shape) {\n      _inheritsLoose(Polyline, _Shape);\n\n      function Polyline() {\n        return _Shape.apply(this, arguments) || this;\n      }\n\n      var _proto = Polyline.prototype;\n\n      _proto._initProperties = function _initProperties() {\n        _Shape.prototype._initProperties.call(this);\n\n        this._attrs.canFill = true;\n        this._attrs.canStroke = true;\n        this._attrs.type = 'polyline';\n      };\n\n      _proto.getDefaultAttrs = function getDefaultAttrs() {\n        return {\n          points: null,\n          lineWidth: 1,\n          smooth: false\n        };\n      };\n\n      _proto.createPath = function createPath(context) {\n        var self = this;\n        var attrs = self.get('attrs');\n        var points = attrs.points,\n            smooth = attrs.smooth;\n\n        var filteredPoints = _filterPoints(points);\n\n        context.beginPath();\n\n        if (filteredPoints.length) {\n          context.moveTo(filteredPoints[0].x, filteredPoints[0].y);\n\n          if (smooth) {\n            var constaint = [[0, 0], [1, 1]];\n            var sps = catmullRom2bezier(filteredPoints, false, constaint);\n\n            for (var i = 0, n = sps.length; i < n; i++) {\n              var sp = sps[i];\n              context.bezierCurveTo(sp[1], sp[2], sp[3], sp[4], sp[5], sp[6]);\n            }\n          } else {\n            var _i;\n\n            var l;\n\n            for (_i = 1, l = filteredPoints.length - 1; _i < l; _i++) {\n              context.lineTo(filteredPoints[_i].x, filteredPoints[_i].y);\n            }\n\n            context.lineTo(filteredPoints[l].x, filteredPoints[l].y);\n          }\n        }\n      };\n\n      _proto.calculateBox = function calculateBox() {\n        var attrs = this.get('attrs');\n        var points = attrs.points,\n            smooth = attrs.smooth,\n            lineWidth = attrs.lineWidth;\n\n        var filteredPoints = _filterPoints(points);\n\n        if (smooth) {\n          var newPoints = [];\n          var constaint = [[0, 0], [1, 1]];\n          var sps = catmullRom2bezier(filteredPoints, false, constaint);\n\n          for (var i = 0, n = sps.length; i < n; i++) {\n            var sp = sps[i];\n\n            if (i === 0) {\n              newPoints.push([filteredPoints[0].x, filteredPoints[0].y, sp[1], sp[2], sp[3], sp[4], sp[5], sp[6]]);\n            } else {\n              var lastPoint = sps[i - 1];\n              newPoints.push([lastPoint[5], lastPoint[6], sp[1], sp[2], sp[3], sp[4], sp[5], sp[6]]);\n            }\n          }\n\n          return getBBoxFromBezierGroup(newPoints, lineWidth);\n        }\n\n        return getBBoxFromPoints(filteredPoints, lineWidth);\n      };\n\n      return Polyline;\n    }(Shape$2);\n\n    var Arc = /*#__PURE__*/function (_Shape) {\n      _inheritsLoose(Arc, _Shape);\n\n      function Arc() {\n        return _Shape.apply(this, arguments) || this;\n      }\n\n      var _proto = Arc.prototype;\n\n      _proto._initProperties = function _initProperties() {\n        _Shape.prototype._initProperties.call(this);\n\n        this._attrs.canStroke = true;\n        this._attrs.canFill = true;\n        this._attrs.type = 'arc';\n      };\n\n      _proto.getDefaultAttrs = function getDefaultAttrs() {\n        return {\n          x: 0,\n          y: 0,\n          r: 0,\n          startAngle: 0,\n          endAngle: Math.PI * 2,\n          anticlockwise: false,\n          lineWidth: 1\n        };\n      };\n\n      _proto.createPath = function createPath(context) {\n        var attrs = this.get('attrs');\n        var x = attrs.x,\n            y = attrs.y,\n            r = attrs.r,\n            startAngle = attrs.startAngle,\n            endAngle = attrs.endAngle,\n            anticlockwise = attrs.anticlockwise;\n        context.beginPath();\n\n        if (startAngle !== endAngle) {\n          context.arc(x, y, r, startAngle, endAngle, anticlockwise);\n        }\n      };\n\n      _proto.calculateBox = function calculateBox() {\n        var attrs = this.get('attrs');\n        var x = attrs.x,\n            y = attrs.y,\n            r = attrs.r,\n            startAngle = attrs.startAngle,\n            endAngle = attrs.endAngle,\n            anticlockwise = attrs.anticlockwise;\n        return getBBoxFromArc(x, y, r, startAngle, endAngle, anticlockwise);\n      };\n\n      return Arc;\n    }(Shape$2);\n\n    var Sector = /*#__PURE__*/function (_Shape) {\n      _inheritsLoose(Sector, _Shape);\n\n      function Sector() {\n        return _Shape.apply(this, arguments) || this;\n      }\n\n      var _proto = Sector.prototype;\n\n      _proto._initProperties = function _initProperties() {\n        _Shape.prototype._initProperties.call(this);\n\n        this._attrs.canFill = true;\n        this._attrs.canStroke = true;\n        this._attrs.type = 'sector';\n      };\n\n      _proto.getDefaultAttrs = function getDefaultAttrs() {\n        return {\n          x: 0,\n          y: 0,\n          lineWidth: 0,\n          r: 0,\n          r0: 0,\n          startAngle: 0,\n          endAngle: Math.PI * 2,\n          anticlockwise: false\n        };\n      };\n\n      _proto.createPath = function createPath(context) {\n        var attrs = this.get('attrs');\n        var x = attrs.x,\n            y = attrs.y,\n            startAngle = attrs.startAngle,\n            endAngle = attrs.endAngle,\n            r = attrs.r,\n            r0 = attrs.r0,\n            anticlockwise = attrs.anticlockwise;\n        context.beginPath();\n        var unitX = Math.cos(startAngle);\n        var unitY = Math.sin(startAngle);\n        context.moveTo(unitX * r0 + x, unitY * r0 + y);\n        context.lineTo(unitX * r + x, unitY * r + y); // 当扇形的角度非常小的时候，就不进行弧线的绘制；或者整个只有1个扇形时，会出现end<0的情况不绘制\n\n        if (Math.abs(endAngle - startAngle) > 0.0001 || startAngle === 0 && endAngle < 0) {\n          context.arc(x, y, r, startAngle, endAngle, anticlockwise);\n          context.lineTo(Math.cos(endAngle) * r0 + x, Math.sin(endAngle) * r0 + y);\n\n          if (r0 !== 0) {\n            context.arc(x, y, r0, endAngle, startAngle, !anticlockwise);\n          }\n        }\n\n        context.closePath();\n      };\n\n      _proto.calculateBox = function calculateBox() {\n        var attrs = this.get('attrs');\n        var x = attrs.x,\n            y = attrs.y,\n            r = attrs.r,\n            r0 = attrs.r0,\n            startAngle = attrs.startAngle,\n            endAngle = attrs.endAngle,\n            anticlockwise = attrs.anticlockwise;\n        var outerBBox = getBBoxFromArc(x, y, r, startAngle, endAngle, anticlockwise);\n        var innerBBox = getBBoxFromArc(x, y, r0, startAngle, endAngle, anticlockwise);\n        return {\n          minX: Math.min(outerBBox.minX, innerBBox.minX),\n          minY: Math.min(outerBBox.minY, innerBBox.minY),\n          maxX: Math.max(outerBBox.maxX, innerBBox.maxX),\n          maxY: Math.max(outerBBox.maxY, innerBBox.maxY)\n        };\n      };\n\n      return Sector;\n    }(Shape$2);\n\n    var Rect$1 = {\n      calcRotatedBox: function calcRotatedBox(_ref) {\n        var width = _ref.width,\n            height = _ref.height,\n            rotate = _ref.rotate;\n        var absRotate = Math.abs(rotate);\n        return {\n          width: Math.abs(width * Math.cos(absRotate) + height * Math.sin(absRotate)),\n          height: Math.abs(height * Math.cos(absRotate) + width * Math.sin(absRotate))\n        };\n      }\n    };\n\n    var textWidthCacheCounter = 0;\n    var textWidthCache = {};\n    var TEXT_CACHE_MAX = 5000;\n\n    var Text = /*#__PURE__*/function (_Shape) {\n      _inheritsLoose(Text, _Shape);\n\n      function Text() {\n        return _Shape.apply(this, arguments) || this;\n      }\n\n      var _proto = Text.prototype;\n\n      _proto._initProperties = function _initProperties() {\n        _Shape.prototype._initProperties.call(this);\n\n        this._attrs.canFill = true;\n        this._attrs.canStroke = true;\n        this._attrs.type = 'text';\n      };\n\n      _proto.getDefaultAttrs = function getDefaultAttrs() {\n        return {\n          lineWidth: 0,\n          lineCount: 1,\n          fontSize: 12,\n          fontFamily: 'sans-serif',\n          fontStyle: 'normal',\n          fontWeight: 'normal',\n          fontVariant: 'normal',\n          textAlign: 'start',\n          textBaseline: 'bottom',\n          lineHeight: null,\n          textArr: null\n        };\n      };\n\n      _proto._getFontStyle = function _getFontStyle() {\n        var attrs = this._attrs.attrs;\n        var fontSize = attrs.fontSize,\n            fontFamily = attrs.fontFamily,\n            fontWeight = attrs.fontWeight,\n            fontStyle = attrs.fontStyle,\n            fontVariant = attrs.fontVariant;\n        return fontStyle + \" \" + fontVariant + \" \" + fontWeight + \" \" + fontSize + \"px \" + fontFamily;\n      };\n\n      _proto._afterAttrsSet = function _afterAttrsSet() {\n        var attrs = this._attrs.attrs;\n        attrs.font = this._getFontStyle();\n\n        if (attrs.text) {\n          var text = attrs.text;\n          var textArr = null;\n          var lineCount = 1;\n\n          if (isString(text) && text.indexOf('\\n') !== -1) {\n            textArr = text.split('\\n');\n            lineCount = textArr.length;\n          }\n\n          attrs.lineCount = lineCount;\n          attrs.textArr = textArr;\n        }\n\n        this.set('attrs', attrs);\n      };\n\n      _proto._getTextHeight = function _getTextHeight() {\n        var attrs = this._attrs.attrs;\n\n        if (attrs.height) {\n          return attrs.height;\n        }\n\n        var lineCount = attrs.lineCount;\n        var fontSize = attrs.fontSize * 1;\n\n        if (lineCount > 1) {\n          var spaceingY = this._getSpaceingY();\n\n          return fontSize * lineCount + spaceingY * (lineCount - 1);\n        }\n\n        return fontSize;\n      };\n\n      _proto._getSpaceingY = function _getSpaceingY() {\n        var attrs = this._attrs.attrs;\n        var lineHeight = attrs.lineHeight;\n        var fontSize = attrs.fontSize * 1;\n        return lineHeight ? lineHeight - fontSize : fontSize * 0.14;\n      };\n\n      _proto.drawInner = function drawInner(context) {\n        var self = this;\n        var attrs = self._attrs.attrs;\n        var text = attrs.text;\n        var x = attrs.x;\n        var y = attrs.y;\n\n        if (isNil(text) || isNaN(x) || isNaN(y)) {\n          // text will be 0\n          return;\n        }\n\n        var textArr = attrs.textArr;\n        var fontSize = attrs.fontSize * 1;\n\n        var spaceingY = self._getSpaceingY();\n\n        if (attrs.rotate) {\n          // do rotation\n          context.translate(x, y);\n          context.rotate(attrs.rotate);\n          x = 0;\n          y = 0;\n        }\n\n        var textBaseline = attrs.textBaseline;\n        var height;\n\n        if (textArr) {\n          height = self._getTextHeight();\n        }\n\n        var subY; // context.beginPath();\n\n        if (self.hasFill()) {\n          var fillOpacity = attrs.fillOpacity;\n\n          if (!isNil(fillOpacity) && fillOpacity !== 1) {\n            context.globalAlpha = fillOpacity;\n          }\n\n          if (textArr) {\n            for (var i = 0, len = textArr.length; i < len; i++) {\n              var subText = textArr[i];\n              subY = y + i * (spaceingY + fontSize) - height + fontSize; // bottom;\n\n              if (textBaseline === 'middle') {\n                subY += height - fontSize - (height - fontSize) / 2;\n              }\n\n              if (textBaseline === 'top') {\n                subY += height - fontSize;\n              }\n\n              context.fillText(subText, x, subY);\n            }\n          } else {\n            context.fillText(text, x, y);\n          }\n        }\n\n        if (self.hasStroke()) {\n          if (textArr) {\n            for (var _i = 0, _len = textArr.length; _i < _len; _i++) {\n              var _subText = textArr[_i];\n              subY = y + _i * (spaceingY + fontSize) - height + fontSize; // bottom;\n\n              if (textBaseline === 'middle') {\n                subY += height - fontSize - (height - fontSize) / 2;\n              }\n\n              if (textBaseline === 'top') {\n                subY += height - fontSize;\n              }\n\n              context.strokeText(_subText, x, subY);\n            }\n          } else {\n            context.strokeText(text, x, y);\n          }\n        }\n      };\n\n      _proto._getAriaLabel = function _getAriaLabel() {\n        return this._attrs.attrs.text;\n      };\n\n      _proto.calculateBox = function calculateBox() {\n        var self = this;\n        var attrs = self._attrs.attrs;\n        var x = attrs.x,\n            y = attrs.y,\n            textAlign = attrs.textAlign,\n            textBaseline = attrs.textBaseline;\n\n        var width = self._getTextWidth(); // attrs.width\n\n\n        if (!width) {\n          return {\n            minX: x,\n            minY: y,\n            maxX: x,\n            maxY: y\n          };\n        }\n\n        var height = self._getTextHeight(); // attrs.height\n\n\n        if (attrs.rotate) {\n          var rotatedBox = Rect$1.calcRotatedBox({\n            width: width,\n            height: height,\n            rotate: attrs.rotate\n          });\n          width = rotatedBox.width;\n          height = rotatedBox.height;\n        }\n\n        var point = {\n          x: x,\n          y: y - height\n        }; // default textAlign: start, textBaseline: bottom\n\n        if (textAlign) {\n          if (textAlign === 'end' || textAlign === 'right') {\n            point.x -= width;\n          } else if (textAlign === 'center') {\n            point.x -= width / 2;\n          }\n        }\n\n        if (textBaseline) {\n          if (textBaseline === 'top') {\n            point.y += height;\n          } else if (textBaseline === 'middle') {\n            point.y += height / 2;\n          }\n        }\n\n        return {\n          minX: point.x,\n          minY: point.y,\n          maxX: point.x + width,\n          maxY: point.y + height\n        };\n      };\n\n      _proto._getTextWidth = function _getTextWidth() {\n        var attrs = this._attrs.attrs;\n\n        if (attrs.width) {\n          return attrs.width;\n        }\n\n        var text = attrs.text;\n        var context = this.get('context');\n        if (isNil(text)) return undefined;\n        var font = attrs.font;\n        var textArr = attrs.textArr;\n        var key = text + '' + font;\n\n        if (textWidthCache[key]) {\n          return textWidthCache[key];\n        }\n\n        var width = 0;\n\n        if (textArr) {\n          for (var i = 0, length = textArr.length; i < length; i++) {\n            var subText = textArr[i];\n            width = Math.max(width, measureText(subText, font, context).width);\n          }\n        } else {\n          width = measureText(text, font, context).width;\n        }\n\n        if (textWidthCacheCounter > TEXT_CACHE_MAX) {\n          textWidthCacheCounter = 0;\n          textWidthCache = {};\n        }\n\n        textWidthCacheCounter++;\n        textWidthCache[key] = width;\n        return width;\n      };\n\n      return Text;\n    }(Shape$2);\n\n    var Custom = /*#__PURE__*/function (_Shape) {\n      _inheritsLoose(Custom, _Shape);\n\n      function Custom() {\n        return _Shape.apply(this, arguments) || this;\n      }\n\n      var _proto = Custom.prototype;\n\n      _proto._initProperties = function _initProperties() {\n        _Shape.prototype._initProperties.call(this);\n\n        this._attrs.canFill = true;\n        this._attrs.canStroke = true;\n        this._attrs.createPath = null;\n        this._attrs.type = 'custom';\n      };\n\n      _proto.createPath = function createPath(context) {\n        var createPath = this.get('createPath');\n        createPath && createPath.call(this, context);\n      };\n\n      _proto.calculateBox = function calculateBox() {\n        var calculateBox = this.get('calculateBox');\n        return calculateBox && calculateBox.call(this);\n      };\n\n      return Custom;\n    }(Shape$2);\n\n    var SYMBOLS = {\n      circle: function circle(x, y, r, ctx) {\n        ctx.arc(x, y, r, 0, Math.PI * 2, false);\n      },\n      square: function square(x, y, r, ctx) {\n        ctx.moveTo(x - r, y - r);\n        ctx.lineTo(x + r, y - r);\n        ctx.lineTo(x + r, y + r);\n        ctx.lineTo(x - r, y + r);\n        ctx.closePath();\n      }\n    };\n\n    var Marker = /*#__PURE__*/function (_Shape) {\n      _inheritsLoose(Marker, _Shape);\n\n      function Marker() {\n        return _Shape.apply(this, arguments) || this;\n      }\n\n      var _proto = Marker.prototype;\n\n      _proto._initProperties = function _initProperties() {\n        _Shape.prototype._initProperties.call(this);\n\n        this._attrs.canFill = true;\n        this._attrs.canStroke = true;\n        this._attrs.type = 'marker';\n      };\n\n      _proto.getDefaultAttrs = function getDefaultAttrs() {\n        return {\n          x: 0,\n          y: 0,\n          lineWidth: 0\n        };\n      };\n\n      _proto.createPath = function createPath(context) {\n        var attrs = this.get('attrs');\n        var x = attrs.x,\n            y = attrs.y,\n            radius = attrs.radius;\n        var symbol = attrs.symbol || 'circle';\n        var method;\n\n        if (isFunction(symbol)) {\n          method = symbol;\n        } else {\n          method = SYMBOLS[symbol];\n        }\n\n        context.beginPath();\n        method(x, y, radius, context, this);\n      };\n\n      _proto.calculateBox = function calculateBox() {\n        var attrs = this.get('attrs');\n        var x = attrs.x,\n            y = attrs.y,\n            radius = attrs.radius;\n        return {\n          minX: x - radius,\n          minY: y - radius,\n          maxX: x + radius,\n          maxY: y + radius\n        };\n      };\n\n      return Marker;\n    }(Shape$2);\n\n    Shape$2.Rect = Rect;\n    Shape$2.Image = ImageShape;\n    Shape$2.Circle = Circle;\n    Shape$2.Line = Line$1;\n    Shape$2.Polygon = Polygon;\n    Shape$2.Polyline = Polyline;\n    Shape$2.Arc = Arc;\n    Shape$2.Sector = Sector;\n    Shape$2.Text = Text;\n    Shape$2.Custom = Custom;\n    Shape$2.Marker = Marker;\n\n    var SHAPE_MAP = {};\n    var INDEX = '_INDEX';\n\n    function getComparer(compare) {\n      return function (left, right) {\n        var result = compare(left, right);\n        return result === 0 ? left[INDEX] - right[INDEX] : result;\n      };\n    }\n\n    var Container = {\n      getGroupClass: function getGroupClass() {},\n      getChildren: function getChildren() {\n        return this.get('children');\n      },\n      addShape: function addShape(type, cfg) {\n        if (cfg === void 0) {\n          cfg = {};\n        }\n\n        var shapeType = SHAPE_MAP[type];\n\n        if (!shapeType) {\n          shapeType = upperFirst(type);\n          SHAPE_MAP[type] = shapeType;\n        }\n\n        var shape = new Shape$2[shapeType](cfg);\n        this.add(shape);\n        return shape;\n      },\n      addGroup: function addGroup(cfg) {\n        var groupClass = this.getGroupClass();\n        var rst = new groupClass(cfg);\n        this.add(rst);\n        return rst;\n      },\n      contain: function contain(item) {\n        var children = this.get('children');\n        return children.indexOf(item) > -1;\n      },\n      sort: function sort() {\n        var children = this.get('children');\n\n        for (var i = 0, len = children.length; i < len; i++) {\n          var child = children[i];\n          child[INDEX] = i;\n        }\n\n        children.sort(getComparer(function (obj1, obj2) {\n          return obj1.get('zIndex') - obj2.get('zIndex');\n        }));\n        return this;\n      },\n      drawChildren: function drawChildren(context) {\n        var children = this.get('children');\n\n        for (var i = 0, len = children.length; i < len; i++) {\n          var child = children[i];\n          child.draw(context);\n        }\n\n        return this;\n      },\n      clear: function clear() {\n        var children = this.get('children');\n\n        while (children.length !== 0) {\n          children[children.length - 1].remove(true);\n        }\n\n        return this;\n      },\n      add: function add(items) {\n        var self = this;\n        var children = self.get('children');\n\n        if (!isArray(items)) {\n          items = [items];\n        }\n\n        for (var i = 0, len = items.length; i < len; i++) {\n          var item = items[i];\n          var parent = item.get('parent');\n\n          if (parent) {\n            var descendants = parent.get('children');\n            remove(descendants, item);\n          }\n\n          self._setEvn(item);\n\n          children.push(item);\n        }\n\n        return self;\n      },\n      _setEvn: function _setEvn(item) {\n        var self = this;\n        var _self$_attrs = self._attrs,\n            context = _self$_attrs.context,\n            canvas = _self$_attrs.canvas,\n            aria = _self$_attrs.aria;\n        var _item$_attrs = item._attrs,\n            isGroup = _item$_attrs.isGroup,\n            type = _item$_attrs.type;\n        item._attrs.parent = self;\n        item._attrs.context = context;\n        item._attrs.canvas = canvas; // 是否需要无障碍处理\n\n        if (aria && item._attrs.aria !== false) {\n          item._attrs.aria = aria;\n        }\n\n        if (type === 'text' && canvas && canvas.get('fontFamily')) {\n          item._attrs.attrs.fontFamily = item._attrs.attrs.fontFamily || canvas.get('fontFamily');\n        }\n\n        var clip = item._attrs.attrs.clip;\n\n        if (clip) {\n          clip._attrs.parent = self;\n          clip._attrs.context = context;\n          clip._attrs.canvas = canvas;\n        }\n\n        if (isGroup) {\n          var children = item._attrs.children;\n\n          for (var i = 0, len = children.length; i < len; i++) {\n            item._setEvn(children[i]);\n          }\n        }\n      },\n      _getAriaLabel: function _getAriaLabel() {\n        var _this$_attrs = this._attrs,\n            aria = _this$_attrs.aria,\n            ariaLabel = _this$_attrs.ariaLabel,\n            children = _this$_attrs.children; // 主动关闭\n\n        if (!aria) return;\n        var childAriaLabels = [];\n\n        if (children && children.length) {\n          for (var i = 0, len = children.length; i < len; i++) {\n            var _childAriaLabel = children[i].getAriaLabel();\n\n            if (_childAriaLabel) {\n              childAriaLabels.push(_childAriaLabel);\n            }\n          }\n        }\n\n        var childAriaLabel = childAriaLabels.join(' '); // 2个都有时拼接成完整句子\n\n        if (ariaLabel && childAriaLabel) {\n          return ariaLabel + \" \" + childAriaLabel + \" \";\n        } // 只有1个，或者都没有\n\n\n        return ariaLabel || childAriaLabel;\n      }\n    };\n\n    var Group = /*#__PURE__*/function (_Rect) {\n      _inheritsLoose(Group, _Rect);\n\n      function Group() {\n        return _Rect.apply(this, arguments) || this;\n      }\n\n      var _proto = Group.prototype;\n\n      _proto._initProperties = function _initProperties() {\n        this._attrs = {\n          type: 'group',\n          zIndex: 0,\n          visible: true,\n          destroyed: false,\n          isGroup: true,\n          canFill: true,\n          canStroke: true,\n          attrs: {},\n          children: []\n        };\n      };\n\n      _proto.getBBox = function getBBox() {\n        var self = this;\n        var minX = Infinity;\n        var maxX = -Infinity;\n        var minY = Infinity;\n        var maxY = -Infinity;\n        var children = self.get('children');\n\n        for (var i = 0, length = children.length; i < length; i++) {\n          var child = children[i];\n\n          if (child.get('visible')) {\n            var box = child.getBBox();\n\n            if (!box) {\n              continue;\n            }\n\n            var leftTop = [box.minX, box.minY];\n            var leftBottom = [box.minX, box.maxY];\n            var rightTop = [box.maxX, box.minY];\n            var rightBottom = [box.maxX, box.maxY];\n            var matrix = child.attr('matrix');\n            Vector2.transformMat2d(leftTop, leftTop, matrix);\n            Vector2.transformMat2d(leftBottom, leftBottom, matrix);\n            Vector2.transformMat2d(rightTop, rightTop, matrix);\n            Vector2.transformMat2d(rightBottom, rightBottom, matrix);\n            minX = Math.min(leftTop[0], leftBottom[0], rightTop[0], rightBottom[0], minX);\n            maxX = Math.max(leftTop[0], leftBottom[0], rightTop[0], rightBottom[0], maxX);\n            minY = Math.min(leftTop[1], leftBottom[1], rightTop[1], rightBottom[1], minY);\n            maxY = Math.max(leftTop[1], leftBottom[1], rightTop[1], rightBottom[1], maxY);\n          }\n        }\n\n        return {\n          minX: minX,\n          minY: minY,\n          maxX: maxX,\n          maxY: maxY,\n          x: minX,\n          y: minY,\n          width: maxX - minX,\n          height: maxY - minY\n        };\n      };\n\n      _proto.createPath = function createPath(context) {\n        var attrs = this.get('attrs'); // 只有在有fillStyle或strokeStyle 时才需要绘制\n\n        if (!attrs.fillStyle && !attrs.strokeStyle) {\n          return;\n        }\n\n        _Rect.prototype.createPath.call(this, context);\n      };\n\n      _proto.drawInner = function drawInner(context) {\n        _Rect.prototype.drawInner.call(this, context);\n\n        this.drawChildren(context);\n      };\n\n      _proto.destroy = function destroy() {\n        if (this.get('destroyed')) {\n          return;\n        }\n\n        this.clear();\n\n        _Rect.prototype.destroy.call(this);\n      };\n\n      return Group;\n    }(Rect);\n\n    mix(Group.prototype, Container, {\n      getGroupClass: function getGroupClass() {\n        return Group;\n      }\n    });\n\n    var requestAnimationFrame = typeof window === 'object' && window.requestAnimationFrame ? window.requestAnimationFrame : function (fn) {\n      return setTimeout(fn, 16);\n    };\n\n    var Canvas = /*#__PURE__*/function (_EventEmit) {\n      _inheritsLoose(Canvas, _EventEmit);\n\n      var _proto = Canvas.prototype;\n\n      _proto.get = function get(name) {\n        return this._attrs[name];\n      };\n\n      _proto.set = function set(name, value) {\n        this._attrs[name] = value;\n      };\n\n      function Canvas(cfg) {\n        var _this;\n\n        _this = _EventEmit.call(this) || this;\n        var title = cfg.title;\n        var ariaLabel = title ? substitute(lang.general.withTitle, {\n          title: title\n        }) : lang.general.title;\n        _this._attrs = mix({\n          type: 'canvas',\n          children: [],\n          ariaLabel: ariaLabel\n        }, cfg);\n\n        _this._initPixelRatio();\n\n        _this._initCanvas();\n\n        return _this;\n      }\n\n      _proto._initPixelRatio = function _initPixelRatio() {\n        var pixelRatio = this.get('pixelRatio');\n\n        if (!pixelRatio) {\n          this.set('pixelRatio', getPixelRatio());\n        }\n      };\n\n      _proto.beforeDraw = function beforeDraw() {\n        var context = this._attrs.context;\n        var el = this._attrs.el;\n        context && context.clearRect && context.clearRect(0, 0, el.width, el.height);\n      };\n\n      _proto._initCanvas = function _initCanvas() {\n        var self = this;\n        var el = self.get('el');\n        var context = self.get('context');\n\n        if (!el && !context) {\n          throw new Error('Please specify the id, el or context of the chart!');\n        }\n\n        var canvas;\n\n        if (el) {\n          // DOMElement or String\n          canvas = isString(el) ? getDomById(el) : el;\n        } else {\n          // 说明没有指定el\n          canvas = CanvasElement$1.create(context);\n        }\n\n        if (context && canvas && !canvas.getContext) {\n          canvas.getContext = function () {\n            return context;\n          };\n        }\n\n        var width = self.get('width');\n\n        if (!width) {\n          width = getWidth(canvas);\n        }\n\n        var height = self.get('height');\n\n        if (!height) {\n          height = getHeight(canvas);\n        }\n\n        self.set('canvas', this);\n        self.set('el', canvas);\n        self.set('context', context || canvas.getContext('2d'));\n        self.changeSize(width, height); // 初始化事件控制器\n\n        var eventController = new EventController({\n          canvas: this,\n          el: canvas\n        });\n        self.set('eventController', eventController);\n      };\n\n      _proto.changeSize = function changeSize(width, height) {\n        var pixelRatio = this.get('pixelRatio');\n        var canvasDOM = this.get('el'); // HTMLCanvasElement or canvasElement\n        // 浏览器环境设置style样式\n\n        if (canvasDOM.style) {\n          canvasDOM.style.width = width + 'px';\n          canvasDOM.style.height = height + 'px';\n        }\n\n        if (isCanvasElement(canvasDOM)) {\n          canvasDOM.width = width * pixelRatio;\n          canvasDOM.height = height * pixelRatio;\n\n          if (pixelRatio !== 1) {\n            var ctx = this.get('context');\n            ctx.scale(pixelRatio, pixelRatio);\n          }\n        }\n\n        this.set('width', width);\n        this.set('height', height);\n      };\n\n      _proto.getWidth = function getWidth() {\n        var pixelRatio = this.get('pixelRatio');\n        var width = this.get('width');\n        return width * pixelRatio;\n      };\n\n      _proto.getHeight = function getHeight() {\n        var pixelRatio = this.get('pixelRatio');\n        var height = this.get('height');\n        return height * pixelRatio;\n      };\n\n      _proto.getPointByClient = function getPointByClient(clientX, clientY) {\n        var el = this.get('el');\n        var bbox = el.getBoundingClientRect();\n        var width = bbox.right - bbox.left;\n        var height = bbox.bottom - bbox.top;\n        return {\n          x: (clientX - bbox.left) * (el.width / width),\n          y: (clientY - bbox.top) * (el.height / height)\n        };\n      };\n\n      _proto._beginDraw = function _beginDraw() {\n        this._attrs.toDraw = true;\n      };\n\n      _proto._endDraw = function _endDraw() {\n        this._attrs.toDraw = false;\n      };\n\n      _proto.draw = function draw() {\n        var self = this;\n\n        function drawInner() {\n          self.set('animateHandler', requestAnimationFrame(function () {\n            self.set('animateHandler', undefined);\n\n            if (self.get('toDraw')) {\n              drawInner();\n            }\n          }));\n          self.beforeDraw();\n\n          try {\n            var context = self._attrs.context;\n            self.drawChildren(context); // 支付宝，微信小程序，需要调context.draw才能完成绘制， 所以这里直接判断是否有.draw方法\n\n            if (context.draw) {\n              context.draw();\n            } // 设置无障碍文本\n\n\n            self.setAriaLabel();\n          } catch (ev) {\n            console.warn('error in draw canvas, detail as:');\n            console.warn(ev);\n\n            self._endDraw();\n          }\n\n          self._endDraw();\n        }\n\n        if (self.get('destroyed')) {\n          return;\n        }\n\n        if (self.get('animateHandler')) {\n          this._beginDraw();\n        } else {\n          drawInner();\n        }\n      } // 设置无障碍文本\n      ;\n\n      _proto.setAriaLabel = function setAriaLabel() {\n        var el = this._attrs.el;\n\n        var ariaLabel = this._getAriaLabel();\n\n        if (ariaLabel && el.setAttribute) {\n          el.setAttribute('aria-label', ariaLabel);\n        }\n      };\n\n      _proto.destroy = function destroy() {\n        if (this.get('destroyed')) {\n          return;\n        } // 需要清理 canvas 画布内容，否则会导致 spa 应用 ios 下 canvas 白屏\n        // https://stackoverflow.com/questions/52532614/total-canvas-memory-use-exceeds-the-maximum-limit-safari-12\n        // https://github.com/antvis/F2/issues/630\n\n\n        var el = this.get('el');\n        el.width = 0;\n        el.height = 0;\n        this.clear();\n        this._attrs = {};\n        this.set('destroyed', true);\n      };\n\n      _proto.isDestroyed = function isDestroyed() {\n        return this.get('destroyed');\n      };\n\n      return Canvas;\n    }(EventEmit);\n\n    mix(Canvas.prototype, Container, {\n      getGroupClass: function getGroupClass() {\n        return Group;\n      }\n    });\n\n    var engines = {};\n\n    function registerEngine(name, engine) {\n      engines[name] = engine;\n    }\n\n    function getEngine(name) {\n      var G = engines[name];\n\n      if (G) {\n        return G;\n      }\n\n      return {\n        Canvas: Canvas,\n        Group: Group,\n        Shape: Shape$2\n      };\n    }\n\n    function createCanvas(cfg) {\n      var renderer = cfg.renderer;\n      var G = getEngine(renderer);\n      return new G.Canvas(cfg);\n    }\n\n    var G = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        registerEngine: registerEngine,\n        getEngine: getEngine,\n        createCanvas: createCanvas,\n        Canvas: Canvas,\n        Group: Group,\n        Shape: Shape$2,\n        Matrix: Matrix,\n        Vector2: Vector2\n    });\n\n    function getClip(coord) {\n      var start = coord.start;\n      var end = coord.end;\n      var width = end.x - start.x;\n      var height = Math.abs(end.y - start.y);\n      var margin = 10;\n      var clip;\n\n      if (coord.isPolar) {\n        var circleRadius = coord.circleRadius,\n            center = coord.center,\n            startAngle = coord.startAngle,\n            endAngle = coord.endAngle;\n        clip = new Shape$2.Sector({\n          attrs: {\n            x: center.x,\n            y: center.y,\n            r: circleRadius,\n            r0: 0,\n            startAngle: startAngle,\n            endAngle: endAngle\n          }\n        });\n      } else {\n        clip = new Shape$2.Rect({\n          attrs: {\n            x: start.x,\n            y: end.y - margin,\n            width: width,\n            height: height + 2 * margin\n          }\n        });\n      }\n\n      clip.isClip = true;\n      return clip;\n    }\n\n    function isPointInPlot(point, plot) {\n      var x = point.x,\n          y = point.y;\n      var tl = plot.tl,\n          tr = plot.tr,\n          br = plot.br;\n      return x >= tl.x && x <= tr.x && y >= tl.y && y <= br.y;\n    }\n\n    var Helper = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        getClip: getClip,\n        isPointInPlot: isPointInPlot\n    });\n\n    function compare(a, b) {\n      return a - b;\n    }\n\n    function _isScaleExist(scales, compareScale) {\n      var flag = false;\n      each(scales, function (scale) {\n        var scaleValues = [].concat(scale.values);\n        var compareScaleValues = [].concat(compareScale.values);\n\n        if (scale.type === compareScale.type && scale.field === compareScale.field && scaleValues.sort(compare).toString() === compareScaleValues.sort(compare).toString()) {\n          flag = true;\n          return;\n        }\n      });\n      return flag;\n    }\n\n    var Chart = /*#__PURE__*/function (_Base) {\n      _inheritsLoose(Chart, _Base);\n\n      Chart.initPlugins = function initPlugins() {\n        return {\n          _plugins: [],\n          _cacheId: 0,\n          register: function register(plugins) {\n            var p = this._plugins;\n            [].concat(plugins).forEach(function (plugin) {\n              if (p.indexOf(plugin) === -1) {\n                p.push(plugin);\n              }\n            });\n            this._cacheId++;\n          },\n          unregister: function unregister(plugins) {\n            var p = this._plugins;\n            [].concat(plugins).forEach(function (plugin) {\n              var idx = p.indexOf(plugin);\n\n              if (idx !== -1) {\n                p.splice(idx, 1);\n              }\n            });\n            this._cacheId++;\n          },\n          clear: function clear() {\n            this._plugins = [];\n            this._cacheId++;\n          },\n          count: function count() {\n            return this._plugins.length;\n          },\n          getAll: function getAll() {\n            return this._plugins;\n          },\n          notify: function notify(chart, hook, args) {\n            var descriptors = this.descriptors(chart);\n            var ilen = descriptors.length;\n            var i;\n            var descriptor;\n            var plugin;\n            var params;\n            var method;\n\n            for (i = 0; i < ilen; ++i) {\n              descriptor = descriptors[i];\n              plugin = descriptor.plugin;\n              method = plugin[hook];\n\n              if (typeof method === 'function') {\n                params = [chart].concat(args || []);\n\n                if (method.apply(plugin, params) === false) {\n                  return false;\n                }\n              }\n            }\n\n            return true;\n          },\n          descriptors: function descriptors(chart) {\n            var cache = chart._plugins || (chart._plugins = {});\n\n            if (cache.id === this._cacheId) {\n              return cache.descriptors;\n            }\n\n            var plugins = [];\n            var descriptors = [];\n\n            this._plugins.concat(chart && chart.get('plugins') || []).forEach(function (plugin) {\n              var idx = plugins.indexOf(plugin);\n\n              if (idx !== -1) {\n                return;\n              }\n\n              plugins.push(plugin);\n              descriptors.push({\n                plugin: plugin\n              });\n            });\n\n            cache.descriptors = descriptors;\n            cache.id = this._cacheId;\n            return descriptors;\n          }\n        };\n      };\n\n      var _proto = Chart.prototype;\n\n      _proto.getDefaultCfg = function getDefaultCfg() {\n        return {\n          /**\n           * the id of canvas\n           * @type {String}\n           */\n          id: null,\n\n          /** 图表渲染引擎 */\n          renderer: 'canvas',\n          rendered: false,\n\n          /**\n           * padding\n           * @type {Array|Number}\n           */\n          padding: Global.padding,\n\n          /**\n           * data\n           * @type {Array}\n           */\n          data: null,\n\n          /**\n           * scales of chart\n           * @type {Object}\n           */\n          scales: {},\n\n          /**\n           * @private\n           * geometry instances\n           * @type {Array}\n           */\n          geoms: [],\n\n          /**\n           * scale configuration\n           * @type {Object}\n           */\n          colDefs: null,\n          pixelRatio: Global.pixelRatio,\n\n          /**\n           * filter options\n           * @type {Object}\n           */\n          filters: null,\n          appendPadding: Global.appendPadding\n        };\n      };\n\n      _proto._syncYScales = function _syncYScales() {\n        var syncY = this.get('syncY');\n\n        if (!syncY) {\n          return;\n        }\n\n        var geoms = this.get('geoms');\n        var syncScales = [];\n        var min = [];\n        var max = [];\n        each(geoms, function (geom) {\n          var yScale = geom.getYScale();\n\n          if (yScale.isLinear) {\n            syncScales.push(yScale);\n            min.push(yScale.min);\n            max.push(yScale.max);\n          }\n        });\n        min = Math.min.apply(null, min);\n        max = Math.max.apply(null, max);\n        each(syncScales, function (scale) {\n          scale.change({\n            min: min\n          });\n          scale.change({\n            max: max\n          });\n        });\n      };\n\n      _proto._getFieldsForLegend = function _getFieldsForLegend() {\n        var fields = [];\n        var geoms = this.get('geoms');\n        each(geoms, function (geom) {\n          var attrOptions = geom.get('attrOptions');\n          var attrCfg = attrOptions.color;\n\n          if (attrCfg && attrCfg.field && isString(attrCfg.field)) {\n            var arr = attrCfg.field.split('*');\n            each(arr, function (item) {\n              if (fields.indexOf(item) === -1) {\n                fields.push(item);\n              }\n            });\n          }\n        });\n        return fields;\n      };\n\n      _proto._getScaleData = function _getScaleData(field) {\n        var data = this.get('data');\n        var filteredData = this.get('filteredData');\n\n        if (filteredData.length) {\n          var legendFields = this._getFieldsForLegend();\n\n          if (legendFields.indexOf(field) === -1) {\n            data = filteredData;\n          }\n        }\n\n        return data;\n      } // _updateScales() {\n      //   const scaleController = this.get('scaleController');\n      //   scaleController.updateScales();\n      //   this._adjustScale();\n      // }\n      ;\n\n      _proto._adjustScale = function _adjustScale() {\n        var self = this;\n        var scaleController = self.get('scaleController'); // 看起来是为了让柱状图最小或最大都默认从0开始\n\n        var geoms = this.get('geoms');\n\n        for (var i = 0; i < geoms.length; i++) {\n          var geom = geoms[i];\n\n          if (geom.get('type') === 'interval') {\n            var yScale = geom.getYScale();\n            scaleController.adjustStartZero(yScale);\n          }\n        }\n      };\n\n      _proto._removeGeoms = function _removeGeoms() {\n        var geoms = this.get('geoms');\n\n        while (geoms.length > 0) {\n          var geom = geoms.shift();\n          geom.destroy();\n        }\n      };\n\n      _proto._clearGeoms = function _clearGeoms() {\n        var geoms = this.get('geoms');\n\n        for (var i = 0, length = geoms.length; i < length; i++) {\n          var geom = geoms[i];\n          geom.clear();\n        }\n      };\n\n      _proto._clearInner = function _clearInner() {\n        this._clearGeoms();\n\n        Chart.plugins.notify(this, 'clearInner');\n        this.emit(EVENT_CLEAR_INNER);\n        this.get('axisController') && this.get('axisController').clear();\n      };\n\n      _proto._initFilteredData = function _initFilteredData() {\n        var filters = this.get('filters');\n        var data = this.get('data') || [];\n\n        if (filters) {\n          data = data.filter(function (obj) {\n            var rst = true;\n            each(filters, function (fn, k) {\n              if (fn) {\n                rst = fn(obj[k], obj);\n\n                if (!rst) {\n                  return false;\n                }\n              }\n            });\n            return rst;\n          });\n        }\n\n        this.set('filteredData', data);\n      };\n\n      _proto._changeGeomsData = function _changeGeomsData() {\n        var geoms = this.get('geoms');\n        var data = this.get('filteredData');\n\n        for (var i = 0, length = geoms.length; i < length; i++) {\n          var geom = geoms[i];\n          geom.changeData(data);\n        }\n      };\n\n      _proto._initGeom = function _initGeom(geom) {\n        if (geom.get('isInit')) {\n          return;\n        }\n\n        var coord = this.get('coord');\n        var data = this.get('filteredData');\n        var colDefs = this.get('colDefs');\n        var middlePlot = this.get('middlePlot');\n        geom.set('chart', this);\n        geom.set('container', middlePlot.addGroup());\n        geom.set('data', data);\n        geom.set('coord', coord);\n        geom.set('colDefs', colDefs);\n        geom.init();\n        this.emit(EVENT_AFTER_GEOM_INIT, geom);\n      };\n\n      _proto._initGeoms = function _initGeoms() {\n        var geoms = this.get('geoms');\n\n        for (var i = 0, length = geoms.length; i < length; i++) {\n          this._initGeom(geoms[i]);\n        }\n      };\n\n      _proto._initCoord = function _initCoord() {\n        var plot = this.get('plotRange');\n        var coordCfg = mix({\n          type: 'cartesian'\n        }, this.get('coordCfg'), {\n          plot: plot\n        });\n        var type = coordCfg.type;\n        var C = Base$1[upperFirst(type)];\n        var coord = new C(coordCfg);\n        this.set('coord', coord);\n      };\n\n      _proto._initLayout = function _initLayout() {\n        var padding = this.get('_padding');\n\n        if (!padding) {\n          padding = this.get('margin') || this.get('padding');\n          padding = parsePadding(padding);\n        }\n\n        var top = padding[0] === 'auto' ? 0 : padding[0];\n        var right = padding[1] === 'auto' ? 0 : padding[1];\n        var bottom = padding[2] === 'auto' ? 0 : padding[2];\n        var left = padding[3] === 'auto' ? 0 : padding[3];\n        var width = this.get('width');\n        var height = this.get('height');\n        var start = {\n          x: left,\n          y: top\n        };\n        var end = {\n          x: width - right,\n          y: height - bottom\n        };\n        var plot = this.get('plot');\n\n        if (plot) {\n          plot.reset(start, end);\n          return;\n        }\n\n        var newPlot = new Plot({\n          start: start,\n          end: end\n        });\n        this.set('plotRange', newPlot);\n        this.set('plot', newPlot);\n      };\n\n      _proto._initCanvas = function _initCanvas() {\n        var self = this;\n\n        try {\n          var canvas = createCanvas({\n            renderer: self.get('renderer'),\n            el: self.get('el') || self.get('id'),\n            context: self.get('context'),\n            pixelRatio: self.get('pixelRatio'),\n            width: self.get('width'),\n            height: self.get('height'),\n            fontFamily: Global.fontFamily,\n            aria: self.get('aria'),\n            title: self.get('title'),\n            landscape: self.get('landscape')\n          });\n          self.set('canvas', canvas);\n          self.set('el', canvas.get('el'));\n          self.set('width', canvas.get('width'));\n          self.set('height', canvas.get('height'));\n        } catch (error) {\n          throw error;\n        }\n\n        Chart.plugins.notify(self, 'afterCanvasInit');\n      };\n\n      _proto._initLayers = function _initLayers() {\n        var canvas = this.get('canvas');\n        this.set('backPlot', canvas.addGroup());\n        this.set('middlePlot', canvas.addGroup({\n          zIndex: 10\n        }));\n        this.set('frontPlot', canvas.addGroup({\n          zIndex: 20\n        }));\n      };\n\n      _proto._initEvents = function _initEvents() {\n        var _this2 = this;\n\n        // 数据更新后的一些更新\n        this.on(EVENT_AFTER_DATA_CHANGE, function () {\n          // 数据更新后，重新设置filterdata\n          _this2._initFilteredData(); // 更新geoms里的数据\n\n\n          _this2._changeGeomsData();\n        }); // 大小变化后的一些更新\n\n        this.on(EVENT_AFTER_SIZE_CHANGE, function () {\n          _this2._initLayout(); // layout变化后，坐标轴也需要做相应的变化\n\n\n          var coord = _this2.get('coord');\n\n          if (coord) {\n            coord.reset(_this2.get('plot'));\n          }\n        });\n      };\n\n      _proto._initScaleController = function _initScaleController() {\n        var scaleController = new ScaleController({\n          chart: this\n        }); // 让colDefs 和 scaleController.defs 用同一个对象，这样就不用考虑同步的问题\n\n        this.set('colDefs', scaleController.defs); // 已经实例化的scales 也保持统一个对象\n\n        this.set('scales', scaleController.scales);\n        this.set('scaleController', scaleController);\n      };\n\n      _proto._clearScaleController = function _clearScaleController() {\n        var scaleController = this.get('scaleController');\n        scaleController.clear();\n      };\n\n      _proto._init = function _init() {\n        var self = this;\n\n        self._initCanvas();\n\n        self._initLayout();\n\n        self._initLayers();\n\n        self._initEvents();\n\n        self._initScaleController();\n\n        self.set('axisController', new AxisController({\n          frontPlot: self.get('frontPlot').addGroup({\n            className: 'axisContainer'\n          }),\n          backPlot: self.get('backPlot').addGroup({\n            className: 'axisContainer'\n          }),\n          chart: self\n        }));\n        Chart.plugins.notify(self, 'init');\n      };\n\n      function Chart(cfg) {\n        var _this;\n\n        _this = _Base.call(this, cfg) || this;\n\n        var self = _assertThisInitialized(_this);\n\n        each(Geom, function (geomConstructor, className) {\n          var methodName = lowerFirst(className);\n\n          self[methodName] = function (cfg) {\n            var geom = new geomConstructor(cfg);\n            self.addGeom(geom);\n            return geom;\n          };\n        });\n\n        self._init();\n\n        return _this;\n      }\n\n      _proto.init = function init() {\n        // 初始filterData\n        this._initFilteredData(); // initialization coordinate instance\n\n\n        this._initCoord();\n\n        Chart.plugins.notify(this, 'beforeGeomInit'); // init all geometry instances\n\n        this._initGeoms(); // 多 Y 轴的情况时，统一 Y 轴的数值范围。\n\n\n        this._syncYScales(); // do some adjust for data\n\n\n        this._adjustScale();\n\n        this.emit(EVENT_AFTER_INIT);\n      }\n      /**\n       * set data and some scale configuration\n       * @chainable\n       * @param  {Array} data the dataset to visualize\n       * @param  {Object} colDefs the configuration for scales\n       * @return {Chart} return the chart instance\n       */\n      ;\n\n      _proto.source = function source(data, colDefs) {\n        this.set('data', data);\n\n        if (colDefs) {\n          this.scale(colDefs);\n        }\n\n        return this;\n      };\n\n      _proto.scale = function scale(field, cfg) {\n        var scaleController = this.get('scaleController');\n        scaleController.setFieldDef(field, cfg);\n        return this;\n      }\n      /**\n       * configure the axis\n       * @chainable\n       * @param  {String|Boolean} field the field name of data\n       * @param  {Object} cfg configuration for axis\n       * @return {Chart} return the chart instance\n       */\n      ;\n\n      _proto.axis = function axis(field, cfg) {\n        var axisController = this.get('axisController');\n\n        if (!field) {\n          axisController.axisCfg = null;\n        } else {\n          axisController.axisCfg = axisController.axisCfg || {};\n          axisController.axisCfg[field] = cfg;\n        }\n\n        return this;\n      }\n      /**\n       * configure the coordinate\n       * @chainable\n       * @param  {String} type set the type of coodinate\n       * @param  {Object} cfg configuration for coordinate\n       * @return {Chart} return the chart instance\n       */\n      ;\n\n      _proto.coord = function coord(type, cfg) {\n        var coordCfg;\n\n        if (isObject(type)) {\n          coordCfg = type;\n        } else {\n          coordCfg = cfg || {};\n          coordCfg.type = type || 'cartesian';\n        }\n\n        this.set('coordCfg', coordCfg);\n        return this;\n      };\n\n      _proto.filter = function filter(field, condition) {\n        var filters = this.get('filters') || {};\n        filters[field] = condition;\n        this.set('filters', filters); // 如果已经render过，则再重新触发一次change\n\n        if (this.get('rendered')) {\n          this.emit(EVENT_AFTER_DATA_CHANGE, this.get('data'));\n        }\n      }\n      /**\n       * render the chart\n       * @chainable\n       * @return {Chart} return the chart instance\n       */\n      ;\n\n      _proto.render = function render() {\n        var rendered = this.get('rendered');\n        var canvas = this.get('canvas');\n        var geoms = this.get('geoms'); // 已经渲染过\n\n        if (rendered) {\n          this._initGeoms();\n\n          this._adjustScale();\n        } else {\n          this.init();\n          this.set('rendered', true);\n        }\n\n        this.emit(EVENT_BEFORE_RENDER);\n        Chart.plugins.notify(this, 'beforeGeomDraw');\n\n        this._renderAxis();\n\n        var middlePlot = this.get('middlePlot');\n\n        if (this.get('limitInPlot') && !middlePlot.attr('clip')) {\n          var coord = this.get('coord');\n          var clip = getClip(coord);\n          clip.set('canvas', middlePlot.get('canvas'));\n          middlePlot.attr('clip', clip);\n        }\n\n        this.emit(EVENT_BEFORE_GEOM_DRAW);\n\n        for (var i = 0, length = geoms.length; i < length; i++) {\n          var geom = geoms[i];\n          geom.paint();\n        }\n\n        this.emit(EVENT_AFTER_GEOM_DRAW);\n        Chart.plugins.notify(this, 'afterGeomDraw');\n        canvas.sort();\n        this.get('frontPlot').sort();\n        Chart.plugins.notify(this, 'beforeCanvasDraw');\n        canvas.draw();\n        this.emit(EVENT_AFTER_RENDER);\n        return this;\n      }\n      /**\n       * clear the chart, include geometris and all the shapes\n       * @chainable\n       * @return {Chart} return the chart\n       */\n      ;\n\n      _proto.clear = function clear() {\n        Chart.plugins.notify(this, 'clear');\n        this.emit(EVENT_CLEAR);\n\n        this._clearInner();\n\n        this._removeGeoms();\n\n        this._clearScaleController();\n\n        this.set('legendItems', null);\n        this.set('filters', null);\n        this.set('isUpdate', false);\n        this.set('_padding', null);\n        this.set('rendered', false);\n        var canvas = this.get('canvas');\n        canvas.draw();\n        return this;\n      };\n\n      _proto.repaint = function repaint() {\n        // 如果在没有render之前就repaint的，就直接return退出\n        var rendered = this.get('rendered');\n\n        if (!rendered) {\n          return;\n        }\n\n        this.set('isUpdate', true);\n        this.set('legendItems', null);\n        Chart.plugins.notify(this, 'repaint');\n\n        this._clearInner();\n\n        this.emit(EVENT_REPAINT);\n        this.render();\n      };\n\n      _proto.changeData = function changeData(data) {\n        this.emit(EVENT_BEFORE_DATA_CHANGE, data);\n        this.set('data', data);\n        Chart.plugins.notify(this, 'changeData');\n        this.emit(EVENT_AFTER_DATA_CHANGE, data);\n        this.set('_padding', null);\n        this.repaint();\n      };\n\n      _proto.changeSize = function changeSize(width, height) {\n        if (width) {\n          this.set('width', width);\n        } else {\n          width = this.get('width');\n        }\n\n        if (height) {\n          this.set('height', height);\n        } else {\n          height = this.get('height');\n        }\n\n        var canvas = this.get('canvas');\n        canvas.changeSize(width, height);\n        this.emit(EVENT_AFTER_SIZE_CHANGE, {\n          width: width,\n          height: height\n        });\n        this.repaint();\n        return this;\n      };\n\n      _proto.destroy = function destroy() {\n        this.clear();\n        var canvas = this.get('canvas');\n        canvas.destroy();\n        Chart.plugins.notify(this, 'afterCanvasDestroyed');\n\n        if (this._interactions) {\n          each(this._interactions, function (interaction) {\n            interaction.destroy();\n          });\n        }\n\n        _Base.prototype.destroy.call(this);\n      }\n      /**\n       * calculate dataset's position on canvas\n       * @param  {Object} record the dataset\n       * @return {Object} return the position\n       */\n      ;\n\n      _proto.getPosition = function getPosition(record) {\n        var self = this;\n        var coord = self.get('coord');\n        var xScale = self.getXScale();\n        var xField = xScale.field;\n        var yScales = self.getYScales(); // default first\n\n        var yScale = yScales[0];\n        var yField = yScale.field;\n\n        for (var i = 0, len = yScales.length; i < len; i++) {\n          var scale = yScales[i];\n          var field = scale.field;\n\n          if (record[field]) {\n            yScale = scale;\n            yField = field;\n            break;\n          }\n        }\n\n        var x = xScale.scale(record[xField]);\n        var y = yScale.scale(record[yField]);\n        return coord.convertPoint({\n          x: x,\n          y: y\n        });\n      }\n      /**\n       * get the data item of the point\n       * @param  {Object} point canvas position\n       * @return {Object} return the data item\n       */\n      ;\n\n      _proto.getRecord = function getRecord(point) {\n        var self = this;\n        var coord = self.get('coord');\n        var xScale = self.getXScale();\n        var yScale = self.getYScales()[0];\n        var invertPoint = coord.invertPoint(point);\n        var record = {};\n        record[xScale.field] = xScale.invert(invertPoint.x);\n        record[yScale.field] = yScale.invert(invertPoint.y);\n        return record;\n      }\n      /**\n       * get the dataset of the point\n       * @param  {Object} point canvas position\n       * @return {Array} return the dataset\n      **/\n      ;\n\n      _proto.getSnapRecords = function getSnapRecords(point) {\n        var geom = this.get('geoms')[0];\n        var data = [];\n\n        if (geom) {\n          // need to judge\n          data = geom.getSnapRecords(point);\n        }\n\n        return data;\n      }\n      /**\n       * creat scale instances\n       * @param  {String} field field name of data\n       * @return {Scale} return the scale\n       */\n      ;\n\n      _proto.createScale = function createScale(field) {\n        var data = this._getScaleData(field);\n\n        var scaleController = this.get('scaleController');\n        return scaleController.createScale(field, data);\n      }\n      /**\n       * @protected\n       * add geometry instance to geoms\n       * @param {Geom} geom geometry instance\n       */\n      ;\n\n      _proto.addGeom = function addGeom(geom) {\n        var geoms = this.get('geoms');\n        geoms.push(geom);\n      }\n      /**\n       * get the scale of x axis\n       * @return {Scale} return the scale\n       */\n      ;\n\n      _proto.getXScale = function getXScale() {\n        var self = this;\n        var geoms = self.get('geoms');\n        var xScale = geoms[0].getXScale();\n        return xScale;\n      }\n      /**\n       * get the scale of y axis\n       * @return {Array} return the scale\n       */\n      ;\n\n      _proto.getYScales = function getYScales() {\n        var geoms = this.get('geoms');\n        var rst = [];\n        each(geoms, function (geom) {\n          var yScale = geom.getYScale();\n\n          if (rst.indexOf(yScale) === -1) {\n            rst.push(yScale);\n          }\n        });\n        return rst;\n      };\n\n      _proto.getLegendItems = function getLegendItems() {\n        if (this.get('legendItems')) {\n          return this.get('legendItems');\n        }\n\n        var legendItems = {};\n        var scales = [];\n        var geoms = this.get('geoms');\n        each(geoms, function (geom) {\n          var colorAttr = geom.getAttr('color');\n\n          if (colorAttr) {\n            var scale = colorAttr.getScale('color'); // 只支持分类图例\n\n            if (scale.isCategory && !_isScaleExist(scales, scale)) {\n              scales.push(scale);\n              var field = scale.field;\n              var ticks = scale.getTicks();\n              var items = [];\n              each(ticks, function (tick) {\n                var text = tick.text;\n                var name = text;\n                var scaleValue = tick.value;\n                var value = scale.invert(scaleValue);\n                var color = colorAttr.mapping(value).join('') || Global.defaultColor;\n                var marker = {\n                  fill: color,\n                  radius: 3,\n                  symbol: 'circle',\n                  stroke: '#fff'\n                };\n                items.push({\n                  name: name,\n                  // for display\n                  dataValue: value,\n                  // the origin value\n                  checked: true,\n                  marker: marker\n                });\n              });\n              legendItems[field] = items;\n            }\n          }\n        });\n        this.set('legendItems', legendItems);\n        return legendItems;\n      } // register the plugins\n      ;\n\n      _proto.registerPlugins = function registerPlugins(plugins) {\n        var self = this;\n        var chartPlugins = self.get('plugins') || [];\n\n        if (!isArray(chartPlugins)) {\n          chartPlugins = [chartPlugins];\n        }\n\n        [].concat(plugins).forEach(function (plugin) {\n          if (chartPlugins.indexOf(plugin) === -1) {\n            plugin.init && plugin.init(self); // init\n\n            chartPlugins.push(plugin);\n          }\n        });\n        Chart.plugins._cacheId++;\n        self.set('plugins', chartPlugins);\n      };\n\n      _proto._renderAxis = function _renderAxis() {\n        var axisController = this.get('axisController');\n        var xScale = this.getXScale();\n        var yScales = this.getYScales();\n        var coord = this.get('coord');\n        Chart.plugins.notify(this, 'beforeRenderAxis');\n        axisController.createAxis(coord, xScale, yScales);\n      };\n\n      _proto._isAutoPadding = function _isAutoPadding() {\n        if (this.get('_padding')) {\n          return false;\n        }\n\n        var padding = this.get('padding');\n\n        if (isArray(padding)) {\n          return padding.indexOf('auto') !== -1;\n        }\n\n        return padding === 'auto';\n      };\n\n      _proto._updateLayout = function _updateLayout(padding) {\n        var width = this.get('width');\n        var height = this.get('height');\n        var start = {\n          x: padding[3],\n          y: padding[0]\n        };\n        var end = {\n          x: width - padding[1],\n          y: height - padding[2]\n        };\n        var plot = this.get('plot');\n        var coord = this.get('coord');\n        plot.reset(start, end);\n        coord.reset(plot);\n      }\n      /**\n       * 是否为横屏展示\n       *\n       * @param {Boolean} landscape 是否为横屏\n       */\n      ;\n\n      _proto.landscape = function landscape(_landscape) {\n        var canvas = this.get('canvas');\n        canvas.set('landscape', _landscape);\n      };\n\n      return Chart;\n    }(Base);\n\n    Chart.plugins = Chart.initPlugins();\n\n    var track = function track() {\n      return null;\n    };\n\n    /**\n     * @fileOverview shape util\n     * @author dxq613@gmail.com\n     */\n\n    function splitPoints(obj) {\n      var points = [];\n      var x = obj.x;\n      var y = obj.y;\n      y = isArray(y) ? y : [y];\n      y.forEach(function (yItem, index) {\n        var point = {\n          x: isArray(x) ? x[index] : x,\n          y: yItem\n        };\n        points.push(point);\n      });\n      return points;\n    }\n\n    function splitArray(data, yField, connectNulls) {\n      if (!data.length) return [];\n      var arr = [];\n      var tmp = [];\n      var yValue;\n      each(data, function (obj) {\n        yValue = obj._origin ? obj._origin[yField] : obj[yField];\n\n        if (connectNulls) {\n          if (!isNil(yValue)) {\n            tmp.push(obj);\n          }\n        } else {\n          if (isArray(yValue) && isNil(yValue[0]) || isNil(yValue)) {\n            if (tmp.length) {\n              arr.push(tmp);\n              tmp = [];\n            }\n          } else {\n            tmp.push(obj);\n          }\n        }\n      });\n\n      if (tmp.length) {\n        arr.push(tmp);\n      }\n\n      return arr;\n    }\n\n    var SHAPES = ['circle', 'hollowCircle', 'rect'];\n    var Point = Shape$1.registerFactory('point', {\n      defaultShapeType: 'circle',\n      getDefaultPoints: function getDefaultPoints(pointInfo) {\n        return splitPoints(pointInfo);\n      }\n    });\n\n    function getPointsCfg(cfg) {\n      var style = {\n        lineWidth: 0,\n        stroke: cfg.color,\n        fill: cfg.color\n      };\n\n      if (cfg.size) {\n        style.size = cfg.size;\n      }\n\n      mix(style, cfg.style);\n      return mix({}, Global.shape.point, style);\n    }\n\n    function drawShape(cfg, container, shape) {\n      if (cfg.size === 0) return;\n      var pointCfg = getPointsCfg(cfg);\n      var size = pointCfg.r || pointCfg.size;\n      var x = cfg.x;\n      var y = !isArray(cfg.y) ? [cfg.y] : cfg.y;\n\n      if (shape === 'hollowCircle') {\n        pointCfg.lineWidth = 1;\n        pointCfg.fill = null;\n      }\n\n      for (var i = 0, len = y.length; i < len; i++) {\n        if (shape === 'rect') {\n          return container.addShape('Rect', {\n            className: 'point',\n            attrs: mix({\n              x: x - size,\n              y: y[i] - size,\n              width: size * 2,\n              height: size * 2\n            }, pointCfg)\n          });\n        }\n\n        return container.addShape('Circle', {\n          className: 'point',\n          attrs: mix({\n            x: x,\n            y: y[i],\n            r: size\n          }, pointCfg)\n        });\n      }\n    }\n\n    each(SHAPES, function (shapeType) {\n      Shape$1.registerShape('point', shapeType, {\n        draw: function draw(cfg, container) {\n          return drawShape(cfg, container, shapeType);\n        }\n      });\n    });\n\n    var Point$1 = /*#__PURE__*/function (_Geom) {\n      _inheritsLoose(Point, _Geom);\n\n      function Point() {\n        return _Geom.apply(this, arguments) || this;\n      }\n\n      var _proto = Point.prototype;\n\n      _proto.getDefaultCfg = function getDefaultCfg() {\n        var cfg = _Geom.prototype.getDefaultCfg.call(this);\n\n        cfg.type = 'point';\n        cfg.shapeType = 'point';\n        cfg.generatePoints = false;\n        return cfg;\n      };\n\n      _proto.draw = function draw(data, shapeFactory) {\n        var self = this;\n        var container = self.get('container');\n        each(data, function (obj) {\n          var shape = obj.shape;\n          var cfg = self.getDrawCfg(obj);\n\n          if (isArray(obj.y)) {\n            var hasStack = self.hasAdjust('stack');\n            each(obj.y, function (y, idx) {\n              cfg.y = y;\n\n              if (!hasStack || idx !== 0) {\n                self.drawShape(shape, obj, cfg, container, shapeFactory);\n              }\n            });\n          } else if (!isNil(obj.y)) {\n            self.drawShape(shape, obj, cfg, container, shapeFactory);\n          }\n        });\n      };\n\n      return Point;\n    }(Geom);\n\n    Geom.Point = Point$1;\n\n    var Line$2 = Shape$1.registerFactory('line', {\n      defaultShapeType: 'line'\n    });\n\n    function getStyle$1(cfg) {\n      var style = {\n        strokeStyle: cfg.color\n      };\n\n      if (cfg.size >= 0) {\n        style.lineWidth = cfg.size;\n      }\n\n      mix(style, cfg.style);\n      return mix({}, Global.shape.line, style);\n    }\n\n    function drawLines(cfg, container, style, smooth) {\n      var points = cfg.points;\n\n      if (points.length && isArray(points[0].y)) {\n        var topPoints = [];\n        var bottomPoints = [];\n\n        for (var i = 0, len = points.length; i < len; i++) {\n          var point = points[i];\n          var tmp = splitPoints(point);\n          bottomPoints.push(tmp[0]);\n          topPoints.push(tmp[1]);\n        }\n\n        if (cfg.isInCircle) {\n          topPoints.push(topPoints[0]);\n          bottomPoints.push(bottomPoints[0]);\n        }\n\n        if (cfg.isStack) {\n          return container.addShape('Polyline', {\n            className: 'line',\n            attrs: mix({\n              points: topPoints,\n              smooth: smooth\n            }, style)\n          });\n        }\n\n        var topShape = container.addShape('Polyline', {\n          className: 'line',\n          attrs: mix({\n            points: topPoints,\n            smooth: smooth\n          }, style)\n        });\n        var bottomShape = container.addShape('Polyline', {\n          className: 'line',\n          attrs: mix({\n            points: bottomPoints,\n            smooth: smooth\n          }, style)\n        });\n        return [topShape, bottomShape];\n      }\n\n      if (cfg.isInCircle) {\n        points.push(points[0]);\n      }\n\n      return container.addShape('Polyline', {\n        className: 'line',\n        attrs: mix({\n          points: points,\n          smooth: smooth\n        }, style)\n      });\n    }\n\n    var SHAPES$1 = ['line', 'smooth', 'dash'];\n    each(SHAPES$1, function (shapeType) {\n      Shape$1.registerShape('line', shapeType, {\n        draw: function draw(cfg, container) {\n          var smooth = shapeType === 'smooth';\n          var style = getStyle$1(cfg);\n\n          if (shapeType === 'dash') {\n            style.lineDash = Global.lineDash;\n          }\n\n          return drawLines(cfg, container, style, smooth);\n        }\n      });\n    });\n\n    var Path = /*#__PURE__*/function (_Geom) {\n      _inheritsLoose(Path, _Geom);\n\n      function Path() {\n        return _Geom.apply(this, arguments) || this;\n      }\n\n      var _proto = Path.prototype;\n\n      _proto.getDefaultCfg = function getDefaultCfg() {\n        var cfg = _Geom.prototype.getDefaultCfg.call(this);\n\n        cfg.type = 'path';\n        cfg.shapeType = 'line';\n        return cfg;\n      };\n\n      _proto.getDrawCfg = function getDrawCfg(obj) {\n        var cfg = _Geom.prototype.getDrawCfg.call(this, obj);\n\n        cfg.isStack = this.hasAdjust('stack');\n        return cfg;\n      };\n\n      _proto.draw = function draw(data, shapeFactory) {\n        var self = this;\n        var container = self.get('container');\n        var yScale = self.getYScale();\n        var connectNulls = self.get('connectNulls');\n        var splitArrayObj = splitArray(data, yScale.field, connectNulls);\n        var cfg = this.getDrawCfg(data[0]);\n        cfg.origin = data;\n        each(splitArrayObj, function (subData, splitedIndex) {\n          cfg.splitedIndex = splitedIndex;\n          cfg.points = subData;\n          self.drawShape(cfg.shape, data[0], cfg, container, shapeFactory);\n        });\n      };\n\n      return Path;\n    }(Geom);\n\n    Geom.Path = Path;\n\n    var Line$3 = /*#__PURE__*/function (_Path) {\n      _inheritsLoose(Line, _Path);\n\n      function Line() {\n        return _Path.apply(this, arguments) || this;\n      }\n\n      var _proto = Line.prototype;\n\n      _proto.getDefaultCfg = function getDefaultCfg() {\n        var cfg = _Path.prototype.getDefaultCfg.call(this);\n\n        cfg.type = 'line';\n        cfg.sortable = true;\n        return cfg;\n      };\n\n      return Line;\n    }(Path);\n\n    Geom.Line = Line$3;\n\n    function equals(v1, v2) {\n      return Math.abs(v1 - v2) < 0.00001;\n    }\n\n    function notEmpty(value) {\n      return !isNaN(value) && !isNil(value);\n    }\n\n    function filterPoints(points) {\n      var filteredPoints = []; // filter the point which x or y is NaN\n\n      for (var i = 0, len = points.length; i < len; i++) {\n        var point = points[i];\n\n        if (notEmpty(point.x) && notEmpty(point.y)) {\n          filteredPoints.push(point);\n        }\n      }\n\n      return filteredPoints;\n    }\n\n    function equalsCenter(points, center) {\n      var eqls = true;\n      each(points, function (point) {\n        if (!equals(point.x, center.x) || !equals(point.y, center.y)) {\n          eqls = false;\n          return false;\n        }\n      });\n      return eqls;\n    }\n\n    function drawRectShape(topPoints, bottomPoints, container, style, isSmooth) {\n      var shape;\n      var points = topPoints.concat(bottomPoints);\n\n      if (isSmooth) {\n        shape = container.addShape('Custom', {\n          className: 'area',\n          attrs: mix({\n            points: points\n          }, style),\n          createPath: function createPath(context) {\n            var constaint = [[0, 0], [1, 1]];\n            var points = filterPoints(this._attrs.attrs.points);\n            var pointsLen = points.length;\n            var topPoints = points.slice(0, pointsLen / 2);\n            var bottomPoints = points.slice(pointsLen / 2, pointsLen);\n            var topSps = catmullRom2bezier(topPoints, false, constaint);\n            context.beginPath();\n            context.moveTo(topPoints[0].x, topPoints[0].y);\n\n            for (var i = 0, n = topSps.length; i < n; i++) {\n              var sp = topSps[i];\n              context.bezierCurveTo(sp[1], sp[2], sp[3], sp[4], sp[5], sp[6]);\n            }\n\n            if (bottomPoints.length) {\n              var bottomSps = catmullRom2bezier(bottomPoints, false, constaint);\n              context.lineTo(bottomPoints[0].x, bottomPoints[0].y);\n\n              for (var _i = 0, _n = bottomSps.length; _i < _n; _i++) {\n                var _sp = bottomSps[_i];\n                context.bezierCurveTo(_sp[1], _sp[2], _sp[3], _sp[4], _sp[5], _sp[6]);\n              }\n            }\n\n            context.closePath();\n          },\n          calculateBox: function calculateBox() {\n            var points = filterPoints(this._attrs.attrs.points);\n            return getBBoxFromPoints(points);\n          }\n        });\n      } else {\n        shape = container.addShape('Polyline', {\n          className: 'area',\n          attrs: mix({\n            points: points\n          }, style)\n        });\n      }\n\n      return shape;\n    }\n\n    function drawShape$1(cfg, container, isSmooth) {\n      var self = this;\n      var points = cfg.points;\n      var topPoints = [];\n      var bottomPoints = [];\n      each(points, function (point) {\n        bottomPoints.push(point[0]);\n        topPoints.push(point[1]);\n      });\n      var style = mix({\n        fillStyle: cfg.color\n      }, Global.shape.area, cfg.style);\n      bottomPoints.reverse();\n      topPoints = self.parsePoints(topPoints);\n      bottomPoints = self.parsePoints(bottomPoints);\n\n      if (cfg.isInCircle) {\n        topPoints.push(topPoints[0]);\n        bottomPoints.unshift(bottomPoints[bottomPoints.length - 1]);\n\n        if (equalsCenter(bottomPoints, cfg.center)) {\n          bottomPoints = [];\n        }\n      }\n\n      return drawRectShape(topPoints, bottomPoints, container, style, isSmooth);\n    }\n\n    var Area = Shape$1.registerFactory('area', {\n      defaultShapeType: 'area',\n      getDefaultPoints: function getDefaultPoints(obj) {\n        var x = obj.x;\n        var y = obj.y;\n        var y0 = obj.y0;\n        y = isArray(y) ? y : [y0, y];\n        var points = [];\n        points.push({\n          x: x,\n          y: y[0]\n        }, {\n          x: x,\n          y: y[1]\n        });\n        return points;\n      }\n    });\n    var SHAPES$2 = ['area', 'smooth'];\n    each(SHAPES$2, function (shapeType) {\n      Shape$1.registerShape('area', shapeType, {\n        draw: function draw(cfg, container) {\n          var smooth = shapeType === 'smooth';\n          return drawShape$1.call(this, cfg, container, smooth);\n        }\n      });\n    });\n\n    var Area$1 = /*#__PURE__*/function (_Geom) {\n      _inheritsLoose(Area, _Geom);\n\n      function Area() {\n        return _Geom.apply(this, arguments) || this;\n      }\n\n      var _proto = Area.prototype;\n\n      /**\n       * get the default configuration\n       * @protected\n       * @return {Object} return the result\n       */\n      _proto.getDefaultCfg = function getDefaultCfg() {\n        var cfg = _Geom.prototype.getDefaultCfg.call(this);\n\n        cfg.type = 'area';\n        cfg.shapeType = 'area';\n        cfg.generatePoints = true;\n        cfg.sortable = true;\n        return cfg;\n      };\n\n      _proto.draw = function draw(data, shapeFactory) {\n        var self = this;\n        var container = self.get('container');\n        var cfg = this.getDrawCfg(data[0]);\n        var yScale = self.getYScale();\n        var connectNulls = self.get('connectNulls');\n        var splitArrayfn = splitArray(data, yScale.field, connectNulls);\n        cfg.origin = data;\n        each(splitArrayfn, function (subData, splitedIndex) {\n          cfg.splitedIndex = splitedIndex;\n          var points = subData.map(function (obj) {\n            return obj.points;\n          });\n          cfg.points = points;\n          self.drawShape(cfg.shape, data[0], cfg, container, shapeFactory);\n        });\n      };\n\n      return Area;\n    }(Geom);\n\n    Geom.Area = Area$1;\n\n    /**\n     * @fileOverview Utility for calculate the with ratui in x axis\n     * @author sima.zhang1990@gmail.com\n     * @author dxq613@gmail.com\n     */\n    var SizeMixin = {\n      initEvent: function initEvent() {\n        var _this = this;\n\n        var chart = this.get('chart');\n\n        if (!chart) {\n          return;\n        }\n\n        chart.on(EVENT_AFTER_SIZE_CHANGE, function () {\n          _this.set('_width', null);\n        });\n      },\n      getDefaultSize: function getDefaultSize() {\n        var defaultSize = this.get('defaultSize');\n\n        if (!defaultSize) {\n          var coord = this.get('coord');\n          var xScale = this.getXScale();\n          var dataArray = this.get('dataArray');\n          var values = uniq(xScale.values);\n          var count = values.length;\n          var range = xScale.range;\n          var normalizeSize = 1 / count;\n          var widthRatio = 1;\n\n          if (coord && coord.isPolar) {\n            if (coord.transposed && count > 1) {\n              widthRatio = Global.widthRatio.multiplePie;\n            } else {\n              widthRatio = Global.widthRatio.rose;\n            }\n          } else {\n            if (xScale.isLinear) {\n              normalizeSize *= range[1] - range[0];\n            }\n\n            widthRatio = Global.widthRatio.column;\n          }\n\n          normalizeSize *= widthRatio;\n\n          if (this.hasAdjust('dodge')) {\n            normalizeSize = normalizeSize / dataArray.length;\n          }\n\n          defaultSize = normalizeSize;\n          this.set('defaultSize', defaultSize);\n        }\n\n        return defaultSize;\n      },\n      getDimWidth: function getDimWidth(dimName) {\n        var coord = this.get('coord');\n        var start = coord.convertPoint({\n          x: 0,\n          y: 0\n        });\n        var end = coord.convertPoint({\n          x: dimName === 'x' ? 1 : 0,\n          y: dimName === 'x' ? 0 : 1\n        });\n        var width = 0;\n\n        if (start && end) {\n          width = Math.sqrt(Math.pow(end.x - start.x, 2) + Math.pow(end.y - start.y, 2));\n        }\n\n        return width;\n      },\n      _getWidth: function _getWidth() {\n        var width = this.get('_width');\n\n        if (!width) {\n          var coord = this.get('coord');\n\n          if (coord && coord.isPolar && !coord.transposed) {\n            width = (coord.endAngle - coord.startAngle) * coord.circleRadius;\n          } else {\n            width = this.getDimWidth('x');\n          }\n\n          this.set('_width', width);\n        }\n\n        return width;\n      },\n      _toNormalizedSize: function _toNormalizedSize(size) {\n        var width = this._getWidth();\n\n        return size / width;\n      },\n      _toCoordSize: function _toCoordSize(normalizeSize) {\n        var width = this._getWidth();\n\n        return width * normalizeSize;\n      },\n      getNormalizedSize: function getNormalizedSize(obj) {\n        var size = this.getAttrValue('size', obj);\n\n        if (isNil(size)) {\n          size = this.getDefaultSize();\n        } else {\n          size = this._toNormalizedSize(size);\n        }\n\n        return size;\n      },\n      getSize: function getSize(obj) {\n        var size = this.getAttrValue('size', obj);\n\n        if (isNil(size)) {\n          var normalizeSize = this.getDefaultSize();\n          size = this._toCoordSize(normalizeSize);\n        }\n\n        return size;\n      }\n    };\n\n    function getRectPoints(cfg) {\n      var x = cfg.x,\n          y = cfg.y,\n          y0 = cfg.y0,\n          size = cfg.size;\n      var ymin = y0;\n      var ymax = y;\n\n      if (isArray(y)) {\n        ymax = y[1];\n        ymin = y[0];\n      }\n\n      var xmin;\n      var xmax;\n\n      if (isArray(x)) {\n        xmin = x[0];\n        xmax = x[1];\n      } else {\n        xmin = x - size / 2;\n        xmax = x + size / 2;\n      }\n\n      return [{\n        x: xmin,\n        y: ymin\n      }, {\n        x: xmin,\n        y: ymax\n      }, {\n        x: xmax,\n        y: ymax\n      }, {\n        x: xmax,\n        y: ymin\n      }];\n    }\n\n    function getRectRange(points) {\n      var xValues = [];\n      var yValues = [];\n\n      for (var i = 0, len = points.length; i < len; i++) {\n        var point = points[i];\n        xValues.push(point.x);\n        yValues.push(point.y);\n      }\n\n      var xMin = Math.min.apply(null, xValues);\n      var yMin = Math.min.apply(null, yValues);\n      var xMax = Math.max.apply(null, xValues);\n      var yMax = Math.max.apply(null, yValues);\n      return {\n        x: xMin,\n        y: yMin,\n        width: xMax - xMin,\n        height: yMax - yMin\n      };\n    }\n\n    function getMiddlePoint(a, b) {\n      var x = (a.x - b.x) / 2 + b.x;\n      var y = (a.y - b.y) / 2 + b.y;\n      return {\n        x: x,\n        y: y\n      };\n    }\n\n    var Interval = Shape$1.registerFactory('interval', {\n      defaultShapeType: 'rect',\n      getDefaultPoints: function getDefaultPoints(cfg) {\n        return getRectPoints(cfg);\n      }\n    });\n    Shape$1.registerShape('interval', 'rect', {\n      draw: function draw(cfg, container) {\n        var points = this.parsePoints(cfg.points);\n        var style = mix({\n          fill: cfg.color\n        }, Global.shape.interval, cfg.style);\n\n        if (cfg.isInCircle) {\n          var newPoints = points.slice(0);\n\n          if (this._coord.transposed) {\n            newPoints = [points[0], points[3], points[2], points[1]];\n          }\n\n          var _cfg$center = cfg.center,\n              x = _cfg$center.x,\n              y = _cfg$center.y;\n          var v = [1, 0];\n          var v0 = [newPoints[0].x - x, newPoints[0].y - y];\n          var v1 = [newPoints[1].x - x, newPoints[1].y - y];\n          var v2 = [newPoints[2].x - x, newPoints[2].y - y];\n          var startAngle = Vector2.angleTo(v, v1);\n          var endAngle = Vector2.angleTo(v, v2);\n          var r0 = Vector2.length(v0);\n          var r = Vector2.length(v1);\n\n          if (startAngle >= 1.5 * Math.PI) {\n            startAngle = startAngle - 2 * Math.PI;\n          }\n\n          if (endAngle >= 1.5 * Math.PI) {\n            endAngle = endAngle - 2 * Math.PI;\n          }\n\n          return container.addShape('Sector', {\n            className: 'interval',\n            attrs: mix({\n              x: x,\n              y: y,\n              r: r,\n              r0: r0,\n              startAngle: startAngle,\n              endAngle: endAngle\n            }, style)\n          });\n        }\n\n        var rectCfg = getRectRange(points);\n        return container.addShape('rect', {\n          className: 'interval',\n          attrs: mix(rectCfg, style)\n        });\n      }\n    }); // 金字塔 和 漏斗图\n\n    ['pyramid', 'funnel'].forEach(function (shapeType) {\n      Shape$1.registerShape('interval', shapeType, {\n        getPoints: function getPoints(cfg) {\n          cfg.size = cfg.size * 2; // 漏斗图的 size 是柱状图的两倍\n\n          return getRectPoints(cfg);\n        },\n        draw: function draw(cfg, container) {\n          var points = this.parsePoints(cfg.points);\n          var nextPoints = this.parsePoints(cfg.nextPoints);\n          var polygonPoints = null;\n\n          if (nextPoints) {\n            polygonPoints = [points[0], points[1], nextPoints[1], nextPoints[0]];\n          } else {\n            polygonPoints = [points[0], points[1]]; // pyramid 顶部是三角形，所以取中心点就好了，funnel顶部是长方形\n\n            if (shapeType === 'pyramid') {\n              polygonPoints.push(getMiddlePoint(points[2], points[3]));\n            } else {\n              polygonPoints.push(points[2], points[3]);\n            }\n          }\n\n          var attrs = mix({\n            fill: cfg.color,\n            points: polygonPoints\n          }, Global.shape.interval, cfg.style);\n          return container.addShape('polygon', {\n            className: 'interval',\n            attrs: attrs\n          });\n        }\n      });\n    });\n\n    var Interval$1 = /*#__PURE__*/function (_Geom) {\n      _inheritsLoose(Interval, _Geom);\n\n      var _proto = Interval.prototype;\n\n      _proto.getDefaultCfg = function getDefaultCfg() {\n        var cfg = _Geom.prototype.getDefaultCfg.call(this);\n\n        cfg.type = 'interval';\n        cfg.shapeType = 'interval';\n        cfg.generatePoints = true;\n        return cfg;\n      };\n\n      function Interval(cfg) {\n        var _this;\n\n        _this = _Geom.call(this, cfg) || this;\n        mix(_assertThisInitialized(_this), SizeMixin);\n        return _this;\n      }\n\n      _proto.init = function init() {\n        _Geom.prototype.init.call(this); // 绑定事件\n\n\n        this.initEvent();\n      };\n\n      _proto.createShapePointsCfg = function createShapePointsCfg(obj) {\n        var cfg = _Geom.prototype.createShapePointsCfg.call(this, obj);\n\n        cfg.size = this.getNormalizedSize(obj);\n        return cfg;\n      };\n\n      _proto.clearInner = function clearInner() {\n        _Geom.prototype.clearInner.call(this);\n\n        this.set('defaultSize', null);\n      };\n\n      return Interval;\n    }(Geom);\n\n    Geom.Interval = Interval$1;\n\n    var Polygon$1 = Shape$1.registerFactory('polygon', {\n      defaultShapeType: 'polygon',\n      getDefaultPoints: function getDefaultPoints(pointInfo) {\n        var points = [];\n        var x = pointInfo.x,\n            y = pointInfo.y;\n\n        for (var i = 0, len = x.length; i < len; i++) {\n          points.push({\n            x: x[i],\n            y: y[i]\n          });\n        }\n\n        return points;\n      }\n    });\n    Shape$1.registerShape('polygon', 'polygon', {\n      draw: function draw(cfg, container) {\n        var points = this.parsePoints(cfg.points);\n        var style = mix({\n          fill: cfg.color,\n          points: points\n        }, cfg.style);\n        return container.addShape('Polygon', {\n          className: 'polygon',\n          attrs: style\n        });\n      }\n    });\n\n    var Polygon$2 = /*#__PURE__*/function (_Geom) {\n      _inheritsLoose(Polygon, _Geom);\n\n      function Polygon() {\n        return _Geom.apply(this, arguments) || this;\n      }\n\n      var _proto = Polygon.prototype;\n\n      _proto.getDefaultCfg = function getDefaultCfg() {\n        var cfg = _Geom.prototype.getDefaultCfg.call(this);\n\n        cfg.type = 'polygon';\n        cfg.shapeType = 'polygon';\n        cfg.generatePoints = true;\n        return cfg;\n      };\n\n      _proto.createShapePointsCfg = function createShapePointsCfg(obj) {\n        var cfg = _Geom.prototype.createShapePointsCfg.call(this, obj);\n\n        var self = this;\n        var x = cfg.x;\n        var y = cfg.y;\n        var temp;\n\n        if (!(isArray(x) && isArray(y))) {\n          var xScale = self.getXScale();\n          var yScale = self.getYScale();\n          var xCount = xScale.values ? xScale.values.length : xScale.ticks.length;\n          var yCount = yScale.values ? yScale.values.length : yScale.ticks.length;\n          var xOffset = 0.5 * 1 / xCount;\n          var yOffset = 0.5 * 1 / yCount;\n\n          if (xScale.isCategory && yScale.isCategory) {\n            x = [x - xOffset, x - xOffset, x + xOffset, x + xOffset];\n            y = [y - yOffset, y + yOffset, y + yOffset, y - yOffset];\n          } else if (isArray(x)) {\n            temp = x;\n            x = [temp[0], temp[0], temp[1], temp[1]];\n            y = [y - yOffset / 2, y + yOffset / 2, y + yOffset / 2, y - yOffset / 2];\n          } else if (isArray(y)) {\n            temp = y;\n            y = [temp[0], temp[1], temp[1], temp[0]];\n            x = [x - xOffset / 2, x - xOffset / 2, x + xOffset / 2, x + xOffset / 2];\n          }\n\n          cfg.x = x;\n          cfg.y = y;\n        }\n\n        return cfg;\n      };\n\n      return Polygon;\n    }(Geom);\n\n    Geom.Polygon = Polygon$2;\n\n    function _sortValue(value) {\n      var sorted = value.sort(function (a, b) {\n        return a < b ? 1 : -1;\n      });\n      var length = sorted.length;\n\n      if (length < 4) {\n        var min = sorted[length - 1];\n\n        for (var i = 0; i < 4 - length; i++) {\n          sorted.push(min);\n        }\n      }\n\n      return sorted;\n    } // from left bottom corner, and clockwise\n\n\n    function getCandlePoints(x, y, width) {\n      var yValues = _sortValue(y);\n\n      var points = [{\n        x: x,\n        y: yValues[0]\n      }, {\n        x: x,\n        y: yValues[1]\n      }, {\n        x: x - width / 2,\n        y: yValues[2]\n      }, {\n        x: x - width / 2,\n        y: yValues[1]\n      }, {\n        x: x + width / 2,\n        y: yValues[1]\n      }, {\n        x: x + width / 2,\n        y: yValues[2]\n      }, {\n        x: x,\n        y: yValues[2]\n      }, {\n        x: x,\n        y: yValues[3]\n      }];\n      return points;\n    }\n\n    var Schema = Shape$1.registerFactory('schema', {});\n    Shape$1.registerShape('schema', 'candle', {\n      getPoints: function getPoints(cfg) {\n        return getCandlePoints(cfg.x, cfg.y, cfg.size);\n      },\n      draw: function draw(cfg, container) {\n        var points = this.parsePoints(cfg.points);\n        var style = mix({\n          stroke: cfg.color,\n          fill: cfg.color,\n          lineWidth: 1\n        }, cfg.style);\n        return container.addShape('Custom', {\n          className: 'schema',\n          attrs: style,\n          createPath: function createPath(ctx) {\n            ctx.beginPath();\n            ctx.moveTo(points[0].x, points[0].y);\n            ctx.lineTo(points[1].x, points[1].y);\n            ctx.moveTo(points[2].x, points[2].y);\n\n            for (var i = 3; i < 6; i++) {\n              ctx.lineTo(points[i].x, points[i].y);\n            }\n\n            ctx.closePath();\n            ctx.moveTo(points[6].x, points[6].y);\n            ctx.lineTo(points[7].x, points[7].y);\n          }\n        });\n      }\n    });\n\n    var Schema$1 = /*#__PURE__*/function (_Geom) {\n      _inheritsLoose(Schema, _Geom);\n\n      var _proto = Schema.prototype;\n\n      _proto.getDefaultCfg = function getDefaultCfg() {\n        var cfg = _Geom.prototype.getDefaultCfg.call(this);\n\n        cfg.type = 'schema';\n        cfg.shapeType = 'schema';\n        cfg.generatePoints = true;\n        return cfg;\n      };\n\n      function Schema(cfg) {\n        var _this;\n\n        _this = _Geom.call(this, cfg) || this;\n        mix(_assertThisInitialized(_this), SizeMixin);\n        return _this;\n      }\n\n      _proto.init = function init() {\n        _Geom.prototype.init.call(this); // 绑定事件\n\n\n        this.initEvent();\n      };\n\n      _proto.createShapePointsCfg = function createShapePointsCfg(obj) {\n        var cfg = _Geom.prototype.createShapePointsCfg.call(this, obj);\n\n        cfg.size = this.getNormalizedSize(obj);\n        return cfg;\n      };\n\n      _proto.clearInner = function clearInner() {\n        _Geom.prototype.clearInner.call(this);\n\n        this.set('defaultSize', null);\n      };\n\n      return Schema;\n    }(Geom);\n\n    Geom.Schema = Schema$1;\n\n    var toString$3 = {}.toString;\n\n    var isType$1 = function isType(value, type) {\n      return toString$3.call(value) === '[object ' + type + ']';\n    };\n\n    var isType_1 = isType$1;\n\n    var isArray$1 = Array.isArray ? Array.isArray : function (value) {\n      return isType_1(value, 'Array');\n    };\n    var isArray_1 = isArray$1;\n\n    // isFinite,\n    var isNil$1 = function isNil(value) {\n      /**\n       * isNil(null) => true\n       * isNil() => true\n       */\n      return value === null || value === undefined;\n    };\n\n    var isNil_1 = isNil$1;\n\n    function _inheritsLoose$1(subClass, superClass) {\n      subClass.prototype = Object.create(superClass.prototype);\n      subClass.prototype.constructor = subClass;\n      subClass.__proto__ = superClass;\n    }\n\n    var Stack = /*#__PURE__*/function (_Adjust) {\n      _inheritsLoose$1(Stack, _Adjust);\n\n      function Stack() {\n        return _Adjust.apply(this, arguments) || this;\n      }\n\n      var _proto = Stack.prototype;\n\n      _proto._initDefaultCfg = function _initDefaultCfg() {\n        this.xField = null; // 调整对应的 x 方向对应的字段名称\n\n        this.yField = null; // 调整对应的 y 方向对应的字段名称\n      };\n\n      _proto.processAdjust = function processAdjust(dataArray) {\n        this.processStack(dataArray);\n      };\n\n      _proto.processStack = function processStack(dataArray) {\n        var self = this;\n        var xField = self.xField;\n        var yField = self.yField;\n        var count = dataArray.length;\n        var stackCache = {\n          positive: {},\n          negative: {}\n        }; // 层叠顺序翻转\n\n        if (self.reverseOrder) {\n          dataArray = dataArray.slice(0).reverse();\n        }\n\n        for (var i = 0; i < count; i++) {\n          var data = dataArray[i];\n\n          for (var j = 0, len = data.length; j < len; j++) {\n            var item = data[j];\n            var x = item[xField] || 0;\n            var y = item[yField];\n            var xkey = x.toString();\n            y = isArray_1(y) ? y[1] : y;\n\n            if (!isNil_1(y)) {\n              var direction = y >= 0 ? 'positive' : 'negative';\n\n              if (!stackCache[direction][xkey]) {\n                stackCache[direction][xkey] = 0;\n              }\n\n              item[yField] = [stackCache[direction][xkey], y + stackCache[direction][xkey]];\n              stackCache[direction][xkey] += y;\n            }\n          }\n        }\n      };\n\n      return Stack;\n    }(base);\n\n    base.Stack = Stack;\n\n    var _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) {\n      return typeof obj;\n    } : function (obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n\n    var isObject$1 = function isObject(value) {\n      /**\n       * isObject({}) => true\n       * isObject([1, 2, 3]) => true\n       * isObject(Function) => true\n       * isObject(null) => false\n       */\n      var type = typeof value === 'undefined' ? 'undefined' : _typeof(value);\n      return value !== null && type === 'object' || type === 'function';\n    };\n\n    var isObject_1 = isObject$1;\n\n    var each$1 = function each(elements, func) {\n      if (!elements) {\n        return;\n      }\n\n      var rst = void 0;\n\n      if (isArray_1(elements)) {\n        for (var i = 0, len = elements.length; i < len; i++) {\n          rst = func(elements[i], i);\n\n          if (rst === false) {\n            break;\n          }\n        }\n      } else if (isObject_1(elements)) {\n        for (var k in elements) {\n          if (elements.hasOwnProperty(k)) {\n            rst = func(elements[k], k);\n\n            if (rst === false) {\n              break;\n            }\n          }\n        }\n      }\n    };\n\n    var each_1 = each$1;\n\n    function _inheritsLoose$2(subClass, superClass) {\n      subClass.prototype = Object.create(superClass.prototype);\n      subClass.prototype.constructor = subClass;\n      subClass.__proto__ = superClass;\n    }\n\n    var MARGIN_RATIO = 1 / 2;\n    var DODGE_RATIO = 1 / 2;\n\n    var Dodge = /*#__PURE__*/function (_Adjust) {\n      _inheritsLoose$2(Dodge, _Adjust);\n\n      function Dodge() {\n        return _Adjust.apply(this, arguments) || this;\n      }\n\n      var _proto = Dodge.prototype;\n\n      _proto._initDefaultCfg = function _initDefaultCfg() {\n        /**\n         * 调整过程中,2个数据的间距\n         * @type {Number}\n         */\n        this.marginRatio = MARGIN_RATIO;\n        /**\n         * 调整占单位宽度的比例,例如：占2个分类间距的 1/2\n         * @type {Number}\n         */\n\n        this.dodgeRatio = DODGE_RATIO;\n        this.adjustNames = ['x', 'y']; // 调整的维度，默认,x,y都做调整\n      };\n\n      _proto.getDodgeOffset = function getDodgeOffset(range, index, count) {\n        var self = this;\n        var pre = range.pre;\n        var next = range.next;\n        var tickLength = next - pre;\n        var width = tickLength * self.dodgeRatio / count;\n        var margin = self.marginRatio * width;\n        var offset = 1 / 2 * (tickLength - count * width - (count - 1) * margin) + ((index + 1) * width + index * margin) - 1 / 2 * width - 1 / 2 * tickLength;\n        return (pre + next) / 2 + offset;\n      };\n\n      _proto.processAdjust = function processAdjust(dataArray) {\n        var self = this;\n        var count = dataArray.length;\n        var xField = self.xField;\n        each_1(dataArray, function (data, index) {\n          for (var i = 0, len = data.length; i < len; i++) {\n            var obj = data[i];\n            var value = obj[xField];\n            var range = {\n              pre: len === 1 ? value - 1 : value - 0.5,\n              next: len === 1 ? value + 1 : value + 0.5\n            };\n            var dodgeValue = self.getDodgeOffset(range, index, count);\n            obj[xField] = dodgeValue;\n          }\n        });\n      };\n\n      return Dodge;\n    }(base);\n\n    base.Dodge = Dodge;\n\n    /**\n     * 是否为函数\n     * @param  {*} fn 对象\n     * @return {Boolean}  是否函数\n     */\n\n    var isFunction$1 = function isFunction(value) {\n      return isType_1(value, 'Function');\n    };\n\n    var isFunction_1 = isFunction$1;\n\n    /**\n     * @param {Array} arr The array to iterate over.\n     * @param {Function} [fn] The iteratee invoked per element.\n     * @return {*} Returns the maximum value.\n     * @example\n     *\n     * var objects = [{ 'n': 1 }, { 'n': 2 }];\n     *\n     * maxBy(objects, function(o) { return o.n; });\n     * // => { 'n': 2 }\n     *\n     * maxBy(objects, 'n');\n     * // => { 'n': 2 }\n     */\n\n    var maxBy = function maxBy(arr, fn) {\n      if (!isArray_1(arr)) {\n        return undefined;\n      }\n\n      var max = arr[0];\n      var maxData = void 0;\n\n      if (isFunction_1(fn)) {\n        maxData = fn(arr[0]);\n      } else {\n        maxData = arr[0][fn];\n      }\n\n      var data = void 0;\n      each_1(arr, function (val) {\n        if (isFunction_1(fn)) {\n          data = fn(val);\n        } else {\n          data = val[fn];\n        }\n\n        if (data > maxData) {\n          max = val;\n          maxData = data;\n        }\n      });\n      return max;\n    };\n\n    var maxBy_1 = maxBy;\n\n    var merge$1 = function merge(dataArray) {\n      var rst = [];\n\n      for (var i = 0; i < dataArray.length; i++) {\n        rst = rst.concat(dataArray[i]);\n      }\n\n      return rst;\n    };\n\n    var merge_1 = merge$1;\n\n    function _inheritsLoose$3(subClass, superClass) {\n      subClass.prototype = Object.create(superClass.prototype);\n      subClass.prototype.constructor = subClass;\n      subClass.__proto__ = superClass;\n    }\n\n    var ArrayUtil = {\n      merge: merge_1\n    };\n\n    var Symmetric = /*#__PURE__*/function (_Adjust) {\n      _inheritsLoose$3(Symmetric, _Adjust);\n\n      function Symmetric() {\n        return _Adjust.apply(this, arguments) || this;\n      }\n\n      var _proto = Symmetric.prototype;\n\n      _proto._initDefaultCfg = function _initDefaultCfg() {\n        this.xField = null; // 调整对应的 x 方向对应的字段名称\n\n        this.yField = null; // 调整对应的 y 方向对应的字段名称\n\n        this.cacheMax = null; // 缓存的最大值\n\n        this.adjustNames = ['y']; // Only support stack y\n\n        this.groupFields = null; // 参与分组的数据维度\n      }; // 获取最大的y值\n\n\n      _proto._getMax = function _getMax(dim) {\n        var self = this;\n        var mergeData = self.mergeData;\n        var maxRecord = maxBy_1(mergeData, function (obj) {\n          var value = obj[dim];\n\n          if (isArray_1(value)) {\n            return Math.max.apply(null, value);\n          }\n\n          return value;\n        });\n        var maxValue = maxRecord[dim];\n        var max = isArray_1(maxValue) ? Math.max.apply(null, maxValue) : maxValue;\n        return max;\n      }; // 获取每个字段最大的值\n\n\n      _proto._getXValuesMax = function _getXValuesMax() {\n        var self = this;\n        var yField = self.yField;\n        var xField = self.xField;\n        var cache = {};\n        var mergeData = self.mergeData;\n        each_1(mergeData, function (obj) {\n          var xValue = obj[xField];\n          var yValue = obj[yField];\n          var max = isArray_1(yValue) ? Math.max.apply(null, yValue) : yValue;\n          cache[xValue] = cache[xValue] || 0;\n\n          if (cache[xValue] < max) {\n            cache[xValue] = max;\n          }\n        });\n        return cache;\n      }; // 入口函数\n\n\n      _proto.processAdjust = function processAdjust(dataArray) {\n        var self = this;\n        var mergeData = ArrayUtil.merge(dataArray);\n        self.mergeData = mergeData;\n\n        self._processSymmetric(dataArray);\n\n        self.mergeData = null;\n      }; // 处理对称\n\n\n      _proto._processSymmetric = function _processSymmetric(dataArray) {\n        var self = this;\n        var xField = self.xField;\n        var yField = self.yField;\n\n        var max = self._getMax(yField);\n\n        var first = dataArray[0][0];\n        var cache;\n\n        if (first && isArray_1(first[yField])) {\n          cache = self._getXValuesMax();\n        }\n\n        each_1(dataArray, function (data) {\n          each_1(data, function (obj) {\n            var value = obj[yField];\n            var offset;\n\n            if (isArray_1(value)) {\n              var xValue = obj[xField];\n              var valueMax = cache[xValue];\n              offset = (max - valueMax) / 2;\n              var tmp = [];\n              /* eslint-disable no-loop-func */\n\n              each_1(value, function (subVal) {\n                // 多个字段\n                tmp.push(offset + subVal);\n              });\n              /* eslint-enable no-loop-func */\n\n              obj[yField] = tmp;\n            } else {\n              offset = (max - value) / 2;\n              obj[yField] = [offset, value + offset];\n            }\n          });\n        });\n      };\n\n      return Symmetric;\n    }(base);\n\n    base.Symmetric = Symmetric;\n\n    var Polar = /*#__PURE__*/function (_Base) {\n      _inheritsLoose(Polar, _Base);\n\n      function Polar() {\n        return _Base.apply(this, arguments) || this;\n      }\n\n      var _proto = Polar.prototype;\n\n      _proto._initDefaultCfg = function _initDefaultCfg() {\n        this.type = 'polar';\n        this.startAngle = -Math.PI / 2;\n        this.endAngle = Math.PI * 3 / 2;\n        this.inner = 0;\n        this.innerRadius = 0; // alias\n\n        this.isPolar = true;\n        this.transposed = false;\n        this.center = null;\n        this.radius = null; // relative, 0 ~ 1\n      };\n\n      _proto.init = function init(start, end) {\n        _Base.prototype.init.call(this, start, end);\n\n        var self = this;\n        var inner = self.inner || self.innerRadius;\n        var width = Math.abs(end.x - start.x);\n        var height = Math.abs(end.y - start.y);\n        var maxRadius;\n        var center;\n\n        if (self.startAngle === -Math.PI && self.endAngle === 0) {\n          maxRadius = Math.min(width / 2, height);\n          center = {\n            x: (start.x + end.x) / 2,\n            y: start.y\n          };\n        } else {\n          maxRadius = Math.min(width, height) / 2;\n          center = {\n            x: (start.x + end.x) / 2,\n            y: (start.y + end.y) / 2\n          };\n        }\n\n        var radius = self.radius;\n\n        if (radius > 0 && radius <= 1) {\n          maxRadius = maxRadius * radius;\n        }\n\n        this.x = {\n          start: self.startAngle,\n          end: self.endAngle\n        };\n        this.y = {\n          start: maxRadius * inner,\n          end: maxRadius\n        };\n        this.center = center;\n        this.circleRadius = maxRadius; // the radius value in px\n      };\n\n      _proto._convertPoint = function _convertPoint(point) {\n        var self = this;\n        var center = self.center;\n        var transposed = self.transposed;\n        var xDim = transposed ? 'y' : 'x';\n        var yDim = transposed ? 'x' : 'y';\n        var x = self.x;\n        var y = self.y;\n        var angle = x.start + (x.end - x.start) * point[xDim];\n        var radius = y.start + (y.end - y.start) * point[yDim];\n        return {\n          x: center.x + Math.cos(angle) * radius,\n          y: center.y + Math.sin(angle) * radius\n        };\n      };\n\n      _proto._invertPoint = function _invertPoint(point) {\n        var self = this;\n        var center = self.center,\n            transposed = self.transposed,\n            x = self.x,\n            y = self.y;\n        var xDim = transposed ? 'y' : 'x';\n        var yDim = transposed ? 'x' : 'y';\n        var m = [1, 0, 0, 1, 0, 0];\n        Matrix.rotate(m, m, x.start);\n        var startV = [1, 0];\n        Vector2.transformMat2d(startV, startV, m);\n        startV = [startV[0], startV[1]];\n        var pointV = [point.x - center.x, point.y - center.y];\n\n        if (Vector2.zero(pointV)) {\n          return {\n            x: 0,\n            y: 0\n          };\n        }\n\n        var theta = Vector2.angleTo(startV, pointV, x.end < x.start);\n\n        if (Math.abs(theta - Math.PI * 2) < 0.001) {\n          theta = 0;\n        }\n\n        var l = Vector2.length(pointV);\n        var percentX = theta / (x.end - x.start);\n        percentX = x.end - x.start > 0 ? percentX : -percentX;\n        var percentY = (l - y.start) / (y.end - y.start);\n        var rst = {};\n        rst[xDim] = percentX;\n        rst[yDim] = percentY;\n        return rst;\n      };\n\n      return Polar;\n    }(Base$1);\n\n    Base$1.Polar = Polar;\n\n    var Circle$1 = /*#__PURE__*/function (_Abstract) {\n      _inheritsLoose(Circle, _Abstract);\n\n      function Circle() {\n        return _Abstract.apply(this, arguments) || this;\n      }\n\n      var _proto = Circle.prototype;\n\n      _proto._initDefaultCfg = function _initDefaultCfg() {\n        _Abstract.prototype._initDefaultCfg.call(this);\n\n        this.startAngle = -Math.PI / 2; // start angle，in radian\n\n        this.endAngle = Math.PI * 3 / 2; // end angle, in radian\n\n        this.radius = null; // radius\n\n        this.center = null; // center\n      };\n\n      _proto.getOffsetPoint = function getOffsetPoint(value) {\n        var startAngle = this.startAngle,\n            endAngle = this.endAngle;\n        var angle = startAngle + (endAngle - startAngle) * value;\n        return this._getCirclePoint(angle);\n      };\n\n      _proto._getCirclePoint = function _getCirclePoint(angle, radius) {\n        var self = this;\n        var center = self.center;\n        radius = radius || self.radius;\n        return {\n          x: center.x + Math.cos(angle) * radius,\n          y: center.y + Math.sin(angle) * radius\n        };\n      };\n\n      _proto.getTextAlignInfo = function getTextAlignInfo(point, offset) {\n        var self = this;\n        var offsetVector = self.getOffsetVector(point, offset);\n        var align;\n        var baseLine = 'middle';\n\n        if (offsetVector[0] > 0) {\n          align = 'left';\n        } else if (offsetVector[0] < 0) {\n          align = 'right';\n        } else {\n          align = 'center';\n\n          if (offsetVector[1] > 0) {\n            baseLine = 'top';\n          } else if (offsetVector[1] < 0) {\n            baseLine = 'bottom';\n          }\n        }\n\n        return {\n          textAlign: align,\n          textBaseline: baseLine\n        };\n      };\n\n      _proto.getAxisVector = function getAxisVector(point) {\n        var center = this.center;\n        var factor = this.offsetFactor;\n        return [(point.y - center.y) * factor, (point.x - center.x) * -1 * factor];\n      };\n\n      _proto.drawLine = function drawLine(lineCfg) {\n        var center = this.center,\n            radius = this.radius,\n            startAngle = this.startAngle,\n            endAngle = this.endAngle;\n        var container = this.getContainer(lineCfg.top);\n        container.addShape('arc', {\n          className: 'axis-line',\n          attrs: mix({\n            x: center.x,\n            y: center.y,\n            r: radius,\n            startAngle: startAngle,\n            endAngle: endAngle\n          }, lineCfg)\n        });\n      };\n\n      return Circle;\n    }(Abastract);\n\n    Abastract.Circle = Circle$1;\n\n    var KEYWORDS_PERCENT = {\n      min: 0,\n      median: 0.5,\n      max: 1\n    };\n\n    var GuideBase = /*#__PURE__*/function () {\n      var _proto = GuideBase.prototype;\n\n      _proto._initDefaultCfg = function _initDefaultCfg() {};\n\n      function GuideBase(cfg) {\n        this._initDefaultCfg();\n\n        deepMix(this, cfg);\n      }\n\n      _proto._getNormalizedValue = function _getNormalizedValue(val, scale) {\n        var rst;\n\n        if (isNil(KEYWORDS_PERCENT[val])) {\n          rst = scale.scale(val);\n        } else {\n          rst = KEYWORDS_PERCENT[val];\n        }\n\n        return rst;\n      };\n\n      _proto.parsePercentPoint = function parsePercentPoint(coord, position) {\n        var xPercent = parseFloat(position[0]) / 100;\n        var yPercent = parseFloat(position[1]) / 100;\n        var start = coord.start;\n        var end = coord.end;\n        var width = Math.abs(start.x - end.x);\n        var height = Math.abs(start.y - end.y);\n        var x = width * xPercent + Math.min(start.x, end.x);\n        var y = height * yPercent + Math.min(start.y, end.y);\n        return {\n          x: x,\n          y: y\n        };\n      };\n\n      _proto.parsePoint = function parsePoint(coord, position) {\n        var self = this;\n        var xScale = self.xScale;\n        var yScales = self.yScales;\n\n        if (isFunction(position)) {\n          position = position(xScale, yScales); // position 必须是对象\n        } // 如果数据格式是 ['50%', '50%'] 的格式\n        // fix: 原始数据中可能会包含 'xxx5%xxx' 这样的数据，需要判断下 https://github.com/antvis/f2/issues/590\n\n\n        if (isString(position[0]) && position[0].indexOf('%') !== -1 && !isNaN(position[0].slice(0, -1))) {\n          return this.parsePercentPoint(coord, position);\n        }\n\n        var x = self._getNormalizedValue(position[0], xScale);\n\n        var y = self._getNormalizedValue(position[1], yScales[0]);\n\n        var point = coord.convertPoint({\n          x: x,\n          y: y\n        });\n\n        if (self.limitInPlot) {\n          // limit in chart plotRange\n          if (x >= 0 && x <= 1 && y >= 0 && y <= 1) {\n            return point;\n          }\n\n          return null;\n        }\n\n        return point;\n      }\n      /**\n       * render the guide component\n       * @param  {Coord} coord  coordinate instance\n       * @param  {Canvas.Group} group the container\n       */\n      ;\n\n      _proto.render = function render()\n      /* coord,group */\n      {};\n\n      _proto.repaint = function repaint() {\n        this.remove();\n        var coord = this.coord,\n            container = this.container,\n            canvas = this.canvas;\n\n        if (container && !container.isDestroyed()) {\n          this.render(coord, container);\n          canvas.draw();\n        }\n      };\n\n      _proto.remove = function remove() {\n        var element = this.element;\n        element && element.remove(true);\n      };\n\n      _proto.changeVisible = function changeVisible(visible) {\n        var self = this;\n        self.visible = visible;\n        var element = self.element;\n        if (!element) return;\n\n        if (element.set) {\n          element.set('visible', visible);\n        } else {\n          element.style.display = visible ? '' : 'none';\n        }\n      };\n\n      return GuideBase;\n    }();\n\n    var Arc$1 = /*#__PURE__*/function (_GuideBase) {\n      _inheritsLoose(Arc, _GuideBase);\n\n      function Arc() {\n        return _GuideBase.apply(this, arguments) || this;\n      }\n\n      var _proto = Arc.prototype;\n\n      _proto._initDefaultCfg = function _initDefaultCfg() {\n        this.type = 'arc';\n        /**\n         * start point\n         * @type {Array | Function}\n         */\n\n        this.start = [];\n        /**\n         * end point\n         * @type {Array | Function}\n         */\n\n        this.end = [];\n        /**\n         * style configuration\n         * @type {Object}\n         */\n\n        this.style = {\n          stroke: '#999',\n          lineWidth: 1\n        };\n      };\n\n      _proto.render = function render(coord, container) {\n        var self = this;\n        var start = self.parsePoint(coord, self.start);\n        var end = self.parsePoint(coord, self.end);\n\n        if (!start || !end) {\n          return;\n        }\n\n        var coordCenter = coord.center;\n        var radius = Math.sqrt((start.x - coordCenter.x) * (start.x - coordCenter.x) + (start.y - coordCenter.y) * (start.y - coordCenter.y));\n        var startAngle = Math.atan2(start.y - coordCenter.y, start.x - coordCenter.x);\n        var endAngle = Math.atan2(end.y - coordCenter.y, end.x - coordCenter.x);\n        var shape = container.addShape('arc', {\n          className: 'guide-arc',\n          attrs: mix({\n            x: coordCenter.x,\n            y: coordCenter.y,\n            r: radius,\n            startAngle: startAngle,\n            endAngle: endAngle\n          }, self.style)\n        });\n        self.element = shape;\n        return shape;\n      };\n\n      return Arc;\n    }(GuideBase);\n\n    GuideBase.Arc = Arc$1;\n\n    function getOffsetFromAlign(alignX, alignY, width, height) {\n      var result = [];\n\n      if (alignX === 'left' && alignY === 'top') {\n        result[0] = 0;\n        result[1] = 0;\n      } else if (alignX === 'right' && alignY === 'top') {\n        result[0] = -width;\n        result[1] = 0;\n      } else if (alignX === 'left' && alignY === 'bottom') {\n        result[0] = 0;\n        result[1] = Math.floor(-height);\n      } else if (alignX === 'right' && alignY === 'bottom') {\n        result[0] = Math.floor(-width);\n        result[1] = Math.floor(-height);\n      } else if (alignX === 'right' && alignY === 'middle') {\n        result[0] = Math.floor(-width);\n        result[1] = Math.floor(-height / 2);\n      } else if (alignX === 'left' && alignY === 'middle') {\n        result[0] = 0;\n        result[1] = Math.floor(-height / 2);\n      } else if (alignX === 'center' && alignY === 'bottom') {\n        result[0] = Math.floor(-width / 2);\n        result[1] = Math.floor(-height);\n      } else if (alignX === 'center' && alignY === 'top') {\n        result[0] = Math.floor(-width / 2);\n        result[1] = 0;\n      } else {\n        result[0] = Math.floor(-width / 2);\n        result[1] = Math.floor(-height / 2);\n      }\n\n      return result;\n    }\n\n    function modifyCSS(DOM, CSS) {\n      for (var key in CSS) {\n        if (CSS.hasOwnProperty(key)) {\n          DOM.style[key] = CSS[key];\n        }\n      }\n\n      return DOM;\n    }\n\n    function createDom(str) {\n      var container = document.createElement('div');\n      str = str.replace(/(^\\s*)|(\\s*$)/g, '');\n      container.innerHTML = '' + str;\n      return container.childNodes[0];\n    }\n\n    var Html = /*#__PURE__*/function (_GuideBase) {\n      _inheritsLoose(Html, _GuideBase);\n\n      function Html() {\n        return _GuideBase.apply(this, arguments) || this;\n      }\n\n      var _proto = Html.prototype;\n\n      _proto._initDefaultCfg = function _initDefaultCfg() {\n        this.type = 'html';\n        /**\n         * dom position\n         * @type {Object | Array}\n         */\n\n        this.position = null;\n        /**\n          * alignment for horizontal direction，can be 'left','center','right'\n          * @type {String}\n          */\n\n        this.alignX = 'center';\n        /**\n          * alignment for vertical direction，can be 'top', 'middle', 'bottom'\n          * @type {String}\n          */\n\n        this.alignY = 'middle';\n        /**\n          * offset for horizontal direction\n          * @type {Number}\n          */\n\n        this.offsetX = null;\n        /**\n          * offset for vertical direction\n          * @type {Number}\n          */\n\n        this.offsetY = null;\n        /**\n        * the html string\n        *@type {String | Function}\n        */\n\n        this.html = null;\n      } // override paint\n      ;\n\n      _proto.render = function render(coord, container) {\n        var self = this;\n        var position = self.parsePoint(coord, self.position);\n\n        if (!position) {\n          return;\n        }\n\n        var myNode = createDom(self.html);\n        myNode = modifyCSS(myNode, {\n          position: 'absolute',\n          top: Math.floor(position.y) + 'px',\n          left: Math.floor(position.x) + 'px',\n          visibility: 'hidden'\n        });\n        var canvasDom = container.get('canvas').get('el');\n        var parentNode = canvasDom.parentNode;\n        parentNode = modifyCSS(parentNode, {\n          position: 'relative'\n        });\n        var wrapperNode = createDom('<div class=\"guideWapper\" style=\"position: absolute;top: 0; left: 0;\"></div>');\n        parentNode.appendChild(wrapperNode);\n        wrapperNode.appendChild(myNode);\n        var canvasOffsetTop = canvasDom.offsetTop;\n        var canvasOffsetLeft = canvasDom.offsetLeft;\n        var alignX = self.alignX,\n            alignY = self.alignY,\n            offsetX = self.offsetX,\n            offsetY = self.offsetY;\n        var width = getWidth(myNode);\n        var height = getHeight(myNode);\n        var newOffset = getOffsetFromAlign(alignX, alignY, width, height);\n        position.x = position.x + newOffset[0] + canvasOffsetLeft;\n        position.y = position.y + newOffset[1] + canvasOffsetTop;\n\n        if (offsetX) {\n          position.x += offsetX;\n        }\n\n        if (offsetY) {\n          position.y += offsetY;\n        }\n\n        modifyCSS(myNode, {\n          top: Math.floor(position.y) + 'px',\n          left: Math.floor(position.x) + 'px',\n          visibility: 'visible'\n        });\n        self.element = wrapperNode;\n      };\n\n      _proto.remove = function remove() {\n        var element = this.element;\n        element && element.parentNode && element.parentNode.removeChild(element);\n      };\n\n      return Html;\n    }(GuideBase);\n\n    GuideBase.Html = Html;\n\n    var Line$4 = /*#__PURE__*/function (_GuideBase) {\n      _inheritsLoose(Line, _GuideBase);\n\n      function Line() {\n        return _GuideBase.apply(this, arguments) || this;\n      }\n\n      var _proto = Line.prototype;\n\n      _proto._initDefaultCfg = function _initDefaultCfg() {\n        this.type = 'line';\n        this.start = [];\n        this.end = [];\n        this.style = {\n          stroke: '#000',\n          lineWidth: 1\n        };\n      };\n\n      _proto.render = function render(coord, container) {\n        var points = [];\n        points[0] = this.parsePoint(coord, this.start);\n        points[1] = this.parsePoint(coord, this.end);\n\n        if (!points[0] || !points[1]) {\n          return;\n        }\n\n        var shape = container.addShape('Line', {\n          className: 'guide-line',\n          attrs: mix({\n            x1: points[0].x,\n            y1: points[0].y,\n            x2: points[1].x,\n            y2: points[1].y\n          }, this.style)\n        });\n        this.element = shape;\n        return shape;\n      };\n\n      return Line;\n    }(GuideBase);\n\n    GuideBase.Line = Line$4;\n\n    var Rect$2 = /*#__PURE__*/function (_GuideBase) {\n      _inheritsLoose(Rect, _GuideBase);\n\n      function Rect() {\n        return _GuideBase.apply(this, arguments) || this;\n      }\n\n      var _proto = Rect.prototype;\n\n      _proto._initDefaultCfg = function _initDefaultCfg() {\n        this.type = 'rect';\n        this.start = [];\n        this.end = [];\n        this.style = {\n          fill: '#CCD7EB',\n          opacity: 0.4\n        };\n      };\n\n      _proto.render = function render(coord, container) {\n        var start = this.parsePoint(coord, this.start);\n        var end = this.parsePoint(coord, this.end);\n\n        if (!start || !end) {\n          return;\n        }\n\n        var shape = container.addShape('rect', {\n          className: 'guide-rect',\n          attrs: mix({\n            x: Math.min(start.x, end.x),\n            y: Math.min(start.y, end.y),\n            width: Math.abs(end.x - start.x),\n            height: Math.abs(start.y - end.y)\n          }, this.style)\n        });\n        this.element = shape;\n        return shape;\n      };\n\n      return Rect;\n    }(GuideBase);\n\n    GuideBase.Rect = Rect$2;\n\n    var Text$1 = /*#__PURE__*/function (_GuideBase) {\n      _inheritsLoose(Text, _GuideBase);\n\n      function Text() {\n        return _GuideBase.apply(this, arguments) || this;\n      }\n\n      var _proto = Text.prototype;\n\n      _proto._initDefaultCfg = function _initDefaultCfg() {\n        this.type = 'text';\n        /**\n         * the position of text\n         * @type {Function | Array}\n         */\n\n        this.position = null;\n        /**\n         * the display content\n         * @type {String}\n         */\n\n        this.content = null;\n        /**\n         * style configuration for text\n         * @type {Object}\n         */\n\n        this.style = {\n          fill: '#000'\n        };\n        /**\n         * offset of horizontal direction\n         * @type {Number}\n         */\n\n        this.offsetX = 0;\n        /**\n         * offset of vertical direction\n         * @type {Number}\n         */\n\n        this.offsetY = 0;\n      };\n\n      _proto.render = function render(coord, container) {\n        var position = this.position;\n        var point = this.parsePoint(coord, position);\n\n        if (!point) {\n          return;\n        }\n\n        var content = this.content,\n            style = this.style,\n            offsetX = this.offsetX,\n            offsetY = this.offsetY;\n\n        if (offsetX) {\n          point.x += offsetX;\n        }\n\n        if (offsetY) {\n          point.y += offsetY;\n        }\n\n        var shape = container.addShape('text', {\n          className: 'guide-text',\n          attrs: mix({\n            x: point.x,\n            y: point.y,\n            text: content\n          }, style)\n        });\n        this.element = shape;\n        return shape;\n      };\n\n      return Text;\n    }(GuideBase);\n\n    GuideBase.Text = Text$1;\n\n    var Tag = /*#__PURE__*/function (_GuideBase) {\n      _inheritsLoose(Tag, _GuideBase);\n\n      function Tag() {\n        return _GuideBase.apply(this, arguments) || this;\n      }\n\n      var _proto = Tag.prototype;\n\n      _proto._initDefaultCfg = function _initDefaultCfg() {\n        this.type = 'tag';\n        this.position = null;\n        this.content = null;\n        this.direct = 'tl';\n        this.autoAdjust = true;\n        this.offsetX = 0;\n        this.offsetY = 0;\n        this.side = 4;\n        this.background = {\n          padding: 5,\n          radius: 2,\n          fill: '#1890FF'\n        };\n        this.textStyle = {\n          fontSize: 12,\n          fill: '#fff',\n          textAlign: 'center',\n          textBaseline: 'middle'\n        };\n        this.withPoint = true;\n        this.pointStyle = {\n          fill: '#1890FF',\n          r: 3,\n          lineWidth: 1,\n          stroke: '#fff'\n        };\n      };\n\n      _proto._getDirect = function _getDirect(container, point, tagWidth, tagHeight) {\n        var direct = this.direct;\n        var side = this.side;\n        var canvas = container.get('canvas');\n        var clientWidth = canvas.get('width');\n        var clientHeight = canvas.get('height');\n        var x = point.x,\n            y = point.y;\n        var vertical = direct[0];\n        var horizontal = direct[1]; // adjust for vertical direction\n\n        if (vertical === 't' && y - side - tagHeight < 0) {\n          vertical = 'b';\n        } else if (vertical === 'b' && y + side + tagHeight > clientHeight) {\n          vertical = 't';\n        } // adjust for horizontal direction\n\n\n        var diff = vertical === 'c' ? side : 0;\n\n        if (horizontal === 'l' && x - diff - tagWidth < 0) {\n          horizontal = 'r';\n        } else if (horizontal === 'r' && x + diff + tagWidth > clientWidth) {\n          horizontal = 'l';\n        } else if (horizontal === 'c') {\n          if (tagWidth / 2 + x + diff > clientWidth) {\n            horizontal = 'l';\n          } else if (x - tagWidth / 2 - diff < 0) {\n            horizontal = 'r';\n          }\n        }\n\n        direct = vertical + horizontal;\n        return direct;\n      };\n\n      _proto.render = function render(coord, container) {\n        var position = this.parsePoint(coord, this.position);\n\n        if (!position) {\n          return;\n        } // 数据不在显示范围内时，x/y 会为NaN\n\n\n        if (isNaN(position.x) || isNaN(position.y)) {\n          return;\n        }\n\n        var content = this.content,\n            background = this.background,\n            textStyle = this.textStyle;\n        var shapes = [];\n        var wrapperContainer = container.addGroup({\n          className: 'guide-tag'\n        });\n\n        if (this.withPoint) {\n          var pointShape = wrapperContainer.addShape('Circle', {\n            className: 'guide-tag-point',\n            attrs: mix({\n              x: position.x,\n              y: position.y\n            }, this.pointStyle)\n          });\n          shapes.push(pointShape);\n        }\n\n        var tagContainer = wrapperContainer.addGroup(); // create a text shape\n\n        var tagText = tagContainer.addShape('text', {\n          className: 'guide-tag-text',\n          zIndex: 1,\n          attrs: mix({\n            x: 0,\n            y: 0,\n            text: content\n          }, textStyle)\n        });\n        shapes.push(tagText); // create background box\n\n        var textBBox = tagText.getBBox();\n        var padding = parsePadding(background.padding);\n        var tagWidth = textBBox.width + padding[1] + padding[3];\n        var tagHeight = textBBox.height + padding[0] + padding[2];\n        var yMin = textBBox.minY - padding[0];\n        var xMin = textBBox.minX - padding[3];\n        var tagBg = tagContainer.addShape('rect', {\n          className: 'guide-tag-bg',\n          zIndex: -1,\n          attrs: mix({\n            x: xMin,\n            y: yMin,\n            width: tagWidth,\n            height: tagHeight\n          }, background)\n        });\n        shapes.push(tagBg);\n        var direct = this.autoAdjust ? this._getDirect(container, position, tagWidth, tagHeight) : this.direct;\n        var side = this.side;\n        var x = position.x + this.offsetX;\n        var y = position.y + this.offsetY;\n        var arrowPoints;\n        var radius = parsePadding(background.radius);\n\n        if (direct === 'tl') {\n          arrowPoints = [{\n            x: tagWidth + xMin - side - 1,\n            y: tagHeight + yMin - 1\n          }, // 这个 1 是为了防止出现白边\n          {\n            x: tagWidth + xMin,\n            y: tagHeight + yMin - 1\n          }, {\n            x: tagWidth + xMin,\n            y: tagHeight + side + yMin\n          }];\n          radius[2] = 0;\n          x = x - tagWidth;\n          y = y - side - tagHeight;\n        } else if (direct === 'cl') {\n          arrowPoints = [{\n            x: tagWidth + xMin - 1,\n            y: (tagHeight - side) / 2 + yMin - 1\n          }, {\n            x: tagWidth + xMin - 1,\n            y: (tagHeight + side) / 2 + yMin + 1\n          }, {\n            x: tagWidth + side + xMin,\n            y: tagHeight / 2 + yMin\n          }];\n          x = x - tagWidth - side;\n          y = y - tagHeight / 2;\n        } else if (direct === 'bl') {\n          arrowPoints = [{\n            x: tagWidth + xMin,\n            y: -side + yMin\n          }, {\n            x: tagWidth + xMin - side - 1,\n            y: yMin + 1\n          }, {\n            x: tagWidth + xMin,\n            y: yMin + 1\n          }];\n          radius[1] = 0;\n          x = x - tagWidth;\n          y = y + side;\n        } else if (direct === 'bc') {\n          arrowPoints = [{\n            x: tagWidth / 2 + xMin,\n            y: -side + yMin\n          }, {\n            x: (tagWidth - side) / 2 + xMin - 1,\n            y: yMin + 1\n          }, {\n            x: (tagWidth + side) / 2 + xMin + 1,\n            y: yMin + 1\n          }];\n          x = x - tagWidth / 2;\n          y = y + side;\n        } else if (direct === 'br') {\n          arrowPoints = [{\n            x: xMin,\n            y: yMin - side\n          }, {\n            x: xMin,\n            y: yMin + 1\n          }, {\n            x: xMin + side + 1,\n            y: yMin + 1\n          }];\n          radius[0] = 0;\n          y = y + side;\n        } else if (direct === 'cr') {\n          arrowPoints = [{\n            x: xMin - side,\n            y: tagHeight / 2 + yMin\n          }, {\n            x: xMin + 1,\n            y: (tagHeight - side) / 2 + yMin - 1\n          }, {\n            x: xMin + 1,\n            y: (tagHeight + side) / 2 + yMin + 1\n          }];\n          x = x + side;\n          y = y - tagHeight / 2;\n        } else if (direct === 'tr') {\n          arrowPoints = [{\n            x: xMin,\n            y: tagHeight + side + yMin\n          }, {\n            x: xMin,\n            y: tagHeight + yMin - 1\n          }, {\n            x: side + xMin + 1,\n            y: tagHeight + yMin - 1\n          }];\n          radius[3] = 0;\n          y = y - tagHeight - side;\n        } else if (direct === 'tc') {\n          arrowPoints = [{\n            x: (tagWidth - side) / 2 + xMin - 1,\n            y: tagHeight + yMin - 1\n          }, {\n            x: (tagWidth + side) / 2 + xMin + 1,\n            y: tagHeight + yMin - 1\n          }, {\n            x: tagWidth / 2 + xMin,\n            y: tagHeight + side + yMin\n          }];\n          x = x - tagWidth / 2;\n          y = y - tagHeight - side;\n        }\n\n        var sideShape = tagContainer.addShape('Polygon', {\n          className: 'guide-tag-side',\n          zIndex: 0,\n          attrs: {\n            points: arrowPoints,\n            fill: background.fill\n          }\n        });\n        shapes.push(sideShape);\n        tagBg.attr('radius', radius);\n        tagContainer.moveTo(x - xMin, y - yMin);\n        tagContainer.sort();\n        this.element = wrapperContainer;\n        return shapes;\n      };\n\n      return Tag;\n    }(GuideBase);\n\n    GuideBase.Tag = Tag;\n\n    var Point$2 = /*#__PURE__*/function (_GuideBase) {\n      _inheritsLoose(Point, _GuideBase);\n\n      function Point() {\n        return _GuideBase.apply(this, arguments) || this;\n      }\n\n      var _proto = Point.prototype;\n\n      _proto._initDefaultCfg = function _initDefaultCfg() {\n        this.type = 'point';\n        this.position = null;\n        this.offsetX = 0;\n        this.offsetY = 0;\n        this.style = {\n          fill: '#1890FF',\n          r: 3,\n          lineWidth: 1,\n          stroke: '#fff'\n        };\n      };\n\n      _proto.render = function render(coord, container) {\n        var position = this.parsePoint(coord, this.position);\n        if (!position) return null;\n        var shape = container.addShape('Circle', {\n          className: 'guide-point',\n          attrs: mix({\n            x: position.x + this.offsetX,\n            y: position.y + this.offsetY\n          }, this.style)\n        });\n        this.element = shape;\n        return shape;\n      };\n\n      return Point;\n    }(GuideBase);\n\n    GuideBase.Point = Point$2;\n\n    var MARKER_RADIUS = 3;\n\n    var List = /*#__PURE__*/function () {\n      var _proto = List.prototype;\n\n      _proto.getDefaultCfg = function getDefaultCfg() {\n        return {\n          showTitle: false,\n\n          /**\n           * title string\n           * @type {?String}\n           */\n          title: null,\n\n          /**\n           * items array\n           * @type {?Array}\n           */\n          items: null,\n\n          /**\n           * offset between title and items\n           * @type {Number}\n           */\n          titleGap: 12,\n\n          /**\n           * offset between each item\n           * @type {Number}\n           */\n          itemGap: 10,\n\n          /**\n           * the offset between each item in vertical direaction\n           * @type {Number}\n           */\n          itemMarginBottom: 12,\n\n          /**\n           * the formatter for item text\n           * @type {[type]}\n           */\n          itemFormatter: null,\n          itemWidth: null,\n\n          /**\n           * offset between marker and text\n           * @type {Number}\n           */\n          wordSpace: 6,\n          x: 0,\n          y: 0,\n          layout: 'horizontal',\n\n          /**\n           * the join string of `name` and `value`\n           * @type {String}\n           */\n          joinString: ': '\n        };\n      };\n\n      function List(cfg) {\n        deepMix(this, this.getDefaultCfg(), cfg);\n\n        this._init();\n\n        this._renderTitle();\n\n        this._renderItems();\n      }\n\n      _proto._init = function _init() {\n        var parent = this.parent;\n        if (!parent) return;\n        var container = parent.addGroup({\n          zIndex: this.zIndex || 0\n        });\n        this.container = container;\n        var wrapper = container.addGroup();\n        this.wrapper = wrapper;\n        var itemsGroup = wrapper.addGroup({\n          className: 'itemsGroup'\n        });\n        this.itemsGroup = itemsGroup;\n      };\n\n      _proto._renderTitle = function _renderTitle(title) {\n        title = title || this.title;\n        var titleShape = this.titleShape;\n        var titleHeight = 0;\n\n        if (this.showTitle && title) {\n          if (titleShape && !titleShape.get('destroyed')) {\n            titleShape.attr('text', title);\n          } else {\n            var wrapper = this.wrapper,\n                titleStyle = this.titleStyle;\n            titleShape = wrapper.addShape('text', {\n              className: 'title',\n              attrs: mix({\n                x: 0,\n                y: 0,\n                text: title\n              }, titleStyle)\n            });\n            this.titleShape = titleShape;\n          }\n\n          titleHeight = titleShape.getBBox().height + this.titleGap;\n        }\n\n        this._titleHeight = titleHeight;\n      };\n\n      _proto._renderItems = function _renderItems(items) {\n        var self = this;\n        items = items || self.items;\n\n        if (!items) {\n          return;\n        }\n\n        if (self.reversed) {\n          items.reverse();\n        }\n\n        each(items, function (item, index) {\n          self._addItem(item, index);\n        });\n\n        if (items.length > 1) {\n          this._adjustItems();\n        }\n\n        this._renderBackground();\n      };\n\n      _proto._renderBackground = function _renderBackground() {\n        var background = this.background;\n\n        if (background) {\n          var container = this.container;\n          var wrapper = this.wrapper;\n\n          var _wrapper$getBBox = wrapper.getBBox(),\n              minX = _wrapper$getBBox.minX,\n              minY = _wrapper$getBBox.minY,\n              width = _wrapper$getBBox.width,\n              height = _wrapper$getBBox.height;\n\n          var padding = background.padding || [0, 0, 0, 0];\n          padding = parsePadding(padding);\n          var attrs = mix({\n            x: minX - padding[3],\n            y: minY - padding[0],\n            width: width + padding[1] + padding[3],\n            height: height + padding[0] + padding[2]\n          }, background);\n          var backShape = this.backShape;\n\n          if (backShape) {\n            backShape.attr(attrs);\n          } else {\n            backShape = container.addShape('Rect', {\n              zIndex: -1,\n              attrs: attrs\n            });\n          }\n\n          this.backShape = backShape;\n          container.sort();\n        }\n      };\n\n      _proto._addItem = function _addItem(item) {\n        var itemsGroup = this.itemsGroup;\n        var itemGroup = itemsGroup.addGroup({\n          name: item.name,\n          value: item.value,\n          dataValue: item.dataValue,\n          checked: item.checked\n        });\n        var unCheckStyle = this.unCheckStyle,\n            unCheckColor = this.unCheckColor,\n            nameStyle = this.nameStyle,\n            valueStyle = this.valueStyle,\n            wordSpace = this.wordSpace;\n        var marker = item.marker,\n            value = item.value;\n        var startX = 0;\n\n        if (unCheckColor) {\n          unCheckStyle.fill = unCheckColor;\n        }\n\n        if (marker) {\n          var radius = marker.radius || MARKER_RADIUS;\n          var markerAttrs = mix({\n            x: radius,\n            y: this._titleHeight\n          }, marker);\n\n          if (item.checked === false) {\n            mix(markerAttrs, unCheckStyle);\n          }\n\n          var markerShape = itemGroup.addShape('marker', {\n            className: 'item-marker',\n            attrs: markerAttrs\n          });\n          startX += markerShape.getBBox().width + wordSpace;\n        }\n\n        var nameText;\n        var name = item.name;\n\n        if (name) {\n          var joinString = this.joinString || '';\n          name = value ? name + joinString : name;\n          nameText = itemGroup.addShape('text', {\n            className: 'name',\n            attrs: mix({\n              x: startX,\n              y: this._titleHeight,\n              text: this._formatItemValue(name)\n            }, nameStyle, item.checked === false ? unCheckStyle : null)\n          });\n        }\n\n        if (value) {\n          var valueX = startX;\n\n          if (nameText) {\n            valueX += nameText.getBBox().width;\n          }\n\n          itemGroup.addShape('text', {\n            className: 'value',\n            attrs: mix({\n              x: valueX,\n              y: this._titleHeight,\n              text: value\n            }, valueStyle, item.checked === false ? unCheckStyle : null)\n          });\n        }\n\n        return itemGroup;\n      };\n\n      _proto._formatItemValue = function _formatItemValue(value) {\n        var formatter = this.itemFormatter;\n\n        if (formatter) {\n          value = formatter.call(this, value);\n        }\n\n        return value;\n      };\n\n      _proto._getMaxItemWidth = function _getMaxItemWidth() {\n        var width;\n        var itemWidth = this.itemWidth;\n\n        if (isNumber(itemWidth) || isNil(itemWidth)) {\n          return itemWidth;\n        }\n\n        if (itemWidth === 'auto') {\n          var itemsGroup = this.itemsGroup;\n          var children = itemsGroup.get('children');\n          var count = children.length;\n          var maxItemWidth = 0;\n\n          for (var i = 0; i < count; i++) {\n            var _children$i$getBBox = children[i].getBBox(),\n                _width = _children$i$getBBox.width;\n\n            maxItemWidth = Math.max(maxItemWidth, _width);\n          }\n\n          var maxLength = this.maxLength;\n          var itemGap = this.itemGap;\n          var twoAvgWidth = (maxLength - itemGap) / 2;\n          var threeAvgWidth = (maxLength - itemGap * 2) / 3;\n\n          if (count === 2) {\n            width = Math.max(maxItemWidth, twoAvgWidth);\n          } else {\n            // 1. max <= 3Avg, 3Avg\n            // 2. 3Avg < max && max < 2avg, 2avg\n            // 3. max > 2avg, max, one column\n            if (maxItemWidth <= threeAvgWidth) {\n              width = threeAvgWidth;\n            } else if (maxItemWidth <= twoAvgWidth) {\n              width = twoAvgWidth;\n            } else {\n              width = maxItemWidth;\n            }\n          }\n\n          return width;\n        }\n      };\n\n      _proto._adjustHorizontal = function _adjustHorizontal() {\n        var maxLength = this.maxLength,\n            itemsGroup = this.itemsGroup;\n        var children = itemsGroup.get('children');\n        var itemGap = this.itemGap,\n            itemMarginBottom = this.itemMarginBottom;\n        var titleHeight = this._titleHeight;\n        var row = 0;\n        var rowWidth = 0;\n        var width;\n        var height;\n\n        var itemWidth = this._getMaxItemWidth();\n\n        var legendHitBoxes = [];\n\n        for (var i = 0, len = children.length; i < len; i++) {\n          var child = children[i];\n          var box = child.getBBox();\n          var childHeight = box.height;\n          var childWidth = box.width;\n          width = itemWidth || childWidth;\n          height = childHeight + itemMarginBottom;\n\n          if (width - (maxLength - rowWidth) > 0.0001) {\n            row++;\n            rowWidth = 0;\n          }\n\n          child.moveTo(rowWidth, row * height);\n          legendHitBoxes.push({\n            x: rowWidth,\n            y: row * height + titleHeight - childHeight / 2,\n            width: childWidth * 1.375,\n            height: childHeight * 1.375\n          });\n          rowWidth += width + itemGap;\n        }\n\n        this.legendHitBoxes = legendHitBoxes;\n        return;\n      };\n\n      _proto._adjustVertical = function _adjustVertical() {\n        var maxLength = this.maxLength,\n            itemsGroup = this.itemsGroup;\n        var itemGap = this.itemGap,\n            itemMarginBottom = this.itemMarginBottom,\n            itemWidth = this.itemWidth;\n        var titleHeight = this._titleHeight;\n        var children = itemsGroup.get('children');\n        var colHeight = 0;\n        var width;\n        var height;\n        var maxItemWidth = 0;\n        var totalWidth = 0;\n        var legendHitBoxes = [];\n\n        for (var i = 0, length = children.length; i < length; i++) {\n          var child = children[i];\n          var bbox = child.getBBox();\n          width = bbox.width;\n          height = bbox.height;\n\n          if (isNumber(itemWidth)) {\n            maxItemWidth = itemWidth + itemGap;\n          } else if (width > maxItemWidth) {\n            maxItemWidth = width + itemGap;\n          }\n\n          if (maxLength - colHeight < height) {\n            colHeight = 0;\n            totalWidth += maxItemWidth;\n            child.moveTo(totalWidth, 0);\n            legendHitBoxes.push({\n              x: totalWidth,\n              y: titleHeight - height / 2,\n              width: width * 1.375,\n              height: height * 1.375\n            });\n          } else {\n            child.moveTo(totalWidth, colHeight);\n            legendHitBoxes.push({\n              x: totalWidth,\n              y: colHeight - height / 2 + titleHeight,\n              width: width * 1.375,\n              height: height * 1.375\n            });\n          }\n\n          colHeight += height + itemMarginBottom;\n        }\n\n        this.legendHitBoxes = legendHitBoxes;\n        return;\n      };\n\n      _proto._adjustItems = function _adjustItems() {\n        var layout = this.layout;\n\n        if (layout === 'horizontal') {\n          this._adjustHorizontal();\n        } else {\n          this._adjustVertical();\n        }\n      };\n\n      _proto.moveTo = function moveTo(x, y) {\n        this.x = x;\n        this.y = y;\n        var container = this.container;\n        container && container.moveTo(x, y);\n        return this;\n      };\n\n      _proto.setItems = function setItems(items) {\n        this.clearItems();\n\n        this._renderItems(items);\n      };\n\n      _proto.setTitle = function setTitle(title) {\n        this._renderTitle(title);\n      };\n\n      _proto.clearItems = function clearItems() {\n        var itemsGroup = this.itemsGroup;\n        itemsGroup.clear();\n      };\n\n      _proto.getWidth = function getWidth() {\n        var container = this.container;\n        var bbox = container.getBBox();\n        return bbox.width;\n      };\n\n      _proto.getHeight = function getHeight() {\n        var container = this.container;\n        var bbox = container.getBBox();\n        return bbox.height;\n      };\n\n      _proto.show = function show() {\n        var container = this.container;\n        container.show();\n      };\n\n      _proto.hide = function hide() {\n        var container = this.container;\n        container.hide();\n      };\n\n      _proto.clear = function clear() {\n        var container = this.container;\n        container.clear();\n        container.remove(true);\n      };\n\n      return List;\n    }();\n\n    var TextBox = /*#__PURE__*/function () {\n      var _proto = TextBox.prototype;\n\n      _proto.getDefaultCfg = function getDefaultCfg() {\n        return {\n          x: 0,\n          y: 0,\n          content: '',\n          textStyle: {\n            fontSize: 12,\n            fill: '#fff',\n            textAlign: 'center',\n            textBaseline: 'middle',\n            fontFamily: 'Arial'\n          },\n          background: {\n            radius: 1,\n            fill: 'rgba(0, 0, 0, 0.65)',\n            padding: [3, 5]\n          },\n          width: 0,\n          height: 0,\n          className: ''\n        };\n      };\n\n      function TextBox(cfg) {\n        deepMix(this, this.getDefaultCfg(), cfg);\n\n        this._init();\n\n        var content = this.content,\n            x = this.x,\n            y = this.y;\n\n        if (!isNil(content)) {\n          this.updateContent(content);\n        }\n\n        this.updatePosition(x, y);\n      }\n\n      _proto._init = function _init() {\n        var content = this.content,\n            textStyle = this.textStyle,\n            background = this.background,\n            className = this.className,\n            visible = this.visible,\n            context = this.context;\n        var container = new Group({\n          context: context,\n          className: className,\n          zIndex: 0,\n          visible: visible\n        });\n        var text = container.addShape('Text', {\n          className: className + '-text',\n          zIndex: 1,\n          attrs: mix({\n            text: content,\n            x: 0,\n            y: 0\n          }, textStyle)\n        });\n        var backgroundShape = container.addShape('Rect', {\n          className: className + '-bg',\n          zIndex: -1,\n          attrs: mix({\n            x: 0,\n            y: 0,\n            width: 0,\n            height: 0\n          }, background)\n        });\n        container.sort();\n        this.container = container;\n        this.textShape = text;\n        this.backgroundShape = backgroundShape;\n      };\n\n      _proto._getBBox = function _getBBox() {\n        var textShape = this.textShape;\n        var background = this.background;\n        var textBBox = textShape.getBBox();\n        var padding = parsePadding(background.padding);\n        var width = textBBox.width + padding[1] + padding[3];\n        var height = textBBox.height + padding[0] + padding[2];\n        var x = textBBox.minX - padding[3];\n        var y = textBBox.minY - padding[0];\n        return {\n          x: x,\n          y: y,\n          width: width,\n          height: height\n        };\n      };\n\n      _proto.updateContent = function updateContent(text) {\n        var textShape = this.textShape,\n            backgroundShape = this.backgroundShape;\n\n        if (!isNil(text)) {\n          if (!isObject(text)) {\n            text = {\n              text: text\n            };\n          }\n\n          textShape.attr(text); // update box shape\n\n          var _this$_getBBox = this._getBBox(),\n              x = _this$_getBBox.x,\n              y = _this$_getBBox.y,\n              tipWidth = _this$_getBBox.width,\n              tipHeight = _this$_getBBox.height;\n\n          var width = this.width || tipWidth;\n          var height = this.height || tipHeight;\n          backgroundShape.attr({\n            x: x,\n            y: y,\n            width: width,\n            height: height\n          });\n          this._width = width;\n          this._height = height;\n          this.content = text.text;\n        }\n      };\n\n      _proto.updatePosition = function updatePosition(x, y) {\n        var container = this.container;\n\n        var _this$_getBBox2 = this._getBBox(),\n            xMin = _this$_getBBox2.x,\n            yMin = _this$_getBBox2.y;\n\n        container.moveTo(x - xMin, y - yMin);\n        this.x = x - xMin;\n        this.y = y - yMin;\n      };\n\n      _proto.getWidth = function getWidth() {\n        return this._width;\n      };\n\n      _proto.getHeight = function getHeight() {\n        return this._height;\n      };\n\n      _proto.show = function show() {\n        this.container.show();\n      };\n\n      _proto.hide = function hide() {\n        this.container.hide();\n      };\n\n      _proto.clear = function clear() {\n        var container = this.container;\n        container.clear();\n        container.remove(true);\n        this.container = null;\n        this.textShape = null;\n        this.backgroundShape = null;\n      };\n\n      return TextBox;\n    }();\n\n    var GAP = 4;\n    /**\n     * TODOList：\n     * 1. 移除 fixed 参数\n     */\n\n    var Tooltip = /*#__PURE__*/function () {\n      var _proto = Tooltip.prototype;\n\n      _proto.getDefaultCfg = function getDefaultCfg() {\n        return {\n          /**\n           * wether show the crosshairs\n           * @type {Object}\n           */\n          showCrosshairs: false,\n\n          /**\n           * the style for crosshairs\n           * @type {Object}\n           */\n          crosshairsStyle: {\n            stroke: 'rgba(0, 0, 0, 0.25)',\n            lineWidth: 1\n          },\n\n          /**\n           * the type of crosshairs, optional value is 'x', 'y' or 'xy', default is 'y'\n           */\n          crosshairsType: 'y',\n\n          /**\n           * show or hide the x axis tip\n           */\n          showXTip: false,\n\n          /**\n           * show or hide the y axis tip\n           */\n          showYTip: false,\n          xTip: null,\n          xTipBackground: {\n            radius: 1,\n            fill: 'rgba(0, 0, 0, 0.65)',\n            padding: [3, 5]\n          },\n          xTipTextStyle: {\n            fontSize: 12,\n            fill: '#fff',\n            textAlign: 'center',\n            textBaseline: 'middle'\n          },\n          yTip: null,\n          yTipBackground: {\n            radius: 1,\n            fill: 'rgba(0, 0, 0, 0.65)',\n            padding: [3, 5]\n          },\n          yTipTextStyle: {\n            fontSize: 12,\n            fill: '#fff',\n            textAlign: 'center',\n            textBaseline: 'middle'\n          },\n\n          /**\n           * the style for tooltip container's background\n           * @type {Object}\n           */\n          background: null,\n\n          /**\n           * layout, can be horizontal or vertical\n           * @type {String}\n           */\n          layout: 'horizontal',\n          offsetX: 0,\n          offsetY: 0\n        };\n      };\n\n      function Tooltip(cfg) {\n        deepMix(this, this.getDefaultCfg(), cfg);\n        var frontPlot = this.frontPlot,\n            custom = this.custom;\n\n        if (!custom) {\n          // custom means user do customize\n          var container = new List(mix({\n            parent: frontPlot,\n            zIndex: 3\n          }, cfg));\n          this.container = container;\n          var fixed = this.fixed,\n              background = this.background;\n\n          if (!fixed) {\n            this.tooltipArrow = frontPlot.addShape('Polygon', {\n              className: 'tooltip-arrow',\n              visible: false,\n              zIndex: 2,\n              attrs: mix({\n                points: []\n              }, background)\n            });\n          }\n        }\n\n        if (this.showXTip) {\n          var xTipBackground = this.xTipBackground,\n              xTipTextStyle = this.xTipTextStyle;\n          var xTipBox = new TextBox({\n            context: frontPlot.get('context'),\n            className: 'xTip',\n            background: xTipBackground,\n            textStyle: xTipTextStyle,\n            visible: false\n          });\n          frontPlot.add(xTipBox.container);\n          this.xTipBox = xTipBox;\n        }\n\n        if (this.showYTip) {\n          var yTipBackground = this.yTipBackground,\n              yTipTextStyle = this.yTipTextStyle;\n          var yTipBox = new TextBox({\n            context: frontPlot.get('context'),\n            className: 'yTip',\n            background: yTipBackground,\n            textStyle: yTipTextStyle,\n            visible: false\n          });\n          frontPlot.add(yTipBox.container);\n          this.yTipBox = yTipBox;\n        }\n\n        if (this.showCrosshairs) {\n          this._renderCrosshairs();\n        }\n\n        frontPlot.sort();\n      }\n\n      _proto.setContent = function setContent(title, items) {\n        this.title = title;\n        this.items = items;\n\n        if (!this.custom) {\n          var container = this.container;\n          container.setTitle(title);\n          container.setItems(items);\n        }\n      };\n\n      _proto.setYTipContent = function setYTipContent(val) {\n        var yTip = this.yTip;\n\n        if (isFunction(yTip)) {\n          val = yTip(val);\n        } else {\n          val = mix({\n            text: val\n          }, yTip);\n        }\n\n        this.yTipBox && this.yTipBox.updateContent(val);\n      };\n\n      _proto.setYTipPosition = function setYTipPosition(pos) {\n        var plotRange = this.plotRange;\n        var crosshairsShapeX = this.crosshairsShapeX;\n\n        if (this.showYTip) {\n          var yTipBox = this.yTipBox;\n          var yTipHeight = yTipBox.getHeight();\n          var yTipWidth = yTipBox.getWidth();\n          var posX = plotRange.tl.x - yTipWidth;\n          var posY = pos - yTipHeight / 2;\n\n          if (posY <= plotRange.tl.y) {\n            posY = plotRange.tl.y;\n          }\n\n          if (posY + yTipHeight >= plotRange.br.y) {\n            posY = plotRange.br.y - yTipHeight;\n          }\n\n          if (posX < 0) {\n            posX = plotRange.tl.x;\n            crosshairsShapeX && crosshairsShapeX.attr('x1', plotRange.tl.x + yTipWidth);\n          }\n\n          yTipBox.updatePosition(posX, posY);\n        }\n      };\n\n      _proto.setXTipContent = function setXTipContent(val) {\n        var xTip = this.xTip;\n\n        if (isFunction(xTip)) {\n          val = xTip(val);\n        } else {\n          val = mix({\n            text: val\n          }, xTip);\n        }\n\n        this.xTipBox && this.xTipBox.updateContent(val);\n      };\n\n      _proto.setXTipPosition = function setXTipPosition(pos) {\n        var showXTip = this.showXTip,\n            canvas = this.canvas,\n            plotRange = this.plotRange,\n            xTipBox = this.xTipBox,\n            crosshairsShapeY = this.crosshairsShapeY;\n\n        if (showXTip) {\n          // const el = canvas.get('el');\n          // const canvasHeight = Util.getHeight(el);\n          var canvasHeight = canvas.get('height');\n          var xTipWidth = xTipBox.getWidth();\n          var xTipHeight = xTipBox.getHeight();\n          var posX = pos - xTipWidth / 2;\n          var posY = plotRange.br.y;\n\n          if (posX <= plotRange.tl.x) {\n            posX = plotRange.tl.x;\n          }\n\n          if (posX + xTipWidth >= plotRange.tr.x) {\n            posX = plotRange.tr.x - xTipWidth;\n          }\n\n          if (canvasHeight - posY < xTipHeight) {\n            posY -= xTipHeight;\n          }\n\n          xTipBox.updatePosition(posX, posY);\n          crosshairsShapeY && crosshairsShapeY.attr('y1', posY);\n        }\n      };\n\n      _proto.setXCrosshairPosition = function setXCrosshairPosition(pos) {\n        this.crosshairsShapeX && this.crosshairsShapeX.moveTo(0, pos);\n      };\n\n      _proto.setYCrosshairPosition = function setYCrosshairPosition(pos) {\n        this.crosshairsShapeY && this.crosshairsShapeY.moveTo(pos, 0);\n      };\n\n      _proto.setPosition = function setPosition(items) {\n        var container = this.container,\n            plotRange = this.plotRange,\n            offsetX = this.offsetX,\n            offsetY = this.offsetY,\n            fixed = this.fixed,\n            tooltipArrow = this.tooltipArrow;\n\n        if (!container) {\n          return;\n        }\n\n        var containerBBox = container.container.getBBox();\n        var minX = containerBBox.minX,\n            minY = containerBBox.minY,\n            width = containerBBox.width,\n            height = containerBBox.height;\n        var tl = plotRange.tl,\n            tr = plotRange.tr;\n        var posX = 0;\n        var posY = tl.y - height - GAP + offsetY;\n\n        if (posY < 0) {\n          posY = 0;\n        }\n\n        if (fixed) {\n          var x = (tl.x + tr.x) / 2;\n          posX = x - width / 2 + offsetX;\n        } else {\n          var _x;\n\n          if (items.length > 1) {\n            _x = (items[0].x + items[items.length - 1].x) / 2;\n          } else {\n            _x = items[0].x;\n          }\n\n          posX = _x - width / 2 + offsetX;\n\n          if (posX < tl.x) {\n            posX = tl.x;\n          }\n\n          if (posX + width > tr.x) {\n            posX = tr.x - width;\n          }\n\n          if (tooltipArrow) {\n            var arrowY = posY + height;\n            tooltipArrow.attr('points', [{\n              x: _x - 3,\n              y: arrowY\n            }, {\n              x: _x + 3,\n              y: arrowY\n            }, {\n              x: _x,\n              y: arrowY + GAP\n            }]);\n            var backShape = container.backShape;\n            var radius = parsePadding(backShape.attr('radius'));\n\n            if (_x === tl.x) {\n              radius[3] = 0;\n              tooltipArrow.attr('points', [{\n                x: tl.x,\n                y: arrowY\n              }, {\n                x: tl.x + GAP,\n                y: arrowY\n              }, {\n                x: tl.x,\n                y: arrowY + GAP\n              }]);\n            } else if (_x === tr.x) {\n              radius[2] = 0;\n              tooltipArrow.attr('points', [{\n                x: tr.x - GAP,\n                y: arrowY\n              }, {\n                x: tr.x,\n                y: arrowY\n              }, {\n                x: tr.x,\n                y: arrowY + GAP\n              }]);\n            }\n\n            backShape.attr('radius', radius);\n          }\n        }\n\n        container.moveTo(posX - minX, posY - minY);\n      };\n\n      _proto.setMarkers = function setMarkers(cfg) {\n        if (cfg === void 0) {\n          cfg = {};\n        }\n\n        var self = this;\n        var _cfg = cfg,\n            items = _cfg.items,\n            style = _cfg.style,\n            type = _cfg.type;\n\n        var markerGroup = self._getMarkerGroup(type);\n\n        if (type === 'circle') {\n          for (var i = 0, length = items.length; i < length; i++) {\n            var item = items[i];\n            markerGroup.addShape('marker', {\n              className: 'tooltip-circle-marker',\n              attrs: mix({\n                x: item.x,\n                y: item.y,\n                stroke: item.color\n              }, style)\n            });\n          }\n        } else {\n          markerGroup.addShape('rect', {\n            className: 'tooltip-rect-marker',\n            attrs: style\n          });\n        }\n      };\n\n      _proto.clearMarkers = function clearMarkers() {\n        var markerGroup = this.markerGroup;\n        markerGroup && markerGroup.clear();\n      };\n\n      _proto.show = function show() {\n        var crosshairsShapeX = this.crosshairsShapeX;\n        var crosshairsShapeY = this.crosshairsShapeY;\n        var markerGroup = this.markerGroup;\n        var container = this.container;\n        var tooltipArrow = this.tooltipArrow;\n        var xTipBox = this.xTipBox;\n        var yTipBox = this.yTipBox;\n        var canvas = this.canvas;\n        crosshairsShapeX && crosshairsShapeX.show();\n        crosshairsShapeY && crosshairsShapeY.show();\n        markerGroup && markerGroup.show();\n        container && container.show();\n        tooltipArrow && tooltipArrow.show();\n        xTipBox && xTipBox.show();\n        yTipBox && yTipBox.show();\n        canvas.draw();\n      };\n\n      _proto.hide = function hide() {\n        var crosshairsShapeX = this.crosshairsShapeX;\n        var crosshairsShapeY = this.crosshairsShapeY;\n        var markerGroup = this.markerGroup;\n        var container = this.container;\n        var tooltipArrow = this.tooltipArrow;\n        var xTipBox = this.xTipBox;\n        var yTipBox = this.yTipBox;\n        crosshairsShapeX && crosshairsShapeX.hide();\n        crosshairsShapeY && crosshairsShapeY.hide();\n        markerGroup && markerGroup.hide();\n        container && container.hide();\n        tooltipArrow && tooltipArrow.hide();\n        xTipBox && xTipBox.hide();\n        yTipBox && yTipBox.hide();\n      };\n\n      _proto.destroy = function destroy() {\n        var crosshairsShapeX = this.crosshairsShapeX;\n        var crosshairsShapeY = this.crosshairsShapeY;\n        var markerGroup = this.markerGroup;\n        var container = this.container;\n        var tooltipArrow = this.tooltipArrow;\n        var xTipBox = this.xTipBox;\n        var yTipBox = this.yTipBox;\n        crosshairsShapeX && crosshairsShapeX.remove(true);\n        crosshairsShapeY && crosshairsShapeY.remove(true);\n        markerGroup && markerGroup.remove(true);\n        tooltipArrow && tooltipArrow.remove(true);\n        container && container.clear();\n        xTipBox && xTipBox.clear();\n        yTipBox && yTipBox.clear();\n        this.destroyed = true;\n      };\n\n      _proto._getMarkerGroup = function _getMarkerGroup(type) {\n        var markerGroup = this.markerGroup;\n\n        if (!markerGroup) {\n          if (type === 'circle') {\n            markerGroup = this.frontPlot.addGroup({\n              zIndex: 1\n            });\n            this.frontPlot.sort();\n          } else {\n            markerGroup = this.backPlot.addGroup();\n          }\n\n          this.markerGroup = markerGroup;\n        } else {\n          markerGroup.clear();\n        }\n\n        return markerGroup;\n      };\n\n      _proto._renderCrosshairs = function _renderCrosshairs() {\n        var crosshairsType = this.crosshairsType,\n            crosshairsStyle = this.crosshairsStyle,\n            frontPlot = this.frontPlot,\n            plotRange = this.plotRange;\n        var tl = plotRange.tl,\n            br = plotRange.br;\n\n        if (directionEnabled(crosshairsType, 'x')) {\n          this.crosshairsShapeX = frontPlot.addShape('Line', {\n            className: 'tooltip-crosshairs-x',\n            zIndex: 0,\n            visible: false,\n            attrs: mix({\n              x1: tl.x,\n              y1: 0,\n              x2: br.x,\n              y2: 0\n            }, crosshairsStyle)\n          });\n        }\n\n        if (directionEnabled(crosshairsType, 'y')) {\n          this.crosshairsShapeY = frontPlot.addShape('Line', {\n            className: 'tooltip-crosshairs-y',\n            zIndex: 0,\n            visible: false,\n            attrs: mix({\n              x1: 0,\n              y1: br.y,\n              x2: 0,\n              y2: tl.y\n            }, crosshairsStyle)\n          });\n        }\n      };\n\n      return Tooltip;\n    }();\n\n    Global.tooltip = deepMix({\n      triggerOn: 'press',\n      triggerOff: 'pressend',\n      alwaysShow: false,\n      showTitle: false,\n      showCrosshairs: false,\n      crosshairsStyle: {\n        stroke: 'rgba(0, 0, 0, 0.25)',\n        lineWidth: 1\n      },\n      showTooltipMarker: true,\n      background: {\n        radius: 1,\n        fill: 'rgba(0, 0, 0, 0.65)',\n        padding: [3, 5]\n      },\n      titleStyle: {\n        fontSize: 12,\n        fill: '#fff',\n        textAlign: 'start',\n        textBaseline: 'top'\n      },\n      nameStyle: {\n        fontSize: 12,\n        fill: 'rgba(255, 255, 255, 0.65)',\n        textAlign: 'start',\n        textBaseline: 'middle'\n      },\n      valueStyle: {\n        fontSize: 12,\n        fill: '#fff',\n        textAlign: 'start',\n        textBaseline: 'middle'\n      },\n      showItemMarker: true,\n      itemMarkerStyle: {\n        radius: 3,\n        symbol: 'circle',\n        lineWidth: 1,\n        stroke: '#fff'\n      },\n      layout: 'horizontal',\n      snap: false\n    }, Global.tooltip || {});\n\n    function _getTooltipValueScale(geom) {\n      var colorAttr = geom.getAttr('color');\n\n      if (colorAttr) {\n        var colorScale = colorAttr.getScale(colorAttr.type);\n\n        if (colorScale.isLinear) {\n          return colorScale;\n        }\n      }\n\n      var xScale = geom.getXScale();\n      var yScale = geom.getYScale();\n\n      if (yScale) {\n        return yScale;\n      }\n\n      return xScale;\n    }\n\n    function getTooltipName(geom, origin) {\n      var name;\n      var nameScale;\n\n      var groupScales = geom._getGroupScales();\n\n      if (groupScales.length) {\n        each(groupScales, function (scale) {\n          nameScale = scale;\n          return false;\n        });\n      }\n\n      if (nameScale) {\n        var field = nameScale.field;\n        name = nameScale.getText(origin[field]);\n      } else {\n        var valueScale = _getTooltipValueScale(geom);\n\n        name = valueScale.alias || valueScale.field;\n      }\n\n      return name;\n    }\n\n    function getTooltipValue(geom, origin) {\n      var scale = _getTooltipValueScale(geom);\n\n      return scale.getText(origin[scale.field]);\n    }\n\n    function getTooltipTitle(geom, origin) {\n      var position = geom.getAttr('position');\n      var field = position.getFields()[0];\n      var scale = geom.get('scales')[field];\n      return scale.getText(origin[scale.field]);\n    }\n\n    function _indexOfArray(items, item) {\n      var rst = -1;\n      each(items, function (sub, index) {\n        if (sub.title === item.title && sub.name === item.name && sub.value === item.value && sub.color === item.color) {\n          rst = index;\n          return false;\n        }\n      });\n      return rst;\n    }\n\n    function _uniqItems(items) {\n      var tmp = [];\n      each(items, function (item) {\n        var index = _indexOfArray(tmp, item);\n\n        if (index === -1) {\n          tmp.push(item);\n        } else {\n          tmp[index] = item;\n        }\n      });\n      return tmp;\n    }\n\n    function isEqual$1(arr1, arr2) {\n      return JSON.stringify(arr1) === JSON.stringify(arr2);\n    }\n\n    var TooltipController = /*#__PURE__*/function () {\n      function TooltipController(cfg) {\n        var _this = this;\n\n        _defineProperty(this, \"handleShowEvent\", function (ev) {\n          var chart = _this.chart;\n          if (!_this.enable) return;\n          var plot = chart.get('plotRange');\n          var point = createEvent(ev, chart);\n\n          if (!isPointInPlot(point, plot) && !_this._tooltipCfg.alwaysShow) {\n            // not in chart plot\n            _this.hideTooltip();\n\n            return;\n          }\n\n          var lastTimeStamp = _this.timeStamp;\n          var timeStamp = +new Date();\n\n          if (timeStamp - lastTimeStamp > 16) {\n            _this.showTooltip(point);\n\n            _this.timeStamp = timeStamp;\n          }\n        });\n\n        _defineProperty(this, \"handleHideEvent\", function () {\n          if (!_this.enable) return;\n\n          _this.hideTooltip();\n        });\n\n        this.enable = true;\n        this.cfg = {};\n        this.tooltip = null;\n        this.chart = null;\n        this.timeStamp = 0;\n        mix(this, cfg);\n        var _chart = this.chart;\n\n        var canvas = _chart.get('canvas');\n\n        this.canvas = canvas;\n        this.canvasDom = canvas.get('el');\n      }\n\n      var _proto = TooltipController.prototype;\n\n      _proto._setCrosshairsCfg = function _setCrosshairsCfg() {\n        var self = this;\n        var chart = self.chart;\n        var defaultCfg = mix({}, Global.tooltip);\n        var geoms = chart.get('geoms');\n        var shapes = [];\n        each(geoms, function (geom) {\n          var type = geom.get('type');\n\n          if (shapes.indexOf(type) === -1) {\n            shapes.push(type);\n          }\n        });\n        var coordType = chart.get('coord').type;\n\n        if (geoms.length && (coordType === 'cartesian' || coordType === 'rect')) {\n          if (shapes.length === 1 && ['line', 'area', 'path', 'point'].indexOf(shapes[0]) !== -1) {\n            mix(defaultCfg, {\n              showCrosshairs: true\n            });\n          }\n        }\n\n        return defaultCfg;\n      };\n\n      _proto._getMaxLength = function _getMaxLength(cfg) {\n        if (cfg === void 0) {\n          cfg = {};\n        }\n\n        var _cfg = cfg,\n            layout = _cfg.layout,\n            plotRange = _cfg.plotRange;\n        return layout === 'horizontal' ? plotRange.br.x - plotRange.bl.x : plotRange.bl.y - plotRange.tr.y;\n      };\n\n      _proto.render = function render() {\n        var self = this;\n\n        if (self.tooltip) {\n          return;\n        }\n\n        var chart = self.chart;\n        var canvas = chart.get('canvas');\n        var frontPlot = chart.get('frontPlot').addGroup({\n          className: 'tooltipContainer',\n          zIndex: 10\n        });\n        var backPlot = chart.get('backPlot').addGroup({\n          className: 'tooltipContainer'\n        });\n        var plotRange = chart.get('plotRange');\n        var coord = chart.get('coord');\n\n        var defaultCfg = self._setCrosshairsCfg();\n\n        var cfg = self.cfg; // 通过 chart.tooltip() 接口传入的 tooltip 配置项\n\n        var tooltipCfg = deepMix({\n          plotRange: plotRange,\n          frontPlot: frontPlot,\n          backPlot: backPlot,\n          canvas: canvas,\n          fixed: coord.transposed || coord.isPolar\n        }, defaultCfg, cfg); // 创建 tooltip 实例需要的配置，不应该修改 this.cfg，即用户传入的配置\n\n        tooltipCfg.maxLength = self._getMaxLength(tooltipCfg);\n        this._tooltipCfg = tooltipCfg;\n        var tooltip = new Tooltip(tooltipCfg);\n        self.tooltip = tooltip; // 需要保持tooltip一直显示\n\n        if (tooltipCfg.alwaysShow && self.prePoint) {\n          this.showTooltip(self.prePoint);\n        }\n\n        self.bindEvents();\n      };\n\n      _proto.clear = function clear() {\n        var tooltip = this.tooltip;\n\n        if (tooltip) {\n          tooltip.destroy();\n          this.unBindEvents();\n        }\n\n        this.tooltip = null;\n        this._lastActive = null;\n      };\n\n      _proto._getTooltipMarkerStyle = function _getTooltipMarkerStyle(cfg) {\n        if (cfg === void 0) {\n          cfg = {};\n        }\n\n        var _cfg2 = cfg,\n            type = _cfg2.type,\n            items = _cfg2.items;\n        var tooltipCfg = this._tooltipCfg;\n\n        if (type === 'rect') {\n          var x;\n          var y;\n          var width;\n          var height;\n          var chart = this.chart;\n\n          var _chart$get = chart.get('plotRange'),\n              tl = _chart$get.tl,\n              br = _chart$get.br;\n\n          var coord = chart.get('coord');\n          var firstItem = items[0];\n          var lastItem = items[items.length - 1];\n          var intervalWidth = firstItem.width;\n\n          if (coord.transposed) {\n            x = tl.x;\n            y = lastItem.y - intervalWidth * 0.75;\n            width = br.x - tl.x;\n            height = firstItem.y - lastItem.y + 1.5 * intervalWidth;\n          } else {\n            x = firstItem.x - intervalWidth * 0.75;\n            y = tl.y;\n            width = lastItem.x - firstItem.x + 1.5 * intervalWidth;\n            height = br.y - tl.y;\n          }\n\n          cfg.style = mix({\n            x: x,\n            y: y,\n            width: width,\n            height: height,\n            fill: '#CCD6EC',\n            opacity: 0.3\n          }, tooltipCfg.tooltipMarkerStyle);\n        } else {\n          cfg.style = mix({\n            radius: 4,\n            fill: '#fff',\n            lineWidth: 2\n          }, tooltipCfg.tooltipMarkerStyle);\n        }\n\n        return cfg;\n      };\n\n      _proto._setTooltip = function _setTooltip(point, items, tooltipMarkerCfg) {\n        if (tooltipMarkerCfg === void 0) {\n          tooltipMarkerCfg = {};\n        }\n\n        this.prePoint = point;\n        var lastActive = this._lastActive;\n        var tooltip = this.tooltip;\n        var cfg = this._tooltipCfg;\n        items = _uniqItems(items);\n        var chart = this.chart;\n        var coord = chart.get('coord');\n        var yScale = chart.getYScales()[0];\n        var snap = cfg.snap;\n\n        if (snap === false && yScale.isLinear) {\n          var invertPoint = coord.invertPoint(point);\n          var plot = chart.get('plotRange');\n          var tip;\n          var pos;\n\n          if (isPointInPlot(point, plot)) {\n            if (coord.transposed) {\n              tip = yScale.invert(invertPoint.x);\n              pos = point.x;\n              tooltip.setXTipContent(tip);\n              tooltip.setXTipPosition(pos);\n              tooltip.setYCrosshairPosition(pos);\n            } else {\n              tip = yScale.invert(invertPoint.y);\n              pos = point.y;\n              tooltip.setYTipContent(tip);\n              tooltip.setYTipPosition(pos);\n              tooltip.setXCrosshairPosition(pos);\n            }\n          }\n        }\n\n        if (cfg.onShow) {\n          cfg.onShow({\n            x: point.x,\n            y: point.y,\n            tooltip: tooltip,\n            items: items,\n            tooltipMarkerCfg: tooltipMarkerCfg\n          });\n        }\n\n        if (isEqual$1(lastActive, items)) {\n          if (snap === false && (directionEnabled(cfg.crosshairsType, 'y') || cfg.showYTip)) {\n            var canvas = this.chart.get('canvas');\n            canvas.draw();\n          }\n\n          return;\n        }\n\n        this._lastActive = items;\n        var onChange = cfg.onChange;\n\n        if (onChange) {\n          onChange({\n            x: point.x,\n            y: point.y,\n            tooltip: tooltip,\n            items: items,\n            tooltipMarkerCfg: tooltipMarkerCfg\n          });\n        }\n\n        var first = items[0];\n        var title = first.title || first.name;\n        var xTipPosX = first.x;\n\n        if (items.length > 1) {\n          xTipPosX = (items[0].x + items[items.length - 1].x) / 2;\n        }\n\n        tooltip.setContent(title, items, coord.transposed);\n        tooltip.setPosition(items, point);\n\n        if (coord.transposed) {\n          var yTipPosY = first.y;\n\n          if (items.length > 1) {\n            yTipPosY = (items[0].y + items[items.length - 1].y) / 2;\n          }\n\n          tooltip.setYTipContent(title);\n          tooltip.setYTipPosition(yTipPosY);\n          tooltip.setXCrosshairPosition(yTipPosY);\n\n          if (snap) {\n            tooltip.setXTipContent(first.value);\n            tooltip.setXTipPosition(xTipPosX);\n            tooltip.setYCrosshairPosition(xTipPosX);\n          }\n        } else {\n          tooltip.setXTipContent(title);\n          tooltip.setXTipPosition(xTipPosX);\n          tooltip.setYCrosshairPosition(xTipPosX);\n\n          if (snap) {\n            tooltip.setYTipContent(first.value);\n            tooltip.setYTipPosition(first.y);\n            tooltip.setXCrosshairPosition(first.y);\n          }\n        }\n\n        var markerItems = tooltipMarkerCfg.items;\n\n        if (cfg.showTooltipMarker && markerItems.length) {\n          tooltipMarkerCfg = this._getTooltipMarkerStyle(tooltipMarkerCfg);\n          tooltip.setMarkers(tooltipMarkerCfg);\n        } else {\n          tooltip.clearMarkers();\n        }\n\n        tooltip.show();\n      };\n\n      _proto.showTooltip = function showTooltip(point) {\n        var self = this;\n        var chart = self.chart;\n        var tooltipMarkerType;\n        var tooltipMarkerItems = [];\n        var items = [];\n        var cfg = self._tooltipCfg;\n        var showItemMarker = cfg.showItemMarker,\n            itemMarkerStyle = cfg.itemMarkerStyle,\n            alwaysShow = cfg.alwaysShow;\n        var marker;\n\n        if (showItemMarker) {\n          marker = itemMarkerStyle;\n        }\n\n        var geoms = chart.get('geoms');\n        var coord = chart.get('coord');\n        each(geoms, function (geom) {\n          if (geom.get('visible')) {\n            var type = geom.get('type');\n            var records = geom.getSnapRecords(point);\n            var adjust = geom.get('adjust'); // 漏斗图和金子塔图tooltip位置有问题，暂时不开放显示\n\n            if (type === 'interval' && adjust && adjust.type === 'symmetric') {\n              return;\n            }\n\n            each(records, function (record) {\n              var x = record.x,\n                  y = record.y,\n                  _origin = record._origin,\n                  color = record.color;\n\n              if ((x || !isNaN(x)) && (y || !isNaN(y))) {\n                var tooltipItem = {\n                  x: x,\n                  y: isArray(y) ? y[1] : y,\n                  color: color || Global.defaultColor,\n                  origin: _origin,\n                  name: getTooltipName(geom, _origin),\n                  value: getTooltipValue(geom, _origin),\n                  title: getTooltipTitle(geom, _origin)\n                };\n\n                if (marker) {\n                  tooltipItem.marker = mix({\n                    fill: color || Global.defaultColor\n                  }, marker);\n                }\n\n                items.push(tooltipItem);\n\n                if (['line', 'area', 'path'].indexOf(type) !== -1) {\n                  tooltipMarkerType = 'circle';\n                  tooltipMarkerItems.push(tooltipItem);\n                } else if (type === 'interval' && (coord.type === 'cartesian' || coord.type === 'rect')) {\n                  tooltipMarkerType = 'rect';\n                  tooltipItem.width = geom.getSize(record._origin);\n                  tooltipMarkerItems.push(tooltipItem);\n                }\n              }\n            });\n          }\n        });\n\n        if (items.length) {\n          var tooltipMarkerCfg = {\n            items: tooltipMarkerItems,\n            type: tooltipMarkerType\n          };\n\n          self._setTooltip(point, items, tooltipMarkerCfg);\n\n          return;\n        }\n\n        if (!alwaysShow) {\n          self.hideTooltip();\n        }\n      };\n\n      _proto.hideTooltip = function hideTooltip() {\n        var cfg = this._tooltipCfg;\n        this._lastActive = null;\n        var tooltip = this.tooltip;\n\n        if (tooltip) {\n          tooltip.hide();\n\n          if (cfg.onHide) {\n            cfg.onHide({\n              tooltip: tooltip\n            });\n          }\n\n          var canvas = this.chart.get('canvas');\n          canvas.draw();\n        }\n      };\n\n      _proto._handleEvent = function _handleEvent(methodName, method, action) {\n        var canvas = this.canvas;\n        each([].concat(methodName), function (aMethod) {\n          if (action === 'bind') {\n            canvas.on(aMethod, method);\n          } else {\n            canvas.off(aMethod, method);\n          }\n        });\n      };\n\n      _proto.bindEvents = function bindEvents() {\n        var cfg = this._tooltipCfg;\n        var triggerOn = cfg.triggerOn,\n            triggerOff = cfg.triggerOff,\n            alwaysShow = cfg.alwaysShow;\n        triggerOn && this._handleEvent(triggerOn, this.handleShowEvent, 'bind'); // 如果 !alwaysShow, 则在手势离开后就隐藏\n\n        if (!alwaysShow) {\n          this._handleEvent(triggerOff, this.handleHideEvent, 'bind');\n        }\n      };\n\n      _proto.unBindEvents = function unBindEvents() {\n        var cfg = this._tooltipCfg;\n        var triggerOn = cfg.triggerOn,\n            triggerOff = cfg.triggerOff,\n            alwaysShow = cfg.alwaysShow;\n        triggerOn && this._handleEvent(triggerOn, this.handleShowEvent, 'unBind');\n\n        if (!alwaysShow) {\n          this._handleEvent(triggerOff, this.handleHideEvent, 'unBind');\n        }\n      };\n\n      return TooltipController;\n    }();\n\n    function init(chart) {\n      var tooltipController = new TooltipController({\n        chart: chart\n      });\n      chart.set('tooltipController', tooltipController);\n\n      chart.tooltip = function (enable, cfg) {\n        if (isObject(enable)) {\n          cfg = enable;\n          enable = true;\n        }\n\n        tooltipController.enable = enable;\n\n        if (cfg) {\n          tooltipController.cfg = cfg;\n        }\n\n        return this;\n      };\n    }\n\n    function afterGeomDraw(chart) {\n      var tooltipController = chart.get('tooltipController');\n      tooltipController.render();\n\n      chart.showTooltip = function (point) {\n        tooltipController.showTooltip(point);\n        return this;\n      };\n\n      chart.hideTooltip = function () {\n        tooltipController.hideTooltip();\n        return this;\n      };\n    }\n\n    function clearInner(chart) {\n      var tooltipController = chart.get('tooltipController');\n      tooltipController.clear();\n    }\n    var tooltip = {\n      init: init,\n      afterGeomDraw: afterGeomDraw,\n      clearInner: clearInner\n    };\n\n    var Tooltip$1 = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        init: init,\n        afterGeomDraw: afterGeomDraw,\n        clearInner: clearInner,\n        'default': tooltip\n    });\n\n    Global.guide = deepMix({\n      line: {\n        style: {\n          stroke: '#a3a3a3',\n          lineWidth: 1\n        },\n        top: true\n      },\n      text: {\n        style: {\n          fill: '#787878',\n          textAlign: 'center',\n          textBaseline: 'middle'\n        },\n        offsetX: 0,\n        offsetY: 0,\n        top: true\n      },\n      rect: {\n        style: {\n          fill: '#fafafa'\n        },\n        top: false\n      },\n      arc: {\n        style: {\n          stroke: '#a3a3a3'\n        },\n        top: true\n      },\n      html: {\n        offsetX: 0,\n        offsetY: 0,\n        alignX: 'center',\n        alignY: 'middle'\n      },\n      tag: {\n        top: true,\n        offsetX: 0,\n        offsetY: 0,\n        side: 4,\n        background: {\n          padding: 5,\n          radius: 2,\n          fill: '#1890FF'\n        },\n        textStyle: {\n          fontSize: 12,\n          fill: '#fff',\n          textAlign: 'center',\n          textBaseline: 'middle'\n        }\n      },\n      point: {\n        top: true,\n        offsetX: 0,\n        offsetY: 0,\n        style: {\n          fill: '#fff',\n          r: 3,\n          lineWidth: 2,\n          stroke: '#1890ff'\n        }\n      }\n    }, Global.guide || {});\n\n    var GuideController = /*#__PURE__*/function () {\n      function GuideController(cfg) {\n        this.guides = [];\n        this.xScale = null;\n        this.yScales = null;\n        this.guideShapes = [];\n        mix(this, cfg);\n      }\n\n      var _proto = GuideController.prototype;\n\n      _proto._toString = function _toString(position) {\n        if (isFunction(position)) {\n          position = position(this.xScale, this.yScales);\n        }\n\n        position = position.toString();\n        return position;\n      };\n\n      _proto._getId = function _getId(shape, guide) {\n        var id = guide.id;\n\n        if (!id) {\n          var type = guide.type;\n\n          if (type === 'arc' || type === 'line' || type === 'rect') {\n            id = this._toString(guide.start) + '-' + this._toString(guide.end);\n          } else {\n            id = this._toString(guide.position);\n          }\n        }\n\n        return id;\n      };\n\n      _proto.paint = function paint(coord) {\n        var self = this;\n        var chart = self.chart,\n            guides = self.guides,\n            xScale = self.xScale,\n            yScales = self.yScales;\n        var guideShapes = [];\n        each(guides, function (guide, idx) {\n          guide.xScale = xScale;\n          guide.yScales = yScales;\n          var container;\n\n          if (guide.type === 'regionFilter') {\n            // TODO: RegionFilter support animation\n            guide.chart = chart;\n          } else {\n            container = guide.top ? self.frontPlot : self.backPlot;\n          }\n\n          guide.coord = coord;\n          guide.container = container;\n          guide.canvas = chart.get('canvas');\n          var shape = guide.render(coord, container);\n\n          if (shape) {\n            var id = self._getId(shape, guide);\n\n            [].concat(shape).forEach(function (s) {\n              s._id = s.get('className') + '-' + id;\n              s.set('index', idx);\n              guideShapes.push(s);\n            });\n          }\n        });\n        self.guideShapes = guideShapes;\n      };\n\n      _proto.clear = function clear() {\n        this.reset();\n        this.guides = [];\n        return this;\n      };\n\n      _proto.reset = function reset() {\n        var guides = this.guides;\n        each(guides, function (guide) {\n          guide.remove();\n        });\n      };\n\n      _proto._createGuide = function _createGuide(type, cfg) {\n        var ClassName = upperFirst(type);\n        var guide = new GuideBase[ClassName](deepMix({}, Global.guide[type], cfg));\n        this.guides.push(guide);\n        return guide;\n      };\n\n      _proto.line = function line(cfg) {\n        if (cfg === void 0) {\n          cfg = {};\n        }\n\n        return this._createGuide('line', cfg);\n      };\n\n      _proto.text = function text(cfg) {\n        if (cfg === void 0) {\n          cfg = {};\n        }\n\n        return this._createGuide('text', cfg);\n      };\n\n      _proto.arc = function arc(cfg) {\n        if (cfg === void 0) {\n          cfg = {};\n        }\n\n        return this._createGuide('arc', cfg);\n      };\n\n      _proto.html = function html(cfg) {\n        if (cfg === void 0) {\n          cfg = {};\n        }\n\n        return this._createGuide('html', cfg);\n      };\n\n      _proto.rect = function rect(cfg) {\n        if (cfg === void 0) {\n          cfg = {};\n        }\n\n        return this._createGuide('rect', cfg);\n      };\n\n      _proto.tag = function tag(cfg) {\n        if (cfg === void 0) {\n          cfg = {};\n        }\n\n        return this._createGuide('tag', cfg);\n      };\n\n      _proto.point = function point(cfg) {\n        if (cfg === void 0) {\n          cfg = {};\n        }\n\n        return this._createGuide('point', cfg);\n      };\n\n      _proto.regionFilter = function regionFilter(cfg) {\n        if (cfg === void 0) {\n          cfg = {};\n        }\n\n        return this._createGuide('regionFilter', cfg);\n      };\n\n      return GuideController;\n    }();\n\n    function init$1(chart) {\n      var guideController = new GuideController({\n        frontPlot: chart.get('frontPlot').addGroup({\n          zIndex: 20,\n          className: 'guideContainer'\n        }),\n        backPlot: chart.get('backPlot').addGroup({\n          className: 'guideContainer'\n        })\n      });\n      chart.set('guideController', guideController);\n      /**\n       * 为图表添加 guide\n       * @return {GuideController} 返回 guide 控制器\n       */\n\n      chart.guide = function () {\n        return guideController;\n      };\n    }\n\n    function afterGeomDraw$1(chart) {\n      var guideController = chart.get('guideController');\n\n      if (!guideController.guides.length) {\n        return;\n      }\n\n      var xScale = chart.getXScale();\n      var yScales = chart.getYScales();\n      var coord = chart.get('coord');\n      guideController.xScale = xScale;\n      guideController.yScales = yScales;\n      guideController.chart = chart; // for regionFilter\n\n      guideController.paint(coord);\n    }\n\n    function clear(chart) {\n      chart.get('guideController').clear();\n    }\n\n    function repaint(chart) {\n      chart.get('guideController').reset();\n    }\n    var guide = {\n      init: init$1,\n      afterGeomDraw: afterGeomDraw$1,\n      clear: clear,\n      repaint: repaint\n    };\n\n    var Guide = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        init: init$1,\n        afterGeomDraw: afterGeomDraw$1,\n        clear: clear,\n        repaint: repaint,\n        'default': guide\n    });\n\n    var LEGEND_GAP = 12;\n    var MARKER_SIZE = 3;\n    var DEFAULT_CFG = {\n      itemMarginBottom: 12,\n      itemGap: 10,\n      showTitle: false,\n      titleStyle: {\n        fontSize: 12,\n        fill: '#808080',\n        textAlign: 'start',\n        textBaseline: 'top'\n      },\n      nameStyle: {\n        fill: '#808080',\n        fontSize: 12,\n        textAlign: 'start',\n        textBaseline: 'middle'\n      },\n      valueStyle: {\n        fill: '#000000',\n        fontSize: 12,\n        textAlign: 'start',\n        textBaseline: 'middle'\n      },\n      unCheckStyle: {\n        fill: '#bfbfbf'\n      },\n      itemWidth: 'auto',\n      wordSpace: 6,\n      selectedMode: 'multiple' // 'multiple' or 'single'\n\n    }; // Register the default configuration for Legend\n\n    Global.legend = deepMix({\n      common: DEFAULT_CFG,\n      // common legend configuration\n      right: mix({\n        position: 'right',\n        layout: 'vertical'\n      }, DEFAULT_CFG),\n      left: mix({\n        position: 'left',\n        layout: 'vertical'\n      }, DEFAULT_CFG),\n      top: mix({\n        position: 'top',\n        layout: 'horizontal'\n      }, DEFAULT_CFG),\n      bottom: mix({\n        position: 'bottom',\n        layout: 'horizontal'\n      }, DEFAULT_CFG)\n    }, Global.legend || {});\n\n    function getPaddingByPos(pos, appendPadding) {\n      var padding = 0;\n      appendPadding = parsePadding(appendPadding);\n\n      switch (pos) {\n        case 'top':\n          padding = appendPadding[0];\n          break;\n\n        case 'right':\n          padding = appendPadding[1];\n          break;\n\n        case 'bottom':\n          padding = appendPadding[2];\n          break;\n\n        case 'left':\n          padding = appendPadding[3];\n          break;\n      }\n\n      return padding;\n    }\n\n    var LegendController = /*#__PURE__*/function () {\n      function LegendController(cfg) {\n        var _this = this;\n\n        _defineProperty(this, \"handleEvent\", function (ev) {\n          var self = _this;\n\n          function findItem(x, y) {\n            var result = null;\n            var legends = self.legends;\n            each(legends, function (legendItems) {\n              each(legendItems, function (legend) {\n                var itemsGroup = legend.itemsGroup,\n                    legendHitBoxes = legend.legendHitBoxes;\n                var children = itemsGroup.get('children');\n\n                if (children.length) {\n                  var legendPosX = legend.x;\n                  var legendPosY = legend.y;\n                  each(legendHitBoxes, function (box, index) {\n                    if (x >= box.x + legendPosX && x <= box.x + box.width + legendPosX && y >= box.y + legendPosY && y <= box.height + box.y + legendPosY) {\n                      // inbox\n                      result = {\n                        clickedItem: children[index],\n                        clickedLegend: legend\n                      };\n                      return false;\n                    }\n                  });\n                }\n              });\n            });\n            return result;\n          }\n\n          var chart = self.chart;\n\n          var _createEvent = createEvent(ev, chart),\n              x = _createEvent.x,\n              y = _createEvent.y;\n\n          var clicked = findItem(x, y);\n\n          if (clicked && clicked.clickedLegend.clickable !== false) {\n            var clickedItem = clicked.clickedItem,\n                clickedLegend = clicked.clickedLegend;\n\n            if (clickedLegend.onClick) {\n              ev.clickedItem = clickedItem;\n              clickedLegend.onClick(ev);\n            } else if (!clickedLegend.custom) {\n              var checked = clickedItem.get('checked');\n              var value = clickedItem.get('dataValue');\n              var filteredVals = clickedLegend.filteredVals,\n                  field = clickedLegend.field,\n                  selectedMode = clickedLegend.selectedMode;\n              var isSingeSelected = selectedMode === 'single';\n\n              if (isSingeSelected) {\n                chart.filter(field, function (val) {\n                  return val === value;\n                });\n              } else {\n                if (checked) {\n                  filteredVals.push(value);\n                } else {\n                  remove(filteredVals, value);\n                }\n\n                chart.filter(field, function (val) {\n                  return filteredVals.indexOf(val) === -1;\n                });\n              }\n\n              chart.repaint();\n            }\n          }\n        });\n\n        this.legendCfg = {};\n        this.enable = true;\n        this.position = 'top';\n        mix(this, cfg);\n        var _chart = this.chart;\n        this.canvasDom = _chart.get('canvas').get('el');\n        this.clear();\n      }\n\n      var _proto = LegendController.prototype;\n\n      _proto.addLegend = function addLegend(scale, items, filteredVals) {\n        var self = this;\n        var legendCfg = self.legendCfg;\n        var field = scale.field;\n        var fieldCfg = legendCfg[field];\n\n        if (fieldCfg === false) {\n          return null;\n        }\n\n        if (fieldCfg && fieldCfg.custom) {\n          self.addCustomLegend(field);\n        } else {\n          var position = legendCfg.position || self.position;\n\n          if (fieldCfg && fieldCfg.position) {\n            position = fieldCfg.position;\n          }\n\n          if (scale.isCategory) {\n            self._addCategoryLegend(scale, items, position, filteredVals);\n          }\n        }\n      };\n\n      _proto.addCustomLegend = function addCustomLegend(field) {\n        var self = this;\n        var legendCfg = self.legendCfg;\n\n        if (field && legendCfg[field]) {\n          legendCfg = legendCfg[field];\n        }\n\n        var position = legendCfg.position || self.position;\n        var legends = self.legends;\n        legends[position] = legends[position] || [];\n        var items = legendCfg.items;\n\n        if (!items) {\n          return null;\n        }\n\n        var container = self.container;\n        each(items, function (item) {\n          if (!isPlainObject(item.marker)) {\n            item.marker = {\n              symbol: item.marker || 'circle',\n              fill: item.fill,\n              radius: MARKER_SIZE\n            };\n          } else {\n            item.marker.radius = item.marker.radius || MARKER_SIZE;\n          }\n\n          item.checked = isNil(item.checked) ? true : item.checked;\n          item.name = item.name || item.value;\n        });\n        var legend = new List(deepMix({}, Global.legend[position], legendCfg, {\n          maxLength: self._getMaxLength(position),\n          items: items,\n          parent: container\n        }));\n        legends[position].push(legend);\n      };\n\n      _proto.clear = function clear() {\n        var legends = this.legends;\n        each(legends, function (legendItems) {\n          each(legendItems, function (legend) {\n            legend.clear();\n          });\n        });\n        this.legends = {};\n        this.unBindEvents();\n      };\n\n      _proto._isFiltered = function _isFiltered(scale, values, value) {\n        var rst = false;\n        each(values, function (val) {\n          rst = rst || scale.getText(val) === scale.getText(value);\n\n          if (rst) {\n            return false;\n          }\n        });\n        return rst;\n      };\n\n      _proto._getMaxLength = function _getMaxLength(position) {\n        var chart = this.chart;\n        var appendPadding = parsePadding(chart.get('appendPadding'));\n        return position === 'right' || position === 'left' ? chart.get('height') - (appendPadding[0] + appendPadding[2]) : chart.get('width') - (appendPadding[1] + appendPadding[3]);\n      };\n\n      _proto._addCategoryLegend = function _addCategoryLegend(scale, items, position, filteredVals) {\n        var self = this;\n        var legendCfg = self.legendCfg,\n            legends = self.legends,\n            container = self.container,\n            chart = self.chart;\n        var field = scale.field;\n        legends[position] = legends[position] || [];\n        var symbol = 'circle';\n\n        if (legendCfg[field] && legendCfg[field].marker) {\n          symbol = legendCfg[field].marker;\n        } else if (legendCfg.marker) {\n          symbol = legendCfg.marker;\n        }\n\n        each(items, function (item) {\n          if (isPlainObject(symbol)) {\n            mix(item.marker, symbol);\n          } else {\n            item.marker.symbol = symbol;\n          }\n\n          if (filteredVals) {\n            item.checked = !self._isFiltered(scale, filteredVals, item.dataValue);\n          }\n        });\n        var legendItems = chart.get('legendItems');\n        legendItems[field] = items;\n        var lastCfg = deepMix({}, Global.legend[position], legendCfg[field] || legendCfg, {\n          maxLength: self._getMaxLength(position),\n          items: items,\n          field: field,\n          filteredVals: filteredVals,\n          parent: container\n        });\n\n        if (lastCfg.showTitle) {\n          deepMix(lastCfg, {\n            title: scale.alias || scale.field\n          });\n        }\n\n        var legend = new List(lastCfg);\n        legends[position].push(legend);\n        return legend;\n      };\n\n      _proto._alignLegend = function _alignLegend(legend, pre, position) {\n        var self = this;\n        var _self$plotRange = self.plotRange,\n            tl = _self$plotRange.tl,\n            bl = _self$plotRange.bl;\n        var chart = self.chart;\n        var offsetX = legend.offsetX || 0;\n        var offsetY = legend.offsetY || 0;\n        var chartWidth = chart.get('width');\n        var chartHeight = chart.get('height');\n        var appendPadding = parsePadding(chart.get('appendPadding'));\n        var legendHeight = legend.getHeight();\n        var legendWidth = legend.getWidth();\n        var x = 0;\n        var y = 0;\n\n        if (position === 'left' || position === 'right') {\n          var verticalAlign = legend.verticalAlign || 'middle';\n          var height = Math.abs(tl.y - bl.y);\n          x = position === 'left' ? appendPadding[3] : chartWidth - legendWidth - appendPadding[1];\n          y = (height - legendHeight) / 2 + tl.y;\n\n          if (verticalAlign === 'top') {\n            y = tl.y;\n          } else if (verticalAlign === 'bottom') {\n            y = bl.y - legendHeight;\n          }\n\n          if (pre) {\n            y = pre.get('y') - legendHeight - LEGEND_GAP;\n          }\n        } else {\n          var align = legend.align || 'left';\n          x = appendPadding[3];\n\n          if (align === 'center') {\n            x = chartWidth / 2 - legendWidth / 2;\n          } else if (align === 'right') {\n            x = chartWidth - (legendWidth + appendPadding[1]);\n          }\n\n          y = position === 'top' ? appendPadding[0] + Math.abs(legend.container.getBBox().minY) : chartHeight - legendHeight;\n\n          if (pre) {\n            var preWidth = pre.getWidth();\n            x = pre.x + preWidth + LEGEND_GAP;\n          }\n        }\n\n        if (position === 'bottom' && offsetY > 0) {\n          offsetY = 0;\n        }\n\n        if (position === 'right' && offsetX > 0) {\n          offsetX = 0;\n        }\n\n        legend.moveTo(x + offsetX, y + offsetY);\n      };\n\n      _proto.alignLegends = function alignLegends() {\n        var self = this;\n        var legends = self.legends;\n        each(legends, function (legendItems, position) {\n          each(legendItems, function (legend, index) {\n            var pre = legendItems[index - 1];\n\n            self._alignLegend(legend, pre, position);\n          });\n        });\n        return self;\n      };\n\n      _proto.bindEvents = function bindEvents() {\n        var legendCfg = this.legendCfg;\n        var triggerOn = legendCfg.triggerOn || 'touchstart';\n        addEventListener(this.canvasDom, triggerOn, this.handleEvent);\n      };\n\n      _proto.unBindEvents = function unBindEvents() {\n        var legendCfg = this.legendCfg;\n        var triggerOn = legendCfg.triggerOn || 'touchstart';\n        removeEventListener(this.canvasDom, triggerOn, this.handleEvent);\n      };\n\n      return LegendController;\n    }();\n\n    function init$2(chart) {\n      var legendController = new LegendController({\n        container: chart.get('backPlot').addGroup(),\n        plotRange: chart.get('plotRange'),\n        chart: chart\n      });\n      chart.set('legendController', legendController);\n\n      chart.legend = function (field, cfg) {\n        var legendCfg = legendController.legendCfg;\n        legendController.enable = true;\n\n        if (isBoolean(field)) {\n          legendController.enable = field;\n          legendCfg = cfg || {};\n        } else if (isObject(field)) {\n          legendCfg = field;\n        } else {\n          legendCfg[field] = cfg;\n        }\n\n        legendController.legendCfg = legendCfg;\n        return this;\n      };\n    }\n\n    function beforeGeomDraw(chart) {\n      var legendController = chart.get('legendController');\n      if (!legendController.enable) return null; // legend is not displayed\n\n      var legendCfg = legendController.legendCfg,\n          container = legendController.container;\n\n      if (legendCfg && legendCfg.custom) {\n        legendController.addCustomLegend();\n      } else {\n        var legendItems = chart.getLegendItems();\n        var scales = chart.get('scales');\n        var filters = chart.get('filters');\n        each(legendItems, function (items, field) {\n          var scale = scales[field];\n          var values = scale.values;\n          var filteredVals;\n\n          if (filters && filters[field]) {\n            filteredVals = values.filter(function (v) {\n              return !filters[field](v);\n            });\n          } else {\n            filteredVals = [];\n          }\n\n          legendController.addLegend(scale, items, filteredVals);\n        });\n      }\n\n      if (legendCfg && legendCfg.clickable !== false) {\n        legendController.bindEvents();\n      }\n\n      var legends = legendController.legends;\n      var legendRange = {\n        top: 0,\n        right: 0,\n        bottom: 0,\n        left: 0\n      };\n      each(legends, function (legendItems, position) {\n        var padding = 0;\n        each(legendItems, function (legend) {\n          var width = legend.getWidth();\n          var height = legend.getHeight();\n\n          if (position === 'top' || position === 'bottom') {\n            padding = Math.max(padding, height);\n\n            if (legend.offsetY > 0) {\n              padding += legend.offsetY;\n            }\n          } else {\n            padding = Math.max(padding, width);\n\n            if (legend.offsetX > 0) {\n              padding += legend.offsetX;\n            }\n          }\n        });\n        legendRange[position] = padding + getPaddingByPos(position, chart.get('appendPadding'));\n      });\n      chart.set('legendRange', legendRange);\n\n      if (Object.keys(legends).length) {\n        container.set('ariaLabel', lang.legend.prefix);\n      } else {\n        container.set('ariaLabel', null);\n      }\n    }\n\n    function afterGeomDraw$2(chart) {\n      var legendController = chart.get('legendController');\n      legendController.alignLegends();\n    }\n\n    function clearInner$1(chart) {\n      var legendController = chart.get('legendController');\n      legendController.clear();\n      chart.set('legendRange', null);\n    }\n    var legend = {\n      init: init$2,\n      beforeGeomDraw: beforeGeomDraw,\n      afterGeomDraw: afterGeomDraw$2,\n      clearInner: clearInner$1\n    };\n\n    var Legend = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        init: init$2,\n        beforeGeomDraw: beforeGeomDraw,\n        afterGeomDraw: afterGeomDraw$2,\n        clearInner: clearInner$1,\n        'default': legend\n    });\n\n    var clock = typeof performance === 'object' && performance.now ? performance : Date;\n\n    var Timeline = /*#__PURE__*/function () {\n      function Timeline() {\n        this.anims = [];\n        this.time = null;\n        this.playing = false;\n        this.canvas = [];\n      }\n\n      var _proto = Timeline.prototype;\n\n      _proto.play = function play() {\n        var self = this;\n        self.time = clock.now();\n        self.playing = true;\n\n        function step() {\n          if (self.playing) {\n            requestAnimationFrame(step);\n            self.update();\n          }\n        }\n\n        requestAnimationFrame(step);\n      };\n\n      _proto.stop = function stop() {\n        this.playing = false;\n        this.time = null;\n        this.canvas = [];\n      };\n\n      _proto.pushAnim = function pushAnim(animInfo) {\n        // 先启动动画\n        if (!this.playing) {\n          this.play();\n        }\n\n        var delay = animInfo.delay,\n            duration = animInfo.duration;\n        var startTime = this.time + delay;\n        var endTime = startTime + duration;\n        animInfo.startTime = startTime;\n        animInfo.endTime = endTime;\n        this.anims.push(animInfo);\n      };\n\n      _proto.update = function update() {\n        var currentTime = clock.now();\n        this.canvas = [];\n\n        if (!this.anims.length) {\n          this.stop();\n          return;\n        }\n\n        for (var i = 0; i < this.anims.length; i++) {\n          var propertyAnim = this.anims[i];\n\n          if (currentTime < propertyAnim.startTime || propertyAnim.hasEnded) {\n            continue;\n          }\n\n          var shape = propertyAnim.shape; // shape\n\n          if (shape.get('destroyed')) {\n            this.anims.splice(i, 1);\n            i--;\n            continue;\n          }\n\n          var startState = propertyAnim.startState,\n              endState = propertyAnim.endState,\n              interpolate = propertyAnim.interpolate,\n              duration = propertyAnim.duration;\n\n          if (currentTime >= propertyAnim.startTime && !propertyAnim.hasStarted) {\n            propertyAnim.hasStarted = true;\n\n            if (propertyAnim.onStart) {\n              propertyAnim.onStart();\n            }\n          }\n\n          var t = (currentTime - propertyAnim.startTime) / duration;\n          t = Math.max(0, Math.min(t, 1));\n          t = propertyAnim.easing(t);\n\n          if (propertyAnim.onFrame) {\n            propertyAnim.onFrame(t);\n          } else {\n            for (var key in interpolate) {\n              var diff = interpolate[key];\n              var value = diff(t);\n              var newValue = void 0;\n\n              if (key === 'points') {\n                newValue = [];\n                var aLen = Math.max(startState.points.length, endState.points.length);\n\n                for (var j = 0; j < aLen; j += 2) {\n                  newValue.push({\n                    x: value[j],\n                    y: value[j + 1]\n                  });\n                }\n              } else {\n                newValue = value;\n              }\n\n              shape._attrs.attrs[key] = newValue;\n              shape._attrs.bbox = null; // should clear calculated bbox\n            }\n          }\n\n          var canvas = shape.get('canvas');\n\n          if (this.canvas.indexOf(canvas) === -1) {\n            this.canvas.push(canvas);\n          }\n\n          if (propertyAnim.onUpdate) {\n            propertyAnim.onUpdate(t);\n          }\n\n          if (currentTime >= propertyAnim.endTime && !propertyAnim.hasEnded) {\n            propertyAnim.hasEnded = true;\n\n            if (propertyAnim.onEnd) {\n              propertyAnim.onEnd();\n            }\n          }\n\n          if (t === 1) {\n            // end\n            this.anims.splice(i, 1);\n            i--;\n          }\n        }\n\n        this.canvas.map(function (c) {\n          c.draw();\n          return c;\n        });\n        this.time = clock.now();\n      };\n\n      return Timeline;\n    }();\n\n    function linear$1(k) {\n      return k;\n    }\n\n    function quadraticIn(k) {\n      return k * k;\n    }\n\n    function quadraticOut(k) {\n      return k * (2 - k);\n    }\n\n    function quadraticInOut(k) {\n      if ((k *= 2) < 1) {\n        return 0.5 * k * k;\n      }\n\n      return -0.5 * (--k * (k - 2) - 1);\n    }\n\n    function cubicIn(k) {\n      return k * k * k;\n    }\n\n    function cubicOut(k) {\n      return --k * k * k + 1;\n    }\n\n    function cubicInOut(k) {\n      if ((k *= 2) < 1) {\n        return 0.5 * k * k * k;\n      }\n\n      return 0.5 * ((k -= 2) * k * k + 2);\n    }\n\n    function elasticIn(k) {\n      var s;\n      var a = 0.1;\n      var p = 0.4;\n      if (k === 0) return 0;\n      if (k === 1) return 1;\n\n      if (!a || a < 1) {\n        a = 1;\n        s = p / 4;\n      } else {\n        s = p / (2 * Math.PI) * Math.asin(1 / a);\n      }\n\n      return -(a * Math.pow(2, 10 * (k -= 1)) * Math.sin((k - s) * (2 * Math.PI) / p));\n    }\n\n    function elasticOut(k) {\n      var s;\n      var a = 0.1;\n      var p = 0.4;\n      if (k === 0) return 0;\n      if (k === 1) return 1;\n\n      if (!a || a < 1) {\n        a = 1;\n        s = p / 4;\n      } else {\n        s = p / (2 * Math.PI) * Math.asin(1 / a);\n      }\n\n      return a * Math.pow(2, -10 * k) * Math.sin((k - s) * (2 * Math.PI) / p) + 1;\n    }\n\n    function elasticInOut(k) {\n      var s;\n      var a = 0.1;\n      var p = 0.4;\n      if (k === 0) return 0;\n      if (k === 1) return 1;\n\n      if (!a || a < 1) {\n        a = 1;\n        s = p / 4;\n      } else {\n        s = p / (2 * Math.PI) * Math.asin(1 / a);\n      }\n\n      if ((k *= 2) < 1) {\n        return -0.5 * (a * Math.pow(2, 10 * (k -= 1)) * Math.sin((k - s) * (2 * Math.PI) / p));\n      }\n\n      return a * Math.pow(2, -10 * (k -= 1)) * Math.sin((k - s) * (2 * Math.PI) / p) * 0.5 + 1;\n    }\n\n    function backIn(k) {\n      var s = 1.70158;\n      return k * k * ((s + 1) * k - s);\n    }\n\n    function backOut(k) {\n      var s = 1.70158;\n      return (k = k - 1) * k * ((s + 1) * k + s) + 1;\n    }\n\n    function backInOut(k) {\n      var s = 1.70158 * 1.525;\n\n      if ((k *= 2) < 1) {\n        return 0.5 * (k * k * ((s + 1) * k - s));\n      }\n\n      return 0.5 * ((k -= 2) * k * ((s + 1) * k + s) + 2);\n    }\n\n    function bounceIn(k) {\n      return 1 - bounceOut(1 - k);\n    }\n\n    function bounceOut(k) {\n      if ((k /= 1) < 1 / 2.75) {\n        return 7.5625 * k * k;\n      } else if (k < 2 / 2.75) {\n        return 7.5625 * (k -= 1.5 / 2.75) * k + 0.75;\n      } else if (k < 2.5 / 2.75) {\n        return 7.5625 * (k -= 2.25 / 2.75) * k + 0.9375;\n      }\n\n      return 7.5625 * (k -= 2.625 / 2.75) * k + 0.984375;\n    }\n\n    function bounceInOut(k) {\n      if (k < 0.5) {\n        return bounceIn(k * 2) * 0.5;\n      }\n\n      return bounceOut(k * 2 - 1) * 0.5 + 0.5;\n    }\n\n    var Easing = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        linear: linear$1,\n        quadraticIn: quadraticIn,\n        quadraticOut: quadraticOut,\n        quadraticInOut: quadraticInOut,\n        cubicIn: cubicIn,\n        cubicOut: cubicOut,\n        cubicInOut: cubicInOut,\n        elasticIn: elasticIn,\n        elasticOut: elasticOut,\n        elasticInOut: elasticInOut,\n        backIn: backIn,\n        backOut: backOut,\n        backInOut: backInOut,\n        bounceIn: bounceIn,\n        bounceOut: bounceOut,\n        bounceInOut: bounceInOut\n    });\n\n    function plainArray(arr) {\n      var result = [];\n\n      for (var i = 0, len = arr.length; i < len; i++) {\n        if (arr[i]) {\n          result.push(arr[i].x);\n          result.push(arr[i].y);\n        }\n      }\n\n      return result;\n    }\n\n    function interpolateNumber(a, b) {\n      a = +a;\n      b -= a;\n      return function (t) {\n        return a + b * t;\n      };\n    }\n\n    function interpolateArray(a, b) {\n      var nb = b ? b.length : 0;\n      var na = a ? Math.min(nb, a.length) : 0;\n      var x = new Array(na);\n      var c = new Array(nb);\n      var i;\n\n      for (i = 0; i < na; ++i) {\n        x[i] = interpolateNumber(a[i], b[i]);\n      }\n\n      for (; i < nb; ++i) {\n        c[i] = b[i];\n      }\n\n      return function (t) {\n        for (i = 0; i < na; ++i) {\n          c[i] = x[i](t);\n        }\n\n        return c;\n      };\n    }\n\n    var Animator = /*#__PURE__*/function () {\n      function Animator(shape, source, timeline) {\n        this.hasStarted = false;\n        this.hasEnded = false;\n        this.shape = shape;\n        this.source = source;\n        this.timeline = timeline;\n        this.animate = null;\n      } // delay, attrs, duration, easing\n\n\n      var _proto = Animator.prototype;\n\n      _proto.to = function to(cfg) {\n        if (cfg === void 0) {\n          cfg = {};\n        }\n\n        var delay = cfg.delay || 0;\n        var attrs = cfg.attrs || {};\n        var duration = cfg.duration || 1000;\n        var easing; // 缓动函数\n\n        if (typeof cfg.easing === 'function') {\n          easing = cfg.easing;\n        } else {\n          easing = Easing[cfg.easing] || linear$1;\n        }\n\n        var animInfo = {\n          shape: this.shape,\n          delay: delay,\n          duration: duration,\n          easing: easing\n        };\n        var interpolate = {}; // 差值函数\n\n        for (var attrName in attrs) {\n          var startValue = this.source[attrName];\n          var endValue = attrs[attrName];\n\n          if (attrName === 'points') {\n            startValue = plainArray(startValue);\n            endValue = plainArray(endValue);\n            interpolate.points = interpolateArray(startValue, endValue);\n            this.source.points = startValue;\n            attrs.points = endValue;\n          } else if (attrName === 'matrix') {\n            interpolate.matrix = interpolateArray(startValue, endValue);\n          } else {\n            interpolate[attrName] = interpolateNumber(startValue, endValue);\n          }\n        }\n\n        animInfo.interpolate = interpolate;\n        animInfo.startState = this.source;\n        animInfo.endState = attrs;\n        this.timeline.pushAnim(animInfo);\n        this.animate = animInfo;\n        return this;\n      };\n\n      _proto.onFrame = function onFrame(callback) {\n        // 自定义每一帧动画的动作\n        if (this.animate) {\n          this.animate.onFrame = function (frame) {\n            callback(frame);\n          };\n        }\n\n        return this;\n      };\n\n      _proto.onStart = function onStart(callback) {\n        if (this.animate) {\n          this.animate.onStart = function () {\n            callback();\n          };\n        }\n\n        return this;\n      };\n\n      _proto.onUpdate = function onUpdate(callback) {\n        if (this.animate) {\n          this.animate.onUpdate = function (frame) {\n            callback(frame);\n          };\n        }\n\n        return this;\n      };\n\n      _proto.onEnd = function onEnd(callback) {\n        if (this.animate) {\n          this.animate.onEnd = function () {\n            callback();\n          };\n        }\n\n        return this;\n      };\n\n      return Animator;\n    }();\n\n    var defaultAnimationCfg = {\n      appear: {\n        duration: 450,\n        easing: 'quadraticOut'\n      },\n      // 'appear' animation options\n      update: {\n        duration: 300,\n        easing: 'quadraticOut'\n      },\n      // 'update' animation options\n      enter: {\n        duration: 300,\n        easing: 'quadraticOut'\n      },\n      // 'enter' animation options\n      leave: {\n        duration: 350,\n        easing: 'quadraticIn'\n      } // 'leave' animation options\n\n    };\n    var Animate = {\n      defaultCfg: {},\n      Action: {},\n      getAnimation: function getAnimation(geomType, coord, animationType) {\n        var geomAnimateCfg = this.defaultCfg[geomType];\n\n        if (geomAnimateCfg) {\n          var animation = geomAnimateCfg[animationType];\n\n          if (isFunction(animation)) {\n            return animation(coord);\n          }\n        }\n\n        return false;\n      },\n      getAnimateCfg: function getAnimateCfg(geomType, animationType) {\n        var defaultCfg = defaultAnimationCfg[animationType];\n        var geomConfig = this.defaultCfg[geomType];\n\n        if (geomConfig && geomConfig.cfg && geomConfig.cfg[animationType]) {\n          return deepMix({}, defaultCfg, geomConfig.cfg[animationType]);\n        }\n\n        return defaultCfg;\n      },\n      registerAnimation: function registerAnimation(animationName, animationFun) {\n        var _extends2;\n\n        if (!this.Action) {\n          this.Action = {};\n        }\n\n        this.Action = _extends({}, this.Action, (_extends2 = {}, _extends2[animationName] = animationFun, _extends2));\n      }\n    };\n\n    /**\n     * Utility\n     * @author sima.zhang1990@gmail.com\n     */\n\n    function getCoordInfo(coord) {\n      var start = coord.start;\n      var end = coord.end;\n      return {\n        start: start,\n        end: end,\n        width: end.x - start.x,\n        height: Math.abs(end.y - start.y)\n      };\n    }\n\n    function getScaledMatrix(shape, v, direct) {\n      var scaledMatrix;\n      shape.apply(v);\n      var x = v[0];\n      var y = v[1];\n\n      if (direct === 'x') {\n        shape.transform([['t', x, y], ['s', 0.01, 1], ['t', -x, -y]]);\n        var matrix = shape.getMatrix();\n        scaledMatrix = Matrix.transform(matrix, [['t', x, y], ['s', 100, 1], ['t', -x, -y]]);\n      } else if (direct === 'y') {\n        shape.transform([['t', x, y], ['s', 1, 0.01], ['t', -x, -y]]);\n\n        var _matrix = shape.getMatrix();\n\n        scaledMatrix = Matrix.transform(_matrix, [['t', x, y], ['s', 1, 100], ['t', -x, -y]]);\n      } else if (direct === 'xy') {\n        shape.transform([['t', x, y], ['s', 0.01, 0.01], ['t', -x, -y]]);\n\n        var _matrix2 = shape.getMatrix();\n\n        scaledMatrix = Matrix.transform(_matrix2, [['t', x, y], ['s', 100, 100], ['t', -x, -y]]);\n      }\n\n      return scaledMatrix;\n    }\n\n    function getAnimateParam(animateCfg, index, id) {\n      var result = {};\n\n      if (animateCfg.delay) {\n        result.delay = isFunction(animateCfg.delay) ? animateCfg.delay(index, id) : animateCfg.delay;\n      }\n\n      result.easing = animateCfg.easing;\n      result.duration = animateCfg.duration;\n      result.delay = animateCfg.delay;\n      return result;\n    }\n\n    function doAnimation(shape, endState, animateCfg, callback) {\n      var id = shape._id;\n      var index = shape.get('index');\n\n      var _getAnimateParam = getAnimateParam(animateCfg, index, id),\n          easing = _getAnimateParam.easing,\n          delay = _getAnimateParam.delay,\n          duration = _getAnimateParam.duration;\n\n      var anim = shape.animate().to({\n        attrs: endState,\n        duration: duration,\n        delay: delay,\n        easing: easing\n      });\n\n      if (callback) {\n        anim.onEnd(function () {\n          callback();\n        });\n      }\n    }\n\n    /**\n     * Animation functions for shape\n     * @author sima.zhang1990@gmail.com\n     */\n    /*\n    function waveIn(shape, animateCfg, coord) {\n      const clip = Helpers.getClip(coord);\n      clip.set('canvas', shape.get('canvas'));\n      shape.attr('clip', clip);\n      const onEnd = function() {\n        shape.attr('clip', null);\n        clip.remove(true);\n      };\n      Helpers.doAnimation(clip, clip.endState, animateCfg, onEnd);\n    }\n\n    function scaleInX(shape, animateCfg) {\n      const box = shape.getBBox();\n      const points = shape.get('origin').points;\n      let x;\n      const y = (box.minY + box.maxY) / 2;\n\n      if (points[0].y - points[1].y > 0) { // 当顶点在零点之下\n        x = box.maxX;\n      } else {\n        x = box.minX;\n      }\n      const scaledMatrix = Helpers.getScaledMatrix(shape, [ x, y ], 'x');\n      Helpers.doAnimation(shape, { matrix: scaledMatrix }, animateCfg);\n    }\n\n    function scaleInY(shape, animateCfg) {\n      const box = shape.getBBox();\n      const points = shape.get('origin').points;\n      const x = (box.minX + box.maxX) / 2;\n      let y;\n\n      if (points[0].y - points[1].y <= 0) { // 当顶点在零点之下\n        y = box.maxY;\n      } else {\n        y = box.minY;\n      }\n      const scaledMatrix = Helpers.getScaledMatrix(shape, [ x, y ], 'x');\n      Helpers.doAnimation(shape, { matrix: scaledMatrix }, animateCfg);\n    }\n    */\n\n    function fadeIn(shape, animateCfg) {\n      var fillOpacity = isNil(shape.attr('fillOpacity')) ? 1 : shape.attr('fillOpacity');\n      var strokeOpacity = isNil(shape.attr('strokeOpacity')) ? 1 : shape.attr('strokeOpacity');\n      shape.attr('fillOpacity', 0);\n      shape.attr('strokeOpacity', 0);\n      var endState = {\n        fillOpacity: fillOpacity,\n        strokeOpacity: strokeOpacity\n      };\n      doAnimation(shape, endState, animateCfg);\n    }\n\n    var ShapeAction = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        fadeIn: fadeIn\n    });\n\n    /**\n     * Group animate functions\n     * @author sima.zhang1990@gmail.com\n     */\n\n    function _groupScaleIn(container, animateCfg, coord, zeroY, type) {\n      var _getCoordInfo = getCoordInfo(coord),\n          start = _getCoordInfo.start,\n          end = _getCoordInfo.end,\n          width = _getCoordInfo.width,\n          height = _getCoordInfo.height;\n\n      var x;\n      var y;\n      var clip = new Shape$2.Rect({\n        attrs: {\n          x: start.x,\n          y: end.y,\n          width: width,\n          height: height\n        }\n      });\n\n      if (type === 'y') {\n        x = start.x + width / 2;\n        y = zeroY.y < start.y ? zeroY.y : start.y;\n      } else if (type === 'x') {\n        x = zeroY.x > start.x ? zeroY.x : start.x;\n        y = start.y + height / 2;\n      } else if (type === 'xy') {\n        if (coord.isPolar) {\n          x = coord.center.x;\n          y = coord.center.y;\n        } else {\n          x = (start.x + end.x) / 2;\n          y = (start.y + end.y) / 2;\n        }\n      }\n\n      var endMatrix = getScaledMatrix(clip, [x, y], type);\n      clip.isClip = true;\n      clip.endState = {\n        matrix: endMatrix\n      };\n      clip.set('canvas', container.get('canvas'));\n      container.attr('clip', clip);\n\n      var onEnd = function onEnd() {\n        container.attr('clip', null);\n        clip.remove(true);\n      };\n\n      doAnimation(clip, clip.endState, animateCfg, onEnd);\n    }\n\n    function _shapeScale(container, animateCfg, type) {\n      var shapes = container.get('children');\n      var x;\n      var y;\n      var endMatrix;\n\n      for (var i = 0, len = shapes.length; i < len; i++) {\n        var shape = shapes[i];\n        var box = shape.getBBox();\n        x = (box.minX + box.maxX) / 2;\n        y = (box.minY + box.maxY) / 2;\n        endMatrix = getScaledMatrix(shape, [x, y], type);\n        doAnimation(shape, {\n          matrix: endMatrix\n        }, animateCfg);\n      }\n    }\n\n    function groupScaleInX(container, animateCfg, coord, zeroY) {\n      _groupScaleIn(container, animateCfg, coord, zeroY, 'x');\n    }\n\n    function groupScaleInY(container, animateCfg, coord, zeroY) {\n      _groupScaleIn(container, animateCfg, coord, zeroY, 'y');\n    }\n\n    function groupScaleInXY(container, animateCfg, coord, zeroY) {\n      _groupScaleIn(container, animateCfg, coord, zeroY, 'xy');\n    }\n\n    function shapesScaleInX(container, animateCfg) {\n      _shapeScale(container, animateCfg, 'x');\n    }\n\n    function shapesScaleInY(container, animateCfg) {\n      _shapeScale(container, animateCfg, 'y');\n    }\n\n    function shapesScaleInXY(container, animateCfg) {\n      _shapeScale(container, animateCfg, 'xy');\n    }\n\n    function groupWaveIn(container, animateCfg, coord) {\n      var clip = getClip(coord);\n      clip.set('canvas', container.get('canvas'));\n      container.attr('clip', clip);\n\n      var onEnd = function onEnd() {\n        container.attr('clip', null);\n        clip.remove(true);\n      };\n\n      var endState = {};\n\n      if (coord.isPolar) {\n        var startAngle = coord.startAngle,\n            endAngle = coord.endAngle;\n        endState.endAngle = endAngle;\n        clip.attr('endAngle', startAngle);\n      } else {\n        var start = coord.start,\n            end = coord.end;\n        var width = Math.abs(start.x - end.x);\n        var height = Math.abs(start.y - end.y);\n\n        if (coord.isTransposed) {\n          clip.attr('height', 0);\n          endState.height = height;\n        } else {\n          clip.attr('width', 0);\n          endState.width = width;\n        }\n      }\n\n      doAnimation(clip, endState, animateCfg, onEnd);\n    }\n\n    var GroupAction = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        groupWaveIn: groupWaveIn,\n        groupScaleInX: groupScaleInX,\n        groupScaleInY: groupScaleInY,\n        groupScaleInXY: groupScaleInXY,\n        shapesScaleInX: shapesScaleInX,\n        shapesScaleInY: shapesScaleInY,\n        shapesScaleInXY: shapesScaleInXY\n    });\n\n    /**\n     * Handle the detail animations\n     * @author sima.zhang1990@gmail.com\n     */\n    var timeline;\n\n    Element.prototype.animate = function () {\n      var attrs = mix({}, this.get('attrs'));\n      return new Animator(this, attrs, timeline);\n    };\n\n    Chart.prototype.animate = function (cfg) {\n      this.set('animate', cfg);\n      return this;\n    };\n\n    Animate.Action = ShapeAction;\n    Animate.defaultCfg = {\n      interval: {\n        enter: function enter(coord) {\n          if (coord.isPolar && coord.transposed) {\n            // for pie chart\n            return function (shape) {\n              shape.set('zIndex', -1);\n              var container = shape.get('parent');\n              container.sort();\n            };\n          }\n\n          return fadeIn;\n        }\n      },\n      area: {\n        enter: function enter(coord) {\n          if (coord.isPolar) return null;\n          return fadeIn;\n        }\n      },\n      line: {\n        enter: function enter(coord) {\n          if (coord.isPolar) return null;\n          return fadeIn;\n        }\n      },\n      path: {\n        enter: function enter(coord) {\n          if (coord.isPolar) return null;\n          return fadeIn;\n        }\n      }\n    };\n    var GROUP_ANIMATION = {\n      line: function line(coord) {\n        if (coord.isPolar) {\n          return groupScaleInXY;\n        }\n\n        return groupWaveIn;\n      },\n      area: function area(coord) {\n        if (coord.isPolar) {\n          return groupScaleInXY;\n        }\n\n        return groupWaveIn;\n      },\n      path: function path(coord) {\n        if (coord.isPolar) {\n          return groupScaleInXY;\n        }\n\n        return groupWaveIn;\n      },\n      point: function point() {\n        return shapesScaleInXY;\n      },\n      interval: function interval(coord) {\n        var result;\n\n        if (coord.isPolar) {\n          // polar coodinate\n          result = groupScaleInXY;\n\n          if (coord.transposed) {\n            // pie chart\n            result = groupWaveIn;\n          }\n        } else {\n          result = coord.transposed ? groupScaleInX : groupScaleInY;\n        }\n\n        return result;\n      },\n      schema: function schema() {\n        return groupWaveIn;\n      }\n    };\n\n    function diff(fromAttrs, toAttrs) {\n      var endState = {};\n\n      for (var k in toAttrs) {\n        if (isNumber(fromAttrs[k]) && fromAttrs[k] !== toAttrs[k]) {\n          endState[k] = toAttrs[k];\n        } else if (isArray(fromAttrs[k]) && JSON.stringify(fromAttrs[k]) !== JSON.stringify(toAttrs[k])) {\n          endState[k] = toAttrs[k];\n        }\n      }\n\n      return endState;\n    } // Add a unique id identifier to each shape\n\n\n    function _getShapeId(geom, dataObj, geomIdx) {\n      var type = geom.get('type');\n      var id = 'geom' + geomIdx + '-' + type;\n      var xScale = geom.getXScale();\n      var yScale = geom.getYScale();\n      var xField = xScale.field || 'x';\n      var yField = yScale.field || 'y';\n      var yVal = dataObj[yField];\n      var xVal;\n\n      if (xScale.isIdentity) {\n        xVal = xScale.value;\n      } else {\n        xVal = dataObj[xField];\n      }\n\n      if (type === 'interval' || type === 'schema') {\n        id += '-' + xVal;\n      } else if (type === 'line' || type === 'area' || type === 'path') {\n        id += '-' + type;\n      } else {\n        id += xScale.isCategory ? '-' + xVal : '-' + xVal + '-' + yVal;\n      }\n\n      var groupScales = geom._getGroupScales();\n\n      each(groupScales, function (groupScale) {\n        var field = groupScale.field;\n\n        if (groupScale.type !== 'identity') {\n          id += '-' + dataObj[field];\n        }\n      });\n      return id;\n    } // get geometry's shapes\n\n\n    function getShapes(geoms, chart, coord) {\n      var shapes = [];\n      each(geoms, function (geom, geomIdx) {\n        var geomContainer = geom.get('container');\n        var geomShapes = geomContainer.get('children');\n        var type = geom.get('type');\n        var animateCfg = isNil(geom.get('animateCfg')) ? _getAnimateCfgByShapeType(type, chart) : geom.get('animateCfg');\n\n        if (animateCfg !== false) {\n          each(geomShapes, function (shape, index) {\n            if (shape.get('className') === type) {\n              shape._id = _getShapeId(geom, shape.get('origin')._origin, geomIdx);\n              shape.set('coord', coord);\n              shape.set('animateCfg', animateCfg);\n              shape.set('index', index);\n              shapes.push(shape);\n            }\n          });\n        }\n\n        geom.set('shapes', geomShapes);\n      });\n      return shapes;\n    }\n\n    function cache(shapes) {\n      var rst = {};\n\n      for (var i = 0, len = shapes.length; i < len; i++) {\n        var shape = shapes[i];\n        if (!shape._id || shape.isClip) continue;\n        var id = shape._id;\n        rst[id] = {\n          _id: id,\n          type: shape.get('type'),\n          // the type of shape\n          attrs: mix({}, shape._attrs.attrs),\n          // the graphics attributes of shape\n          className: shape.get('className'),\n          geomType: shape.get('className'),\n          index: shape.get('index'),\n          coord: shape.get('coord'),\n          animateCfg: shape.get('animateCfg')\n        };\n      }\n\n      return rst;\n    }\n\n    function getAnimate(geomType, coord, animationType, animationName) {\n      var result;\n\n      if (isFunction(animationName)) {\n        result = animationName;\n      } else if (isString(animationName)) {\n        result = Animate.Action[animationName];\n      } else {\n        result = Animate.getAnimation(geomType, coord, animationType);\n      }\n\n      return result;\n    }\n\n    function getAnimateCfg(geomType, animationType, animateCfg) {\n      if (animateCfg === false || isObject(animateCfg) && animateCfg[animationType] === false) {\n        return false;\n      }\n\n      var defaultCfg = Animate.getAnimateCfg(geomType, animationType);\n\n      if (animateCfg && animateCfg[animationType]) {\n        return deepMix({}, defaultCfg, animateCfg[animationType]);\n      }\n\n      return defaultCfg;\n    }\n\n    function addAnimate(cache, shapes, canvas) {\n      var animate;\n      var animateCfg; // the order of animation: leave -> update -> enter\n\n      var updateShapes = [];\n      var newShapes = [];\n      each(shapes, function (shape) {\n        var result = cache[shape._id];\n\n        if (!result) {\n          newShapes.push(shape);\n        } else {\n          shape.set('cacheShape', result);\n          updateShapes.push(shape);\n          delete cache[shape._id];\n        }\n      }); // first do the leave animation\n\n      each(cache, function (deletedShape) {\n        var className = deletedShape.className,\n            coord = deletedShape.coord,\n            _id = deletedShape._id,\n            attrs = deletedShape.attrs,\n            index = deletedShape.index,\n            type = deletedShape.type;\n        animateCfg = getAnimateCfg(className, 'leave', deletedShape.animateCfg);\n        if (animateCfg === false) return true;\n        animate = getAnimate(className, coord, 'leave', animateCfg.animation);\n\n        if (isFunction(animate)) {\n          var tempShape = canvas.addShape(type, {\n            attrs: attrs,\n            index: index,\n            canvas: canvas,\n            className: className\n          });\n          tempShape._id = _id;\n          animate(tempShape, animateCfg, coord);\n        }\n      }); // then do the update animation\n\n      each(updateShapes, function (updateShape) {\n        var className = updateShape.get('className');\n        animateCfg = getAnimateCfg(className, 'update', updateShape.get('animateCfg'));\n        if (animateCfg === false) return true;\n        var coord = updateShape.get('coord');\n        var cacheAttrs = updateShape.get('cacheShape').attrs;\n        var endState = diff(cacheAttrs, updateShape._attrs.attrs); // 判断如果属性相同的话就不进行变换\n\n        if (Object.keys(endState).length) {\n          animate = getAnimate(className, coord, 'update', animateCfg.animation);\n\n          if (isFunction(animate)) {\n            animate(updateShape, animateCfg, coord);\n          } else {\n            var startState = {};\n            each(endState, function (value, key) {\n              startState[key] = cacheAttrs[key];\n            });\n            updateShape.attr(startState);\n            updateShape.animate().to({\n              attrs: endState,\n              duration: animateCfg.duration,\n              easing: animateCfg.easing,\n              delay: animateCfg.delay\n            }).onEnd(function () {\n              updateShape.set('cacheShape', null);\n            });\n          }\n        }\n      }); // last, enter animation\n\n      each(newShapes, function (newShape) {\n        // 新图形元素的进场元素\n        var className = newShape.get('className');\n        var coord = newShape.get('coord');\n        animateCfg = getAnimateCfg(className, 'enter', newShape.get('animateCfg'));\n        if (animateCfg === false) return true;\n        animate = getAnimate(className, coord, 'enter', animateCfg.animation);\n\n        if (isFunction(animate)) {\n          if (className === 'interval' && coord.isPolar && coord.transposed) {\n            var index = newShape.get('index');\n            var lastShape = updateShapes[index - 1];\n            animate(newShape, animateCfg, lastShape);\n          } else {\n            animate(newShape, animateCfg, coord);\n          }\n        }\n      });\n    }\n\n    function _getAnimateCfgByShapeType(type, chart) {\n      if (!type) {\n        return null;\n      }\n\n      var animateCfg = chart.get('animate');\n\n      if (type.indexOf('guide-tag') > -1) {\n        type = 'guide-tag';\n      }\n\n      if (isObject(animateCfg)) {\n        return animateCfg[type];\n      }\n\n      if (animateCfg === false) {\n        return false;\n      }\n\n      return null;\n    }\n\n    function afterCanvasInit()\n    /* chart */\n    {\n      timeline = new Timeline();\n      timeline.play();\n    }\n\n    function beforeCanvasDraw(chart) {\n      if (chart.get('animate') === false) {\n        return;\n      }\n\n      var isUpdate = chart.get('isUpdate');\n      var canvas = chart.get('canvas');\n      var coord = chart.get('coord');\n      var geoms = chart.get('geoms');\n      var caches = canvas.get('caches') || [];\n\n      if (caches.length === 0) {\n        isUpdate = false;\n      }\n\n      var cacheShapes = getShapes(geoms, chart, coord);\n\n      var _chart$get = chart.get('axisController'),\n          frontPlot = _chart$get.frontPlot,\n          backPlot = _chart$get.backPlot;\n\n      var axisShapes = frontPlot.get('children').concat(backPlot.get('children'));\n      var guideShapes = [];\n\n      if (chart.get('guideController')) {\n        guideShapes = chart.get('guideController').guideShapes;\n      }\n\n      var componentShapes = [];\n      axisShapes.concat(guideShapes).forEach(function (s) {\n        var className = s.get('className');\n\n        var animateCfg = _getAnimateCfgByShapeType(className, chart);\n\n        s.set('coord', coord);\n        s.set('animateCfg', animateCfg);\n        componentShapes.push(s);\n        cacheShapes.push(s);\n      });\n      canvas.set('caches', cache(cacheShapes));\n\n      if (isUpdate) {\n        addAnimate(caches, cacheShapes, canvas);\n      } else {\n        // do the appear animation\n        var animateCfg;\n        var animate;\n        each(geoms, function (geom) {\n          var type = geom.get('type');\n          var geomCfg = isNil(geom.get('animateCfg')) ? _getAnimateCfgByShapeType(type, chart) : geom.get('animateCfg');\n\n          if (geomCfg !== false) {\n            animateCfg = getAnimateCfg(type, 'appear', geomCfg);\n            animate = getAnimate(type, coord, 'appear', animateCfg.animation);\n\n            if (isFunction(animate)) {\n              var shapes = geom.get('shapes');\n              each(shapes, function (shape) {\n                animate(shape, animateCfg, coord);\n              });\n            } else if (GROUP_ANIMATION[type]) {\n              // do the default animation\n              animate = GroupAction[animateCfg.animation] || GROUP_ANIMATION[type](coord);\n              var yScale = geom.getYScale();\n              var zeroY = coord.convertPoint({\n                x: 0,\n                y: yScale.scale(geom.getYMinValue())\n              });\n              var container = geom.get('container');\n              animate && animate(container, animateCfg, coord, zeroY);\n            }\n          }\n        }); // do the animation of components\n\n        each(componentShapes, function (shape) {\n          var animateCfg = shape.get('animateCfg');\n          var className = shape.get('className');\n\n          if (animateCfg && animateCfg.appear) {\n            // if user configure\n            var defaultCfg = Animate.getAnimateCfg(className, 'appear');\n            var appearCfg = deepMix({}, defaultCfg, animateCfg.appear);\n\n            var _animate = getAnimate(className, coord, 'appear', appearCfg.animation);\n\n            if (isFunction(_animate)) {\n              _animate(shape, appearCfg, coord);\n            }\n          }\n        });\n      }\n    }\n\n    function afterCanvasDestroyed()\n    /* chart */\n    {\n      timeline.stop();\n    }\n    var detail = {\n      afterCanvasInit: afterCanvasInit,\n      beforeCanvasDraw: beforeCanvasDraw,\n      afterCanvasDestroyed: afterCanvasDestroyed\n    };\n\n    var Animation = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        afterCanvasInit: afterCanvasInit,\n        beforeCanvasDraw: beforeCanvasDraw,\n        afterCanvasDestroyed: afterCanvasDestroyed,\n        'default': detail\n    });\n\n    Chart._Interactions = {};\n\n    Chart.registerInteraction = function (type, constructor) {\n      Chart._Interactions[type] = constructor;\n    };\n\n    Chart.getInteraction = function (type) {\n      return Chart._Interactions[type];\n    };\n\n    Chart.prototype.interaction = function (type, cfg) {\n      var interactions = this._interactions || {};\n\n      if (interactions[type]) {\n        // if reprated, destroy last\n        interactions[type].destroy();\n      }\n\n      var Ctor = Chart.getInteraction(type);\n      var interact = new Ctor(cfg, this);\n      interactions[type] = interact;\n      this._interactions = interactions;\n      return this;\n    };\n\n    Chart.prototype.clearInteraction = function (type) {\n      var interactions = this._interactions;\n      if (!interactions) return;\n\n      if (type) {\n        interactions[type] && interactions[type].destroy();\n        delete interactions[type];\n      } else {\n        each(interactions, function (interaction, key) {\n          interaction.destroy();\n          delete interactions[key];\n        });\n      }\n\n      return this;\n    };\n\n    function isValuesEqual(values, newValues) {\n      if (values.length !== newValues.length) {\n        return false;\n      }\n\n      var lastIndex = values.length - 1;\n      return values[0] === newValues[0] && values[lastIndex] === newValues[lastIndex];\n    } // 不同交互之间共享的上下文\n\n\n    var defaultRange = [0, 1];\n\n    var Context = /*#__PURE__*/function () {\n      // 最开始的原始值\n      // 当前显示的范围\n      // 缩放最小的点数\n      // 最小的缩放比例, 默认通过minCount计算\n      // minScale = 0.01;\n      // 交互开始时，ticks个数，主要为了每次缩放后，更新ticks个数\n      // lastTickCount;\n      function Context(chart) {\n        var _this = this;\n\n        _defineProperty(this, \"chart\", null);\n\n        _defineProperty(this, \"values\", null);\n\n        _defineProperty(this, \"range\", defaultRange);\n\n        _defineProperty(this, \"startRange\", defaultRange);\n\n        _defineProperty(this, \"minCount\", 10);\n\n        _defineProperty(this, \"_afterinit\", function () {\n          // 初始化value值\n          var scale = _this.getPinchScale(); // 记录原始全量数据\n\n\n          var values = [].concat(scale.values);\n          _this.values = values; // 最小的缩放比例\n\n          if (!_this.minScale) {\n            _this.minScale = _this.minCount / values.length;\n          } // 初始化的时候有设置range，则初始化成默认比例\n\n\n          if (_this.range !== defaultRange) {\n            _this.updateRange(_this.range);\n\n            _this.updateTicks();\n          }\n        });\n\n        _defineProperty(this, \"_afterdatachange\", function () {\n          _this.updateRange(_this.range);\n        });\n\n        this.chart = chart;\n\n        this._initEvent(chart);\n      }\n\n      var _proto = Context.prototype;\n\n      _proto._initEvent = function _initEvent(chart) {\n        // 在整体初始化后还需要设置一些初始状态\n        chart.on(EVENT_AFTER_INIT, this._afterinit);\n        chart.on(EVENT_AFTER_DATA_CHANGE, this._afterdatachange);\n      } // 缩放的主轴scale\n      ;\n\n      _proto.getPinchScale = function getPinchScale() {\n        var chart = this.chart; // 默认缩放x轴\n\n        var scale = chart.getXScale();\n        return scale;\n      } // 跟随轴的scale\n      ;\n\n      _proto.getFollowScale = function getFollowScale() {\n        var chart = this.chart; // 默认缩放x轴\n\n        var scales = chart.getYScales() || [];\n        return scales[0];\n      };\n\n      _proto.start = function start() {\n        var range = this.range;\n        var scale = this.getPinchScale();\n        var start = range[0],\n            end = range[1]; // 记录交互起始的范围\n\n        this.startRange = [start, end]; // 记录开始时的ticks个数\n\n        this.lastTickCount = scale.tickCount;\n      };\n\n      _proto.doZoom = function doZoom(leftScale, rightScale, zoom) {\n        var range = this.startRange,\n            minScale = this.minScale;\n        var start = range[0],\n            end = range[1];\n        var zoomOffset = 1 - zoom;\n        var rangeLen = end - start;\n        var rangeOffset = rangeLen * zoomOffset;\n        var leftOffset = rangeOffset * leftScale;\n        var rightOffset = rangeOffset * rightScale;\n        var newStart = Math.max(0, start - leftOffset);\n        var newEnd = Math.min(1, end + rightOffset);\n        var newRange = [newStart, newEnd]; // 如果已经到了最小比例，则不能再继续再放大\n\n        if (newEnd - newStart < minScale) {\n          return;\n        }\n\n        this.updateRange(newRange);\n      };\n\n      _proto.doMove = function doMove(ratio) {\n        // 不管是0， 还是其他，都不用处理\n        if (!ratio) return;\n        var range = this.startRange;\n        var start = range[0],\n            end = range[1];\n        var rangeLen = end - start;\n        var rangeOffset = rangeLen * ratio;\n        var newStart = start - rangeOffset;\n        var newEnd = end - rangeOffset; // 处理边界值\n\n        var newRange;\n\n        if (newStart < 0) {\n          newRange = [0, rangeLen];\n        } else if (newEnd > 1) {\n          newRange = [1 - rangeLen, 1];\n        } else {\n          newRange = [newStart, newEnd];\n        }\n\n        this.updateRange(newRange);\n      };\n\n      _proto.updateRange = function updateRange(range) {\n        var values = this.values; // 0， 1 的范围之间\n\n        var start = range[0],\n            end = range[1]; // start 不能小于0\n\n        start = Math.max(0, start); // end 不能大于1\n\n        end = Math.min(1, end); // 设置当前的范围\n\n        this.range = [start, end];\n        var len = values.length;\n        var valueStart = start * len;\n        var valueEnd = end * len; // 从原始数据里截取需要显示的数据\n\n        var newValues = values.slice(valueStart, valueEnd);\n        this.repaint(newValues);\n      };\n\n      _proto.repaint = function repaint(newValues) {\n        var chart = this.chart;\n        var scale = this.getPinchScale();\n        var currentValues = scale.values,\n            ticks = scale.ticks; // 如果新数组和当前显示的数组相同，则不更新\n\n        if (isValuesEqual(currentValues, newValues)) {\n          return;\n        } // 更新主轴values\n\n\n        this.updateScale(scale, {\n          ticks: ticks,\n          values: newValues\n        });\n        this.updateFollowScale(scale, newValues);\n        chart.repaint();\n      };\n\n      _proto.updateFollowScale = function updateFollowScale(pinchScale, pinchValues) {\n        var chart = this.chart;\n        var followScale = this.getFollowScale();\n        var pinchField = pinchScale.field,\n            pinchScaleType = pinchScale.type;\n        var followField = followScale.field; // 根据主轴的value值，找到所有从轴的value值\n\n        var values = []; // 转成map，让查找性能更高\n\n        var pinchValueMap = {};\n        pinchValues.forEach(function (item) {\n          pinchValueMap[item] = true;\n        });\n        var data = chart.get('data');\n        data.forEach(function (item) {\n          if (pinchScaleType === 'timeCat') {\n            var value = toTimeStamp(item[pinchField]);\n\n            if (pinchValueMap[value]) {\n              values.push(item[followField]);\n            }\n          }\n        });\n\n        var _getRange = getRange$1(values),\n            min = _getRange.min,\n            max = _getRange.max;\n\n        this.updateScale(followScale, {\n          min: min,\n          max: max,\n          nice: true\n        });\n      };\n\n      _proto.updateScale = function updateScale(scale, cfg) {\n        if (!scale) {\n          return;\n        }\n\n        scale.change(cfg);\n      } // 上一次的tick个数\n      ;\n\n      _proto.updateTicks = function updateTicks() {\n        var chart = this.chart,\n            values = this.values;\n        var scale = this.getPinchScale();\n        var currentValues = scale.values,\n            tickCount = scale.tickCount; // 根据当前数据的比例，和定义的tickCount计算应该需要多少个ticks\n\n        var newTickCount = Math.round(tickCount * values.length / currentValues.length);\n        var catTicks = getTickMethod('cat');\n        var ticks = catTicks({\n          tickCount: newTickCount,\n          values: values\n        });\n        this.updateScale(scale, {\n          ticks: ticks,\n          values: currentValues\n        }); // 更新完后，需要重新绘制一次\n\n        chart.repaint();\n      };\n\n      _proto.destroy = function destroy() {\n        var chart = this.chart;\n        chart.off(EVENT_AFTER_INIT, this._afterinit);\n        chart.off(EVENT_AFTER_DATA_CHANGE, this._afterdatachange);\n      };\n\n      return Context;\n    }();\n\n    var Base$2 = /*#__PURE__*/function () {\n      var _proto = Base.prototype;\n\n      // 交互的上下文\n      _proto.getDefaultCfg = function getDefaultCfg() {\n        return {};\n      };\n\n      _proto.getInteractionContext = function getInteractionContext(chart) {\n        var interactionContext = chart.get('interactionContext');\n\n        if (interactionContext) {\n          return interactionContext;\n        }\n\n        interactionContext = new Context(chart);\n        chart.set('interactionContext', interactionContext);\n        return interactionContext;\n      };\n\n      function Base(cfg, chart) {\n        var _this = this;\n\n        _defineProperty(this, \"type\", '');\n\n        _defineProperty(this, \"startEvent\", 'touchstart');\n\n        _defineProperty(this, \"processEvent\", 'touchmove');\n\n        _defineProperty(this, \"endEvent\", 'touchend');\n\n        _defineProperty(this, \"resetEvent\", null);\n\n        _defineProperty(this, \"context\", null);\n\n        _defineProperty(this, \"_start\", function (ev) {\n          _this.preStart && _this.preStart(ev);\n\n          _this.start(ev);\n\n          _this.onStart && _this.onStart(ev);\n        });\n\n        _defineProperty(this, \"_process\", function (ev) {\n          _this.preProcess && _this.preProcess(ev);\n\n          _this.process(ev);\n\n          _this.onProcess && _this.onProcess(ev);\n        });\n\n        _defineProperty(this, \"_end\", function (ev) {\n          _this.preEnd && _this.preEnd(ev);\n\n          _this.end(ev);\n\n          _this.onEnd && _this.onEnd(ev);\n        });\n\n        _defineProperty(this, \"_reset\", function (ev) {\n          _this.preReset && _this.preReset(ev);\n\n          _this.reset(ev);\n\n          _this.onReset && _this.onReset(ev);\n        });\n\n        mix(this, this.getDefaultCfg(), cfg);\n        this.context = this.getInteractionContext(chart);\n        this.chart = chart; // 只处理range, 暂时先这么处理后面再看情况调整\n\n        var range = this.range;\n\n        if (range) {\n          this.context.range = range;\n        }\n\n        this._bindEvents(chart);\n      }\n\n      _proto._bindEvents = function _bindEvents(chart) {\n        var startEvent = this.startEvent,\n            processEvent = this.processEvent,\n            endEvent = this.endEvent,\n            resetEvent = this.resetEvent;\n        var canvas = chart.get('canvas'); // 统一绑定事件\n\n        canvas.on(startEvent, this._start);\n        canvas.on(processEvent, this._process);\n        canvas.on(endEvent, this._end);\n        canvas.on(resetEvent, this._reset);\n      };\n\n      _proto._clearEvents = function _clearEvents() {\n        var chart = this.chart,\n            startEvent = this.startEvent,\n            processEvent = this.processEvent,\n            endEvent = this.endEvent,\n            resetEvent = this.resetEvent;\n        var canvas = chart.get('canvas'); // 统一绑定事件\n\n        canvas.off(startEvent, this._start);\n        canvas.off(processEvent, this._process);\n        canvas.off(endEvent, this._end);\n        canvas.off(resetEvent, this._start);\n      };\n\n      // override\n      _proto.start = function start() {} // override\n      ;\n\n      _proto.process = function process() {} // override\n      ;\n\n      _proto.end = function end() {} // override\n      ;\n\n      _proto.reset = function reset() {};\n\n      _proto.destroy = function destroy() {\n        this.context.destroy();\n\n        this._clearEvents();\n      };\n\n      return Base;\n    }();\n\n    var Pan = /*#__PURE__*/function (_Base) {\n      _inheritsLoose(Pan, _Base);\n\n      function Pan() {\n        return _Base.apply(this, arguments) || this;\n      }\n\n      var _proto = Pan.prototype;\n\n      _proto.getDefaultCfg = function getDefaultCfg() {\n        return {\n          type: 'pan',\n          startEvent: 'panstart',\n          processEvent: 'pan',\n          endEvent: 'panend'\n        };\n      };\n\n      _proto.start = function start() {\n        var context = this.context;\n        context.start();\n      };\n\n      _proto.process = function process(e) {\n        var direction = e.direction,\n            deltaX = e.deltaX;\n\n        if (direction === 'up' || direction === 'down') {\n          return;\n        }\n\n        e.preventDefault && e.preventDefault();\n        var context = this.context;\n        var chart = context.chart;\n        var coord = chart.get('coord');\n        var start = coord.start,\n            end = coord.end;\n        var coordWidth = end.x - start.x;\n        var ratio = deltaX / coordWidth;\n        context.doMove(ratio);\n      };\n\n      return Pan;\n    }(Base$2);\n\n    var Pinch = /*#__PURE__*/function (_Base) {\n      _inheritsLoose(Pinch, _Base);\n\n      var _proto = Pinch.prototype;\n\n      _proto.getDefaultCfg = function getDefaultCfg() {\n        return {\n          type: 'pinch',\n          startEvent: 'pinchstart',\n          processEvent: 'pinch',\n          endEvent: 'pinchend'\n        };\n      };\n\n      function Pinch(cfg, chart) {\n        var _this;\n\n        _this = _Base.call(this, cfg, chart) || this;\n\n        var _assertThisInitialize = _assertThisInitialized(_this),\n            context = _assertThisInitialize.context;\n\n        mix(context, cfg);\n        return _this;\n      }\n\n      _proto.start = function start() {\n        var context = this.context;\n        context.start();\n      };\n\n      _proto.process = function process(e) {\n        e.preventDefault && e.preventDefault();\n        var zoom = e.zoom,\n            center = e.center;\n        var context = this.context;\n        var chart = context.chart;\n        var coord = chart.get('coord');\n        var start = coord.start,\n            end = coord.end;\n        var coordWidth = end.x - start.x;\n        var leftLen = Math.abs(center.x - start.x);\n        var rightLen = Math.abs(end.x - center.x); // 计算左右缩放的比例\n\n        var leftScale = leftLen / coordWidth;\n        var rightScale = rightLen / coordWidth;\n        context.doZoom(leftScale, rightScale, zoom);\n      };\n\n      _proto.end = function end() {\n        // 缩放完成后再更新ticks\n        var context = this.context;\n        context.updateTicks();\n      };\n\n      return Pinch;\n    }(Base$2);\n\n    Chart.registerInteraction('pan', Pan);\n    Chart.registerInteraction('pinch', Pinch);\n\n    /**\n     * Default, without interactins\n     */\n    var Component = {\n      // 为了兼容之前版本\n      Marker: Shape$2.Marker,\n      Tooltip: Tooltip\n    }; // register plugins\n\n    Chart.plugins.register([Tooltip$1, Legend, Guide, Animation]); // 默认添加交互\n    var index = {\n      Component: Component,\n      Global: Global,\n      Chart: Chart,\n      Shape: Shape$1,\n      G: G,\n      Util: Util,\n      Helper: Helper,\n      track: track,\n      Animate: Animate\n    };\n\n    exports.Animate = Animate;\n    exports.Chart = Chart;\n    exports.Component = Component;\n    exports.G = G;\n    exports.Global = Global;\n    exports.Helper = Helper;\n    exports.Shape = Shape$1;\n    exports.Util = Util;\n    exports.default = index;\n    exports.track = track;\n\n    Object.defineProperty(exports, '__esModule', { value: true });\n\n})));\n"]},"metadata":{},"sourceType":"script"}